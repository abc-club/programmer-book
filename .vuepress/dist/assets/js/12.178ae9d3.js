(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{240:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{align:"center"}},[t._v("postman+newman+Jenkins之API全自动化测试(MAC)")]),t._v(" "),a("h2",{attrs:{id:"名词解释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#名词解释"}},[t._v("#")]),t._v(" 名词解释")]),t._v(" "),a("h3",{attrs:{id:"postman"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#postman"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.getpostman.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("postman"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("主要用于模拟网络请求包\n快速创建请求\n回放、管理请求\n快速设置网络代理")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bd00e2740d6d",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"newman"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#newman"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.npmjs.com/package/newman",target:"_blank",rel:"noopener noreferrer"}},[t._v("newman"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("newman是postman的命令行指令，允许我们在命令行中运行postman collection.\n")])])]),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bd057c6d7e0f",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://jenkins.io/zh/",target:"_blank",rel:"noopener noreferrer"}},[t._v("jenkins"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("Jenkins是一个开源软件项目，是基于Java开发的一种持续集成工具，用于监控持续重复的工作，旨在提供一个开放易用的软件平台，使软件的持续集成变成可能。\n")])])]),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bd08320ae65b",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"准备工作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[t._v("#")]),t._v(" 准备工作")]),t._v(" "),a("h3",{attrs:{id:"安装postman"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装postman"}},[t._v("#")]),t._v(" 安装postman")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v(" 没有太多注意事项，直接[官网下载](https://www.getpostman.com/downloads/)，然后安装\n")])])]),a("h3",{attrs:{id:"安装newman"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装newman"}},[t._v("#")]),t._v(" 安装newman")]),t._v(" "),a("p",[t._v("** 必须选安装node和npm **")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("```\n$ npm install -g newman\n$ newman -v \n```\n")])])]),a("h3",{attrs:{id:"安装jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装jenkins"}},[t._v("#")]),t._v(" 安装jenkins")]),t._v(" "),a("p",[t._v("请参考 https://juejin.im/post/5d52e1865188255d691bdf59")]),t._v(" "),a("h2",{attrs:{id:"postman的使用与导出"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#postman的使用与导出"}},[t._v("#")]),t._v(" postman的使用与导出")]),t._v(" "),a("p",[t._v("下面以网易云音乐登录，然后用接口返回的userId获取用户信息为例")]),t._v(" "),a("ol",[a("li",[t._v("创建test文件夹")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bd0d2dd3b1b1",alt:""}})]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("定义环境，并设置变量")])]),t._v(" "),a("p",[a("strong",[t._v("注意我这里用的是网易云音乐的接口，项目地址：https://github.com/Binaryify/NeteaseCloudMusicApi")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bd3d17aaa8be",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bd62b1bc7816",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bd7703bcc8ce",alt:""}})]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("登录")])]),t._v(" "),a("p",[t._v("先增加两个变量：phone和password\n"),a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8be0e7ebd61fc",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8be28dcbe6635?w=3172&h=1892&f=png&s=349050",alt:""}})]),t._v(" "),a("p",[t._v("接下来便可以使用这几个变量了")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8be3ad9908227",alt:""}}),t._v("\n填好url,点击send,如下图，请求成功\n"),a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8be50b9493e7f",alt:""}}),t._v("\ncmd+s保存这个请求到test文件夹，取名为login\n"),a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8be9ba75eb766",alt:""}})]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[t._v("获取用户信息\n保存userId到变量")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('var data = JSON.parse(responseBody);\n\nif (data.code === 200) {\n  tests["login api"] = true;\n  pm.environment.set("userId", data.profile.userId);\n}\nelse {\n  tests["login api"] = false;\n}\n')])])]),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bec8e320eeff",alt:""}})]),t._v(" "),a("p",[t._v("点击send后，我们可以看到userId被保存到变量中了")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bedfcf7ca70a",alt:""}})]),t._v(" "),a("p",[t._v("开始获取用户信息，这里为了演示更复杂点的功能，我们在header里加个时间戳吧")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('timestamp = new Date();\npostman.setGlobalVariable("timestamp",timestamp);\n')])])]),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bf2a3e17e65c",alt:""}})]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('var data = JSON.parse(responseBody);\n\nif (data.code === 200) {\n  tests["userDetail api"] = true;\n}\nelse {\n  tests["userDetail api"] = false;\n}\n')])])]),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bfab036c32af",alt:""}}),t._v(" "),a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bf3ebda5a296",alt:""}}),t._v("\ncmd+s保存这个请求到test文件夹，取名为userDetail")]),t._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[t._v("执行test文件夹中所有的请求")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bf80d8a1e3c9",alt:""}}),t._v("\n之后看到如下界面，点击run test")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bf8814c52f87",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bfb61d1f55ab",alt:""}})]),t._v(" "),a("ol",{attrs:{start:"6"}},[a("li",[t._v("导出test文件和环境变量文件")])]),t._v(" "),a("p",[t._v("导出请求文件\n"),a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bfccf196755d",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bfd2169b9a50",alt:""}})]),t._v(" "),a("p",[t._v("导出环境变量文件\n"),a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8bfdbcfe06bdc",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"jenkins配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins配置"}},[t._v("#")]),t._v(" jenkins配置")]),t._v(" "),a("ol",[a("li",[t._v("新建任务")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8c00913e77324",alt:""}})]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("填写任务信息")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8c0166647a7a5",alt:""}})]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("配置")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8c0244094be8a",alt:""}})]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 注意这里的PATH要改成你的npm的路径，否则找不到newman命令\n\nexport PATH=/Users/isaacho/.tnvm/versions/alinode/v3.11.4/bin:$PATH\n\nnewman run  /Users/isaacho/Documents/test.postman_collection.json -e /Users/isaacho/Documents/test.postman_environment.json\n\n")])])]),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8c03d4713b46e",alt:""}})]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[t._v("build")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8c061dd0c48f1",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/14/16c8c05943f94b32",alt:""}})]),t._v(" "),a("p",[t._v("到这里已经大功告成了！！！")]),t._v(" "),a("h2",{attrs:{id:"可能遇到的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可能遇到的问题"}},[t._v("#")]),t._v(" 可能遇到的问题")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("build失败，提示找不到命令\n那请注意你的PATH是否正确")])]),t._v(" "),a("li",[a("p",[t._v("build没有权限\njenkins用户没有读写postman_collection.json和postman_environment.json的权限，可以给jenkins修改文件夹的权限")])])]),t._v(" "),a("h2",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),a("ul",[a("li",[t._v("https://www.getpostman.com/docs")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/wanglin_lin/article/details/51959342",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jenkins+postman+newman之API全自动化测试"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://zxning.github.io/2018/12/21/postman/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Mac | 使用postman+newman+Jenkins配置线上接口自动监控"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports}}]);