/*!
 * Tencent Video Player creative plugins.
 * @Copyright 2019 
 * modify at: 2019-07-11 15:53:46
 * power by Tencent Video FE Team
 */
!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=23)}([function(e,t,r){"use strict";e.exports=function(e){return{log:function(){var t=Array.prototype.slice.call(arguments),r=new Date,i=[r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()].join(":");t.unshift(e?"["+i+" TxpCreativePlayer/"+e+"]":""),function(){window.TxpCreativePlayer&&TxpCreativePlayer.debug&&window.console&&window.console.log&&window.console.log.apply(window.console,arguments)}.apply(null,t)},err:function(){var t=Array.prototype.slice.call(arguments),r=new Date,i=[r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()].join(":");t.unshift(e?"["+i+" TxpCreativePlayer/"+e+"]":""),function(){window.TxpCreativePlayer&&TxpCreativePlayer.debug&&window.console&&window.console.error&&window.console.error.apply(window.console,arguments)}.apply(null,t)}}}},function(e,t,r){"use strict";e.exports={AD_STOP:"innerStopAdEvt",AD_SHOW:"innerShowAdEvt",AD_HIDE:"innerHideAdEvt",REPORT_EVENT:{AD_VIEW:"reportAdView",AD_GET_INFO:"reportAdGetInfo",AD_GET_INFO_ERROR:"reportAdGetInfoError",AD_LOAD_COMPLETE:"reportAdLoadComplete",AD_END:"reportAdEnd",AD_CLICK:"reportAdClick",AD_SCREEN_SHOT:"reportAdScreenShot",AD_DURING:"reportAdDuring",AD_MIND_CZC:"reportCzcMind",AD_DP3_CZC:"reportCzcDp3",AD_POINT_VIEW:"reportPointView",AD_3PARTY_VIEW:"report3PartyView",NEW_DP3:"newDp3"},TXPLAYER_EVENT:{AD_REQUEST_ORDER:"requestOrderEvt",AD_GET_INFO:"getAdInfoEvt",AD_LOAD_START:"loadStartEvt",AD_LOAD_READY:"loadReadyEvt",AD_LOAD_PROGRESS:"loadProgressEvt",AD_LOAD_COMPLETE:"loadCompleteEvt",AD_ENTER_COUNTDOWN:"enterCountdownEvt",AD_ENTER_COUNTDOWN_COMPLETE:"enterCountdownCompleteEvt",AD_PLAY_START:"playStartEvt",AD_PLAY_END:"playEndEvt",AD_PLAY_ERROR:"playErrorEvt",AD_SHOW:"showAdEvt",AD_STOP:"stopAdEvt",AD_EXIT_WINDOW_FULLSCREEN:"exitWindowFullscreen",AD_EXIT_BROWSER_FULLSCREEN:"exitBrowserFullscreen",AD_MOVE_IN:"moveinAd",AD_MOVE_OUT:"moveoutAd",AD_REPORT:"reportAd"},TXPLAYER_API:{UP_BARRAGE_ZINDEX:"upBarrageZindex",RESET_BARRAGE_ZINDEX:"resetBarrageZindex",GET_PLAYSTATE:"getPlayState",GET_CONTROL_STATUS:"getControlStatus",GET_VOLUME:"getVolume"},UI_EVENT:{VIDEO_SKIP_TEXT:"videoSkipTextClickEvt",VIDEO_CLOSE_BUTTON_CLICK:"videoCloseButtonClickEvt",VIDEO_NO_SKIP_CLOSE_BUTTON_CLICK:"videoNoSkipCloseButtonClickEvt",VIDEO_NO_SKIP_KNOW_BUTTON_CLICK:"videoNoSkipKnowButtonClickEvt",VIDEO_NO_SKIP_BUTTON_CLICK:"videoNoSkipButtonClickEvt",VIDEO_LINK_AREA_CLICK:"videoLinkAreaClickEvt",VIDEO_DETAIL_BUTTON_CLICK:"videoDetailButtonClickEvt",VIDEO_VOLUME_BUTTON_CLICK:"videoVolumeButtonClickEvt"},VPAID_EVENT:{AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError",AdPauseTimeCount:"AdPauseTimeCount",AdResumeTimeCount:"AdResumeTimeCount"}}},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports={getScale:function(e,t,r,i,n){var a,o,s;return a=r/e,o=i/t,s=Math.min(a,o),n&&(n.width=parseInt(n.width*s),n.height=parseInt(n.height*s)),s||1},checkSuffix:function(e,t){if(!e)return!1;e=e.toLowerCase();var r=/\.(\w+)(?:$|\?|\#)/.exec(e);if(!r||!r[1])return!1;if(!t)return r[1];if("string"==typeof t)return r[1]===t;if(t instanceof Array){for(var i=t.length-1;i>=0;i--)if(r[1]===t[i])return!0;return!1}},loadJs:function(e,t,r,i){var n=document.createElement("script");n.type="text/javascript",n.charset="UTF-8",n.src=e.replace(/http(s)?:/,location.protocol);var a=!1;if(n.onerror=function(e){a=!0,t({src:e.target.src,error:{type:"jserror",code:404}})},n.addEventListener?n.addEventListener("load",function(){a=!0,t()},!1):n.attachEvent&&n.attachEvent("onreadystatechange",function(){"loaded"==window.event.srcElement.readyState&&(a=!0,t())}),i){var o=document.createElement("base");o.href=n.src.match(/.+\//)[0],i.getElementsByTagName("head")[0].appendChild(o)}r?r.appendChild(n):document.getElementsByTagName("head")[0].appendChild(n),setTimeout(function(){a||(t&&t({src:e,error:{type:"js timeout",code:502}}),t=function(){})},5e3)},appendParamsToUrl:function(e,t){return"string"==typeof e&&t&&(e+=(-1==e.indexOf("?")?"?":"&")+this.param2url(t)),e},param2url:function(e){if("object"==(void 0===e?"undefined":i(e))){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r+"="+e[r]);return t.join("&")}return""},url2Obj:function(e){var t={};if(!e)return t;var r=document.createElement("a");r.href=e;var i=r.search||"";return i?((i=i.replace(/^\?/,"").split("&")).forEach(function(e){var r=e.split("=");t[r[0]]=r[1]}),t):t},refreshUrlParamOrder:function(e){if(!e)return"";var t=document.createElement("a");t.href=e;var r=t.search||"";if(!r)return e;if((r=r.replace(/^\?/,"").split("&")).sort(function(){return.5-Math.random()>0?1:-1}),r[0]&&/^vkey/.test(r[0])&&r.length>1){var i=r[0];r[0]=r[1],r[1]=i}return r=r.join("&"),t.href.replace(t.search,"?"+r)},getVideoType:function(){var e="";return window.COVER_INFO&&window.COVER_INFO.typeid?e=+window.COVER_INFO.typeid:window.VIDEO_INFO&&window.VIDEO_INFO.type&&(e=+window.VIDEO_INFO.type),e},getUA:function(e){if(!e)return"unknown";var t=-1,r=(e=e.toLowerCase()).match(/(?:metasr.\d*|qqlive.\d*|qqbrowser.\d*|maxthon.\d*|theworld|lbbrowser|firefox.\d*|opera.\d*|bidubrowser.\d*)/);if(null!==r)return r[0].replace(" ","").replace("/","");if(e.indexOf("android")>-1)return"android";if(e.indexOf("iphone")>-1)return"iphone";if(e.indexOf("ipad")>-1)return"ipad";if((t=e.indexOf("chrome"))>-1)return"chrome"+parseInt(e.substr(t+7,4));if((t=e.indexOf("safari"))>-1)return"safari";var i=e.indexOf("msie");if(i>-1)return"ie"+parseInt(e.substr(i+5,2));if(e.indexOf("trident")>-1){var n=e.indexOf("rv:");if(n>-1)return"ie"+parseInt(e.substr(n+3,2))}return e},cookie:{set:function(e,t,r,i,n){if(n){var a=new Date,o=new Date;o.setTime(a.getTime()+36e5*n)}return document.cookie=e+"="+t+"; "+(n?"expires="+o.toGMTString()+"; ":"")+(i?"path="+i+"; ":"path=/; ")+(r?"domain="+r+";":"domain="+window.location.host+";"),!0},get:function(e){var t=new RegExp("(?:^|;+|\\s+)"+e+"=([^;]*)"),r=document.cookie.match(t);return r?r[1]:""},del:function(e,t,r){var i=new Date;i.setTime(i.getTime()-1),document.cookie=e+"=; expires="+i.toGMTString()+";"+(r?"path="+r+"; ":"path=/; ")+(t?"domain="+t+";":"domain="+window.location.host+";")}}}},function(e,t,r){"use strict";e.exports={LD:"LD",HT:"HT",ZC:"ZC",CZC:"CZC",ZT:"ZT",KB:"KB",PSJ:"PSJ",PPB:"PPB",PVL:"PVL",ZI:"ZI",PDF:"PDF",BS:"BS",TP:"TP",VIN:"VIN"}},function(e,t,r){"use strict";e.exports={INIT:0,LOADING:1,LOAD_READY:2,PLAYING:3,PAUSED:4,END:-1,WAIT_FOR_STOP:-2}},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n="undefined"!=typeof Txplayer&&Txplayer.dataset.hideClass||"txp_none",a={},o=1;e.exports={attr:function(e,t,r){if(!e)return"";if(t){if(void 0!==r)return e.setAttribute(t,r);if("src"!==t)return e.getAttribute(t);e.src=src}return""},removeAttr:function(e,t){e&&t&&("src"===t?delete e.src:e.removeAttribute(t))},css:function(e,t,r){if(!e)return"";if(t){if(void 0===r&&"string"==typeof t){var n={};try{n=document.defaultView.getComputedStyle(e,null)}catch(s){n=e.currentStyle}return n[t]}if(void 0===r&&"object"===(void 0===t?"undefined":i(t))){var a=t;for(var o in a)a.hasOwnProperty(o)&&(/width|height|left|right|top|bottom/.test(o)&&"number"==typeof a[o]&&(a[o]=a[o]+"px"),e.style[o]=a[o])}else"string"==typeof t&&"string"==typeof r&&(/width|height|left|right|top|bottom/i.test(t)&&"number"==typeof r&&(r+="px"),e.style[t]=r)}},append:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();if(t)for(var r=0,i=e.length;r<i;r++)t.appendChild(e[r])},addClass:function(e,t){if(!this.hasClass(e,t))if(e.className&&0!==e.className.length){var r=e.className.split(" ");r.push(t),e.className=r.join(" ")}else e.className=t},removeClass:function(e,t){if(this.hasClass(e,t)){var r=e.className.split(" "),i=r.indexOf(t);r.splice(i,1),e.className=r.join(" ")}},hasClass:function(e,t){return e.className&&e.className.indexOf(t)>-1},hide:function(e){this.addClass(e,n)},show:function(e){this.removeClass(e,n)},on:function(){var e,t=Array.prototype.slice.call(arguments),r=t.shift();if(r&&((e=r)._zid||(e._zid=o++),t.length>=2)){var i=function(e,t,r){var i=e._zid,n={evt:t};return a[i]||(a[i]={}),n.cb=function(e){r(e)},a[i][t]||(a[i][t]=[]),a[i][t].push(n),n}(r,t[0],t[1]),n=t[2];void 0!==n&&(n=!1),"function"==typeof r.addEventListener?r.addEventListener(t[0],i.cb,n):"function"==typeof r.attachEvent?r.attachEvent(t[0],i.cb,n):r["on"+t[0]]=i.cb}},_removeListener:function(e,t,r,i){void 0===i&&(i=!1),"function"==typeof e.removeEventListener?e.removeEventListener(t,r,i):"function"==typeof e.detachEvent?e.detachEvent("on"+t,r,i):e["on"+t]=null},off:function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),r=this;if(t){var i=e[2];if(2===arguments.length)((function(e,t){var r=e._zid,i=[];return a[r]&&(i=a[r][t]),i})(t,e[0],e[1])||[]).forEach(function(e){r._removeListener(t,e.evt,e.cb,!1)}),function(e,t,r){var i=e._zid;a[i]&&(t?delete a[i][t]:delete a[i])}(t,e[0],e[1]);else arguments.length>2&&this._removeListener(t,e[0],e[1],i)}},text:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();if(t)if(1===e.length)t.textContent=e[0];else if(0===e.length)return t.textContent},html:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();if(t)return 1!==e.length?t.innerHTML:void(t.innerHTML=e[0])}}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(i){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=r(4),a=r(3),o=r(1),s=r(0)("base/adBase"),d=r(2),l=r(9),u=0;e.exports=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s.log("new AdBase",t),this._name="adBase",this.infos=t.infos,this.info=t.infos&&t.infos[0]?t.infos[0]:null,this.scene=t.scene,this.dataset=t.dataset,this.$dom=t.dom,this.message=t.message,this.adplayer=t.adplayer,this._canPlay=!1,this._isShow=!1,this._state=n.INIT,this._isSmallWindow=!1}return i(e,[{key:"_loadReadyHandler",value:function(e){this._canPlay=!0,this._state=n.loadReady,this._emitEvent(o.TXPLAYER_EVENT.AD_LOAD_READY,e)}},{key:"_emitEvent",value:function(e,t){void 0===t&&(t={adtype:this.adtype,adinfo:this.info,isWholeScene:this.isWholeScene}),this.message&&this.message.emit(e,t)}},{key:"callOuterApi",value:function(e){var t=this.adplayer.getConf();if(t.playerMethod&&"function"==typeof t.playerMethod[e]){var r=Array.prototype.slice.call(arguments);return r.shift(),t.playerMethod[e].apply(null,r)}}},{key:"initUI",value:function(e,t,r){var i=e.layer;if(i){var n=this.template(r);if(!i.innerHTML||-1==i.innerHTML.indexOf(n)){var a=document.createElement("div");a.innerHTML=n,i.appendChild(a.children[0])}for(var o in r)r.hasOwnProperty(o)&&(t["$"+o]=i.querySelector('[data-role="'+r[o]+'"]'))}}},{key:"addEvent",value:function(){}},{key:"removeEvent",value:function(){}},{key:"load",value:function(){if(this._state=n.LOADING,this.info&&this.info.isEmpty&&!this.info.isVideoAd){if(this.adtype==a.PDF)return;this.message.emit(o.REPORT_EVENT.AD_VIEW,{adInfo:this.info})}}},{key:"play",value:function(){if(this._state=n.PLAYING,!this._isStart){this._isStart=!0;var e=this.adtype;e!==a.PDF&&e!==a.PPB&&e!==a.PVL&&this.message.emit(o.TXPLAYER_EVENT.AD_SHOW,{adtype:e})}}},{key:"pause",value:function(){this._state=n.PAUSED}},{key:"resume",value:function(){this._state=n.PLAYING}},{key:"mute",value:function(){}},{key:"unMute",value:function(){}},{key:"setVolume",value:function(){}},{key:"resize",value:function(e){}},{key:"setFullScreen",value:function(){}},{key:"setSmallWindow",value:function(e){this._isSmallWindow=e&&e.isSmallWindow}},{key:"stop",value:function(e){this._isStart=!1,this.removeEvent(),this._state=n.END,this._emitEvent(o.AD_STOP,e),this.adtype!==a.LD&&this.adtype!==a.KB&&this.adtype!==a.HT&&this.adtype!==a.ZC&&this.message.emit(o.TXPLAYER_EVENT.AD_STOP,{adtype:this.adtype})}},{key:"waitForStop",value:function(){this._state=n.WAIT_FOR_STOP}},{key:"show",value:function(){if(!this._isShow){this._isShow=!0;var e=this.adtype;e!==a.LD&&e!==a.KB&&e!==a.HT&&e!==a.ZC&&e!==a.PSJ&&e!==a.PDF&&e!==a.PPB&&e!==a.PVL&&this.message.emit(o.TXPLAYER_EVENT.AD_SHOW,{adtype:e})}this._emitEvent(o.AD_SHOW),this.showTime||(this.showTime=+new Date)}},{key:"hide",value:function(){this._isShow=!1,this._emitEvent(o.AD_HIDE)}},{key:"destroy",value:function(){}},{key:"openLink",value:function(){if(this.info&&this.info.link){var e=(new Date).getTime();if(e-u<300)s.log("click too fast");else{u=e;var t=this.adplayer.getConf(),r=t&&t.playerData&&t.playerData.playerPfEx||"",i=d.appendParamsToUrl(this.info.link,{pf_ex:r||"",appversion:l});window.open(i),this._emitEvent(o.REPORT_EVENT.AD_CLICK,{adInfo:this.info,adclick:this.info.order_id,clicktime:+new Date-this.showTime,scene:this.scene})}}}},{key:"template",value:function(e){return""}},{key:"adtype",get:function(){return this.info?this.info.adtype:""}},{key:"isWholeScene",get:function(){return!!this.scene&&this.scene.isWholeScene}},{key:"canPlay",get:function(){return this._canPlay}},{key:"state",get:function(){return this._state}},{key:"isShow",get:function(){return this._isShow}}]),e}()},function(e,t,r){(function(i,n){var a;!function(i){var o=i.Promise,s=o&&"resolve"in o&&"reject"in o&&"all"in o&&"race"in o&&function(){var e;return new o(function(t){e=t}),"function"==typeof e}();void 0!==t&&t?(t.Promise=s?o:D,t.Polyfill=D):(a=function(){return s?o:D}.call(t,r,t,e))===undefined||(e.exports=a);var d="pending",l="sealed",u="fulfilled",c="rejected",h=function(){};function f(e){return"[object Array]"===Object.prototype.toString.call(e)}var p,v=void 0!==n?n:setTimeout,y=[];function g(){for(var e=0;e<y.length;e++)y[e][0](y[e][1]);y=[],p=!1}function m(e,t){y.push([e,t]),p||(p=!0,v(g,0))}function E(e){var t=e.owner,r=t.state_,i=t.data_,n=e[r],a=e.then;if("function"==typeof n){r=u;try{i=n(i)}catch(o){b(a,o)}}_(a,i)||(r===u&&T(a,i),r===c&&b(a,i))}function _(e,t){var r;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"==typeof t)){var i=t.then;if("function"==typeof i)return i.call(t,function(i){r||(r=!0,t!==i?T(e,i):A(e,i))},function(t){r||(r=!0,b(e,t))}),!0}}catch(n){return r||b(e,n),!0}return!1}function T(e,t){e!==t&&_(e,t)||A(e,t)}function A(e,t){e.state_===d&&(e.state_=l,e.data_=t,m(S,e))}function b(e,t){e.state_===d&&(e.state_=l,e.data_=t,m(R,e))}function w(e){var t=e.then_;e.then_=undefined;for(var r=0;r<t.length;r++)E(t[r])}function S(e){e.state_=u,w(e)}function R(e){e.state_=c,w(e)}function D(e){if("function"!=typeof e)throw new TypeError("Promise constructor takes a function argument");if(this instanceof D==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(e,t){function r(e){b(t,e)}try{e(function(e){T(t,e)},r)}catch(i){r(i)}}(e,this)}D.prototype={constructor:D,state_:d,then_:null,data_:undefined,then:function(e,t){var r={owner:this,then:new this.constructor(h),fulfilled:e,rejected:t};return this.state_===u||this.state_===c?m(E,r):this.then_.push(r),r.then},"catch":function(e){return this.then(null,e)}},D.all=function(e){if(!f(e))throw new TypeError("You must pass an array to Promise.all().");return new this(function(t,r){var i=[],n=0;function a(e){return n++,function(r){i[e]=r,--n||t(i)}}for(var o,s=0;s<e.length;s++)(o=e[s])&&"function"==typeof o.then?o.then(a(s),r):i[s]=o;n||t(i)})},D.race=function(e){if(!f(e))throw new TypeError("You must pass an array to Promise.race().");return new this(function(t,r){for(var i,n=0;n<e.length;n++)(i=e[n])&&"function"==typeof i.then?i.then(t,r):t(i)})},D.resolve=function(e){return e&&"object"==typeof e&&e.constructor===this?e:new this(function(t){t(e)})},D.reject=function(e){return new this(function(t,r){r(e)})}}("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this)}).call(t,r(6),r(14).setImmediate)},function(e,t,r){"use strict";e.exports="1.0.141"},function(e,t,r){"use strict";var i=r(45)();e.exports=function(e){return e!==i&&null!==e}},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=r(0)("material/vpaid"),a=r(2),o=r(5),s=r(12),d=r(3),l=r(1).VPAID_EVENT,u=r(18),c={NOT_START:0,READY:1,LOAD_COMPLETE:2,PLAYING:3,PAUSE:4,END:5,STOP:6},h=0,f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instanceCount=h++,n.log("new Vpaid:",this.instanceCount),this.init(t),this.playState=c.NOT_START}return i(e,[{key:"init",value:function(e){this.params=e,this.wrapper=e.container,this.outerEvents=e.events;this.playTimer=new s,this.iframe=document.createElement("iframe"),this.iframe.id="adLoaderIframe"+this.instanceCount,this.iframe.name="adLoaderIframe"+this.instanceCount,this.iframe.frameBorder=0;try{this.iframe.setAttribute("allow","autoplay")}catch(t){n.log('iframe.setAttribute("allow", "autoplay") : ',t)}o.css(this.iframe,{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"none","pointer-events":"auto"}),this.wrapper.appendChild(this.iframe),o.css(this.iframe.contentWindow.document.body,{overflow:"hidden"})}},{key:"loadAd",value:function(e){n.log("load vpaid:",e,this.instanceCount),this.loadParams=e,this.outerEvents=e.events,this.api=e.api,this.info=e.info,this.duration=parseInt(e.adInfo.duration);var t=this;e.adInfo.richRes||(n.log("load vpaid error, richRes is empty."),this.callOuterEvents(l.AdError,this.loadParams),this.stopAd()),setTimeout(function(){var r=a.appendParamsToUrl(e.adInfo.richRes,{t:(new Date).getTime()});n.log("\u5bcc\u5a92\u4f53js\u5f00\u59cb\u52a0\u8f7d\uff1a",r,t.iframe.contentWindow,t.instanceCount),a.loadJs(r,t.onInitAd.bind(t),t.iframe.contentWindow.document.body,t.iframe.contentWindow.document)},100)}},{key:"onInitAd",value:function(e){var t,r=this;if(e&&e.error)return n.log("\u5bcc\u5a92\u4f53js\u52a0\u8f7d\u5931\u8d25\uff1a",e.error,this.instanceCount),this.loadParams.error=e.error,this.callOuterEvents(l.AdError,this.loadParams),void this.stopAd();if(n.log("vpaid params",this.params),this.params&&this.params.adInfo){this.params.adInfo.adtype!=d.ZI&&this.params.adInfo.adtype!==d.LD||(o.on(this.iframe.contentWindow.document.body,"click",function(e){n.log("\u70b9\u51fb\u4e86\u5bcc\u5a92\u4f53iframe"),e.currentTarget!==e.target&&e.target.dataset.click||(clearTimeout(t),t=setTimeout(function(){var e=r.safeCallOuterApi("getPlayState");r.safeCallOuterApi("getPlayState");e===u.PLAYING?r.safeCallOuterApi("userPausePlayer"):e===u.PAUSE&&r.safeCallOuterApi("userPlay")},300))}),o.on(this.iframe.contentWindow.document.body,"dblclick",function(e){clearTimeout(t),r.safeCallOuterApi("toggleWindowFullScreen")})),this.events={AdLoaded:l.AdLoaded,AdStarted:l.AdStarted,AdStopped:l.AdStopped,AdPaused:l.AdPaused,AdPlaying:l.AdPlaying,AdError:l.AdError,AdVideoStart:l.AdVideoStart,AdClickThru:l.AdClickThru,AdVideoComplete:l.AdVideoComplete,AdPauseTimeCount:l.AdPauseTimeCount,AdResumeTimeCount:l.AdResumeTimeCount};var i=this,a=i.iframe.contentWindow.getVPAIDAd;if(a&&"function"==typeof a){for(var s in i.VPAIDCreative=a(),this.events)i.VPAIDCreative.subscribe(i.onSubscribe,s,i);setTimeout(function(){i.VPAIDCreative.initAd(i.params.adWidth||i.params.playerData.playerWidth,i.params.adHeight||i.params.playerData.playerHeight,"normal",0,i.loadParams.adInfo.richData)},10)}}}},{key:"onSubscribe",value:function(e,t){this.events[e]&&this[this.events[e]](t)}},{key:"safeCallOuterApi",value:function(){var e=Array.prototype.slice.call(arguments).shift();if(this.api&&e&&this.api[e])try{return this.api[e]()}catch(t){n.log("call outer api error: ",e,", ",t)}}},{key:"safeCallCreativeMethod",value:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();if(this.VPAIDCreative&&t&&this.VPAIDCreative[t])try{return this.VPAIDCreative[t].apply(this.VPAIDCreative,e)}catch(r){n.log("call vpaid method error: ",t,", ",r)}}},{key:"resize",value:function(e,t){this.safeCallCreativeMethod("resizeAd",e,t)}},{key:"mute",value:function(e){this.safeCallCreativeMethod("mute",e)}},{key:"setVolume",value:function(e){this.safeCallCreativeMethod("setAdVolume",e),!TxpCreativePlayer.fromPcClient&&this.api.getBrowserDisableIframeAutoPlay()&&(0===e?this.mute(!0):this.mute(!1))}},{key:"setPos",value:function(e){this.safeCallCreativeMethod("setPos",e)}},{key:"continueTimeout",value:function(){var e=this;this.duration>0&&this.params.adInfo.adtype!=d.ZT&&this.params.adInfo.adtype!=d.ZI&&this.playTimer.on(this.duration,function(){e.callOuterEvents(l.AdVideoComplete,e.loadParams),e.stopAd(),n.log("rich ad timeout !!!!  ",e.loadParams,e.instanceCount)})}},{key:"play",value:function(){this.VPAIDCreative&&(this.continueTimeout(),this.playState===c.PAUSE?(this.safeCallCreativeMethod("resumeAd"),this.playTimer.go()):this.playState===c.PAUSE&&this.playState===c.STOP&&this.playState===c.END||this.safeCallCreativeMethod("startAd"))}},{key:"pause",value:function(){this.playState!==c.PAUSE&&this.VPAIDCreative&&(this.safeCallCreativeMethod("pauseAd"),this.playTimer.pause())}},{key:"stopAd",value:function(){this.playState!==c.STOP&&(this.playTimer&&this.playTimer.clear(),this.VPAIDCreative&&(this.safeCallCreativeMethod("stopAd"),this.destroy()))}},{key:"callOuterEvents",value:function(e,t){if(n.log("callOuterEvents: ",e,t),this.outerEvents&&"function"==typeof this.outerEvents[e])try{this.outerEvents[e](t)}catch(r){n.log("callOuterEvents error: ",r)}}},{key:"destroy",value:function(){n.log("vpaid destroy.",this.instanceCount),this.playTimer&&this.playTimer.clear(),this.wrapper&&this.iframe&&this.wrapper.contains(this.iframe)&&this.wrapper.removeChild(this.iframe)}}]),e}();for(var p in l)l.hasOwnProperty(p)&&(f.prototype[p]||(f.prototype[p]=function(e){return function(t){var r=this;return e===l.AdPaused&&(this.playState=c.PAUSE),e!==l.AdStarted&&e!==l.AdPlaying||(this.playState=c.PLAYING),e===l.AdLoaded&&(this.playState=c.LOAD_COMPLETE),e!==l.AdStopped&&e!==l.AdError||(this.playState=c.STOP),e!==l.AdStopped&&e!==l.AdError||setTimeout(function(){r.destroy()},100),this.callOuterEvents(e,t)}}(p)));e.exports=f},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timer=null,this.startTime=null,this.during=0,this.remain=-1,this.callback=null}return i(e,[{key:"on",value:function(e,t){var r=this;e<0||"function"==typeof t&&(this.clearTimer(),this.during=e,this.callback=t,this.timer=setTimeout(function(){r.callback&&r.callback(),r.clear()},e),this.startTime=(new Date).getTime())}},{key:"pause",value:function(){var e=(new Date).getTime()-this.startTime;e>this.during||(this.remain=this.during-e,this.clearTimer())}},{key:"go",value:function(){this.remain<0||this.on(this.remain,this.callback)}},{key:"clearTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.startTime=null,this.during=0}},{key:"clear",value:function(){this.clearTimer(),this.callback=null,this.remain=-1}}]),e}();e.exports=n},function(e,t,r){"use strict";var i=Object.prototype.hasOwnProperty,n=Object.prototype.toString,a=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===n.call(e)},o=function(e){if(!e||"[object Object]"!==n.call(e))return!1;var t,r=i.call(e,"constructor"),a=e.constructor&&e.constructor.prototype&&i.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!r&&!a)return!1;for(t in e);return void 0===t||i.call(e,t)};e.exports=function s(){var e,t,r,i,n,d,l=arguments[0],u=1,c=arguments.length,h=!1;for("boolean"==typeof l&&(h=l,l=arguments[1]||{},u=2),(null==l||"object"!=typeof l&&"function"!=typeof l)&&(l={});u<c;++u)if(null!=(e=arguments[u]))for(t in e)r=l[t],l!==(i=e[t])&&(h&&i&&(o(i)||(n=a(i)))?(n?(n=!1,d=r&&a(r)?r:[]):d=r&&o(r)?r:{},l[t]=s(h,d,i)):void 0!==i&&(l[t]=i));return l}},function(e,t,r){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(n.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new a(n.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r(15),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(t,r(6))},function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var i,n,a,o,s,d=1,l={},u=!1,c=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick(function(){p(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){p(e.data)},i=function(e){a.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,i=function(e){var t=c.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):i=function(e){setTimeout(p,0,e)}:(o="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&p(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),i=function(t){e.postMessage(o+t,"*")}),h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return l[d]=n,i(d),d++},h.clearImmediate=f}function f(e){delete l[e]}function p(e){if(u)setTimeout(p,0,e);else{var t=l[e];if(t){u=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(r,i)}}(t)}finally{f(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,r(6),r(16))},function(e,t){var r,i,n=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var d,l=[],u=!1,c=-1;function h(){u&&d&&(u=!1,d.length?l=d.concat(l):c=-1,l.length&&f())}function f(){if(!u){var e=s(h);u=!0;for(var t=l.length;t;){for(d=l,l=[];++c<t;)d&&d[c].run();c=-1,t=l.length}d=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new p(e,t)),1!==l.length||u||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=v,n.addListener=v,n.once=v,n.off=v,n.removeListener=v,n.removeAllListeners=v,n.emit=v,n.prependListener=v,n.prependOnceListener=v,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function S(e,t,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(i===undefined){var n=Object.getPrototypeOf(e);return null===n?undefined:S(n,t,r)}if("value"in i)return i.value;var a=i.get;return a===undefined?undefined:a.call(r)};var a=r(7),o=r(61),s=r(11),d=r(12),l=r(62),u=r(5),c=r(2),h=r(0),f=r(63),p=r(1),v=p.VPAID_EVENT,y=r(3),g=r(4),m=r(66),E=r(9),_=r(67),T=r(68),A=r(70),b=!1;function w(){if(!/mobile|mqqbrowser|android|iphone/gi.test(navigator.userAgent))try{var e=window.$;if(!e)return;var t=e('<div class="adsbox" style="position:absolute;left:-9999px;top:-9999px;width:1px;height:1px;"></div>').appendTo(e(document.body)),r=e('<div class="side_ad" style="position:absolute;left:-9999px;top:-9999px;width:1px;height:1px;"></div>').appendTo(e(document.body));window.setTimeout(function(){try{b=!0,0!==t[0].offsetHeight&&r.is(":visible")||(TxpCreativePlayer.adBlockEnabled=!0),t.remove(),r.remove()}catch(e){}},100)}catch(i){}}window.document&&document.body?w():window.document.addEventListener&&document.addEventListener("readystatechange",function(){b||"interactive"!=document.readyState&&"complete"!=document.readyState||w()}),e.exports=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.logger=h("base/videoAdBase("+e._name+")"),r.message=e.message,r.adplayer=e.adplayer,r.videoAdUi=r.adplayer.videoAdUi,r.conf=r.adplayer.getConf(),TxpCreativePlayer.fromPcClient||(r.blockScreen=new A(r.conf,r.adplayer.$dom.$videoAd.$videoBlackScreen)),r.reset(),r.initVideo(),r.bindVideoEvent(),r.bindVideoUiEvent(),r.bindBrowserEvent(),r.initOrderResource(e.infos),r.geturls=new T,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a),i(t,[{key:"reset",value:function(){if(this.queue&&this.queue.length>0)for(var e=0,t=this.queue.length;e<t;e++)this._clearAdTimer(this.queue[e]);this.volume=0,this.$videos=[],this.queue=[],this.emptyQueue=[],this.richMediaMap={},this.currentAdIndex=0,this.nextAdIndex=0,this.rollbackAdIndex=0,this.duration=0,this.countdown=0,this.showCountdown=0,this.isLoadComplete=!1,this.prevCurrentTime=-1,this.$currentVideo=null,this.$preloadVideo=null,this.ordertype="",this.isEmpty=!1,this.emptyCount=0,this.errorCount=0,this.firstShowTrueView=!1,this.isTrueView=!1,this.rfid="",this.errorCode="",this.currentPlayAdType="",this.isMute=!1,this.hasReportVideoEnd=!1,this.hasDestroy=!1,this.userCloseOrderId="",this.firstViewTime=0,this.firstLoadingStartTime=0,this.firstLoadingEndTime=0,this.playedTime=0,this.setViewMonitor=!1,this.hasReportPlayStartArr=[],this.hasPlaying=[]}},{key:"load",value:function(){this._state!==g.WAIT_FOR_STOP&&n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this)}},{key:"play",value:function(){if(this.currentPlayAdType=this.ordertype,this.ordertype===y.HT&&this._state===g.WAIT_FOR_STOP)return n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"pause",this).call(this),void this.reportVideoEnd();this._state!==g.PLAYING&&((this.$currentVideo||this.richMediaPlayer)&&this.queue[this.currentAdIndex].status===g.PAUSED?this.resume():this.start(this.currentAdIndex))}},{key:"resume",value:function(){var e=this;n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resume",this).call(this);var r=this.queue[this.currentAdIndex];if(r)if(r.isRichMedia&&this.richMediaPlayer)this.richMediaPlayer.play(),this.startCountDown();else if(this.$currentVideo){var i=this.$currentVideo.play();i&&i["catch"](function(t){e.logger.log("resume:",t)}),this.startCountDown()}}},{key:"pause",value:function(){if(this._state!==g.PAUSED){n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"pause",this).call(this);var e=this.queue[this.currentAdIndex];e&&(e.isRichMedia&&this.richMediaPlayer?(this.richMediaPlayer.pause(),this.stopCountDown()):this.$currentVideo&&(this.$currentVideo.pause(),this.stopCountDown()))}}},{key:"mute",value:function(){this.$videos.forEach(function(e){e.el.muted=!0}),this.richMediaPlayer&&this.richMediaPlayer.mute(!0)}},{key:"unMute",value:function(){this.$videos.forEach(function(e){e.el.muted=!1}),this.richMediaPlayer&&this.richMediaPlayer.mute(!1)}},{key:"setVolume",value:function(e){e=Math.max(0,Math.min(1,e/100)),this.volume=e,this.isMute=0===this.volume,this.$videos.forEach(function(t){t.el.volume=e}),this.richMediaPlayer&&this.richMediaPlayer.setVolume(100*e),this.isMute?this.mute():this.unMute(),this.videoAdUi.updateVideoVolumeBtn({mute:this.isMute})}},{key:"resize",value:function(e){var t=e.width,r=e.height;this.richMediaPlayer&&this.richMediaPlayer.resize(t,r)}},{key:"adjustUI",value:function(e){if(e){var t=(e.top||10)+"px",r=(e.bottom||10)+"px";this.videoAdUi.adjustVideoAdControl({top:t,bottom:r})}}},{key:"stop",value:function(e){this.blockScreen&&this.blockScreen.reset(),this.reportVideoEnd(e)}},{key:"clearVideoDom",value:function(){var e=this;this.logger.log("clearVideoDom");var t=this.adplayer.$dom.$videoAd.$videoAdContainer.querySelectorAll("video");(t=Array.prototype.slice.call(t)).forEach(function(t){if(t)try{u.removeAttr(t,"src"),t.pause(),e.adplayer.$dom.$videoAd.$videoAdContainer.removeChild(t)}catch(r){e.logger.err("clearVideoDom: ",r)}})}},{key:"initVideo",value:function(){this.clearVideoDom(),this.volume=Math.min(1,Math.max(0,this.callOuterApi(p.TXPLAYER_API.GET_VOLUME)/100));for(var e=0;e<2;e++){var t=document.createElement("video");t.crossOrigin="*",u.hide(t),u.attr(t,"data-idx",e),this.$videos.push({el:t,status:m.EMPTY,vindex:-1}),this.adplayer.$dom.$videoAd.$videoAdContainer.appendChild(t),t.volume=Math.min(1,Math.max(0,this.callOuterApi(p.TXPLAYER_API.GET_VOLUME)/100)),new o(this.$videos[e].el,"",{preload:"none",style:{position:"absolute",top:0,left:0}})}this.volume?this.unMute():this.mute()}},{key:"initOrderResource",value:function(e){var t=this,r=e.length>0&&e[0].isAutoPlay,i=0,n=0;e&&e.length||(this.isEmpty=!0),this.ordertype=e.adtype===y.KB?y.LD:e.adtype,this.orderList=e;var a=0,o=0,s=0;e.forEach(function(e,r){if(e.adtype===y.KB?(o++,e.orderIdx=o):(s++,e.orderIdx=s),t.ordertype||(t.ordertype=e.adtype===y.KB?y.LD:e.adtype),t.rfid||(t.rfid=e.rfid),e.isEmpty)i++,t.emptyQueue.push({adtype:e.adtype,_index:r,realDuration:0,duration:0,loadStartTime:0,loadCompleteTime:0,viewTime:0,orderId:e.order_id}),t.message.emit(p.REPORT_EVENT.AD_VIEW,{adInfo:t.orderList[r],scene:t.scene});else{var d=e.creative?e.creative[0].material[0]:{},l=parseInt(e.duration/1e3,10);t.duration+=l,d.url&&e.order_id&&(e.adtype!==y.KB&&(t.showCountdown+=l),a++,t.queue.push({tpIndex:a,_index:r,index:n,fileSize:(+d.cs||0)/1024,playStartTime:0,loadStartTime:0,loadCompleteTime:0,viewStartTime:0,viewTime:0,adtype:e.adtype,status:g.INIT,speed:0,loadedPercent:0,url:c.refreshUrlParamOrder(d.url),link:e.link,duration:l,width:d.width,height:d.height,orderId:e.order_id,vid:d.vid||e.vid,adFlag:e.adFlag,isRichMedia:e.isRichMedia||!1,isTrueView:e.isTrueView||!1,isVip:e.userIsVip||!1,canSkip:e.canSkip||!1,displayCode:e.display_code,dspName:e.dsp_name,noClick:e.no_click,hasReportView:!1,hasReportLoadComplete:!1,reportUrlView:e.reportUrlView})),e.isRichMedia&&(t.queue[n].adInfo=e),n++}}),this.countdown=this.duration,this.emptyCount=i,this.isTrueView=("in"===this.conf.playerData.playerPf||"client"===this.conf.playerData.playerPf)&&1===this.queue.length&&this.queue[0].isTrueView,e&&this.emptyCount===e.length&&(this.isEmpty=!0),this.isEmpty?(this.logger.log("\u7a7a\u8ba2\u5355"),this.reportVideoEnd()):(this.logger.log("\u4e00\u5171\u6709["+this.queue.length+"]\u4e2a\u975e\u7a7a\u8ba2\u5355\uff0c\u603b\u65f6\u957f: ",this.duration,"s"),this.lastVideoIndex=this.queue.length-1,r?(this.readyToPlay=!0,this.play()):this.preloadNext(this.currentAdIndex))}},{key:"updateVideoUi",value:function(e){var t=this.videoAdUi;t.resetVideoUi();var r=this.queue[e];if(r){r.viewStartTime=+new Date;var i=!!r.isRichMedia;this.showCloseButton="function"==typeof this.conf.playerMethod.showOpenVIPGuide;if(this.canClickToStopAd=!1,this.showCloseButton=this.showCloseButton||this.canClickToStopAd,this.canSkip=r.canSkip,this.logger.log("\u66f4\u65b0\u89c6\u56fe: \u7b2c",e,"\u4e2a"),t.updateVideoLayer(!0),t.updateVideoAdInner(!0),"VipDisplay"===r.displayCode?t.updateVideoAdControl(!1):t.updateVideoAdControl(!0),i?(t.updateVideoRichMediaAdContainer(i),t.updateVideoAdLayer(!i)):(t.updateVideoAdLayer(!i),t.updateVideoRichMediaAdContainer(i)),t.updateVideoDSP(r.dspName),t.toggleVideoCountDown(this.showCountdown>0),r.isRichMedia||!r.link||"N"!=r.noClick?t.updateLinkArea(!1):t.updateLinkArea(!0),r.link&&"N"==r.noClick?t.updateDetail(!0):t.updateDetail(!1),t.updateVideoVolumeBtn({mute:this.isMute}),!r.canSkip)return t.showVideoForbidSkipAd(r.adFlag),void t.toggleVideoCountDown(!1);if(r.adtype===y.KB){if(!this.showCloseButton)return void t.updateCloseButton({show:!1});t.updateCloseButton({text:"\u5173\u95ed\u5e7f\u544a",show:!0})}if(r.isVip){var n="VipCommand"===r.displayCode,a={showCloseButton:!0,showVipCommand:n,showVipClick:!n};return n&&t.updateDetail(!1),t.updateSkipTips(a),void t.toggleVideoCountDown(!0)}this.isTrueView&&(this.canClickToStopAd=!0,t.updateTrueview({countdown:this.firstShowTrueView?0:5,showCloseButton:this.showCloseButton,duration:r.duration}),this.firstShowTrueView=!0),t.updateSkipTips({isTrueView:this.isTrueView,showVipClick:!1,showCloseButton:this.showCloseButton,shortVideo:!1})}}},{key:"startCountDown",value:function(){var e=this;"running"!==this.countDownStatus&&(this.countDownStatus="running",this.showCountdown>0&&this.setCountdonw(),this.countDownInterval=setInterval(function(){if(e.countdown=e.countdown-1,e.showCountdown=e.showCountdown-1,0===e.countdown&&e.videoAdUi.resetVideoUi(),e.countdown<=0){if(e.stopCountDown(),e.videoAdUi.updateVideoCountDown(""),e.videoAdUi.toggleVideoCountDown(!1),e.queue.length>0){var t=1e3*(e.duration-e.playedTime);setTimeout(function(){if(e.queue.length>0&&!e.hasReportVideoEnd){if(e.logger.log("\u5012\u8ba1\u65f6\u7ed3\u675f\u4e86"),e.$currentVideo&&e.currentAdIndex===e.lastVideoIndex){var t=e.$currentVideo.currentTime/e.$currentVideo.duration;t>=0&&t<.5&&(e.logger.log("\u6700\u540e\u4e00\u4e2avideo\uff0c\u64ad\u653e\u65f6\u95f4\u4e0d\u8db3\u4e00\u534a\uff0c\u8ba4\u4e3a\u5361\u987f\u800c\u7ed3\u675f"),e.errorCode=2201)}else e.currentAdIndex<e.lastVideoIndex&&(e.logger.log("\u6700\u540e\u6709\u5e7f\u544a\u6ca1\u64ad\u653e\uff0c\u8ba4\u4e3a\u5361\u987f\u800c\u7ed3\u675f"),e.errorCode=2201);e.reportVideoEnd()}},t)}}else"running"===e.countDownStatus&&(e.showCountdown>0?(e.playedTime++,e.setCountdonw()):(e.videoAdUi.updateVideoCountDown(""),e.videoAdUi.toggleVideoCountDown(!1)))},1e3))}},{key:"stopCountDown",value:function(){clearInterval(this.countDownInterval),this.countDownStatus="stop"}},{key:"startRichMedia",value:function(){this.richMediaPlayer&&(this.richMediaPlayer.setVolume(100*this.volume),this.startCountDown(),this.richMediaPlayer.play())}},{key:"start",value:function(e){var t=this.queue[e];if(this.logger.log("\u5f00\u59cb\u64ad\u653e: \u7b2c",e,"\u4e2a"),this.adViewMonitor||(this.adViewMonitor=new l(this.adplayer.$dom.$videoAd.$videoContainer)),t.isRichMedia)t.status===g.INIT?(this.currentAdIndex=e,this.preloadRichMedia(e,!0),this._startAdTimer(14,t),this.updateVideoUi(e)):t.status===g.LOAD_READY&&this.richMediaMap["rich_"+e]&&(this.currentAdIndex=e,this.richMediaPlayer=this.richMediaMap["rich_"+e],this.updateVideoUi(e),t.playStartTime||(t.playStartTime=+new Date),this.startRichMedia(),this.adViewMonitor.start(t),this._startAdTimer(14,t));else if(t&&t.url){this.showCloseButton="function"==typeof this.conf.playerMethod.showOpenVIPGuide;this.canClickToStopAd=!1,this.showCloseButton=this.showCloseButton||this.canClickToStopAd,this.setCountdonw(),this._resetFreeVideo();var r=this._getVideoByIndex(e);r||((r=this._getFreeVideo()).vindex=e);var i=r&&r.el;i&&(this.logger.log("-==>>> start: ",r.vindex,r.status),r.status===m.EMPTY?(r.status=m.PLAYING,this.playUrl(t)):r.status===m.PRELOADING&&(r.status=m.PLAYING,this.playVideo(r)),this.updateVideoUi(e),i.preload="auto",u.show(i),this._hideFreeVideo(),this.currentAdIndex=e,this.$currentVideo=i)}else e<this.lastVideoIndex?this.start(e++):(this.logger.log("\u53ef\u64ad\u7d22\u5f15\u8d85\u51fa\u8303\u56f4"),this.reportVideoEnd())}},{key:"setCountdonw",value:function(){this.showCloseButton?this.videoAdUi.updateVideoCountDown(this.showCountdown):this.videoAdUi.updateVideoCountDownHtml('<span style="color:#fff;">\u5e7f\u544a\u5269\u4f59: </span><span>'+this.showCountdown+'</span><span style="color:#fff;">\u79d2</span>')}},{key:"_clearAdTimer",value:function(e){this.logger.log("--==>>>_clearAdTimer, orderInfo.index: ",e.index),e&&e.adPlayTimer&&e.adPlayTimer.clear()}},{key:"_startAdTimer",value:function(e,t){var r=this;this.logger.log("--==>>>_startAdTimer, orderInfo.index: ",t.index);var i=this._getVideoByIndex(t.index);t.adPlayTimer||(t.adPlayTimer=new d),t.adPlayTimer.clear(),t.adPlayTimer.on(1e3*e,function(){if(r.logger.log("--==>>>\u8ba2\u5355\u8d85\u65f6, orderInfo.index: "+t.index+", vid: "+t.vid),t.isRichMedia||i.status!=m.PLAYING)t.isRichMedia&&r.richMediaPlayer&&(t&&t.status>=g.INIT&&t.status<g.LOAD_READY?(r.countdown+=e,r.logger.log("\u5bcc\u5a92\u4f53\u5361\u987f"+e+"\u79d2\u8d85\u65f6\uff0c\u89e6\u53d1\u5bcc\u5a92\u4f53\u7ed3\u675f\uff0c\u76f4\u63a5\u4e0b\u4e00\u4e2a"),r.errorCode=2201,r.richmediaPlayer.stopAd()):r.logger.log("rich end startAdTimer"));else{var n=t.loadedPercent||r._getVideoBufferPercent(i.el);if(!t||t.isRichMedia||0!=n&&i.el.currentTime)r.logger.log("currentvideo end startAdTimer");else{r.countdown+=e,r.logger.log("\u64ad\u653e\u5361\u987f"+e+"\u79d2\u8d85\u65f6\uff0c\u89e6\u53d1\u5f53\u524d\u89c6\u9891\u64ad\u653e\u5931\u8d25"),r.errorCode=2201;try{i.el.pause(),i.el.src="",i.el.load(),t.detailErrCode=10}catch(o){}}}if(t.isRichMedia||i.status!=m.PRELOADING)r.logger.log("end startAdTimer");else{var a=r._getVideoBufferPercent(i.el);0==a?(r.logger.log("\u9884\u52a0\u8f7d"+e+"\u79d2\u8d85\u65f6\uff0c\u89e6\u53d1\u9519\u8bef\uff0c\u76f4\u63a5\u4e0b\u4e00\u4e2a. \u5df2\u52a0\u8f7d\uff1a",100*a,"%, \u5f53\u524d\u8d44\u6e90url: ",i.el.url),r.errorCode=2201,i.el.src="",i.el.load(),t.detailErrCode=20):r.logger.log("preloadvideo end startAdTimer")}})}},{key:"preloadNext",value:function(e,t){if(!this.queue||0===this.queue.length)return this.logger.log("\u961f\u5217\u4e3a\u7a7a\uff0c\u4e0d\u8fdb\u884c\u9884\u52a0\u8f7d\uff0c\u76f4\u63a5\u8fd4\u56de."),void(this.currentAdIndex>=this.lastVideoIndex&&this.reportVideoEnd(!0));if(e!==this.nextAdIndex||0===e){if(e>this.lastVideoIndex)return this.isLoadComplete=!0,this.logger.log("\u6240\u6709\u5e7f\u544a\u52a0\u8f7d\u5b8c\u6210\uff0c\u76f4\u63a5\u8fd4\u56de"),void(this.currentAdIndex>=this.lastVideoIndex&&this.reportVideoEnd(!0));var r=this.nextAdIndex;this.nextAdIndex=e;var i=this.queue[e];if(i.isRichMedia)this.richMediaPlayer?(this.logger.log("\u5f53\u524d\u6b63\u5728\u64ad\u653e\u5bcc\u5a92\u4f53\uff0c\u6ca1\u6709\u529e\u6cd5\u9884\u52a0\u8f7d\u4e0b\u4e00\u4e2a\u5bcc\u5a92\u4f53\uff0c\u53ea\u80fd\u7b49\u64ad\u5b8c\uff0c\u56de\u9000nextAdIndex\u7b49\u5f85\u4e0b\u4e00\u6b21\u9884\u52a0\u8f7d\uff0c\u5148\u8fd9\u6837\u7b80\u5355\u5904\u7406\u5427"),this.nextAdIndex=r):(this.logger.log("[\u5bcc\u5a92\u4f53]\u5f00\u59cb\u9884\u52a0\u8f7d: \u7b2c",this.nextAdIndex,"\u4e2a"),this.preloadRichMedia(e,!!t),this._startAdTimer(14,i));else if(i&&i.url&&i.status===g.INIT){this.logger.log("\u5f00\u59cb\u9884\u52a0\u8f7d: \u7b2c",this.nextAdIndex,"\u4e2a"),i.status=g.LOADING,this._resetFreeVideo();var n=this._getFreeVideo(),a=n&&n.el;this.$preloadVideo=a,a?(n.status=m.PRELOADING,n.vindex=this.nextAdIndex,a.preload="auto",a.src=i.url,i.url||(i.detailErrCode=60),this._startAdTimer(14,i),this.rollbackAdIndex=0):(this.logger.log("\u6ca1\u6709\u7a7a\u95f2\u7684video\u53ef\u4ee5\u7528\u6765\u9884\u52a0\u8f7d\uff0c\u56de\u9000nextAdIndex\uff0c\u91cd\u7f6e\u5f53\u524d\u9884\u52a0\u8f7d\u7684\u89c6\u9891\u52a0\u8f7d\u72b6\u6001\uff0c\u7b49\u5f85\u4e0b\u4e00\u6b21\u9884\u52a0\u8f7d.",r),this.rollbackAdIndex=this.nextAdIndex,this.nextAdIndex=r,i.status=g.INIT)}}else this.currentAdIndex>=this.lastVideoIndex&&(this.logger.log("\u6700\u540e\u4e00\u4e2a\u9884\u52a0\u8f7d\u5b8c\u6210\u7684\u89c6\u9891\u548c\u5f53\u524d\u9884\u52a0\u8f7d\u7684\u89c6\u9891\u662f\u540c\u4e00\u4e2a\uff0c\u6240\u4ee5\u4e0d\u7528\u518d\u9884\u52a0\u8f7d\u4e86\uff0c\u76f4\u63a5\u8fd4\u56de. report"),this.reportVideoEnd(!0))}},{key:"preloadRichMedia",value:function(e,t){var r=this.queue[e];r.status=g.LOADING;var i=new s({adInfo:r.adInfo,playerData:this.conf.playerData,container:this.adplayer.$dom.$videoAd.$videoRichMediaAdContainer,api:this.conf.playerMethod});if(this.richMediaPlayer=this.richMediaMap["rich_"+r.index]=i,this.richMediaPlayer){var n={};n[v.AdLoaded]=this.onVpaidAdLoaded.bind(this,r,t),n[v.AdStarted]=this.onVpaidAdStarted.bind(this),n[v.AdVideoStart]=this.onVpaidAdVideoStart.bind(this),n[v.AdClickThru]=this.onVpaidAdClickThru.bind(this),n[v.AdStopped]=this.onVpaidAdStopped.bind(this,r),n[v.AdVideoComplete]=this.onVpaidAdVideoComplete.bind(this),n[v.AdError]=this.onVpaidAdError.bind(this,r),n[v.AdPlaying]=this.onVpaidAdPlaying.bind(this),n[v.AdPaused]=this.onVpaidAdPaused.bind(this),n[v.AdPauseTimeCount]=this.onVpaidAdPauseTimeCount.bind(this),n[v.AdResumeTimeCount]=this.onVpaidAdResumeTimeCount.bind(this),r.loadStartTime=+new Date,i.loadAd({api:this.conf.playerMethod,index:Object.keys(this.richMediaMap).length,preload:!1,adInfo:r.adInfo,events:n}),this.firstLoadingStartTime||(this.firstLoadingStartTime=+new Date),this.logger.log("6072 loadStart",r.tpIndex),this.message.emit(p.TXPLAYER_EVENT.AD_LOAD_START,{adtype:r.adtype===y.KB?y.LD:r.adtype,duration:1e3*+r.duration,index:r.tpIndex}),r.status=g.LOAD_READY}}},{key:"playNext",value:function(e){if(this.stopCountDown(),this.currentAdIndex>=this.lastVideoIndex||e>this.lastVideoIndex)return this.logger.log("\u5f53\u524d\u64ad\u653e\u7684\u662f\u6700\u540e\u4e00\u4e2a, \u4e0d\u518d\u64ad\u653e\u4e0b\u4e00\u4e2a"),void this.reportVideoEnd();e=e||this.currentAdIndex+1;var t=this.queue[e];if(t){var r=t.status!==g.END;this.logger.log("\u64ad\u653e\u4e0b\u4e00\u4e2a: index: ",e,", \u72b6\u6001\u662f\u5426\u53ef\u64ad: ",r),r?this.start(e):this.playNext(e+1)}}},{key:"destroy",value:function(){if(!this.hasDestroy){var e=this.ordertype;this.pause(),this.videoAdUi.hideAll(),this.$videos.forEach(function(e){if(u.hide(e.el),e.hls){if(e.hlsEvt)for(var t in e.hlsEvt)e.hls.off(t,e.hlsEvt[t]);e.hls.destroy(),e.hls=null}}),this.unbindVideoEvent(),this.unbindBrowserEvent(),this.clearVideoDom(),this.reset(),this.richMediaPlayer&&(this.richMediaPlayer.stopAd(),this.richMediaPlayer=null),this.unbindVideoUiEvent(),this.hasDestroy=!0,n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"stop",this).call(this,{adtype:e,removeType:!0})}}},{key:"reportVideoEnd",value:function(e){this.blockScreen&&!e?this.blockScreen.isNeedShow(this.reportVideoEndImpl.bind(this)):this.reportVideoEndImpl(e)}},{key:"reportVideoEndImpl",value:function(e){var r=this,i=!1;if(TxpCreativePlayer.fromPcClient&&(this.dataset.playerIsSkipPrelude&&this.dataset.playtime>=this.dataset.playerEndTime||!this.dataset.playerIsSkipPrelude&&this.dataset.playtime>=this.dataset.playerDuration)&&(i=!0),e||this.ordertype!==y.HT||this.currentPlayAdType===y.HT||this._state===g.WAIT_FOR_STOP||i){if(!this.hasReportVideoEnd){this.hasReportVideoEnd=!0,this.logger.log("\u6240\u6709\u5e7f\u544a\u64ad\u653e\u5b8c\u6210"),clearTimeout(this.vpaidPauseTimeCountHandler),this.stopCountDown();var a=this.isEmpty?[]:this.queue.map(function(e){return 1e3*e.duration}),o=this.isEmpty?[]:this.queue.map(function(e){return"undefined"!=typeof e.realDuration?e.realDuration:e.playStartTime?+new Date-e.playStartTime:0}),s=0;this.isEmpty||this.queue.forEach(function(e,t){e.viewTime?(r.logger.log("viewTime_"+t,e.viewTime),s+=e.viewTime):e.viewStartTime&&(r.logger.log("viewTime_"+t,+new Date-e.viewStartTime),s+=+new Date-e.viewStartTime)}),this.logger.log("report",p.REPORT_EVENT.AD_END);this.queue[this.currentAdIndex];this.message.emit(p.REPORT_EVENT.AD_END,{adInfo:{list:this.orderList,adtype:this.ordertype},rfid:this.rfid,adtype:this.ordertype,errorcode:this.errorCode,adclose:this.userCloseOrderId,closetime:this.userCloseOrderId?1e3*(this.duration-this.countdown):"",adtt:s,adfbt:this.isEmpty?"":this.firstLoadingEndTime&&this.firstLoadingStartTime?Math.abs(this.firstLoadingEndTime-this.firstLoadingStartTime):-1,videopt:a,videott:o,firstview:this.isEmpty?"":this.firstViewTime||-1});this.ordertype;var d=0,l=0;a.forEach(function(e){d+=e}),o.forEach(function(e){l+=e}),this.message.emit(p.TXPLAYER_EVENT.AD_STOP,{index:this.currentAdIndex,rfid:this.rfid,adtype:this.ordertype,isAllAdEnd:Math.abs(d-l)<5e3}),this.destroy()}}else n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"waitForStop",this).call(this)}},{key:"onVideoLoadStart",value:function(e){if(e.src){var t=u.attr(e,"data-idx");this.firstLoadingStartTime||(this.firstLoadingStartTime=+new Date);var r=this._getTargetOrderInfo(t);this.logger.log("loadstart index: ",r.tpIndex),r&&(r.loadStartTime=+new Date,this.logger.log("6072 loadStart",r.tpIndex),this.message.emit(p.TXPLAYER_EVENT.AD_LOAD_START,{adtype:r.adtype===y.KB?y.LD:r.adtype,duration:1e3*+r.duration,index:r.tpIndex}))}}},{key:"onVideoCanPlay",value:function(e){var t=u.attr(e,"data-idx"),r=this._getTargetOrderInfo(t);if(this.logger.log("canplay duration: ",e.duration,", idx: ",t),r){var i=+new Date,n=this._getVideoBufferPercent(e);r.loadedPercent=n,r.speed=n&r.fileSize/(i-r.loadStartTime)*1e3,1==r.tpIndex&&this.hasReportPlayStartArr&&-1==this.hasReportPlayStartArr.indexOf(r.tpIndex)&&(this.logger.log("6072 playStart",r.tpIndex),this.hasReportPlayStartArr.push(r.tpIndex),this.message.emit(p.TXPLAYER_EVENT.AD_PLAY_START,{adtype:r.adtype===y.KB?y.LD:r.adtype,index:r.tpIndex,vid:r.vid,duration:r.duration,src:r.url})),this.canPlay||this.ordertype===y.ZC?!this.canPlay&&this.ordertype===y.ZC&&r.loadedPercent>=.05&&(this.logger.log(this.ordertype+" is Ready."),this._loadReadyHandler({displayCode:r.displayCode,adtype:r.adtype===y.KB?y.LD:r.adtype,index:r.index,speed:r.speed})):(this.logger.log(this.ordertype+" is Ready."),this._loadReadyHandler({adtype:r.adtype===y.KB?y.LD:r.adtype,index:r.index,speed:r.speed}))}}},{key:"onVideoProgress",value:function(e){var t=this._getTargetOrderInfo(u.attr(e,"data-idx")),r=0,i=!1,n=t?t.index:-1;if(t){var a=+new Date;r=this._getVideoBufferPercent(e),t.loadedPercent=r,i=r>.99,t.speed=r&t.fileSize/(a-t.loadStartTime)*1e3,this.message.emit(p.TXPLAYER_EVENT.AD_LOAD_PROGRESS,{adtype:t.adtype===y.KB?y.LD:t.adtype,index:t.tpIndex,speed:t.speed}),this.logger.log("progress percent: ",r)}t&&i&&!this.isLoadComplete&&!t.loadCompleteTime&&(this.logger.log("report[video progress]",p.REPORT_EVENT.AD_LOAD_COMPLETE,n),this.logger.log("progress...."),this._handleVideoLoadComplete(t,n,n===this.currentAdIndex)),t&&!this.canPlay&&this.ordertype===y.ZC&&t.loadedPercent>=.05&&(this.logger.log(this.ordertype+" is Ready."),this._loadReadyHandler({displayCode:t.displayCode,adtype:t.adtype===y.KB?y.LD:t.adtype,index:t.index,speed:t.speed}))}},{key:"_handleVideoLoadComplete",value:function(e,t,r){e.loadCompleteTime=+new Date,e.speed=e.fileSize/(e.loadCompleteTime-e.loadStartTime)*1e3,e.status=g.LOAD_READY,e.hasReportLoadComplete||(e.hasReportLoadComplete=!0,this.message.emit(p.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:this.orderList[e._index],adload:e.loadCompleteTime-e.loadStartTime,tpindex:e.tpIndex,oid:e.orderId,errorcode:""}),this.message.emit(p.TXPLAYER_EVENT.AD_LOAD_COMPLETE,{adtype:e.adtype===y.KB?y.LD:e.adtype,index:e.tpIndex,isAllEnd:t===this.lastVideoIndex,speed:e.speed})),this._doPreloadNextVideo(e,t,r)}},{key:"_doPreloadNextVideo",value:function(e,t,r){this.isLoadComplete=t>=this.lastVideoIndex,t<this.lastVideoIndex?r?(this.logger.log("[\u5f53\u524d]\u52a0\u8f7d\u5b8c\u6210:",t,"\uff0c\u9884\u52a0\u8f7d\u4e0b\u4e00\u4e2a"),this.preloadNext(this.currentAdIndex+1)):(this.logger.log("[\u9884\u52a0\u8f7d]\u52a0\u8f7d\u5b8c\u6210: ",t,"\uff0c\u9884\u52a0\u8f7d\u4e0b\u4e00\u4e2a"),this.preloadNext(t+1)):this.isLoadComplete&&this.logger.log("\u6240\u6709\u5e7f\u544a\u52a0\u8f7d\u5b8c\u6210")}},{key:"onVideoTimeupdate",value:function(e){u.attr(e,"data-idx");var t=parseInt(e.currentTime);if(0!==e.currentTime&&(0===e.currentTime||t!==this.prevCurrentTime)){this.prevCurrentTime=t;var r=this._getVideoBufferPercent(e),i=this._getTargetOrderInfo(u.attr(e,"data-idx")),n=r>.99,a=i?i.index:-1;i&&(i.loadedPercent=r,i.realDuration=parseInt(1e3*e.currentTime,10)),n&&a===this.currentAdIndex&&!this.isLoadComplete&&(i.loadCompleteTime?this.rollbackAdIndex&&this.rollbackAdIndex<=this.lastVideoIndex&&this._getFreeVideo()&&(this.logger.log("\u56de\u9000\u7684\u5143\u7d20\u53ef\u4ee5\u5f00\u59cb\u8fdb\u884c\u52a0\u8f7d\u4e86"),this.preloadNext(this.rollbackAdIndex)):(this.logger.log("\u5f53\u524dvideo\u5df2\u7ecf\u52a0\u8f7d\u5b8c",a),this.logger.log("report[video timeupdate]",p.REPORT_EVENT.AD_LOAD_COMPLETE,a),this._handleVideoLoadComplete(i,a,!0)))}}},{key:"onVideoPlaying",value:function(e){var r=u.attr(e,"data-idx"),i=this._getTargetOrderInfo(r);if(n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"play",this).call(this),i){this._clearAdTimer(i),i._tempErrorCode=0,this.blockScreen&&this.blockScreen.onAdPlaying(),i.status=g.PLAYING,this.firstViewTime||(this.firstViewTime=parseInt(window.performance.now(),10)),i.hasReportView||(i.hasReportView=!0,this.logger.log("report",p.REPORT_EVENT.AD_VIEW,i.index),this.message.emit(p.REPORT_EVENT.AD_VIEW,{adInfo:this.orderList[i._index],scene:this.scene})),this.firstViewTime||(this.firstViewTime=parseInt(window.performance.now(),10)),this.firstLoadingEndTime||(this.firstLoadingEndTime=+new Date),this.logger.log("\u7b2c",i.index,"\u4e2a\u5f00\u64ad\u4e86"),this.hasPlaying&&-1==this.hasPlaying.indexOf(i.tpIndex)&&(this.hasPlaying.push(i.tpIndex),this.startCountDown()),1!=i.tpIndex&&this.hasReportPlayStartArr&&-1==this.hasReportPlayStartArr.indexOf(i.tpIndex)&&(this.logger.log("6072 oldPlayStart",i.tpIndex),this.hasReportPlayStartArr.push(i.tpIndex),this.message.emit(p.TXPLAYER_EVENT.AD_PLAY_START,{adtype:i.adtype===y.KB?y.LD:i.adtype,index:i.tpIndex,vid:i.vid,duration:i.duration,src:i.url})),this.queue[this.currentAdIndex].status=g.PLAYING;var a=this.queue[this.currentAdIndex];this.setViewMonitor||(this.setViewMonitor=!0,this._reportScreenShot({video:this.$currentVideo,oid:a.orderId,index:i.index,vid:a.vid,empty:this.info.isEmpty}),this.adViewMonitor.start(a))}}},{key:"onVideoPause",value:function(e){var t=u.attr(e,"data-idx"),r=this._getTargetOrderInfo(t);r&&(this.message.emit(p.TXPLAYER_EVENT.AD_PAUSE,{adtype:r.adtype===y.KB?y.LD:r.adtype,index:r.tpIndex}),r.status=g.PAUSED)}},{key:"onVideoResume",value:function(e){var t=u.attr(e,"data-idx");if(e.currentTime>0){t=u.attr(e,"data-idx");var r=this._getTargetOrderInfo(t);r&&(this.message.emit(p.TXPLAYER_EVENT.AD_RESUME,{adtype:r.adtype===y.KB?y.LD:r.adtype,index:r.tpIndex}),r.status=g.PLAYING)}}},{key:"playVideo",value:function(e){var t=this;if(this.logger.log("-==>>> playVideo: (video.vindex/video.status)",e.vindex,e.status),e.status==m.PLAYING){var r=e.el.play();r&&r["catch"](function(e){t.logger.log("playUrl: ",e)})}}},{key:"playUrl",value:function(e){var t,r=this,i=this._getVideoByIndex(e.index);if(this.logger.log("-==>>> playUrl: (video.vindex/video.status)",i.vindex,i.status),i.bakUrlData)if(0<i.bakUrlData.urls.length)if("hls"==i.bakUrlData.type&&_.isSupported()){if(i.hls){if(i.hlsEvt)for(var n in i.hlsEvt)i.hls.off(n,i.hlsEvt[n]);i.hls.destroy(),i.hls=null}if(!i.hls)for(var n in i.hls=new _,i.hlsEvt={},i.hlsEvt[_.Events.MANIFEST_PARSED]=function(){r.playVideo(i)},i.hlsEvt[_.Events.ERROR]=function(t,n){r.logger.log("-==>>> playUrl, hls error: (orderInfo.index/orderInfo.vid/error)",e.index,e.vid,n),i.el.src="",i.el.load(),e.detailErrCode=30},i.hlsEvt)i.hls.on(n,i.hlsEvt[n]);i.bakUrlData.m3u8?(t=i.bakUrlData.urls.shift(),i.hls.url=t,i.hls.trigger("hlsManifestLoading",{url:t,m3u8:i.bakUrlData.m3u8}),setTimeout(function(){i.hls.coreComponents[0].loadsuccess({data:i.bakUrlData.m3u8,url:t},{loaded:1,retry:1,tfirst:1,tload:1,total:1,trequest:1},{type:"manifest",url:t}),i.bakUrlData.m3u8=void 0},50),this.logger.log("-==>>> playUrl, ZC_m3u8: (orderInfo.index/orderInfo.vid)",e.index,e.vid)):(t=i.bakUrlData.urls.shift(),i.hls.loadSource(t),this.logger.log("-==>>> playUrl, url_m3u8: (orderInfo.index/orderInfo.vid)",e.index,e.vid)),i.hls.attachMedia(i.el),this._startAdTimer(14,e)}else t=i.bakUrlData.urls.shift(),i.el.src=t||"",t||(e.detailErrCode=70),this.playVideo(i),this.logger.log("-==>>> playUrl, mp4: (orderInfo.index/orderInfo.vid)",e.index,e.vid),this._startAdTimer(14,e);else i.el.src="",i.el.load(),i.failAll=!0,e.detailErrCode=40;else i.el.src=e.url||"",e.url||(e.detailErrCode=50),this.playVideo(i),this._startAdTimer(14,e)}},{key:"loadBakUrl",value:function(e){var t=this;this.logger.log("\u5f00\u59cb\u8bf7\u6c42hls\u5730\u5740: \u7b2c",e.index,"\u4e2a, vid: ",e.vid),this.geturls.requestVideoUrlsByVid({vid:e.vid,flowid:this.conf.playerData.playerFlowid,guid:this.conf.playerData.playerGuid,onSucc:function(r){t.loadUrlSucc(e,r)},onFail:function(r){t.loadUrlFail(e,r)}})}},{key:"loadUrlSucc",value:function(e,t){this.logger.log("loadUrlSucc: \u7b2c"+e.index+"\u4e2a, vid: "+e.vid+", \u5907\u4efd\u5730\u5740\u6570\uff1a"+(t&&t.urls?t.urls.length:0));var r=this._getVideoByIndex(e.index);e&&t&&t.urls&&t.urls.length>0?(r.bakUrlData=t,this.playUrl(e)):this.onVideoError(r.el,!0)}},{key:"loadUrlFail",value:function(e,t){this.logger.log("loadUrlFail: \u7b2c",e.index,"\u4e2a, ",t);var r=this._getVideoByIndex(e.index);this.onVideoError(r.el,!0)}},{key:"onVideoError",value:function(e,t){if(!this.isLoadComplete){var r=u.attr(e,"data-idx"),i=this._getTargetOrderInfo(r);if(i){i.loadStartTime-+new Date<500&&TxpCreativePlayer.adBlockEnabled&&(i._tempErrorCode=6);var n=this._getVideoByIndex(i.index);if(this.logger.log("-==>>> onVideoError: (video.vindex/video.status)",n.vindex,n.status,", has adb: ",TxpCreativePlayer.adBlockEnabled),this._clearAdTimer(i),this.logger.log("\u89c6\u9891\u51fa\u9519: \u7b2c",i.index,"\u4e2a, vid: ",i.vid),!t&&!n.failAll)return void(n.bakUrlData?(this.logger.log("-==>>> onVideoError: \u6709\u5907\u4efd\u5730\u5740",n.bakUrlData.urls?n.bakUrlData.urls.length:0),this.playUrl(i)):(this.logger.log("-==>>> onVideoError: \u6ca1\u6709\u5907\u4efd\u5730\u5740"),this.loadBakUrl(i)));this.logger.log("-==>>> onVideoError: \u6700\u7ec8\u7ed3\u675f, \u7b2c",i.index,"\u4e2a, vid: ",i.vid),n.status=m.ERROR,i.viewStartTime&&(i.viewTime=+new Date-i.viewStartTime),i.status=g.END,i.realDuration=parseInt(1e3*e.currentTime,10),this.prevCurrentTime=0,this.errorCount++,i.loadCompleteTime||(i.loadCompleteTime=+new Date),i.hasReportLoadComplete||(i.hasReportLoadComplete=!0,this.logger.log("report[video error]",p.REPORT_EVENT.AD_LOAD_COMPLETE,i._index),this.message.emit(p.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:this.orderList[i._index],adload:i.loadCompleteTime-i.loadStartTime,tpindex:i.tpIndex,oid:i.orderId,errMsg:i.url,errorcode:2301}));var a=e.error.message||"",o=e.error.code;a||e.currentSrc==e.src||(a="MEDIA_ELEMENT_ERROR: Empty src attribute"),6==+i._tempErrorCode?(o=i._tempErrorCode,i._tempErrorCode=0,this.blockScreen&&(this.blockScreen.errorByADBlock=!0)):"MEDIA_ELEMENT_ERROR: Empty src attribute"===a&&(o=5),"undefined"!=typeof e.readyState&&(a+=";readyState:"+e.readyState),"undefined"!=typeof e.networkState&&(a+=";networkState:"+e.networkState);var s=e.error&&e.error.constructor&&e.error.constructor.name;this.logger.log("6072 playError: (orderInfo.index/orderInfo.vid/errorCode)",i.index,i.vid,o),this.message.emit(p.TXPLAYER_EVENT.AD_PLAY_ERROR,{adtype:i.adtype===y.KB?y.LD:i.adtype,index:i.tpIndex,vid:i.vid,duration:i.duration,errorCode:o,detailErrCode:i.detailErrCode,errorMessage:a||s||"",preload:i.index!==this.currentAdIndex,src:i.url,isAllEnd:this.currentAdIndex===i.index&&i.index===this.lastVideoIndex}),i.index!==this.currentAdIndex&&i.index===this.lastVideoIndex&&this.message.emit(p.TXPLAYER_EVENT.AD_LOAD_COMPLETE,{adtype:i.adtype===y.KB?y.LD:i.adtype,index:i.tpIndex,errorCode:o,errorMessage:a,isAllEnd:!0}),this.countdown=this.countdown-i.duration,i.adtype!==y.KB&&(this.showCountdown=this.showCountdown-i.duration),i.index===this.currentAdIndex?this.currentPlayAdType?(this.logger.log("\u5f53\u524d\u89c6\u9891\u5931\u8d25\u4e86\uff0c\u5f53\u524d\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\uff0c\u76f4\u63a5\u64ad\u653e\u4e0b\u4e00\u4e2a"),this.playNext()):(this.logger.log("\u5f53\u524d\u89c6\u9891\u5931\u8d25\u4e86\uff0c\u4f46\u662f\u8fd8\u6ca1\u6709\u8c03\u7528\u8fc7play\uff0c\u76f4\u63a5\u9884\u52a0\u8f7d\u4e0b\u4e00\u4e2a."),this.currentAdIndex<=this.lastVideoIndex?(this.currentAdIndex=this.currentAdIndex+1,this.preloadNext(i.index+1)):(this.logger.log("\u6240\u6709\u90fd\u64ad\u5b8c\u4e86"),this.reportVideoEnd())):(this.logger.log("\u9884\u52a0\u8f7d\u52a0\u8f7d\u4e0b\u4e00\u4e2a"),this.preloadNext(i.index+1)),this.setViewMonitor=!1}this.errorCount==this.orderList.length&&(this.errorCode=2201)}}},{key:"onVideoEnded",value:function(e){var t=u.attr(e,"data-idx"),r=this._getTargetOrderInfo(t);r&&(this.logger.log("\u64ad\u653e\u5b8c\u6210: \u7b2c",this.currentAdIndex,"\u4e2a"),this._clearAdTimer(r),this._getVideoByIndex(r.index).status=m.END,r.viewStartTime&&(r.viewTime=+new Date-r.viewStartTime),r.status=g.END,r.realDuration=parseInt(1e3*e.duration,10),this.message.emit(p.TXPLAYER_EVENT.AD_PLAY_END,{adInfo:this.orderList[r._index],adtype:r.adtype===y.KB?y.LD:r.adtype,index:r.tpIndex,errorcode:0}),this.setViewMonitor=!1),this.playNext(),this.prevCurrentTime=0}},{key:"bindVideoEvent",value:function(){for(var e=0,t=this.$videos.length;e<t;e++)this.dobindVideoEvent(this.$videos[e].el)}},{key:"unbindVideoEvent",value:function(){for(var e=0,t=this.$videos.length;e<t;e++)this.doUnbindVideoEvent(this.$videos[e].el);this._videoEvents={}}},{key:"dobindVideoEvent",value:function(e){var t=this;for(var r in this._videoEvents||(this._videoEvents={loadstart:function(e){t.onVideoLoadStart(e.target)},progress:function(e){t.onVideoProgress(e.target)},canplay:function(e){t.onVideoCanPlay(e.target)},playing:function(e){t.onVideoPlaying(e.target)},play:function(e){t.onVideoResume(e.target)},pause:function(e){t.onVideoPause(e.target)},timeupdate:function(e){t.onVideoTimeupdate(e.target)},error:function(e){t.onVideoError(e.target)},ended:function(e){t.onVideoEnded(e.target)}}),this._videoEvents)this._videoEvents.hasOwnProperty(r)&&u.on(e,r,this._videoEvents[r])}},{key:"doUnbindVideoEvent",value:function(e){if(this._videoEvents)for(var t in this._videoEvents)this._videoEvents.hasOwnProperty(t)&&u.off(e,t,this._videoEvents[t])}},{key:"bindVideoUiEvent",value:function(){var e=this;function t(){if(this.canClickToStopAd){var e=this.queue[this.currentAdIndex];return e.viewStartTime&&(e.viewTime=+new Date-e.viewStartTime),this.userCloseOrderId=e.orderId,this.logger.log("\u7528\u6237\u70b9\u51fb\u4e86\u5173\u95ed"),void this.reportVideoEnd()}this.showCloseButton&&(this.pause(),this.conf.playerMethod.showOpenVIPGuide&&this.conf.playerMethod.showOpenVIPGuide())}function r(){var e=this.queue[this.currentAdIndex];if(e.link&&"N"==e.noClick){this.logger.log("report",p.REPORT_EVENT.AD_CLICK),this.message.emit(p.REPORT_EVENT.AD_CLICK,{adInfo:this.orderList[e._index],adclick:e.link?e.orderId:"",clicktime:1e3*(this.duration-this.countdown),scene:this.scene});var t=this.adplayer.getConf(),r=t&&t.playerData&&t.playerData.playerPfEx||"",i=c.appendParamsToUrl(e.link,{pf_ex:r||"",appversion:E});window.open(i)}}function i(e){e?this.pause():this.resume(),this.videoAdUi.updateNoSkipDialog({show:e})}this.message.on(p.UI_EVENT.VIDEO_SKIP_TEXT,function(r){e.canSkip?e.videoAdUi.trueViewInterval||t.apply(e):i.apply(e,[!0])}),this.message.on(p.UI_EVENT.VIDEO_CLOSE_BUTTON_CLICK,function(r){t.apply(e)}),this.message.on(p.UI_EVENT.VIDEO_LINK_AREA_CLICK,function(t){r.apply(e)}),this.message.on(p.UI_EVENT.VIDEO_DETAIL_BUTTON_CLICK,function(t){r.apply(e)}),this.message.on(p.UI_EVENT.VIDEO_NO_SKIP_BUTTON_CLICK,function(t){i.apply(e,[!0])}),this.message.on(p.UI_EVENT.VIDEO_NO_SKIP_KNOW_BUTTON_CLICK,function(t){i.apply(e,[!1])}),this.message.on(p.UI_EVENT.VIDEO_NO_SKIP_CLOSE_BUTTON_CLICK,function(t){i.apply(e,[!1])}),this.message.on(p.UI_EVENT.VIDEO_VOLUME_BUTTON_CLICK,function(t){e.isMute=!e.isMute,e.isMute?e.setVolume(0):e.setVolume(Math.min(100,Math.max(0,e.callOuterApi(p.TXPLAYER_API.GET_VOLUME)))),e.videoAdUi.updateVideoVolumeBtn({mute:e.isMute})})}},{key:"unbindVideoUiEvent",value:function(){f(this.message,p.UI_EVENT.VIDEO_SKIP_TEXT),f(this.message,p.UI_EVENT.VIDEO_CLOSE_BUTTON_CLICK),f(this.message,p.UI_EVENT.VIDEO_LINK_AREA_CLICK),f(this.message,p.UI_EVENT.VIDEO_DETAIL_BUTTON_CLICK),f(this.message,p.UI_EVENT.VIDEO_NO_SKIP_BUTTON_CLICK),f(this.message,p.UI_EVENT.VIDEO_NO_SKIP_KNOW_BUTTON_CLICK),f(this.message,p.UI_EVENT.VIDEO_NO_SKIP_CLOSE_BUTTON_CLICK)}},{key:"onVpaidAdLoaded",value:function(e,t){this.firstLoadingEndTime||(this.firstLoadingEndTime=+new Date),this.logger.log("[\u5bcc\u5a92\u4f53]\u52a0\u8f7d\u5b8c\u6210: \u7b2c",e.index,"\u4e2a"),this.canPlay||this._loadReadyHandler({adtype:e.adtype===y.KB?y.LD:e.adtype,index:e.index,speed:e.speed}),e.loadCompleteTime=+new Date,e.hasReportLoadComplete||(e.hasReportLoadComplete=!0,this._clearAdTimer(e),this.logger.log("report[rich]",p.REPORT_EVENT.AD_LOAD_COMPLETE),this.message.emit(p.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:this.orderList[e._index],adload:e.loadCompleteTime-e.loadStartTime,tpindex:e.tpIndex,oid:e.orderId,errorcode:0})),t&&(e.playStartTime||(e.playStartTime=+new Date),this.startRichMedia())}},{key:"onVpaidAdStarted",value:function(){this.logger.log("[\u5bcc\u5a92\u4f53]\u64ad\u653e\u5f00\u59cb: \u7b2c",this.currentAdIndex,"\u4e2a");var e=this.queue[this.currentAdIndex];e.hasReportView||(e.hasReportView=!0,this.message.emit(p.REPORT_EVENT.AD_VIEW,{adInfo:this.orderList[e._index],scene:this.scene})),this.firstViewTime||(this.firstViewTime=parseInt(window.performance.now(),10)),this.logger.log("6072 playStart",e.tpIndex),this.message.emit(p.TXPLAYER_EVENT.AD_PLAY_START,{adtype:e.adtype===y.KB?y.LD:e.adtype,index:e.tpIndex,vid:e.vid,duration:e.duration,src:e.src});var t=this.queue[this.currentAdIndex+1];t&&!t.isRichMedia&&this.preloadNext(this.currentAdIndex+1)}},{key:"onVpaidAdVideoStart",value:function(){this.logger.log("[\u5bcc\u5a92\u4f53]\u89c6\u9891\u5f00\u59cb\u64ad\u653e: \u7b2c",this.currentAdIndex,"\u4e2a")}},{key:"onVpaidAdPlaying",value:function(){this.logger.log("[\u5bcc\u5a92\u4f53]\u6062\u590d\u64ad\u653e"),this.startCountDown(),n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"play",this).call(this)}},{key:"onVpaidAdPaused",value:function(){this.logger.log("[\u5bcc\u5a92\u4f53]\u6682\u505c\u64ad\u653e"),this.stopCountDown()}},{key:"onVpaidAdPauseTimeCount",value:function(){var e=this;this.logger.log("[\u5bcc\u5a92\u4f53]\u6682\u505c\u5012\u8ba1\u65f6"),this.stopCountDown(),clearTimeout(this.vpaidPauseTimeCountHandler),this.vpaidPauseTimeCountHandler=setTimeout(function(){e.startCountDown()},3e3),this.richMediaPlayer&&this.richMediaPlayer.continueTimeout()}},{key:"onVpaidAdResumeTimeCount",value:function(){this.logger.log("[\u5bcc\u5a92\u4f53]\u6062\u590d\u5012\u8ba1\u65f6"),clearTimeout(this.vpaidPauseTimeCountHandler),this.startCountDown()}},{key:"onVpaidAdClickThru",value:function(){this.logger.log("[\u5bcc\u5a92\u4f53]\u70b9\u51fb\u5bcc\u5a92\u4f53: \u7b2c",this.currentAdIndex,"\u4e2a");var e=this.queue[this.currentAdIndex];if(e.link&&"N"==e.noClick){var t=this.adplayer.getConf(),r=t&&t.playerData&&t.playerData.playerPfEx||"",i=c.appendParamsToUrl(e.link,{pf_ex:r||"",appversion:E});window.open(i)}}},{key:"onVpaidAdVideoComplete",value:function(){this.logger.log("[\u5bcc\u5a92\u4f53]\u64ad\u653e\u7ed3\u675f: \u7b2c",this.currentAdIndex,"\u4e2a");var e=this.queue[this.currentAdIndex];e.viewStartTime&&(e.viewTime=+new Date-e.viewStartTime),e.status=g.END,e.realDuration=e.playStartTime?+new Date-e.playStartTime:0,this.richMediaPlayer.destroy();this.queue[this.currentAdIndex+1];this.richMediaPlayer=null,this.playNext()}},{key:"onVpaidAdStopped",value:function(e){this.logger.log("[\u5bcc\u5a92\u4f53]\u5e7f\u544a\u505c\u6b62: \u7b2c",this.currentAdIndex,"\u4e2a"),e.status=g.END}},{key:"onVpaidAdError",value:function(e){this.logger.log("[\u5bcc\u5a92\u4f53]\u52a0\u8f7d\u5931\u8d25"),e.loadCompleteTime||(e.loadCompleteTime=+new Date),e.hasReportLoadComplete||(e.hasReportLoadComplete=!0,this._clearAdTimer(e),this.logger.log("report[rich error]",p.REPORT_EVENT.AD_LOAD_COMPLETE,e.index),e.viewStartTime&&(e.viewTime=+new Date-e.viewStartTime),e.realDuration=e.playStartTime?+new Date-e.playStartTime:0,this._emitEvent(p.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:this.orderList[e._index],adload:e.loadCompleteTime-e.loadStartTime,tpindex:e.tpIndex,oid:e.orderId,errorcode:2301})),e.status=g.END;var t=this.queue[this.currentAdIndex];this.logger.log("6072 playError",e.tpIndex),this.message.emit(p.TXPLAYER_EVENT.AD_PLAY_ERROR,{adtype:e.adtype,index:e.tpIndex,vid:e.vid,duration:e.duration,errorCode:404,errorMessage:"richMediaLoadError",preload:e.index!==this.currentAdIndex,src:e.url,isAllEnd:this.currentAdIndex===e.index&&e.index===this.lastVideoIndex}),this.countdown=this.countdown-e.duration,e.adtype!==y.KB&&(this.showCountdown=this.showCountdown-e.duration),t.tpIndex===e.tpIndex?this.playNext():this.preloadNext(this.nextAdIndex+1)}},{key:"bindBrowserEvent",value:function(){var e=this;this.unbindBrowserEvent(),this.logger.log("add:_browserBeforeUnload"),this._browserBeforeUnload=function(){e.logger.log("report:_browserBeforeUnload");var t=e.queue[e.currentAdIndex];t&&(t.viewStartTime&&(t.viewTime=+new Date-t.viewStartTime),e.userCloseOrderId=t.orderId,e.rfid="",e.reportVideoEnd(!0),setTimeout(function(){location.reload()},300))},window.addEventListener("beforeunload",this._browserBeforeUnload)}},{key:"unbindBrowserEvent",value:function(){this.logger.log("remove:_browserBeforeUnload"),window.removeEventListener("beforeunload",this._browserBeforeUnload)}},{key:"_getFreeVideo",value:function(){for(var e=0,t=this.$videos.length;e<t;e++)if(this.$videos[e].status===m.EMPTY)return this.$videos[e];return null}},{key:"_resetFreeVideo",value:function(){for(var e=0,t=this.$videos.length;e<t;e++)this.$videos[e].status>m.PLAYING&&(this.$videos[e].status=m.EMPTY,this.$videos[e].bakUrlData=void 0,this.$videos[e].failAll=!1)}},{key:"_hideFreeVideo",value:function(){for(var e=0,t=this.$videos.length;e<t;e++)this.$videos[e].status!==m.PLAYING&&u.hide(this.$videos[e].el)}},{key:"_getVideoBufferPercent",value:function(e){var t=0;if(e&&e.buffered&&e.buffered.length>0)try{t=(e.buffered.end(0)-e.buffered.start(0))/e.duration}catch(r){}return t}},{key:"_getTargetOrderInfo",value:function(e){for(var t=0,r=this.$videos.length;t<r;t++)if(u.attr(this.$videos[t].el,"data-idx")==e)return this.queue[this.$videos[t].vindex];return null}},{key:"_getVideoByIndex",value:function(e){for(var t=0,r=this.$videos.length;t<r;t++)if(this.$videos[t].vindex===e)return this.$videos[t];return null}},{key:"_reportScreenShot",value:function(e){var t=this,r=1e3*Math.ceil(5*Math.random());e.time=r;var i=setTimeout(function(){t.message.emit(p.REPORT_EVENT.AD_SCREEN_SHOT,e),clearTimeout(i)},r)}}]),t}()},function(e,t,r){"use strict";e.exports={END:0,PLAYING:1,PAUSE:2,LOADING:3}},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=0,a=+new Date,o=r(8).Promise;e.exports=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.image=null,this.conf=t||{}}return i(e,[{key:"load",value:function(){var e=this;if(this.image)return o.resolve(this.image);var t=this.conf;return new o(function(r,i){var o=new Image;for(var s in o.id="adplayer_image_material_"+a+"_"+n,o.style.width="100%",o.style.height="100%",t.style)t.style.hasOwnProperty(s)&&(o.style[s]=t.style[s]);o.onload=function(){this.image=o,n++,r(this.image)}.bind(e),o.onerror=function(e){i(e)}.bind(e),o.src=t.url})}},{key:"destroy",value:function(){this.image&&(this.image.src="",this.image=null)}}]),e}()},function(e,t,r){"use strict";var i=r(8).Promise;function n(e,t){if("string"!=typeof t)return null;var r=t.split("."),i=r[0],n="";r.length>1&&(n=r[1]);var a=e.store;if(a.hasOwnProperty(i)){if(!n)return a[i];if(a[i].hasOwnProperty(n))return a[i][n]}}function a(){var e=new XMLHttpRequest;return e.open("GET","//dp3.qq.com/dynamic?pf=h5&sdktype=3&chid=-1&appversion=171101&get_type=sdkconfig"),new i(function(t,r){e.onreadystatechange=function(){if("200"==e.status&&4==e.readyState){var r=e.responseText,i={adflag:{}};try{var n=document.createElement("div");n.innerHTML=r,Array.prototype.forEach.call(n.querySelectorAll(".item"),function(e){var t=e.querySelector(".key").innerText,r=e.querySelector(".value").innerText;i.adflag[t]=r}),n=null}catch(a){}if(Object.keys(i.adflag).length)return void t(JSON.stringify(i));t(JSON.stringify({adflag:{PSJ:1,PPB:0,PVL:0,PDF:0}}))}},e.onerror=e.ontimeout=function(){t(JSON.stringify({adflag:{PSJ:0,PPB:0,PVL:0,PDF:0}}))},e.send(null)})}function o(e){var t,r,i={store:e=JSON.parse(e),t:(new Date).getTime()};return t="dp3config",r=JSON.stringify(i),window.localStorage&&window.localStorage.setItem(t,r),i}function s(e){return window.localStorage?window.localStorage.getItem(e):null}e.exports=function(e){var t;return t=e?"adflag."+e:"adflag",new i(function(e,r){var i=s("dp3config");if(i){var d=JSON.parse(i);(new Date).getTime()-d.t>36e5?a().then(function(r){e(n(o(r),t))})["catch"](r):e(n(d,t))}else a().then(function(r){e(n(o(r),t))})["catch"](r)})}},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=r(3),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene_id="",this.time=15e3,this.orderList=null,this.status=0,this.isWholeScene=!1}return i(e,[{key:"getStartSec",value:function(){var e=this.firstOrder;return e&&e.adtype==n.PSJ&&e.anchor&&e.anchor.begin?parseInt(.001*e.anchor.begin,10):parseInt(.001*this.time,10)}},{key:"getEndSec",value:function(e){var t=this.firstOrder;return t?t.adtype==n.PSJ&&this.isWholeScene&&t.anchor?parseInt(parseInt(e)-.001*parseInt(t.anchor.end),10):t.adtype==n.VIN?.001*parseInt(this.end_time):parseInt(this.getStartSec()+.001*t.duration,10):-1}},{key:"isEmpty",get:function(){return!this.orderList||0===!this.orderList.length||this.orderList.every(function(e){return e.isEmpty})}},{key:"orderType",get:function(){var e=this.firstOrder;return e?e.adtype:""}},{key:"firstOrder",get:function(){return this.orderList?this.orderList[0]:null}}]),e}();e.exports=a},function(e,t,r){"use strict";e.exports=r(55)},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=r(9),a=r(24),o=r(25),s=r(26),d=r(29),l=r(1),u=r(3),c=r(4),h=r(0)("index"),f=r(58),p=r(59),v=null,y=null,g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hasLoadEndingAd=!1;var r=+new Date;if(e.instance[r]=this,h.log("new TxpCreativePlayer",t),!t)throw Error("\u521d\u59cb\u5316\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a!");this._initController(t)}return i(e,[{key:"_initController",value:function(e){this.controllers={},this.controllers.confController=new o(this),this.setConf(e),this.controllers.orderController=new s(this),this.controllers.adController=new d(this)}},{key:"emitToPlayer",value:function(e,t){var r=this.getConf().playerMsg;r&&r.broadcast&&r.broadcast(e,t)}},{key:"init",value:function(e){this.controllers.confController.setConf(e),this.controllers.adController.init(e)}},{key:"setOrder",value:function(e){this.controllers.adController.initOrderReport(e),this.controllers.orderController.setOrder(e)}},{key:"setPlaytime",value:function(e){var t=this,r=this.dataset;r.playtime=e,this.hasLoadEndingAd||(!r.playerIsSkipPrelude&&r.playerDuration&&r.playerDuration-e<=10||r.playerIsSkipPrelude&&r.playerEndTime>0&&r.playerEndTime-e<=10||r.playerIsSkipPrelude&&r.playerEndTime>0&&e>r.playerEndTime)&&(this.hasLoadEndingAd=!0,this.emitToPlayer(l.TXPLAYER_EVENT.AD_REQUEST_ORDER,{adtype:u.HT})),(v=this.controllers.orderController.sceneInfos)&&v.length&&v.forEach(function(i){var n=i.getStartSec(),o=i.getEndSec(r.playerDuration);if(i.orderList&&n>0)switch(i.orderType){case u.VIN:e>=n&&e<=o?i.status==a.INIT&&(h.log("load VIN"),t.loadAd(i.orderList,i).then(function(){i.status=a.PLAYING,t.playAd(i.orderList,i),h.log("play VIN")})):i.status!=a.INIT&&(i.status=a.INIT,t.stopAd(i.orderList),h.log("stop VIN"));break;case u.ZC:if(!t.hasLoadEndingAd)if(i.status==a.INIT){if(e>=i.getStartSec()-12&&e<=i.getStartSec()+12){i.status=a.LOADING;var s=t.controllers.orderController.getOrdersByType(u.ZC),d=i.orderList;d.adcost=s.adcost,d.errorcode=s.errorcode,t.loadAd(d,i)}}else i.status==a.LOADING?(y=t.controllers.adController.getAd(i.orderList))&&y.canPlay&&(i.status=a.PLAYING):i.status==a.PLAYING&&(y=t.controllers.adController.getAd(i.orderList))&&y.state==c.END&&(i.status=a.END);break;case u.ZI:case u.BS:e==i.getStartSec()?i.status==a.INIT&&(i.status=a.LOADING,t.loadAd(i.orderList,i)):e>i.getStartSec()&&e<=i.getEndSec(r.playerDuration)?i.status==a.LOADING&&(y=t.controllers.adController.getAd(i.orderList))&&y.canPlay&&(i.status=a.PLAYING,t.playAd(i.orderList,i),h.log("play BS")):i.status!=a.INIT&&(i.status=a.INIT,t.stopAd(i.orderList));break;case u.PSJ:e>=i.getStartSec()-6&&e<i.getStartSec()-1?i.status==a.INIT?(t.loadAd(i.orderList,i).then(function(){i.status=a.LOADING}),h.log("load PSJ")):i.status==a.PLAYING&&(i.status=a.INIT,t.stopAd(i.orderList)):e>=i.getStartSec()-1&&e<i.getEndSec(r.playerDuration)-1?(e==i.getStartSec()-1&&i.status==a.PLAYING&&(i.status=a.INIT,t.stopAd(i.orderList)),i.status==a.INIT?(t.loadAd(i.orderList,i).then(function(){i.status=a.LOADING}),h.log("load PSJ")):i.status!=a.LOADING&&i.status!=a.PLAYING||(i.status=a.PLAYING,t.playAd(i.orderList,i),h.log("play PSJ"))):i.status!=a.INIT&&(i.status=a.INIT,t.stopAd(i.orderList),h.log("stop PSJ"));break;case u.CZC:e>=i.getStartSec()-2&&e<=i.getStartSec()?i.status==a.INIT&&(t.loadAd(i.orderList,i).then(function(){i.status=a.LOADING}),h.log("load CZC")):e>i.getStartSec()&&e<=i.getEndSec(r.playerDuration)?i.status==a.INIT?(t.loadAd(i.orderList,i).then(function(){i.status=a.LOADING}),h.log("load CZC")):i.status!=a.LOADING&&i.status!=a.PLAYING||(i.status=a.PLAYING,t.playAd(i.orderList,i),h.log("play CZC")):i.status!=a.INIT&&(i.status=a.INIT,t.stopAd(i.orderList),h.log("stop CZC"))}})}},{key:"dataset",get:function(){return this.getConf().playerData}}]),e}();f.install(g),p.install(g),g.version=n,g.loadNextPart=function(){g.adClass.loadNextPart()},g.instance={},g.EVENT=l,g.AD_TYPE=u,g.Logger=h,g.fromPcClient=!1,g.debug=/debugad=1/.test(location.search||""),window.TxpCreativePlayer||(window.TxpCreativePlayer=g),e.exports=g},function(e,t,r){"use strict";e.exports={INIT:0,LOADING:2,LOAD_READY:4,PLAYING:6,END:-1}},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=r(13),a=r(0)("controller/confController"),o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a.log("new ConfController"),this.defaultConf={playerMsg:null,playerDom:{pvlAdLayer:null,ppbAdLayer:null,pdfAdLayer:null,videoAdLayer:null,interactiveAdLayer:null},playerMethod:{},playerData:{playerWidth:0,playerHeight:0,playerLeft:0,playerTop:0,playtime:0,playerEndTime:0,playerDuration:0,playerFrom:"",playerPlatform:"",playerPf:"",playerPfEx:"",playerVersion:"",playerCid:"",playerVid:"",playerFlowid:"",playerGuid:"",playerPt:"",playerPu:0,playerTrialerMode:!1,playerAdExt:"",playerType:"",playerIsSkipPrelude:!1,playerVptag:""}}}return i(e,[{key:"setConf",value:function(){var e=Array.prototype.slice.call(arguments,0),t=e.length;if(0!==t)if(this.conf){if(1===t){var r=e[0];for(var i in r)r.hasOwnProperty(i)&&(this.conf[i]=n(this.conf[i],r[i]))}else if(2===t&&"string"==typeof e[0]){var a=e[0].split(".");if(1===a.length)this.conf[e[0]]=e[1];else{for(var o=this.conf[a[0]],s=1;s<a.length;s++)o=o[a[s]];o=e[1]}}}else this.conf=n(this.defaultConf,e[0])}},{key:"getConf",value:function(){return this.conf}}]),e}();e.exports=o},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();r(21);var n=r(3),a=r(27),o=r(0)("controller/orderController"),s=[n.ZC,n.BS,n.ZI,n.TP,n.PSJ],d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adplayer=t,this.dataset=this.adplayer.dataset,this.reset()}return i(e,[{key:"reset",value:function(){this.sceneInfos=[],this.adtypeMap={},this.watchbuys=[]}},{key:"setOrder",value:function(e,t){if(o.log("order: ",e),!(e=a.parse(e)))return null;if(e.sceneInfos&&e.sceneInfos.length&&(this.sceneInfos=this.checkScenesConflict(e),this.watchbuys=e.watchbuys,this.setPageWatchBuyData()),e.adtypeMap)for(var r in e.adtypeMap)this.adtypeMap[r]=e.adtypeMap[r];return t&&e.adtypeMap?e.adtypeMap[t]:e.adtypeMap}},{key:"setPageWatchBuyData",value:function(){this.watchbuys&&this.watchbuys.length>0&&"function"==typeof window.__flashplayer_watchAndBuyList&&window.__flashplayer_watchAndBuyList(this.watchbuys)}},{key:"clearPageWatchBuyData",value:function(){this.watchbuys=[]}},{key:"checkScenesConflict",value:function(e){var t=e.sceneInfos,r=(e.adtypeMap,e.fields);if(t){if(r&&r[0]&&r[0].videotag&&r[0].videotag[0]&&r[0].videotag[0].ts&&r[0].videotag[0].ts.t){var i=r[0].videotag[0].ts.t[0],a=void 0;i&&i.forEach(function(e){a=parseInt(.001*e.pt),t.forEach(function(e){e.orderType!=n.BS||e.isEmpty||e.isConflictMark||e.getEndSec()<a-10||e.getStartSec()>a+15+10||(e.isConflictMark=!0)})})}var o=void 0,d=void 0,l=t.length,u=void 0,c=void 0;for(o=0;o<l;o++)if((u=t[o])&&!u.isEmpty&&!u.isWholeScene&&!u.isConflictMark)for(d=o+1;d<l;d++)if((c=t[d])&&!c.isEmpty&&!c.isWholeScene&&!c.isConflictMark&&this.isSceneConflict(u,c)){if(u.orderType==n.CZC&&c.orderType==n.ZC){c.isConflictMark=!0;break}if(u.orderType==n.ZC&&c.orderType==n.CZC){u.isConflictMark=!0;break}if(u.orderType==n.CZC||c.orderType==n.CZC)break;if(s.indexOf(u.orderType)>s.indexOf(c.orderType)){u.isConflictMark=!0;break}c.isConflictMark=!0}return t=t.filter(function(e){return!e.isConflictMark})}}},{key:"isSceneConflict",value:function(e,t){var r=e.getStartSec(),i=e.getEndSec(),n=t.getStartSec();return!(t.getEndSec()<r-10||n>i+10)}},{key:"getOrdersByType",value:function(e){return this.adtypeMap[e]}},{key:"isOrderEmpty",value:function(e){if(!e)return!0;var t=e instanceof Array?e:this.getOrdersByType(e);return!t||0===t.length||t.every(function(e){return e.isEmpty})}},{key:"getOrderDuration",value:function(e){if(!e)return 0;var t=0,r=e instanceof Array?e:this.getOrdersByType(e);return r&&0!==r.length?(r.forEach(function(e){t+=+e.duration}),t/1e3):0}}]),e}();e.exports=d},function(e,t,r){"use strict";var i=r(21),n=r(28),a=r(3),o=r(2),s={VIDEO:"mp4",PIC:["jpg","png","jpeg"],PSJ:"mp4"},d={LD:["richMediaJs"],ZI:["richMediaJs","res"],ZT:["richMediaJs"]};function l(e,t,r){return e+"_"+t+"_"+r}function u(e){for(var t=e?e.length:0,r=void 0,i=[],n=0;n<t;n++)r=e[n],i[n]={index:r.index,url:r.url||"",width:r.width,height:r.height,md5:r.md5,vid:r.vid,cs:r.cs,ds:r.ds};return i}function c(e){switch(e){case a.LD:case a.HT:case a.ZC:return d.LD;case a.ZI:return d.ZI;case a.ZT:return d.ZT}return null}function h(e){var t={};if(!e)return t;var r="";try{r=decodeURIComponent(e)}catch(n){}var i=void 0;return r.split("&").forEach(function(e){if((i=e.split("="))[0]&&(t[i[0]]=i[1],i[1]))switch(i[0]){case"richdata":case"watch_buy":var r=i[1];try{r=decodeURIComponent(i[1])}catch(n){r=i[1]}try{t[i[0]]=JSON.parse(r)}catch(n){t[i[0]]={}}}}),t}e.exports={parse:function(e){if(!e)return null;var t={},r={},d=[],f=[],p=void 0,v=void 0,y=void 0,g=void 0,m=void 0,E=void 0,_=void 0,T=void 0,A=void 0,b=void 0,w=void 0,S=void 0,R=function(e){var t={};if("undefined"!=typeof e.anchor_binding)for(var r=0,i=e.anchor_binding.length||0;r<i;r++){var n=e.anchor_binding[r];n.order_list&&n.order_list.length&&n.order_list.forEach(function(e){var r=e.order_id+"_"+e.cre_id;t[r]||(t[r]=[]),t[r].push(n.time)})}return t}(e);for(var D in e.adList&&e.adList.item&&function(){var i=void 0;v=e.adList.item.length||0;var d=function(){var d=[];if((i=e.adList.item[p]).creative)for(g=i.creative.length,y=0;y<g;y++){m=i.creative[y],d[y]={id:m.id||"0",duration:m.duration||5e3,material:u(m.material)};var f={};m.reportUrlOther&&(f.reportUrlOther=m.reportUrlOther),m.reportUrlSDK&&(f.reportUrlSDK=m.reportUrlSDK),m.clickReportUrlOther&&(f.clickReportUrlOther=m.clickReportUrlOther),d[y].creport=f}else i.image&&(d[0]={id:"0",duration:i.duration,material:u(i.image)});d.forEach(function(u){for(var f=R[i.order_id+"_"+u.id],p=0,v=f?f.length:1;p<v;p++){var y=new n;if(y.order_id=i.order_id,y.adtype=i.type,y.display_code=i.display_code,y.duration=i.duration||0,y.no_click=i.no_click,y.inner_jump=i.inner_jump,y.privacy_url=i.privacy_url,y.privacy_type=i.privacy_type,y.dsp_name=i.dsp_name||"",y.expired_time=i.expired_time,y.link=i.link||"",y.reportTime=i.ReportTime||0,y.reportUrl=i.reportUrl||"",y.reportUrlOther=i.reportUrlOther,y.reportUrlSDK=i.reportUrlSDK,y.clickReportUrlOther=i.clickReportUrlOther,y.reportUrlView=i.reportUrlView,y.extParams=h(i.params),y.creative=d,y.setCurCreative(u.id),y.getCurCreative()&&y.getCurCreative().duration>0&&(y.duration=y.getCurCreative().duration),y.setCurMaterial(0),A=y.getCurMaterial()?y.getCurMaterial().url:"",y.canPlay=o.checkSuffix(A,y.isVideoAd?s.VIDEO:s.PIC),y.adtype==a.PSJ&&(T=y.getCurCreative()?y.getCurCreative().material:null)instanceof Array)for(_=T.length||0,E=0;E<_;E++)if(o.checkSuffix(T[E].url,s.PSJ)){y.setCurMaterial(E),y.canPlay=!0;break}if(S=c(y.adtype),y.isRichMedia&&S)for(w=S.length||0,b=0;b<w;b++)if(y.richData&&y.richData.plugins&&y.richData.plugins[S[b]]){y.richType=S[b],y.richRes=y.richData.plugins[S[b]];break}y.adLoc=e.adLoc,y.adGetv=e.adGetv,0==p&&(r[y.adtype]||(r[y.adtype]=[]),r[y.adtype].push(y)),t[l(y.order_id,u.id,f?f[p]:0)]=y}})};for(p=0;p<v;p++)d()}(),"undefined"!=typeof e.anchor_binding&&function(){var r=void 0,n=void 0,o=void 0;for(v=e.anchor_binding.length||0,p=0;p<v;p++)n=e.anchor_binding[p],(r=new i).scene_id=n.scene_id,r.time=n.time||0,r.end_time=n.end_time||r.time,r.adunit_id=n.adunit_id||"",n.order_list&&n.order_list.length&&(r.orderList=[],n.order_list.forEach(function(e){if(o=t[l(e.order_id,e.cre_id,r.time)]){o.link=e.link,o.reportTime=e.report_time||0,o.reportUrl=e.report_url,"1"==e.report_range&&(o.reportRange=1,o.reportBegin=e.report_begin,o.reportEnd=e.report_end),o.setCurCreative(e.cre_id);var i=o.getCurCreative();if(i&&i.duration>0&&(o.duration=i.duration),i&&i.creport){var n=i.creport;Object.keys(n).length&&["reportUrlOther","clickReportUrlOther","reportUrlView"].forEach(function(e){if(n[e]&&n[e].reportitem&&n[e].reportitem.length){n.dreport=n.dreport||{},n.dreport.reportitem=n.dreport.reportitem||[];var t=n[e].reportitem;t.forEach(function(e,r){"1"==e.report_range&&(n.dreport.reportitem.push(e),t.splice(r,1))})}})}e.anchor?o.anchor={pos_x:e.anchor.pos_x,pos_y:e.anchor.pos_y,pos_h:e.anchor.pos_h,pos_w:e.anchor.pos_w,begin:e.anchor.begin,end:e.anchor.end,interval:e.anchor.interval,ratio:e.anchor.ratio}:o.anchor=null,r.orderList.push(o)}})),(o=r.orderList?r.orderList[0]:null)&&(o.adtype==a.PSJ&&o.anchor&&o.anchor.end&&o.anchor.interval?r.isWholeScene=!0:r.isWholeScene=!1,o.adtype==a.BS&&f.push({order_id:o.order_id,scene_id:r.scene_id,link:o.link,params:{watch_buy:o.watchBuyData},play_mtime:.001*r.time})),d[p]=r}(),r)r[D]&&(r[D].adcost=e.adcost,r[D].errorcode=e.errorcode);return f.length>0&&f.sort(function(e,t){return e.play_mtime<=t.play_mtime?-1:1}),{adtypeMap:r,sceneInfos:d,fields:e.fields,watchbuys:f}}}},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=r(3),a=r(2),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.order_id="",this.adtype="",this.display_code="",this.duration="",this.no_click="N",this.inner_jump="N",this.privacy_url="",this.privacy_type="",this.dsp_name="",this.expired_time=0,this.creative=null,this.link="",this.reportTime=0,this.reportUrl="",this.reportUrlOther=null,this.reportUrlSDK=null,this.clickReportUrlOther=null,this.reportUrlView=null,this.anchor=null,this.adLoc=null,this.adGetv=null,this.orderIdx=0,this._cre_id="",this._curCreative=null,this._materialIdx=0,this._curMaterial=null,this.extParams=null,this.richType="",this.richRes=null,this.canPlay=!0,this.isTrueview=!1,this.forbidSkip=!1,this.isVip=!1,this.vid=""}return i(e,[{key:"getCurCreative",value:function(){return this._curCreative?this._curCreative:this.creative&&this.creative.length?this.creative[0]:null}},{key:"setCurCreative",value:function(e){if(this.creative){this._cre_id=e;for(var t=this.creative.length||0,r=void 0,i=0;i<t;i++)if((r=this.creative[i])&&r.id==this._cre_id){this._curCreative=r;break}}}},{key:"getCurMaterial",value:function(){return this._curMaterial}},{key:"setCurMaterial",value:function(e){if(this._materialIdx=e,this.getCurCreative()&&this.getCurCreative().material){var t=this.getCurCreative().material;t instanceof Array?this._curMaterial=t[this._materialIdx]||t[0]:this._curMaterial=t}}},{key:"onlyId",get:function(){return this.order_id+"_"+this._cre_id}},{key:"creId",get:function(){return this._cre_id}},{key:"oadId",get:function(){return this.adLoc?this.adLoc.aid:0}},{key:"adFlag",get:function(){return this.adLoc?this.adLoc.adFlag:0}},{key:"isEmpty",get:function(){return parseInt(this.order_id)<100||"Empty"==this.display_code}},{key:"richData",get:function(){return this.extParams?this.extParams.richdata:null}},{key:"watchBuyData",get:function(){return this.extParams?this.extParams.watch_buy:null}},{key:"isRichMedia",get:function(){return this.display_code&&"RichVideoFront"==this.display_code}},{key:"isVideoAd",get:function(){switch(this.adtype){case n.LD:case n.HT:case n.ZC:case n.KB:return!0}return!1}},{key:"isAutoPlay",get:function(){switch(this.adtype){case n.ZC:case n.HT:return!1}return!0}},{key:"canSkip",get:function(){return!this.adLoc||0==this.adLoc.adFlag}},{key:"userIsVip",get:function(){return this.adLoc&&1==this.adLoc.isvip}},{key:"rfid",get:function(){return this.adLoc?this.adLoc.rfid:""}},{key:"isTrueView",get:function(){return this.richData&&this.richData.plugins&&"N"!=this.richData.plugins.trueview}},{key:"plugType",get:function(){return this.richData&&this.richData.plugins?this.richData.plugins.plugType:""}},{key:"locId",get:function(){return this.reportUrl&&a.url2Obj(this.reportUrl).loc||""}}]),e}();e.exports=o},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(30),o=r(31),s=r(1),d=r(0)("controller/adController"),l=r(37),u=r(53),c=r(3),h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adplayer=t,this.message=new l,this.adService=new a(this.adplayer,this.message),this.adReporter=new o,this.bindPlayerEvent(),this.listenReportEvents()}return i(e,[{key:"init",value:function(){if(!this.adplayer.videoAdUi){var e=this.adplayer.getConf();this.adplayer.$dom={},this.adplayer.videoAdUi=new u({adplayer:this.adplayer,conf:e,message:this.message})}}},{key:"initOrderReport",value:function(e){this.adReporter.init({adplayer:this.adplayer,playerData:this.adplayer.getConf().playerData,orderList:e.adList,adcost:e.adcost,message:this.message}),this.reportEvents={}}},{key:"bindPlayerEvent",value:function(){for(var e in s.TXPLAYER_EVENT)if(s.TXPLAYER_EVENT.hasOwnProperty(e)){var t=this;!function(e){t.message.on(s.TXPLAYER_EVENT[e],function(r){d.log("emitToPlayer: ",e);try{t.message.emit[s[e]]}catch(i){}t.adplayer.emitToPlayer(s.TXPLAYER_EVENT[e],r)})}(e)}}},{key:"getAd",value:function(e){return this.adService.getAd(e)}},{key:"preloadAd",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;this.adService.preloadAd(e,t),this.adReporter.reportAd(e)}},{key:"loadAd",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return this.adService.loadAd(e,t)}},{key:"playAd",value:function(){this.adService.playAd.apply(this.adService,arguments)}},{key:"pauseAd",value:function(){this.adService.pauseAd.apply(this.adService,arguments)}},{key:"stopAd",value:function(){this.adService.stopAd.apply(this.adService,arguments)}},{key:"stopAllAd",value:function(){this.adService.stopAllAd.apply(this.adService,arguments)}},{key:"readRfId",value:function(){var e="";if("undefined"!=typeof window.localStorage)try{e=window.localStorage["TxpCreativePlayer-rfid"]}catch(t){}return e||""}},{key:"muteAd",value:function(){this.adService.muteAd.apply(this.adService,arguments)}},{key:"unMuteAd",value:function(){this.adService.unMuteAd.apply(this.adService,arguments)}},{key:"setAdVolume",value:function(){this.adService.setAdVolume.apply(this.adService,arguments)}},{key:"resizeAd",value:function(){this.adService.resizeAd.apply(this.adService,arguments)}},{key:"adjustUI",value:function(){this.adService.adjustUI.apply(this.adService,arguments)}},{key:"hideAdBeforeResize",value:function(){this.adService.hideAdBeforeResize.apply(this.adService,arguments)}},{key:"setAdFullscreen",value:function(){this.adService.setAdFullscreen.apply(this.adService,arguments)}},{key:"setAdSmallWindow",value:function(e){this.adService.setAdSmallWindow.apply(this.adService,arguments)}},{key:"setAdPosition",value:function(e){this.adService.setAdPosition.apply(this.adService,arguments)}},{key:"reportAd",value:function(e){return this.adService.reportAd.apply(this.adService,arguments)}},{key:"seekStart",value:function(e){this.adService.seekStart.apply(this.adService,arguments)}},{key:"listenReportEvents",value:function(){var e,t=this,r=this;this.reportEvents=(n(e={},s.REPORT_EVENT.AD_DP3_CZC,function(e){d.log("report: ",s.REPORT_EVENT.AD_DP3_CZC,e);try{r.adReporter.reportCzcDp3(e)}catch(t){}}),n(e,s.REPORT_EVENT.AD_MIND_CZC,function(e){d.log("report: ",s.REPORT_EVENT.AD_MIND_CZC,e);try{r.adReporter.reportAdMind(e)}catch(t){}}),n(e,s.REPORT_EVENT.AD_DURING,function(e){d.log("report: ",s.REPORT_EVENT.AD_DURING,e);try{r.adReporter.reportAdData(e,!e.isOther)}catch(t){}}),n(e,s.REPORT_EVENT.AD_POINT_VIEW,function(e){d.log("report: ",s.REPORT_EVENT.AD_POINT_VIEW,e);try{r.adReporter.reportAdData(e,!0)}catch(t){}}),n(e,s.REPORT_EVENT.AD_3PARTY_VIEW,function(e){d.log("report: ",s.REPORT_EVENT.AD_3PARTY_VIEW,e);try{r.adReporter.reportAdData(e)}catch(t){}}),n(e,s.REPORT_EVENT.AD_SCREEN_SHOT,function(e){d.log("report: ",s.REPORT_EVENT.AD_SCREEN_SHOT,e);try{r.adReporter.reportAdScreenShot(e)}catch(t){}}),n(e,s.REPORT_EVENT.AD_GET_INFO_ERROR,function(e){d.log("report: ",s.REPORT_EVENT.AD_GET_INFO_ERROR,e);try{r.adReporter.reportDp3Error(e)}catch(t){}}),n(e,s.REPORT_EVENT.AD_VIEW,function(e){d.log("report: ",s.REPORT_EVENT.AD_VIEW,e.adInfo);try{r.adReporter.reportAd(e)}catch(t){}}),n(e,s.REPORT_EVENT.AD_GET_INFO,function(e){var t={adtype:e.adtype||"",errMsg:e.errMsg||"",adInfo:e.adInfo,adcost:e.adcost||"",errorcode:e.errorCode||""};d.log("ad_get_info-report: ",s.REPORT_EVENT.AD_GET_INFO,e);try{r.adReporter.reportDp3(1,t),r.adReporter.reportVideoDp3(1,t)}catch(i){}}),n(e,s.REPORT_EVENT.NEW_DP3,function(e){r.adReporter.reportNewDp3(e,e.adInfo)}),n(e,s.REPORT_EVENT.AD_END,function(e){var t={adclose:e.adclose||"",closetime:e.closetime||"",adfbt:e.adfbt||"",adtt:e.adtt||"",firstview:e.firstview||"",videott:e.videott||"",videopt:e.videopt||"",errorcode:e.errorcode||"",adInfo:e.adInfo};if(d.log("report: ",s.REPORT_EVENT.AD_END,e),e.adInfo.list&&e.adInfo.list.length>0)for(var i=0,n=e.adInfo.list.length;i<n;i++)if(e.adInfo.list[i]&&e.adInfo.list[i].delayReportTimeoutIds)for(var a in e.adInfo.list[i].delayReportTimeoutIds)d.log("\u6e05\u9664\u5ef6\u65f6\u4e0a\u62a5, order_id/timeid: ",e.adInfo.list[i].order_id,a),clearTimeout(a);try{var o=e.adInfo;!o||o.adtype!=c.LD&&o.adtype!=c.KB&&o.adtype!=c.ZC&&o.adtype!=c.HT||(r.adReporter.reportDp3(2,t),r.adReporter.reportVideoDp3(2,t))}catch(l){}}),n(e,s.REPORT_EVENT.AD_LOAD_COMPLETE,function(e){var t={errorcode:e.errorcode,adload:e.adload||"",tpindex:e.tpindex||"",oid:e.oid||e.adInfo.order_id||"",adInfo:e.adInfo};try{r.adReporter.reportDp3(3,t),r.adReporter.reportVideoDp3(3,t)}catch(i){}d.log("report: ",s.REPORT_EVENT.AD_LOAD_COMPLETE,e)}),n(e,s.REPORT_EVENT.AD_CLICK,function(e){var t={adclick:e.adclick,clicktime:e.clicktime||"",adInfo:e.adInfo};try{var i=e.adInfo;!i||i.adtype!=c.LD&&i.adtype!=c.KB&&i.adtype!=c.ZC&&i.adtype!=c.HT||(r.adReporter.reportDp3(4,t),r.adReporter.reportVideoDp3(4,t)),r.adReporter.reportOtherAdClick(e)}catch(n){}d.log("report: ",s.REPORT_EVENT.AD_CLICK,e)}),e),Object.keys(this.reportEvents).forEach(function(e){var r=t.reportEvents[e];t.message.on(e,r)})}}]),e}();e.exports=h},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var a=r(3),o=r(4),s=r(1),d=r(0)("service/adService"),l=r(8).Promise;e.exports=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adplayer=t,this.message=r,this.adplayer.adMap=this.adMap={};var i=this;this.message.on(s.AD_SHOW,function(e){e&&i.isNeedCheckType(e.adtype)&&(d.log("ad show, adtype="+e.adtype),i.checkSceneShow())}),this.message.on(s.AD_HIDE,function(e){e&&!e.isWholeScene&&i.isNeedCheckType(e.adtype)&&(d.log("ad hide, adtype="+e.adtype),i.checkSceneShow())}),this.message.on(s.AD_STOP,function(e){if(e){if(e.removeType&&e.adtype)return delete i.adMap[e.adtype],void d.log("ad stop and removeTypeFromAdMap, adtype="+e.adtype+", isWholeScene="+e.isWholeScene);var t=void 0,r=void 0,n=void 0;if(e.adinfo)for(var a in n=i.getAd(e.adinfo),i.adMap)if((t=i.adMap[a])&&(r=t.indexOf(n),!/PPB|PDF/gi.test(a)&&r>-1)){t.splice(r,1,undefined),d.log("ad stop and removeFromAdMap, adtype="+e.adinfo.adtype+", isWholeScene="+e.isWholeScene);break}}})}return n(e,[{key:"checkSceneShow",value:function(){var e=void 0,t=!1,r=[];for(var i in this.adMap)(e=this.adMap[i])&&e.length&&e.forEach(function(e){e&&(e.isWholeScene?r.push(e):e.isShow&&e.info&&"PPB"!==e.info.adtype&&"PDF"!==e.info.adtype&&"CZC"!==e.info.adtype&&(t=!0))});r.forEach(function(e){t?e.isShow&&(e.hide(!0),d.log("and ad hide, adtype="+e.adtype+", isWholeScene="+e.isWholeScene)):e.isShow||(e.show(!0),d.log("and ad show, adtype="+e.adtype+", isWholeScene="+e.isWholeScene))})}},{key:"isNeedCheckType",value:function(e){switch(e){case a.ZT:case a.ZI:case a.TP:case a.PSJ:case a.BS:return!0}return!1}},{key:"loadAd",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!e)return l.resolve();var r=this.getAd(e);return r&&r.stop(),(r=this._createAd(e,this.adplayer.$dom,t))?(r.load(),l.resolve()):l.reject()}},{key:"_reportAdGetInfo",value:function(e){e.adtype!=a.CZC&&e.adtype!=a.VIN&&this.message.emit(s.REPORT_EVENT.AD_GET_INFO,{errMsg:e.list.errMsg||"",adInfo:e,adcost:e.list.adcost,errorCode:e.list.errorcode,adtype:e.adtype,duration:this.adplayer.getOrderDuration(e.list),isEmpty:this.adplayer.isOrderEmpty(e.list)})}},{key:"_createAd",value:function(e,t){var r,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!(e=this._getParam(e)).adtype||!e.list)return null;var n=e.adtype,d={infos:e.list,dom:t,scene:i,dataset:this.adplayer.dataset,message:this.message,adplayer:this.adplayer};switch(this._reportAdGetInfo(e),n){case a.LD:this.message.emit(s.TXPLAYER_EVENT.AD_GET_INFO,{adtype:n,duration:this.adplayer.getOrderDuration(e.list),isEmpty:this.adplayer.isOrderEmpty(e.list)}),r=TxpCreativePlayer.adClass.make("LoadingAd",d);break;case a.HT:r=TxpCreativePlayer.adClass.make("EndingAd",d);break;case a.ZC:r=TxpCreativePlayer.adClass.make("ZcAd",d);break;case a.ZT:r=TxpCreativePlayer.adClass.make("ZtAd",d);break;case a.ZI:r=TxpCreativePlayer.adClass.make("IvbAd",d);break;case a.BS:r=TxpCreativePlayer.adClass.make("BuyAd",d);break;case a.PSJ:r=TxpCreativePlayer.adClass.make("FlowAd",d);break;case a.PDF:case a.PPB:case a.PVL:d.dom=this.adplayer.getConf().playerDom[n.toLowerCase()+"AdLayer"],r=TxpCreativePlayer.adClass.make("EmbedAd",d);break;case a.CZC:r=TxpCreativePlayer.adClass.make("CzcAd",d);break;case a.VIN:r=TxpCreativePlayer.adClass.make("VinAd",d);break;default:r=null}if(r){if(r.state!==o.END){this.adMap[n]||(this.adMap[n]=[]);var l=this.adMap[n];if(l.length>0&&(e.adtype==a.LD||e.adtype==a.ZC||e.adtype==a.HT))for(var u=0;u<l.length;u++){try{l[u]&&l[u].stop()}catch(c){}l.splice(u,1),u--}l.push(r)}return r}}},{key:"_getParam",value:function(e){if(!e)return e;var t=void 0;return"string"==typeof e?{adtype:t=e,list:this.adplayer.getOrdersByType(t)}:e instanceof Array?{adtype:t=e.adtype||(e[0]?e[0].adtype:""),list:e}:"object"===(void 0===e?"undefined":i(e))?{adtype:t=e.adtype||"",list:[e]}:e}},{key:"getAd",value:function(e){if(!e)return null;var t=void 0,r=void 0,n=void 0,a=void 0;for(var o in this.adMap)for(a=(t=this.adMap[o])?t.length:0,n=0;n<a;n++)if(r=t[n])if("string"==typeof e){if(r.adtype==e){if(r._isForceHide)continue;return r}}else if(e instanceof Array){if(r.infos&&r.infos==e)return r}else if("object"===(void 0===e?"undefined":i(e))&&r.info&&(r.info==e||r.info.onlyId==e.onlyId&&r.info&&r.info.adtype===e.adtype))return r;return null}},{key:"_broadcastToAllAd",value:function(){var e=this;if(this.adMap){var t=Array.prototype.slice.call(arguments),r=t[0];t.shift();var i=function(i){e.adMap[i]&&e.adMap[i].forEach(function(e){try{e&&"function"==typeof e[r]&&e[r].apply(e,t)}catch(n){d.log("\u5e7f\u544a\u7c7b\u578b["+i+"]\u8c03\u7528["+r+"]\u62a5\u9519\uff1a",n)}})};for(var n in this.adMap){i(n)}}}},{key:"playAd",value:function(e){var t=this;d.log("playAd",e);var r=this.getAd(e);if(r&&r.canPlay)d.log("play"),r.play();else if(r&&r._state===o.WAIT_FOR_STOP)d.log("stop"),r.stop();else if(!r)if(e===a.HT){var i=function(){t.endingAdTimeoutHandler=setTimeout(function(){var r=t.getAd(e);r&&r.canPlay&&r._state>=o.INIT&&r._state<=o.LOAD_READY?r.play():r&&r.stop&&r._state<=o.INIT?r.stop(!0):r||t.message.emit(s.TXPLAYER_EVENT.AD_STOP,{adtype:a.HT})},1e3)};t.adplayer.hasLoadEndingAd?(d.log("\u5df2\u7ecf\u8bf7\u6c42\u8fc7\u4e86..."),i()):setTimeout(function(){t.adplayer.hasLoadEndingAd?i():t.adplayer.hasLoadEndingAd=!0},500)}else this.message.emit(s.TXPLAYER_EVENT.AD_STOP,{adtype:e})}},{key:"stopAd",value:function(e){var t=this.getAd(e);t&&t.stop()}},{key:"pauseAd",value:function(e){var t=this.getAd(e);t&&t.pause()}},{key:"reportAd",value:function(e,t){var r,i=this;return"string"==typeof e&&(r=this.getAd(e)),r?("[object Array]"!==Object.prototype.toString.call(r)&&(r=[r]),r.forEach(function(e){e.info&&t.view&&i.message.emit(s.REPORT_EVENT.AD_VIEW,{adInfo:e.info})}),!0):!!t.info&&(this.message.emit(s.REPORT_EVENT.AD_GET_INFO,t.data),!0)}},{key:"stopAllAd",value:function(){clearTimeout(this.endingAdTimeoutHandler),this.adplayer.hasLoadEndingAd=!1,this._broadcastToAllAd("stop",!0);var e=this.adplayer.controllers;e&&e.orderController&&e.orderController.reset(),this.adplayer.adMap=this.adMap={}}},{key:"muteAd",value:function(){this._broadcastToAllAd("mute")}},{key:"unMuteAd",value:function(){this._broadcastToAllAd("unMute")}},{key:"setAdVolume",value:function(e){this._broadcastToAllAd("setVolume",e)}},{key:"resizeAd",value:function(e){this._broadcastToAllAd("resize",e)}},{key:"adjustUI",value:function(e){this._broadcastToAllAd("adjustUI",e)}},{key:"hideAdBeforeResize",value:function(){this._broadcastToAllAd("hideAdBeforeResize")}},{key:"setAdFullscreen",value:function(e){this._broadcastToAllAd("setFullScreen",e)}},{key:"setAdSmallWindow",value:function(e){if(e){var t=this.adplayer.dataset;t.playerWidth=e.width,t.playerHeight=e.height}this._broadcastToAllAd("setSmallWindow",e)}},{key:"setAdPosition",value:function(e){this._broadcastToAllAd("setPosition",e)}},{key:"seekStart",value:function(e){this._broadcastToAllAd("seekStart",e)}}]),e}()},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=r(9),a=r(32),o=r(33),s=r(35),d=r(36),l=r(13),u=r(0)("modules/adReporter"),c=r(2);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adCommonReporter=null,this.adReportDp3=null,this.screenShotter=null,this.commonCfg={},this.screenShotCfg={},this.dp3Cfg={},this.mindCfg={}}return i(e,[{key:"init",value:function(e){if(e&&e.playerData){var t=this.playerData=e.playerData;this.adplayer=e.adplayer,this.commonCfg={from:t.playerFrom,pf:t.playerPf,v:t.playerVersion,dura:t.playerDuration,coverid:t.playerCid,pf_ex:t.playerPfEx,chid:t.playerChid||0,tpid:t.playerTpid||"",vptag:t.playerVptag,appversion:n},this.adCommonReporter||(this.adCommonReporter=new a),this.adCommonReporter.init(this.commonCfg,e.message),this.screenShotCfg={flowid:t.playerFlowid,guid:t.playerGuid,platform:t.playerPlatform,vid:t.playerVid},this.screenShotter||(this.screenShotter=new o),this.screenShotter.init(this.screenShotCfg),this.dp3Cfg={appuser:function(e){if(document.cookie.length>0){var t=document.cookie.indexOf(e+"=");if(-1!=t){t=t+e.length+1;var r=document.cookie.indexOf(";",t);return-1==r&&(r=document.cookie.length),decodeURIComponent(document.cookie.substring(t,r))}}return""}("appuser"),flowid:t.playerFlowid,guid:t.playerGuid,pf:t.playerPf,pfEx:t.playerPfEx,chid:t.playerChid||0,mvid:t.playerVid,videoDuration:t.playerDuration,coverid:t.playerCid,pversion:t.playerVersion,live:0,version:n,orderList:e.orderList||{},adcost:e.adcost||""},this.adReportDp3||(this.adReportDp3=new s),this.adReportDp3.init(this.dp3Cfg),this.mindReporter||(this.mindReporter=new d),this.mindReporter.init(this.mindCfg)}}},{key:"reportAd",value:function(e){this.adCommonReporter.reportAd(e)}},{key:"reportAdData",value:function(e,t){this.adCommonReporter.reportAdData(e,t)}},{key:"reportOtherAdClick",value:function(e){this.adCommonReporter.reportOtherAdClick(e)}},{key:"reportDp3",value:function(e,t){this.adReportDp3.reportStep(e,t)}},{key:"reportNewDp3",value:function(e,t){var r=t&&t.extParams&&t.extParams.richdata?t.extParams.richdata.plugins:{},i=this.adplayer.getConf(),n={bid:"10021013",requestid:"",pf:i.playerData.playerPf,chid:i.playerData.playerChid||"",ts:+new Date,configversion:"",data:"",adtype:e.adtype,flow_id:i.playerData.playerFlowid,live:0,offline:0,reportkey:"",preload:0,page:"",style:"",playmode:"",coverid:i.playerData.coverid||"",vid:i.playerData.playerVid,previd:"",channelid:"",tpid:i.playerData.playerTpid,videoDuration:i.playerData.playerDuration,body:[{errorcode:e.errorcode||"",starttime:e.starttime||0,fullscreen:0,muted:0,userclose:r&&"Y"==r.close_ad?1:0,oid:t?t.order_id:"",ad_vid:"",cdnUrl:"",dfn:"",lpLoadDuration:"",lpStayDuration:"",playOidDuration:"",errorName:"",errorMsg:"",displayid:"",isEmpty:"",failedUrl:"",clickX:"",clickY:"",soid:"",orderAdType:"",playVidTime:"",anchorid:e.anchorid||"",adtype:e.adtype,allAdDuration:"",adunit_id:e.adunit_id||""}]};u.log("("+e.adtype+") reportNewDp3:",n);try{var a=new XMLHttpRequest;a.open("POST","//dp3.qq.com/stdlog",!0),a.responseType="text",a.timeout="8000",a.setRequestHeader("Content-type","text/plain"),a.send(JSON.stringify(n))}catch(o){console.log(o)}}},{key:"reportVideoDp3",value:function(e,t){this.adReportDp3.reportStepForVidoe(e,t)}},{key:"reportDp3Error",value:function(e){var t=e.playerData,r=e.adcost,i=e.errorCode,a=e.adtype.split("|"),o={appuser:c.cookie.get("appuser")||"",channel:c.getVideoType(),qq:c.cookie.get("luin")||c.cookie.get("uin")||"",guid:t.playerGuid||"",pf:t.playerPf||"",pfEx:t.playerPfEx||"",chid:t.playerChid||0,mvid:t.playerVid||"",videoDuration:t.playerDuration||0,coverid:t.playerCid||"",pversion:t.playerVersion||"",live:0,version:n,ua:c.getUA(navigator.userAgent),adcost:r||"",errorcode:i};a.forEach(function(t){o.adtype=t,function(t){var r={bid:"10091006",step:1};for(var n in 0!=+i&&(r.errMsg=e.errMsg||""),t)r[n]=t[n];try{var a=new XMLHttpRequest;a.open("POST","//dp3.qq.com/stdlog"),a.responseType="text",a.timeout="8000",a.setRequestHeader("Content-type","text/plain"),a.send(JSON.stringify(r))}catch(o){u.log("reportErrorByPost:",o)}}(o),function(e,t,r){var i=c.appendParamsToUrl(e,t);i+="&step=1",r&&(i+="&_dc="+Math.random());var n=new Image;n.onload=n.onerror=function(){n=null},n.src=i}("//btrace.video.qq.com/kvcollect?BossId=5818&Pwd=1658255276",o,!0)})}},{key:"reportAdScreenShot",value:function(e){this.screenShotter.shot(e)}},{key:"resetAdScreenShot",value:function(){this.screenShotter.reset()}},{key:"reportAdMind",value:function(e){this.mindReporter.reportMind(e)}},{key:"reportCzcDp3",value:function(e){var t,r,i,n,a=this.playerData,o={appuser:c.cookie.get("appuser")||"",qq:c.cookie.get("luin")||c.cookie.get("uin")||"",flowid:a.playerFlowid,guid:a.playerGuid||"",pf:a.playerPf||"",chid:a.playerChid||0,vid:a.playerVid||"",coverid:a.playerCid||"",ua:c.getUA(navigator.userAgent)};o=l({},o,e),t="//dp3.qq.com/stdlog?bid=10091007",r=o,i=c.appendParamsToUrl(t,r),(n=new Image).onload=n.onerror=function(){n=null},n.src=i}}]),e}()},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var a=r(13),o=r(0)("modules/adcommonreporter"),s=r(1),d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.delayReportArr=null,this.list=[],this.timer=null,this.imgObj=null}return n(e,[{key:"init",value:function(e,t){this.config=e,this.message=t}},{key:"reportAd",value:function(e){var t=this,r=e.adInfo,n=e.scene;if(Array.isArray(r)&&(r=r[0]),r&&"object"==(void 0===r?"undefined":i(r))){var o="PSJ"==r.adtype&&!n.isWholeScene;if(r.reportUrl&&("CZC"!=r.adtype||"CZC"==r.adtype&&"1"!=r.reportRange)){var s={url:document.URL};s=a(s,l(this.config,r)),TxpCreativePlayer.fromPcClient&&(s.vptag=this.config.vptag||"");var d=r.reportUrl,h=c(d);s=a(s,h);var f=u(d.split("?")[0],s,!0);this.reportData({adinfo:r,time:o?0:parseInt(r.reportTime)||0,url:f},r.adtype+"\u5185\u90e8\u66dd\u5149\u4e0a\u62a5(reportUrl)")}var p=["reportUrlOther"];if(p.forEach(function(e){r[e]&&Array.isArray(r[e].reportitem)&&r[e].reportitem.length&&r[e].reportitem.forEach(function(e,i){e&&e.url&&t.reportData({adinfo:r,time:o?0:parseInt(e.reporttime)||0,url:e.url,isOther:!0},r.adtype+"\u7b2c\u4e09\u65b9\u66dd\u5149\u4e0a\u62a5(reportUrlOther)")})}),"CZC"!=r.adtype&&p.push("dreport"),r._curCreative&&r._curCreative.creport){var v=r._curCreative.creport;p.forEach(function(e){v[e]&&Array.isArray(v[e].reportitem)&&v[e].reportitem.length&&v[e].reportitem.forEach(function(e,i){e&&e.url&&t.reportData({adinfo:r,time:o?0:parseInt(e.reporttime)||0,url:e.url,isOther:!0},r.adtype+"\u521b\u610f\u7ea7\u522b\u7684\u7b2c\u4e09\u65b9\u4e0a\u62a5(creative.creport)")})})}}}},{key:"reportOtherAdClick",value:function(e){var t=e.adInfo,r=t._curCreative&&t._curCreative.creport;if(Array.isArray(t)&&(t=t[0]),t&&"object"==(void 0===t?"undefined":i(t))){if(t.clickReportUrlOther&&t.clickReportUrlOther.reportitem)for(var n=t.clickReportUrlOther.reportitem,a=0;a<n.length;a++){"2"!=(s=n[a]).reporttype&&this.requestReportUrl(s.url)}if(r&&r.clickReportUrlOther&&r.clickReportUrlOther.reportitem){var o=r.clickReportUrlOther.reportitem;for(a=0;a<o.length;a++){var s;"2"!=(s=o[a]).reporttype&&this.requestReportUrl(s.url)}}}}},{key:"reportAdData",value:function(e,t){if(t){var r={url:document.URL};r=a(r,l(this.config,e.adinfo||{}));var i=u(e.url,r,!0),n=i.split("?")[0],o=c(i);e.adinfo.reportTime&&0!=e.adinfo.reportTime&&(o.t=e.adinfo.reportTime),e.url=u(n,o,!1)}this.reportData(e)}},{key:"reportData",value:function(e,t){e&&(o.log("("+t+") report:","("+e.time+")",e.url),e.time>0?this.delayReport(e.url,e.time-100,e.adinfo,e.isOther):this.requestReportUrl(e.url))}},{key:"setReportNull",value:function(e){e.order_id="1",e.reportUrl=e.reportUrl.replace(/(livemsg\?o\=)(\d+)(\&)/,"$190$3"),e.reportUrlOther=null,e.reportUrlSDK=null}},{key:"delayReport",value:function(e,t,r,i){var n=this,a=setTimeout(function(){if(clearTimeout(a),r.delayReportTimeoutIds&&r.delayReportTimeoutIds[a]&&delete r.delayReportTimeoutIds[a],o.log("\u5ef6\u65f6\u4e0a\u62a5\u5b8c\u6210, order_id/time/url: ",r.order_id,t,e),r){var s=t+100,d=r.realViewTime;if(i){if(d&&d<s)return;n.requestReportUrl(e)}else{var l=e.split("?")[0],h=c(e);r.reportTime&&0!=r.reportTime&&(h.t=r.reportTime),r.isTrueView&&d&&(h.t=d);var f=u(l,h,!1);n.requestReportUrl(f)}}else n.requestReportUrl(e)},t);r.delayReportTimeoutIds||(r.delayReportTimeoutIds={}),r.delayReportTimeoutIds[a]=1,o.log("\u5ef6\u65f6\u4e0a\u62a5, order_id/timeid/time/: ",r.order_id,a,t)}},{key:"requestReportUrl",value:function(e){var t=this;-1==e.indexOf("uniquetimestamp")&&(e=u(e,{uniquetimestamp:Date.now()})),this.timer?this.list.push(e):(this.timer=setTimeout(function(){t.timeoutHandler()},1e3),TxpCreativePlayer.fromPcClient?this.message.emit(s.TXPLAYER_EVENT.AD_REPORT,{data:{reportUrl:e}}):(this.imgObj=document.createElement("img"),this.imgObj.onerror=t.timeoutHandler.bind(this),this.imgObj.src=e))}},{key:"timeoutHandler",value:function(){if(0===this.list.length)return this.imgObj=null,void(this.timer=null);clearTimeout(this.timer),this.timer=null,this.requestReportUrl(this.list.shift())}}]),e}();function l(e,t){var r={oadid:t.oadId||"",vptag:function(){for(var e=document.location.toString().toLowerCase(),t="",r=["ptag","adtag","pgv_ref"],i=0,n=r.length;i<n&&!(t=h(r[i],e));i++);if(!t)try{t=sessionStorage.getItem("ptag")}catch(o){}if(!t){var a=function(e){if(void 0===e||null==e||""==e)return"";var t=document.createElement("a");return t.href=e,t.hostname}(document.referrer);a&&-1===["v.qq.com","film.qq.com","m.v.qq.com"].indexOf(a)&&(t=a.replace(/\./g,"_"))}t||(t=function(e){if(document.cookie.length>0){var t=document.cookie.indexOf(e+"=");if(-1!=t){t=t+e.length+1;var r=document.cookie.indexOf(";",t);return-1==r&&(r=document.cookie.length),decodeURIComponent(document.cookie.substring(t,r))}}return""}("ptag"));return t}()||"",url:location.href,lcount:t.orderIdx||1,t:0};return"Empty"==t.display_code&&(r.chid=e.chid),r=a(r,e)}function u(e,t,r){return"string"==typeof e&&t&&(e+=(-1==e.indexOf("?")?"?":"&")+function(e,t){var r=[];for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];r.push(i+"="+(t?encodeURIComponent(n):n))}return r.join("&")}(t,r)),e}function c(e){var t=e.indexOf("?"),r={};return e.substring(t+1).split("&").forEach(function(e){var t=e.split("=");t.length>=2&&(r[t.shift()]=t.join("="))}),r}function h(e,t){t=t||document.location.toString();var r,i=new RegExp("(^|&|\\\\?)"+e+"=([^&]*)(&|$|#)");return(r=t.match(i))?r[2]:""}e.exports=d},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n={EMPTY:"",AD_ERROR:"1",CORS_ERROR:"2",NOT_SUPPORT:"3",SCRIPT_ERROR:"4"},a=r(34),o=r(2).getUA(window.navigator.userAgent),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hasReport=!1,this.imageExt="png",this.imageQuality=1,this.width=160,this.height=90,this.reportUrl=location.protocol+"//adss.video.qq.com/report",this.worker=null,this.canvas=null,this.ctx=null,this.errcode=n.EMPTY,this.initWorker(),this.initCanvas(),this.addEventListener()}return i(e,[{key:"init",value:function(e){this.cfg=e}},{key:"initWorker",value:function(e){try{var t=window.URL||window.webkitURL||window.mozURL||window.msURL,r=new Blob(["self.onmessage = function(res) {var data = res.data;var imageData = data.imageData;var width = data.width;var height = data.height;var chunkLength = width * height;for (var i = 0; i < chunkLength * 4; i = i + 4) {var gray = parseInt((imageData.data[i] + imageData.data[i + 1] + imageData.data[i + 2]) / 3);imageData.data[i] = imageData.data[i + 1] = imageData.data[i + 2] = gray;}try { postMessage(imageData); } catch(e) {console.log(e)}}"],{type:"application/javascript"}),i=t.createObjectURL(r);this.worker=new Worker(i)}catch(a){this.worker=null,this.errcode=n.NOT_SUPPORT}}},{key:"initCanvas",value:function(){this.canvas=document.createElement("canvas"),this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this.canvas.style.cssText="width:"+this.width+"px;height:"+this.height+"px;",this.ctx=this.canvas.getContext("2d")}},{key:"addEventListener",value:function(){var e=this;this.worker&&this.canvas&&this.ctx&&(this.worker.onmessage=function(t){e.ctx.putImageData(t.data,0,0),e.imageUrl=e.canvas.toDataURL("image/"+e.imageExt,e.imageQuality),e.reportData()},this.worker.onerror=function(t){e.errcode=n.SCRIPT_ERROR,e.reportData()})}},{key:"shot",value:function(e){if("safari"!==o&&!this.hasReport){var t=!1;if(e=e||{},this.ptime=e.time||"",this.orderid=e.oid||"",this.aid=e.vid||"",this.idx=e.index,this.errcode=n.EMPTY,(!e.video&&!e.empty||e.video&&0===e.time&&e.video.error&&e.video.error.code)&&(this.errcode=n.AD_ERROR),e.video&&this.worker&&this.ctx)try{this.video=e.video,this.ctx.drawImage(this.video,0,0,this.width,this.height);var r=this.ctx.getImageData(0,0,this.width,this.height);t=!0,this.worker.postMessage({imageData:r,width:this.width,height:this.height})}catch(i){this.errcode=n.CORS_ERROR,t=!1}t||this.reportData()}}},{key:"reportData",value:function(){if(!this.hasReport){this.hasReport=!0;var e=this,t=+new Date,r=a("adsafe"+t+this.cfg.flowid+this.cfg.guid+this.cfg.platform+this.cfg.vid),i={ftime:parseInt(t/1e3),flow_id:this.cfg.flowid,guid:this.cfg.guid,platform:this.cfg.platform,vid:this.cfg.vid,aidtype:1,aid:this.aid,idx:this.idx,ptime:this.ptime,orderid:this.orderid,admedia:"",pdata:"",crc:r,errcode:this.errcode};this.imageUrl&&(i.pdata=this.imageUrl.replace(/^data\:image\/png\;base64\,/,""));try{var n=new XMLHttpRequest;n.open("POST",this.reportUrl),n.addEventListener("error",function(){e.reportCgiError(n.status)}),n.send(JSON.stringify(i))}catch(o){}this.reset()}}},{key:"reset",value:function(){this.hasReport=!1,this.imageUrl="",this.aid="",this.idx="",this.ptime="",this.orderid="",this.errcode=n.EMPTY,this.ctx.clearRect(0,0,this.width,this.height)}},{key:"reportCgiError",value:function(){}}]),e}();e.exports=s},function(e,t,r){"use strict";var i;"function"==typeof Symbol&&Symbol.iterator;!function(n){function a(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function o(e,t,r,i,n,o){return a(function(e,t){return e<<t|e>>>32-t}(a(a(t,e),a(i,o)),n),r)}function s(e,t,r,i,n,a,s){return o(t&r|~t&i,e,t,n,a,s)}function d(e,t,r,i,n,a,s){return o(t&i|r&~i,e,t,n,a,s)}function l(e,t,r,i,n,a,s){return o(t^r^i,e,t,n,a,s)}function u(e,t,r,i,n,a,s){return o(r^(t|~i),e,t,n,a,s)}function c(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var r,i,n,o,c,h=1732584193,f=-271733879,p=-1732584194,v=271733878;for(r=0;r<e.length;r+=16)i=h,n=f,o=p,c=v,f=u(f=u(f=u(f=u(f=l(f=l(f=l(f=l(f=d(f=d(f=d(f=d(f=s(f=s(f=s(f=s(f,p=s(p,v=s(v,h=s(h,f,p,v,e[r],7,-680876936),f,p,e[r+1],12,-389564586),h,f,e[r+2],17,606105819),v,h,e[r+3],22,-1044525330),p=s(p,v=s(v,h=s(h,f,p,v,e[r+4],7,-176418897),f,p,e[r+5],12,1200080426),h,f,e[r+6],17,-1473231341),v,h,e[r+7],22,-45705983),p=s(p,v=s(v,h=s(h,f,p,v,e[r+8],7,1770035416),f,p,e[r+9],12,-1958414417),h,f,e[r+10],17,-42063),v,h,e[r+11],22,-1990404162),p=s(p,v=s(v,h=s(h,f,p,v,e[r+12],7,1804603682),f,p,e[r+13],12,-40341101),h,f,e[r+14],17,-1502002290),v,h,e[r+15],22,1236535329),p=d(p,v=d(v,h=d(h,f,p,v,e[r+1],5,-165796510),f,p,e[r+6],9,-1069501632),h,f,e[r+11],14,643717713),v,h,e[r],20,-373897302),p=d(p,v=d(v,h=d(h,f,p,v,e[r+5],5,-701558691),f,p,e[r+10],9,38016083),h,f,e[r+15],14,-660478335),v,h,e[r+4],20,-405537848),p=d(p,v=d(v,h=d(h,f,p,v,e[r+9],5,568446438),f,p,e[r+14],9,-1019803690),h,f,e[r+3],14,-187363961),v,h,e[r+8],20,1163531501),p=d(p,v=d(v,h=d(h,f,p,v,e[r+13],5,-1444681467),f,p,e[r+2],9,-51403784),h,f,e[r+7],14,1735328473),v,h,e[r+12],20,-1926607734),p=l(p,v=l(v,h=l(h,f,p,v,e[r+5],4,-378558),f,p,e[r+8],11,-2022574463),h,f,e[r+11],16,1839030562),v,h,e[r+14],23,-35309556),p=l(p,v=l(v,h=l(h,f,p,v,e[r+1],4,-1530992060),f,p,e[r+4],11,1272893353),h,f,e[r+7],16,-155497632),v,h,e[r+10],23,-1094730640),p=l(p,v=l(v,h=l(h,f,p,v,e[r+13],4,681279174),f,p,e[r],11,-358537222),h,f,e[r+3],16,-722521979),v,h,e[r+6],23,76029189),p=l(p,v=l(v,h=l(h,f,p,v,e[r+9],4,-640364487),f,p,e[r+12],11,-421815835),h,f,e[r+15],16,530742520),v,h,e[r+2],23,-995338651),p=u(p,v=u(v,h=u(h,f,p,v,e[r],6,-198630844),f,p,e[r+7],10,1126891415),h,f,e[r+14],15,-1416354905),v,h,e[r+5],21,-57434055),p=u(p,v=u(v,h=u(h,f,p,v,e[r+12],6,1700485571),f,p,e[r+3],10,-1894986606),h,f,e[r+10],15,-1051523),v,h,e[r+1],21,-2054922799),p=u(p,v=u(v,h=u(h,f,p,v,e[r+8],6,1873313359),f,p,e[r+15],10,-30611744),h,f,e[r+6],15,-1560198380),v,h,e[r+13],21,1309151649),p=u(p,v=u(v,h=u(h,f,p,v,e[r+4],6,-145523070),f,p,e[r+11],10,-1120210379),h,f,e[r+2],15,718787259),v,h,e[r+9],21,-343485551),h=a(h,i),f=a(f,n),p=a(p,o),v=a(v,c);return[h,f,p,v]}function h(e){var t,r="",i=32*e.length;for(t=0;t<i;t+=8)r+=String.fromCharCode(e[t>>5]>>>t%32&255);return r}function f(e){var t,r=[];for(r[(e.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;var i=8*e.length;for(t=0;t<i;t+=8)r[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return r}function p(e){var t,r,i="0123456789abcdef",n="";for(r=0;r<e.length;r+=1)t=e.charCodeAt(r),n+=i.charAt(t>>>4&15)+i.charAt(15&t);return n}function v(e){return unescape(encodeURIComponent(e))}function y(e){return function(e){return h(c(f(e),8*e.length))}(v(e))}function g(e,t){return function(e,t){var r,i,n=f(e),a=[],o=[];for(a[15]=o[15]=void 0,n.length>16&&(n=c(n,8*e.length)),r=0;r<16;r+=1)a[r]=909522486^n[r],o[r]=1549556828^n[r];return i=c(a.concat(f(t)),512+8*t.length),h(c(o.concat(i),640))}(v(e),v(t))}function m(e,t,r){return t?r?g(t,e):function(e,t){return p(g(e,t))}(t,e):r?y(e):function(e){return p(y(e))}(e)}(i=function(){return m}.call(t,r,t,e))===undefined||(e.exports=i)}(undefined)},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=r(0)("modules/adReportDp3"),a=r(2),o=r(3);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.qq=a.cookie.get("luin")||a.cookie.get("uin")||"",this.adListMap={}}return i(e,[{key:"init",value:function(e){this.config=e;var t=e.orderList||{},r=function(e){var t=[],r=e.item;if(r){var i="[object Array]"===Object.prototype.toString.call(r)?r:[r];i.forEach(function(e,r){e.type&&t.indexOf(e.type)<0&&t.push(e.type)})}return n.log("getTypesFromAdList:",e,t),t.join("_")}(t);r&&(this.adListMap[r]={list:t,adcost:e.adcost})}},{key:"getBaseParam",value:function(){return n.log("getBaseParam:",this.config),{appuser:a.cookie.get("appuser")||"",guid:this.config.guid||"",pf:this.config.pf,pfEx:this.config.pfEx,chid:this.config.chid,channel:a.getVideoType(),requestid:this.config.flowid||"",mvid:this.config.mvid||"",videoDuration:this.config.videoDuration||0,coverid:this.config.coverid||"",qq:this.qq,pversion:this.config.pversion,live:0,version:this.config.version,ua:a.getUA(navigator.userAgent)}}},{key:"parseOrderList",value:function(e){n.log("parseOrderList:",e);var t=[],r=[],i=[],a=e.item;a&&("[object Array]"===Object.prototype.toString.call(a)?a:[a]).forEach(function(e,n){(e=function(e){var t=JSON.parse(JSON.stringify(e));t.creative?t.duration=t.creative[0].duration:t.creative=[];t.image&&(t.image.length?t.creative=t.creative.concat(t.image):t.creative.push(t.image));return t}(e)).order_id&&e.duration&&(e.duration&&i.push(e.duration),"[object Array]"===Object.prototype.toString.call(e.creative)&&e.creative.length&&(e.creative[0].vid?r.push(e.creative[0].vid):e.creative[0].material&&e.creative[0].material.length&&e.creative[0].material[0].vid&&r.push(e.creative[0].material[0].vid)),t.push(e.order_id))});return{oids:t,vids:r,videopt:i}}},{key:"handleParams",value:function(e,t,r){if(e){var i=t.adInfo;i&&i.list&&i.list.length>0&&(i=i.list[0]);var a,s,d={};if(n.log("reportStep",this.config,t),d.adtype=i&&i.adtype?i.adtype:t.adtype,d.adtype){var l=function(e,t){var r={};Object.keys(e).forEach(function(i){i.indexOf(t)>=0&&(r=e[i])});var i=JSON.parse(JSON.stringify(r));o.ZC!==t&&o.ZI!==t&&o.PSJ!==t&&o.BS!==t||i.list&&i.list.item&&i.list.item.length&&(i.list.item=i.list.item.filter(function(e){return e.type===t}));return n.log("getOrderListOfType:",t,i),i}(this.adListMap,d.adtype);if(1===e||2===e){d.flowid=this.config.flowid,i&&(d.soid=function(e,t){if(!e)return"";var r={};return(e.indexOf("?")>-1?e.split("?")[1]:e).split("&").forEach(function(e){var t=e.split("=");r[t[0]]=t[1]}),r[t]||""}(i.reportUrl,"soid"),d.isTrueView=i.isTrueView?1:0,d.adid=i.oadId||"");var u=l&&l.list?this.parseOrderList(l.list):null;d.oids=u?u.oids.join(","):"",d.adtype==o.LD||d.adtype==o.KB||d.adtype==o.ZC||d.adtype==o.HT?d.vids=u?u.vids.join(","):"":d.vids=""}return t.errorcode!==undefined&&(d.errorcode=t.errorcode),"undefined"!=typeof d.errorcode&&0!=d.errorcode&&(d.errMsg=t.errMsg||""),1===e?d.adcost=t.adcost||l.adcost:2===e?(d.adfbt=t.adfbt||"",d.adtt=t.adtt||"",a=t.videopt||[],s=t.videott||[],d.videopt=a.join(",")||"",d.videott=s.join(",")||"",d.errorcode=t.errorcode?t.errorcode:i&&i.errorcode?2201:"",d.adclose=t.adclose||"",d.closetime=t.closetime||"",d.firstview=t.errorcode?-1:t.firstview||""):3===e?(d.adload=t.adload,d.tpindex=t.tpindex,d.oid=t.oid,d.errorcode=t.errorcode||""):4===e&&(d.adclick=t.adclick,d.clicktime=t.clicktime),d.timestamp=+new Date,"video"==r&&d.timestamp&&(d.ctimestamp=d.timestamp,delete d.timestamp),3!==e&&4!==e||(d.timestamp&&delete d.timestamp,d.ctimestamp&&delete d.ctimestamp,d.flowid&&delete d.flowid),d}}}},{key:"reportStep",value:function(e,t){if(e){var r=this.handleParams(e,t);if(r){var i=this.getBaseParam();for(var a in i.bid="10091006",i.step=e,r)i[a]=r[a];try{var o=new XMLHttpRequest;o.open("POST","//dp3.qq.com/stdlog"),o.responseType="text",o.timeout="8000",o.setRequestHeader("Content-type","text/plain"),o.send(JSON.stringify(i))}catch(s){n.log("dp3 reportStep:",s)}}}}},{key:"reportStepForVidoe",value:function(e,t){if(e){var r="//btrace.video.qq.com/kvcollect?BossId=5818&Pwd=1658255276&"+function(e){var t=[];for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];t.push(r+"="+encodeURIComponent(i))}return t.join("&")}(this.getBaseParam()),i=this.handleParams(e,t,"video");if(i){var n=a.appendParamsToUrl(r,i);n+="&step="+e+"&_dc="+Math.random(),this.report(n)}}}},{key:"report",value:function(e){e&&(this.sendReport(e.url||e),n.log("report:",e.url||e))}},{key:"sendReport",value:function(e,t){var r="GP_REPORT"+ +new Date+".r"+Math.floor(1e3*Math.random()),i=this[r]=new Image;i.onload=i.onerror=function(){t&&t(),delete this[r]},i.src=e}}]),e}()},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=r(0)("modules/adReportDp3"),a=r(2);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"init",value:function(e){this.config=e;e.orderList;this.setBaseStepUrl()}},{key:"setBaseStepUrl",value:function(){var e=this.getBaseParam();this.baseStepUrl="http://p.l.qq.com/?t=s"+function(e){var t=[];for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];t.push(r+"="+encodeURIComponent(i))}return t.join("&")}(e)}},{key:"getBaseParam",value:function(){return n.log("getBaseParam:",this.config),{}}},{key:"reportMind",value:function(e){var t={actid:e.actid,mid:e.orderId,oid:e.orderId,creative_id:e.creative_id,pf:e.pf,locid:e.locId},r=this.handleVers(e.extra);r&&(t.aver=r);var i=a.appendParamsToUrl(this.baseStepUrl,t);this.report(i)}},{key:"report",value:function(e){e&&(this.sendReport(e.url||e),n.log("report:",e.url||e))}},{key:"sendReport",value:function(e,t){var r="GP_REPORT"+ +new Date+".r"+Math.floor(1e3*Math.random()),i=this[r]=new Image;i.onload=i.onerror=function(){t&&t(),delete this[r]},i.src=e}},{key:"handleVers",value:function(e){e=e||{};var t="";for(var r in e){if(e.hasOwnProperty(r))t+=r+"{"+e[r]+"}"}return t}}]),e}()},function(e,t,r){"use strict";var i,n,a,o,s,d,l,u=r(38),c=r(52),h=Function.prototype.apply,f=Function.prototype.call,p=Object.create,v=Object.defineProperty,y=Object.defineProperties,g=Object.prototype.hasOwnProperty,m={configurable:!0,enumerable:!1,writable:!0};s={on:i=function(e,t){var r;return c(t),g.call(this,"__ee__")?r=this.__ee__:(r=m.value=p(null),v(this,"__ee__",m),m.value=null),r[e]?"object"==typeof r[e]?r[e].push(t):r[e]=[r[e],t]:r[e]=t,this},once:n=function(e,t){var r,n;return c(t),n=this,i.call(this,e,r=function(){a.call(n,e,r),h.call(t,this,arguments)}),r.__eeOnceListener__=t,this},off:a=function(e,t){var r,i,n,a;if(c(t),!g.call(this,"__ee__"))return this;if(!(r=this.__ee__)[e])return this;if("object"==typeof(i=r[e]))for(a=0;n=i[a];++a)n!==t&&n.__eeOnceListener__!==t||(2===i.length?r[e]=i[a?0:1]:i.splice(a,1));else i!==t&&i.__eeOnceListener__!==t||delete r[e];return this},emit:o=function(e){var t,r,i,n,a;if(g.call(this,"__ee__")&&(n=this.__ee__[e]))if("object"==typeof n){for(r=arguments.length,a=new Array(r-1),t=1;t<r;++t)a[t-1]=arguments[t];for(n=n.slice(),t=0;i=n[t];++t)h.call(i,this,a)}else switch(arguments.length){case 1:f.call(n,this);break;case 2:f.call(n,this,arguments[1]);break;case 3:f.call(n,this,arguments[1],arguments[2]);break;default:for(r=arguments.length,a=new Array(r-1),t=1;t<r;++t)a[t-1]=arguments[t];h.call(n,this,a)}}},d={on:u(i),once:u(n),off:u(a),emit:u(o)},l=y({},d),e.exports=t=function(e){return null==e?p(l):y(Object(e),d)},t.methods=s},function(e,t,r){"use strict";var i=r(39),n=r(47),a=r(48),o=r(49);(e.exports=function(e,t){var r,a,s,d,l;return arguments.length<2||"string"!=typeof e?(d=t,t=e,e=null):d=arguments[2],null==e?(r=s=!0,a=!1):(r=o.call(e,"c"),a=o.call(e,"e"),s=o.call(e,"w")),l={value:t,configurable:r,enumerable:a,writable:s},d?i(n(d),l):l}).gs=function(e,t,r){var s,d,l,u;return"string"!=typeof e?(l=r,r=t,t=e,e=null):l=arguments[3],null==t?t=undefined:a(t)?null==r?r=undefined:a(r)||(l=r,r=undefined):(l=t,t=r=undefined),null==e?(s=!0,d=!1):(s=o.call(e,"c"),d=o.call(e,"e")),u={get:t,set:r,configurable:s,enumerable:d},l?i(n(l),u):u}},function(e,t,r){"use strict";e.exports=r(40)()?Object.assign:r(41)},function(e,t,r){"use strict";e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},function(e,t,r){"use strict";var i=r(42),n=r(46),a=Math.max;e.exports=function(e,t){var r,o,s,d=a(arguments.length,2);for(e=Object(n(e)),s=function(i){try{e[i]=t[i]}catch(n){r||(r=n)}},o=1;o<d;++o)t=arguments[o],i(t).forEach(s);if(r!==undefined)throw r;return e}},function(e,t,r){"use strict";e.exports=r(43)()?Object.keys:r(44)},function(e,t,r){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},function(e,t,r){"use strict";var i=r(10),n=Object.keys;e.exports=function(e){return n(i(e)?Object(e):e)}},function(e,t,r){"use strict";e.exports=function(){}},function(e,t,r){"use strict";var i=r(10);e.exports=function(e){if(!i(e))throw new TypeError("Cannot use null or undefined");return e}},function(e,t,r){"use strict";var i=r(10),n=Array.prototype.forEach,a=Object.create;e.exports=function(e){var t=a(null);return n.call(arguments,function(e){i(e)&&function(e,t){var r;for(r in e)t[r]=e[r]}(Object(e),t)}),t}},function(e,t,r){"use strict";e.exports=function(e){return"function"==typeof e}},function(e,t,r){"use strict";e.exports=r(50)()?String.prototype.contains:r(51)},function(e,t,r){"use strict";var i="razdwatrzy";e.exports=function(){return"function"==typeof i.contains&&(!0===i.contains("dwa")&&!1===i.contains("foo"))}},function(e,t,r){"use strict";var i=String.prototype.indexOf;e.exports=function(e){return i.call(this,e,arguments[1])>-1}},function(e,t,r){"use strict";e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=r(54),a=r(57),o=r(0)("base/videoAdUi"),s=r(5),d=r(1);e.exports=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adplayer=t.adplayer,this.message=t.message,this.renderVideoAdCountdownLayer(t.conf),this.renderVideoAdLayer(t.conf),this.bindVideoAdLayerUiEvent(),this.renderInteractiveAdLayer(t.conf)}return i(e,[{key:"renderVideoAdCountdownLayer",value:function(e){if(e.playerDom.videoAdCountdownLayer){var t={countdown:"adplayer-enter-countdown",countdownNum:"adplayer-enter-countdown-num"};for(var r in e.playerDom.videoAdCountdownLayer.innerHTML=n(t),this.adplayer.$dom.$enterCountdown={},this.adplayer.$dom.$enterCountdown.layer=e.playerDom.videoAdCountdownLayer,t)t.hasOwnProperty(r)&&(this.adplayer.$dom.$enterCountdown["$"+r]=e.playerDom.videoAdCountdownLayer.querySelector('[data-role="'+t[r]+'"]'))}else o.log("\u6ca1\u6709\u627e\u5230\u8fdb\u5165\u5e7f\u544a\u5012\u8ba1\u65f6\u5bb9\u5668")}},{key:"renderVideoAdLayer",value:function(e){if(e.playerDom.videoAdLayer){var t={videoContainer:"adplayer-video-container",videoAdInner:"adplayer-video-inner",videoAdContainer:"adplayer-video-ad-container",videoRichMediaAdContainer:"adplayer-video-rich-media-ad-container",videoAdControl:"adplayer-video-ad-control",videoCountDown:"adplayer-video-countdown",videoCloseBtn:"adplayer-video-close-btn",videoSkipText:"adplayer-video-skip-text",videoNoSkipBtn:"adplayer-video-no-skip-btn",videoDetailBtn:"adplayer-video-detail-btn",videoDetailBtnText:"adplayer-video-detail-btn-text",videoLinkArea:"adplayer-video-link-area",videoVolumeBtn:"adplayer-video-volume-btn",videoNoSkipDialog:"adplayer-video-no-skip-dialog",videoNoSkipAuthor:"adplayer-video-no-skip-author",videoNoSkipKnowBtn:"adplayer-video-no-skip-know-btn",videoNoSkipCloseBtn:"adplayer-video-no-skip-close-btn",videoDspNameText:"adplayer-video-dsp-name-text",videoBlackScreen:"aplayer-video-black-screen"};for(var r in e.playerDom.videoAdLayer.innerHTML=a(t),this.adplayer.$dom.$videoAd={},this.adplayer.$dom.$videoAd.layer=e.playerDom.videoAdLayer,t)t.hasOwnProperty(r)&&(this.adplayer.$dom.$videoAd["$"+r]=e.playerDom.videoAdLayer.querySelector('[data-role="'+t[r]+'"]'));var i=this.adplayer.$dom,n=i.$videoAd;for(var s in this.$videoAd=i.$videoAd,n)n.hasOwnProperty(s)&&(this[s]=n[s])}else o.log("\u6ca1\u6709\u627e\u5230\u89c6\u9891\u7c7b\u5e7f\u544a\u5bb9\u5668")}},{key:"renderInteractiveAdLayer",value:function(e){e.playerDom.interactiveAdLayer?(this.adplayer.$dom.$interactiveAd={},this.adplayer.$dom.$interactiveAd.layer=e.playerDom.interactiveAdLayer,this.$interactiveAd=this.adplayer.$dom.$interactiveAd,this.$interactiveAd.layer&&s.show(this.$interactiveAd.layer)):o.log("\u6ca1\u6709\u627e\u5230\u4e92\u52a8\u5e7f\u544a\u5bb9\u5668")}},{key:"bindVideoAdLayerUiEvent",value:function(){var e=this;this.$videoAd&&(s.on(this.$videoSkipText,"click",function(t){e.message.emit(d.UI_EVENT.VIDEO_SKIP_TEXT,{target:t.target})}),s.on(this.$videoCloseBtn,"click",function(t){e.message.emit(d.UI_EVENT.VIDEO_CLOSE_BUTTON_CLICK,{target:t.target})}),s.on(this.$videoNoSkipBtn,"click",function(t){e.message.emit(d.UI_EVENT.VIDEO_NO_SKIP_BUTTON_CLICK,{target:t.target})}),s.on(this.$videoNoSkipCloseBtn,"click",function(t){e.message.emit(d.UI_EVENT.VIDEO_NO_SKIP_CLOSE_BUTTON_CLICK,{target:t.target})}),s.on(this.$videoNoSkipKnowBtn,"click",function(t){e.message.emit(d.UI_EVENT.VIDEO_NO_SKIP_KNOW_BUTTON_CLICK,{target:t.target})}),s.on(this.$videoLinkArea,"click",function(t){e.message.emit(d.UI_EVENT.VIDEO_LINK_AREA_CLICK,{target:t.target})}),s.on(this.$videoDetailBtn,"click",function(t){e.message.emit(d.UI_EVENT.VIDEO_DETAIL_BUTTON_CLICK,{target:t.target})}),s.on(this.$videoVolumeBtn,"click",function(t){e.message.emit(d.UI_EVENT.VIDEO_VOLUME_BUTTON_CLICK,{target:t.target})}))}},{key:"hideAll",value:function(){this.resetVideoUi(!0)}},{key:"resetVideoUi",value:function(e){var t=[this.$videoCountDown,this.$videoCloseBtn,this.$videoSkipText,this.$videoAdControl,this.$videoNoSkipBtn,this.$videoLinkArea,this.$videoDetailBtn,this.$videoNoSkipDialog,this.$videoNoSkipKnowBtn,this.$videoNoSkipCloseBtn];e&&(t=[this.$videoContainer,this.$videoAdContainer,this.$videoRichMediaAdContainer].concat(t)),t.forEach(function(e){s.hide(e)}),clearInterval(this.trueViewInterval),this.trueViewInterval=null}},{key:"updateVideoAdInner",value:function(e){e?s.show(this.$videoAdInner):s.hide(this.$videoAdInner)}},{key:"updateVideoLayer",value:function(e){e?s.show(this.$videoContainer):s.hide(this.$videoContainer)}},{key:"updateVideoAdControl",value:function(e){e?s.show(this.$videoAdControl):s.hide(this.$videoAdControl)}},{key:"adjustVideoAdControl",value:function(e){e&&(s.css(this.$videoAdControl,"top",e.top),s.css(this.$videoDetailBtn,"bottom",e.bottom))}},{key:"updateVideoAdLayer",value:function(e){e?s.show(this.$videoAdContainer):s.hide(this.$videoAdContainer)}},{key:"updateVideoRichMediaAdContainer",value:function(e){e?s.show(this.$videoRichMediaAdContainer):s.hide(this.$videoRichMediaAdContainer)}},{key:"updateVideoDSP",value:function(e){e?(s.text(this.$videoDspNameText,e),s.show(this.$videoDspNameText)):(s.text(this.$videoDspNameText,""),s.hide(this.$videoDspNameText))}},{key:"updateLinkArea",value:function(e){e?s.show(this.$videoLinkArea):s.hide(this.$videoLinkArea)}},{key:"showVideoForbidSkipAd",value:function(e){2==e?(s.text(this.$videoNoSkipAuthor,"\u5185\u5bb9\u65b9"),s.text(this.$videoSkipText,"\u5e94\u5185\u5bb9\u65b9\u8981\u6c42\uff0cVIP\u65e0\u6cd5\u514d\u8be5\u7247\u5e7f\u544a"),s.show(this.$videoSkipText),s.show(this.$videoNoSkipBtn)):1==e&&(s.text(this.$videoNoSkipAuthor,"\u7248\u6743\u65b9\uff08\u534e\u7eb3\uff09"),s.text(this.$videoSkipText,"\u5e94\u7248\u6743\u65b9\u8981\u6c42\uff0cVIP\u65e0\u6cd5\u514d\u8be5\u7247\u5e7f\u544a"),s.show(this.$videoSkipText),s.show(this.$videoNoSkipBtn)),s.show(this.$videoNoSkipCloseBtn),s.show(this.$videoNoSkipKnowBtn)}},{key:"toggleVideoCountDown",value:function(e){e?s.show(this.$videoCountDown):s.hide(this.$videoCountDown)}},{key:"updateVideoCountDown",value:function(e){s.html(this.$videoCountDown,e)}},{key:"updateVideoCountDownHtml",value:function(e){e+="<style>.txp_ad_countdown:after{display:none}</style>",s.html(this.$videoCountDown,e)}},{key:"updateCloseButton",value:function(e){var t=this.$videoCloseBtn,r=this.$videoSkipText;e.show?(s.show(t),s.show(r)):(s.hide(t),s.hide(r)),"undefined"!=typeof e.text&&s.text(r,e.text)}},{key:"updateDetail",value:function(e){e?(s.show(this.$videoDetailBtn),s.text(this.$videoDetailBtnText,"\u8be6\u60c5\u70b9\u51fb")):(s.hide(this.$videoDetailBtn),s.text(this.$videoDetailBtnText,""))}},{key:"updateSkipTips",value:function(e){var t="";e.showVipCommand?t="\u5173\u95ed\u63a8\u8350":e.showVipClick?t="VIP\u70b9\u51fb\u5173\u95ed\u5e7f\u544a":e.shortVideo?t="\u5173\u95ed\u5e7f\u544a":e.isTrueView||(t="VIP\u53ef\u5173\u95ed\u5e7f\u544a"),e.isTrueView?(this.updateCloseButton({show:!0}),s.text(this.$videoSkipText)||s.hide(this.$videoSkipText),s.hide(this.$videoCloseBtn)):this.updateCloseButton({show:e.showCloseButton&&!e.isTrueView,text:t})}},{key:"updateTrueview",value:function(e){var t=this;if(e.showCloseButton){var r=e.countdown;e.duration<=10?(s.text(this.$videoSkipText,"\u5173\u95ed\u5e7f\u544a"),s.show(this.$videoCloseBtn)):r>0?(s.html(this.$videoSkipText,"\u4f60\u53ef\u4ee5\u5728"+r+"\u79d2\u540e\u5173\u95ed\u5e7f\u544a"),s.hide(this.$videoCloseBtn),this.trueViewInterval=setInterval(function(){--r<=0?(clearInterval(t.trueViewInterval),t.trueViewInterval=null,s.text(t.$videoSkipText,"\u5173\u95ed\u5e7f\u544a"),s.show(t.$videoCloseBtn)):(s.html(t.$videoSkipText,"\u4f60\u53ef\u4ee5\u5728"+r+"\u79d2\u540e\u5173\u95ed\u5e7f\u544a"),s.hide(t.$videoCloseBtn))},1e3)):(s.text(this.$videoSkipText,"\u5173\u95ed\u5e7f\u544a"),s.show(this.$videoCloseBtn))}else s.hide(this.$videoSkipText)}},{key:"updateNoSkipDialog",value:function(e){e.show?s.show(this.$videoNoSkipDialog):s.hide(this.$videoNoSkipDialog)}},{key:"updateVideoVolumeBtn",value:function(e){TxpCreativePlayer.fromPcClient?s.show(this.$videoVolumeBtn):s.hide(this.$videoVolumeBtn),e.mute?s.addClass(this.$videoVolumeBtn,"txp_btn_ad_mute"):s.removeClass(this.$videoVolumeBtn,"txp_btn_ad_mute")}}]),e}()},function(e,t,r){var i=r(22);e.exports=function(e){"use strict";e=e||{};var t="",r=i.$escape,n=e.countdown,a=e.countdownNum;return t+='<txpdiv class="txp_ad_control txp_none" data-role="',t+=r(n),t+='">\r\n    <txpdiv class="txp_ad_skip">\r\n        <txpdiv class="txp_ad_countdown" data-role="',t+=r(a),t+='"></txpdiv>\r\n        <txpdiv class="txp_ad_skip_text">\u8fdb\u5165\u5e7f\u544a</txpdiv>\r\n    </txpdiv>\r\n</txpdiv>'}},function(e,t,r){"use strict";(function(t){var i=r(56),n=Object.create(i?t:window),a=/["&'<>]/;n.$escape=function(e){return function(e){var t=""+e,r=a.exec(t);if(!r)return e;var i="",n=void 0,o=void 0,s=void 0;for(n=r.index,o=0;n<t.length;n++){switch(t.charCodeAt(n)){case 34:s="&#34;";break;case 38:s="&#38;";break;case 39:s="&#39;";break;case 60:s="&#60;";break;case 62:s="&#62;";break;default:continue}o!==n&&(i+=t.substring(o,n)),o=n+1,i+=s}return o!==n?i+t.substring(o,n):i}(function t(e){"string"!=typeof e&&(e=e===undefined||null===e?"":"function"==typeof e?t(e.call(e)):JSON.stringify(e));return e}(e))},n.$each=function(e,t){if(Array.isArray(e))for(var r=0,i=e.length;r<i;r++)t(e[r],r);else for(var n in e)t(e[n],n)},e.exports=n}).call(t,r(6))},function(e,t,r){(function(t){e.exports=!1;try{e.exports="[object process]"===Object.prototype.toString.call(t.process)}catch(r){}}).call(t,r(6))},function(e,t,r){var i=r(22);e.exports=function(e){"use strict";e=e||{};var t="",r=i.$escape,n=e.videoContainer,a=e.videoAdContainer,o=e.videoRichMediaAdContainer,s=e.videoBlackScreen,d=e.videoAdInner,l=e.videoLinkArea,u=e.videoDetailBtn,c=e.videoDetailBtnText,h=e.videoDspNameText,f=e.videoAdControl,p=e.videoCountDown,v=e.videoSkipText,y=e.videoCloseBtn,g=e.videoNoSkipBtn,m=e.videoVolumeBtn,E=e.videoNoSkipDialog,_=e.videoNoSkipAuthor,T=e.videoNoSkipKnowBtn,A=e.videoNoSkipCloseBtn;return t+='<style>\r\n    .txp_btn_ad_volume{\r\n        background: rgba(37, 37, 37, .7) url(https://ca.gtimg.com/adplugin/js/imgs/mutes.png) no-repeat;\r\n        height: 28px;\r\n        border: none;\r\n        border-radius: 14px;\r\n        width: 28px;\r\n        margin-left: 8px;\r\n        user-select: initial;\r\n        outline: none;\r\n    }\r\n    .txp_btn_ad_mute{\r\n        background-position-y: -28px;\r\n    }\r\n    /* adblock */\r\n    .txp_cac_black_screen {\r\n        position: absolute;\r\n        top: 0;\r\n        bottom: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        z-index: 1000;\r\n        background-color: #000;\r\n        text-align: center;\r\n        display: flex;\r\n        line-height: 1.5;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n    }\r\n    .txp_cac_black_screen .txp_cac_black_screen_title {\r\n        margin-bottom: 15px;\r\n        font-size: 16px;\r\n        color: #fff;\r\n        text-align: center;\r\n    }\r\n    .txp_cac_black_screen .txp_cac_black_screen_em {\r\n        display: inline;\r\n        color: #ff7000;\r\n    }\r\n    \r\n</style>\r\n<txpdiv data-role="',t+=r(n),t+='" class="txp_ad" style="width: 100%; height: 100%;">\r\n\r\n    \x3c!-- \u5e7f\u544a video \u6807\u7b7e\u5bb9\u5668--\x3e\r\n    <txpdiv data-role="',t+=r(a),t+='" style="width: 100%; height: 100%; position: relative;"></txpdiv>\r\n\r\n    \x3c!-- \u5e7f\u544a \u5bcc\u5a92\u4f53\u5bb9\u5668\u6807\u7b7e --\x3e\r\n    <txpdiv data-role="',t+=r(o),t+='" style="width: 100%; height: 100%;"></txpdiv>\r\n\r\n    <txp data-role="',t+=r(s),t+='" class="txp_cac_black_screen txp_none">\r\n        <txp class="txp_cac_black_screen_title">\u5e7f\u544a\u88ab\u62e6\u622a\u63d2\u4ef6\u8bef\u4f24\u5566\uff0c<txp class="txp_cac_black_screen_em">1</txp>\u79d2\u540e\u64ad\u653e</txp>\r\n        <txp>\u5173\u95ed\u62e6\u622a\u63d2\u4ef6\u6062\u590d\u6b63\u5e38</txp>\r\n    </txp>\r\n\r\n    \x3c!-- \u5185\u90e8\u533a\u57df --\x3e\r\n    <txpdiv data-role="',t+=r(d),t+='" class="txp_ad_inner txp_none">\r\n        \x3c!-- \u5e7f\u544a\u70b9\u51fb\u533a\u57df --\x3e\r\n        <a data-role="',t+=r(l),t+='" href="javascript:;" class="txp_ad_link"></a>\r\n\r\n        \x3c!-- \u8be6\u60c5\u70b9\u51fb --\x3e\r\n        <a data-role="',t+=r(u),t+='" class="txp_ad_more" href="javascript:;"><txpdiv data-role="',t+=r(c),t+='"></txpdiv><txpdiv class="txp_icon_arrow"></txpdiv></a>\r\n\r\n        \x3c!-- \u5e95\u90e8\u4ecb\u7ecd --\x3e\r\n        <txpdiv data-role="',t+=r(h),t+='" style="left:10px;bottom:10px;position:absolute;opacity:0.6;font-size:12px;text-shadow:2px 2px #000"></txpdiv>\r\n\r\n        \x3c!-- \u65e0\u6cd5\u8df3\u8fc7\u5e7f\u544a\u6309\u94ae --\x3e\r\n        <txpdiv class="txp_ad_control" data-role="',t+=r(f),t+='">\r\n            <txpdiv class="txp_ad_skip">\r\n                \x3c!-- \u5012\u8ba1\u65f6 --\x3e\r\n                <txpdiv data-role="',t+=r(p),t+='" class="txp_ad_countdown"></txpdiv>\r\n\r\n                \x3c!-- \u8df3\u8fc7\u5e7f\u544a\u6587\u6848\u6216\u8005\u8fdb\u5165\u5e7f\u544a\u6587\u6848 --\x3e\r\n                <txpdiv data-role="',t+=r(v),t+='" class="txp_ad_skip_text" style="cursor: pointer;"></txpdiv>\r\n\r\n                \x3c!-- \u5173\u95ed\u5e7f\u544a\u6309\u94ae --\x3e\r\n                <button data-role="',t+=r(y),t+='" class="txp_btn txp_btn_close"></button>\r\n\r\n                \x3c!-- \u65e0\u6cd5\u514d\u5e7f\u544a\u8bf4\u660e --\x3e\r\n                <button data-role="',t+=r(g),t+='" class="txp_btn txp_btn_hint" title="\u65e0\u6cd5\u8df3\u8fc7\u5e7f\u544a\u8bf4\u660e"></button>\r\n            </txpdiv>\r\n            <button data-role="',t+=r(m),t+='" class="txp_btn txp_btn_ad_volume txp_none" style="z-index: 10;position: relative;">\r\n            </button>\r\n        </txpdiv>\r\n\r\n        \x3c!-- \u65e0\u6cd5\u514d\u5e7f\u544a\u5f39\u7a97\u8bf4\u660e --\x3e\r\n        <txpdiv data-role="',t+=r(E),t+='" class="txp_ad_dialog txp_none">\r\n            <txpdiv class="txp_dialog_bd">\r\n                \u4e3a\u4e86\u7ed9\u817e\u8baf\u89c6\u9891\u7528\u6237\u63d0\u4f9b\u66f4\u591a\u4f18\u8d28\u7f8e\u5267\uff0c\u5e94<span data-role="',t+=r(_),t+='">\u7248\u6743\u65b9\uff08\u534e\u7eb3\uff09</span>\u8981\u6c42\uff0c\u597d\u83b1\u575e\u4f1a\u5458\u5728\u89c2\u770b\u534e\u7eb3\u7f8e\u5267\u65f6\u65e0\u6cd5\u8df3\u8fc7\u5e7f\u544a\uff08\u300a\u5438\u8840\u9b3c\u65e5\u8bb0\u300b\u300a\u7834\u4ea7\u59d0\u59b9\u300b\u300a\u65e0\u803b\u4e4b\u5f92\u300b\u7b49\uff09\u3002\u6211\u4eec\u4f1a\u4e3a\u4f1a\u5458\u7528\u6237\u7ee7\u7eed\u4e89\u53d6\u514d\u5e7f\u544a\u6743\u76ca\uff0c\u8bf7\u60a8\u8c05\u89e3\uff0c\u8c22\u8c22\uff01\r\n            </txpdiv>\r\n            <txpdiv data-role="',t+=r(T),t+='" class="txp_ad_btn">\u6211\u77e5\u9053\u4e86!</txpdiv>\r\n            <a class="txp_ad_fb" target="_blank" href="http://support.qq.com/write.shtml?fid=850">\u610f\u89c1\u53cd\u9988</a>\r\n            <button data-role="',t+=r(A),t+='" class="txp_btn txp_btn_close"></button>\r\n        </txpdiv>\r\n    </txpdiv>\r\n</txpdiv>'}},function(e,t,r){"use strict";var i="adController",n=[{k:"setConf",c:["confController"]},{k:"getConf",c:["confController"]},{k:"getOrdersByType",c:["orderController"]},{k:"getOrderDuration",c:["orderController"]},{k:"isOrderEmpty",c:["orderController"]},{k:"setPageWatchBuyData",c:["orderController"]},{k:"clearPageWatchBuyData",c:["orderController"]},{k:"preLoadAd",c:[i]},{k:"loadAd",c:[i]},{k:"playAd",c:[i]},{k:"pauseAd",c:[i]},{k:"stopAd",c:[i]},{k:"stopAllAd",c:[i]},{k:"readRfId",c:[i]},{k:"muteAd",c:[i]},{k:"unMuteAd",c:[i]},{k:"setAdVolume",c:[i]},{k:"resizeAd",c:[i]},{k:"adjustUI",c:[i]},{k:"hideAdBeforeResize",c:[i]},{k:"setAdFullscreen",c:[i]},{k:"setAdPosition",c:[i]},{k:"setAdSmallWindow",c:[i]},{k:"reportAd",c:[i]},{k:"seekStart",c:[i]}];e.exports={install:function(e){n.forEach(function(t){e.prototype[t.k]||(e.prototype[t.k]=function(){for(var e=0,r=t.c.length;e<r;e++)return this.controllers[t.c[e]][t.k].apply(this.controllers[t.c[e]],Array.prototype.slice.call(arguments))})})}}},function(e,t,r){"use strict";var i=r(60),n=r(71),a=r(72),o=r(73),s=r(2);e.exports={install:function(e){e.adClass={loadedCount:0,maxLoadedCount:3,nextPartUrl:"//vm.gtimg.cn/tencentvideo/txpv5/creative/plugins/nextpart",nextPartReady:!1,hasRequestNextPart:!1,make:function(){var e=Array.prototype.slice.call(arguments),t=e[0];e.shift();var r=this.factory;if(r[t]&&r[t].ready)return r[t].creater.apply(r[t].creater,e)},loadNextPart:function(){var t=this,r=e.version;this.loadedCount>0&&(r+="."+ +new Date),this.loadedCount++,!this.hasRequestNextPart&&this.loadedCount<=this.maxLoadedCount&&s.loadJs(s.appendParamsToUrl(this.nextPartUrl+"."+e.version+".js",{t:r}),function(e){e&&e.error?(t.hasRequestNextPart=!1,t.loadNextPart()):t.hasRequestNextPart=!0})},factory:{LoadingAd:{ready:!0,creater:function(e){return e._name="LoadingAd",new i(e)}},EmbedAd:{ready:!0,creater:function(e){return e._name="EmbedAd",new n(e)}},EndingAd:{ready:!0,creater:function(e){return e._name="EndingAd",new o(e)}},ZcAd:{ready:!0,creater:function(e){return e._name="ZcAd",new a(e)}}}}}}},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();r(0)("base/loadingAd");var n=r(17),a=r(1);e.exports=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.message.on(a.TXPLAYER_EVENT.AD_STOP,function(e){"LD"===e.adtype&&e.rfid&&e.isAllAdEnd&&r.saveRfId(e.rfid)}),r._name=e._name,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n),i(t,[{key:"saveRfId",value:function(e){if("undefined"!=typeof window.localStorage)try{window.localStorage["TxpCreativePlayer-rfid"]=e}catch(t){}}}]),t}()},function(e,t,r){"use strict";e.exports=function i(e,t,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e){for(var n in t=t||"",(r=r||{}).autoplay&&(e.autoplay=!0),e.preload="undefined"!=typeof r.preload&&r.preload,t&&(e.src=t),e.style.width="100%",e.style.height="100%",r.style)r.style.hasOwnProperty(n)&&(e.style[n]=r.style[n]);this.video=e}}},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();r(0)("AdViewMonitor");var n=r(8).Promise,a=r(2);e.exports=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&(this.api={url:"//ra.gtimg.com/web/viewability/viewabilityalone.js",startMonitor:null},this.target=t)}return i(e,[{key:"initApi",value:function(){var e=this;return new n(function(t,r){a.loadJs(e.api.url,function(i){i?r():crystalViewModule&&crystalViewModule.startviewability?(e.api.startMonitor=crystalViewModule.startviewability,t()):r()})})}},{key:"getReportData",value:function(e){var t=[],r=e.reportUrlView;return r&&r.reportitem&&r.reportitem.length>0?(r.reportitem.forEach(function(e){e&&e.url&&t.push(e.url)}),{objectID:[this.target],reportItemUrl:t,oid:e.orderId,duration:1e3*e.duration,retry:0}):null}},{key:"start",value:function(e){var t=this,r=this.getReportData(e);r&&(this.api.startMonitor?this.api.startMonitor(r):this.initApi().then(function(){t.api.startMonitor(r)}))}}]),e}()},function(e,t,r){"use strict";var i=r(64),n=Object.prototype.hasOwnProperty;e.exports=function(e){var t,r=arguments[1];if(i(e),r===undefined)n.call(e,"__ee__")&&delete e.__ee__;else{if(!(t=n.call(e,"__ee__")&&e.__ee__))return;t[r]&&delete t[r]}}},function(e,t,r){"use strict";var i=r(65);e.exports=function(e){if(!i(e))throw new TypeError(e+" is not an Object");return e}},function(e,t,r){"use strict";var i=r(10),n={"function":!0,object:!0};e.exports=function(e){return i(e)&&n[typeof e]||!1}},function(e,t,r){"use strict";e.exports={EMPTY:0,PRELOADING:1,PLAYING:2,END:3,ERROR:4}},function(e,t,r){var i;i=function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=10)}([function(e,t,r){"use strict";r.d(t,"a",function(){return u}),r.d(t,"b",function(){return c});var i=r(4),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(){}var o={trace:a,debug:a,log:a,warn:a,info:a,error:a},s=o;var d=Object(i.a)();function l(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];r.forEach(function(t){s[t]=e[t]?e[t].bind(e):function(e){var t=d.console[e];return t?function(){for(var r=arguments.length,i=Array(r),n=0;n<r;n++)i[n]=arguments[n];i[0]&&(i[0]=function(e,t){return t="["+e+"] > "+t}(e,i[0])),t.apply(d.console,i)}:a}(t)})}var u=function(e){if(!0===e||"object"===(void 0===e?"undefined":n(e))){l(e,"debug","log","info","warn","error");try{s.log()}catch(t){s=o}}else s=o},c=s},function(e,t,r){"use strict";t.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return n});var i={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},n={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},function(e,t){e.exports=void 0},function(e,t,r){"use strict";t.a=function(){return"undefined"==typeof window?self:window}},function(e,t,r){var i,n,a,o,s;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,n=/^([^\/;?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var i=this.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");return i.path=s.normalizePath(i.path),s.buildURLFromParts(i)}var a=this.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return r.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=this.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var d=n.exec(o.path);o.netLoc=d[1],o.path=d[2]}o.netLoc&&!o.path&&(o.path="/");var l={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(l.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var u=o.path,c=u.substring(0,u.lastIndexOf("/")+1)+a.path;l.path=s.normalizePath(c)}else l.path=o.path,a.params||(l.params=o.params,a.query||(l.query=o.query));return null===l.path&&(l.path=r.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(l)},parseURL:function(e){var t=i.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(o,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||undefined}function i(e){return"function"==typeof e}function n(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=undefined,r.prototype._maxListeners=undefined,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,o,s,d,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(a(r=this._events[e]))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(n(r))for(s=Array.prototype.slice.call(arguments,1),o=(l=r.slice()).length,d=0;d<o;d++)l[d].apply(this,s);return!0},r.prototype.addListener=function(e,t){var o;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?n(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,n(this._events[e])&&!this._events[e].warned&&(o=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var r=!1;function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var r,a,o,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(r=this._events[e]).length,a=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(n(r)){for(s=o;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){a=s;break}if(a<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(a,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,r){"use strict";var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,r){for(var i=r,n=0;e.isHeader(t,r);){n+=10,n+=e._readSize(t,r+6),e.isFooter(t,r+10)&&(n+=10),r+=n}return n>0?t.subarray(i,i+n):undefined},e._readSize=function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]},e.getTimeStamp=function(t){for(var r=e.getID3Frames(t),i=0;i<r.length;i++){var n=r[i];if(e.isTimeStampFrame(n))return e._readTimeStamp(n)}return undefined},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),i=e._readSize(t,4);return{type:r,size:i,data:t.subarray(10,10+i)}},e.getID3Frames=function(t){for(var r=0,i=[];e.isHeader(t,r);){for(var n=e._readSize(t,r+6),a=(r+=10)+n;r+8<a;){var o=e._getFrameData(t.subarray(r)),s=e._decodeFrame(o);s&&i.push(s),r+=o.size+10}e.isFooter(t,r)&&(r+=10)}return i},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):undefined},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,r&&(i+=47721858.84),Math.round(i)}return undefined},e._decodePrivFrame=function(t){if(t.size<2)return undefined;var r=e._utf8ArrayToStr(t.data,!0),i=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:i.buffer}},e._decodeTextFrame=function(t){if(t.size<2)return undefined;if("TXXX"===t.type){var r=1,i=e._utf8ArrayToStr(t.data.subarray(r));r+=i.length+1;var n=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:i,data:n}}var a=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:a}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return undefined;var r=1,i=e._utf8ArrayToStr(t.data.subarray(r));r+=i.length+1;var n=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:i,data:n}}var a=e._utf8ArrayToStr(t.data);return{key:t.type,data:a}},e._utf8ArrayToStr=function(e){for(var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1],r=e.length,i=void 0,n=void 0,a=void 0,o="",s=0;s<r;){if(0===(i=e[s++])&&t)return o;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(i);break;case 12:case 13:n=e[s++],o+=String.fromCharCode((31&i)<<6|63&n);break;case 14:n=e[s++],a=e[s++],o+=String.fromCharCode((15&i)<<12|(63&n)<<6|(63&a)<<0)}}return o},e}();i._utf8ArrayToStr;t.a=i},function(e,t,r){"use strict";var i=r(0),n=r(1);var a=Math.pow(2,32)-1,o=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.remuxer=r}return e.prototype.resetTimeStamp=function(e){this.initPTS=e},e.prototype.resetInitSegment=function(t,r,i,a){if(t&&t.byteLength){var o=this.initData=e.parseInitSegment(t);null==r&&(r="mp4a.40.5"),null==i&&(i="avc1.42e01e");var s={};o.audio&&o.video?s.audiovideo={container:"video/mp4",codec:r+","+i,initSegment:a?t:null}:(o.audio&&(s.audio={container:"audio/mp4",codec:r,initSegment:a?t:null}),o.video&&(s.video={container:"video/mp4",codec:i,initSegment:a?t:null})),this.observer.trigger(n.a.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else r&&(this.audioCodec=r),i&&(this.videoCodec=i)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<8|e[t+1];return r<0?65536+r:r},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r},e.writeUint32=function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},e.findBox=function(t,r){var i=[],n=void 0,a=void 0,o=void 0,s=void 0,d=void 0,l=void 0,u=void 0;if(t.data?(l=t.start,s=t.end,t=t.data):(l=0,s=t.byteLength),!r.length)return null;for(n=l;n<s;)a=e.readUint32(t,n),o=e.bin2str(t.subarray(n+4,n+8)),u=a>1?n+a:s,o===r[0]&&(1===r.length?i.push({data:t,start:n+8,end:u}):(d=e.findBox({data:t,start:n+8,end:u},r.slice(1))).length&&(i=i.concat(d))),n=u;return i},e.parseSegmentIndex=function(t){var r=e.findBox(t,["moov"])[0],i=r?r.end:null,n=0,a=e.findBox(t,["sidx"]),o=void 0;if(!a||!a[0])return null;o=[];var s=(a=a[0]).data[0];n=0===s?8:16;var d=e.readUint32(a,n);n+=4;n+=0===s?8:16,n+=2;var l=a.end+0,u=e.readUint16(a,n);n+=2;for(var c=0;c<u;c++){var h=n,f=e.readUint32(a,h);h+=4;var p=2147483647&f;if(1===(2147483648&f)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var v=e.readUint32(a,h);h+=4,o.push({referenceSize:p,subsegmentDuration:v,info:{duration:v/d,start:l,end:l+p-1}}),l+=p,n=h+=4}return{earliestPresentationTime:0,timescale:d,version:s,referencesCount:u,references:o,moovEndOffset:i}},e.parseInitSegment=function(t){var r=[];return e.findBox(t,["moov","trak"]).forEach(function(t){var n=e.findBox(t,["tkhd"])[0];if(n){var a=n.data[n.start],o=0===a?12:20,s=e.readUint32(n,o),d=e.findBox(t,["mdia","mdhd"])[0];if(d){o=0===(a=d.data[d.start])?12:20;var l=e.readUint32(d,o),u=e.findBox(t,["mdia","hdlr"])[0];if(u){var c={soun:"audio",vide:"video"}[e.bin2str(u.data.subarray(u.start+8,u.start+12))];if(c){var h=e.findBox(t,["mdia","minf","stbl","stsd"]);if(h.length){h=h[0];var f=e.bin2str(h.data.subarray(h.start+12,h.start+16));i.b.log("MP4Demuxer:"+c+":"+f+" found")}r[s]={timescale:l,type:c},r[c]={timescale:l,id:s}}}}}}),r},e.getStartDTS=function(t,r){var i,n,a=void 0;return a=e.findBox(r,["moof","traf"]),i=[].concat.apply([],a.map(function(r){return e.findBox(r,["tfhd"]).map(function(i){var n,a;return n=e.readUint32(i,4),a=t[n].timescale||9e4,e.findBox(r,["tfdt"]).map(function(t){var r,i=void 0;return r=t.data[t.start],i=e.readUint32(t,4),1===r&&(i*=Math.pow(2,32),i+=e.readUint32(t,8)),i})[0]/a})})),n=Math.min.apply(null,i),isFinite(n)?n:0},e.offsetStartDTS=function(t,r,i){e.findBox(r,["moof","traf"]).map(function(r){return e.findBox(r,["tfhd"]).map(function(n){var o=e.readUint32(n,4),s=t[o].timescale||9e4;e.findBox(r,["tfdt"]).map(function(t){var r=t.data[t.start],n=e.readUint32(t,4);if(0===r)e.writeUint32(t,4,n-i*s);else{n*=Math.pow(2,32),n+=e.readUint32(t,8),n-=i*s,n=Math.max(n,0);var o=Math.floor(n/(a+1)),d=Math.floor(n%(a+1));e.writeUint32(t,4,o),e.writeUint32(t,8,d)}})})})},e.prototype.append=function(t,r,i,a){var o=this.initData;o||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),o=this.initData);var s,d=this.initPTS;if(d===undefined){var l=e.getStartDTS(o,t);this.initPTS=d=l-r,this.observer.trigger(n.a.INIT_PTS_FOUND,{initPTS:d})}e.offsetStartDTS(o,t,d),s=e.getStartDTS(o,t),this.remuxer.remux(o.audio,o.video,null,null,s,i,a,t)},e.prototype.destroy=function(){},e}();t.a=o},function(e,t,r){"use strict";var i=r(1),n=r(2);var a=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.subtle=t,this.aesIV=r}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}();var o=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.subtle=t,this.key=r}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}();var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return e.prototype.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),i=0;i<4;i++)r[i]=t.getUint32(4*i);return r},e.prototype.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,i=r[0],n=r[1],a=r[2],o=r[3],s=this.invSubMix,d=s[0],l=s[1],u=s[2],c=s[3],h=new Uint32Array(256),f=0,p=0,v=0;for(v=0;v<256;v++)h[v]=v<128?v<<1:v<<1^283;for(v=0;v<256;v++){var y=p^p<<1^p<<2^p<<3^p<<4;y=y>>>8^255&y^99,e[f]=y,t[y]=f;var g=h[f],m=h[g],E=h[m],_=257*h[y]^16843008*y;i[f]=_<<24|_>>>8,n[f]=_<<16|_>>>16,a[f]=_<<8|_>>>24,o[f]=_,_=16843009*E^65537*m^257*g^16843008*f,d[y]=_<<24|_>>>8,l[y]=_<<16|_>>>16,u[y]=_<<8|_>>>24,c[y]=_,f?(f=g^h[h[h[E^g]]],p^=h[h[p]]):f=p=1}},e.prototype.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,i=0;i<t.length&&r;)r=t[i]===this.key[i],i++;if(!r){this.key=t;var n=this.keySize=t.length;if(4!==n&&6!==n&&8!==n)throw new Error("Invalid aes key size="+n);var a=this.ksRows=4*(n+6+1),o=void 0,s=void 0,d=this.keySchedule=new Uint32Array(a),l=this.invKeySchedule=new Uint32Array(a),u=this.sBox,c=this.rcon,h=this.invSubMix,f=h[0],p=h[1],v=h[2],y=h[3],g=void 0,m=void 0;for(o=0;o<a;o++)o<n?g=d[o]=t[o]:(m=g,o%n==0?(m=u[(m=m<<8|m>>>24)>>>24]<<24|u[m>>>16&255]<<16|u[m>>>8&255]<<8|u[255&m],m^=c[o/n|0]<<24):n>6&&o%n==4&&(m=u[m>>>24]<<24|u[m>>>16&255]<<16|u[m>>>8&255]<<8|u[255&m]),d[o]=g=(d[o-n]^m)>>>0);for(s=0;s<a;s++)o=a-s,m=3&s?d[o]:d[o-4],l[s]=s<4||o<=4?m:f[u[m>>>24]]^p[u[m>>>16&255]]^v[u[m>>>8&255]]^y[u[255&m]],l[s]=l[s]>>>0}},e.prototype.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},e.prototype.decrypt=function(e,t,r,i){for(var n,a,o,s=this.keySize+6,d=this.invKeySchedule,l=this.invSBox,u=this.invSubMix,c=u[0],h=u[1],f=u[2],p=u[3],v=this.uint8ArrayToUint32Array_(r),y=v[0],g=v[1],m=v[2],E=v[3],_=new Int32Array(e),T=new Int32Array(_.length),A=void 0,b=void 0,w=void 0,S=void 0,R=void 0,D=void 0,L=void 0,C=void 0,x=void 0,I=void 0,k=void 0,P=void 0,O=void 0,N=void 0,M=this.networkToHostOrderSwap;t<_.length;){for(x=M(_[t]),I=M(_[t+1]),k=M(_[t+2]),P=M(_[t+3]),R=x^d[0],D=P^d[1],L=k^d[2],C=I^d[3],O=4,N=1;N<s;N++)A=c[R>>>24]^h[D>>16&255]^f[L>>8&255]^p[255&C]^d[O],b=c[D>>>24]^h[L>>16&255]^f[C>>8&255]^p[255&R]^d[O+1],w=c[L>>>24]^h[C>>16&255]^f[R>>8&255]^p[255&D]^d[O+2],S=c[C>>>24]^h[R>>16&255]^f[D>>8&255]^p[255&L]^d[O+3],R=A,D=b,L=w,C=S,O+=4;A=l[R>>>24]<<24^l[D>>16&255]<<16^l[L>>8&255]<<8^l[255&C]^d[O],b=l[D>>>24]<<24^l[L>>16&255]<<16^l[C>>8&255]<<8^l[255&R]^d[O+1],w=l[L>>>24]<<24^l[C>>16&255]<<16^l[R>>8&255]<<8^l[255&D]^d[O+2],S=l[C>>>24]<<24^l[R>>16&255]<<16^l[D>>8&255]<<8^l[255&L]^d[O+3],O+=3,T[t]=M(A^y),T[t+1]=M(S^g),T[t+2]=M(w^m),T[t+3]=M(b^E),y=x,g=I,m=k,E=P,t+=4}return i?(n=T.buffer,a=n.byteLength,(o=a&&new DataView(n).getUint8(a-1))?n.slice(0,a-o):n):T.buffer},e.prototype.destroy=function(){this.key=undefined,this.keySize=undefined,this.ksRows=undefined,this.sBox=undefined,this.invSBox=undefined,this.subMix=undefined,this.invSubMix=undefined,this.keySchedule=undefined,this.invKeySchedule=undefined,this.rcon=undefined},e}(),d=r(0),l=r(4);var u=Object(l.a)(),c=function(){function e(t,r){var i=(arguments.length>2&&arguments[2]!==undefined?arguments[2]:{}).removePKCS7Padding,n=i===undefined||i;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logEnabled=!0,this.observer=t,this.config=r,this.removePKCS7Padding=n,n)try{var a=u.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(o){}this.disableWebCrypto=!this.subtle}return e.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},e.prototype.decrypt=function(e,t,r,i){var n=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(d.b.log("JS AES decrypt"),this.logEnabled=!1);var l=this.decryptor;l||(this.decryptor=l=new s),l.expandKey(t),i(l.decrypt(e,0,r,this.removePKCS7Padding))}else{this.logEnabled&&(d.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var u=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new o(u,t)),this.fastAesKey.expandKey().then(function(o){new a(u,r).decrypt(e,o)["catch"](function(a){n.onWebCryptoError(a,e,t,r,i)}).then(function(e){i(e)})})["catch"](function(a){n.onWebCryptoError(a,e,t,r,i)})}},e.prototype.onWebCryptoError=function(e,t,r,a,o){this.config.enableSoftwareAES?(d.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,a,o)):(d.b.error("decrypting error : "+e.message),this.observer.trigger(i.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},e.prototype.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=undefined)},e}();function h(e,t){return 255===e[t]&&240==(246&e[t+1])}function f(e,t){return 1&e[t+1]?7:9}function p(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function v(e,t){return!!(t+1<e.length&&h(e,t))}function y(e,t){if(t+1<e.length&&h(e,t)){var r=f(e,t);t+5<e.length&&(r=p(e,t));var i=t+r;if(i===e.length||i+1<e.length&&h(e,i))return!0}return!1}function g(e,t,r,a,o){if(!e.samplerate){var s=function(e,t,r,a){var o,s=void 0,l=void 0,u=void 0,c=void 0,h=navigator.userAgent.toLowerCase(),f=a,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(s=1+((192&t[r+2])>>>6),!((o=(60&t[r+2])>>>2)>p.length-1))return u=(1&t[r+2])<<2,u|=(192&t[r+3])>>>6,d.b.log("manifest codec:"+a+",ADTS data:type:"+s+",sampleingIndex:"+o+"["+p[o]+"Hz],channelConfig:"+u),/firefox/i.test(h)?o>=6?(s=5,c=new Array(4),l=o-3):(s=2,c=new Array(2),l=o):-1!==h.indexOf("android")?(s=2,c=new Array(2),l=o):(s=5,c=new Array(4),a&&(-1!==a.indexOf("mp4a.40.29")||-1!==a.indexOf("mp4a.40.5"))||!a&&o>=6?l=o-3:((a&&-1!==a.indexOf("mp4a.40.2")&&(o>=6&&1===u||/vivaldi/i.test(h))||!a&&1===u)&&(s=2,c=new Array(2)),l=o)),c[0]=s<<3,c[0]|=(14&o)>>1,c[1]|=(1&o)<<7,c[1]|=u<<3,5===s&&(c[1]|=(14&l)>>1,c[2]=(1&l)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:p[o],channelCount:u,codec:"mp4a.40."+s,manifestCodec:f};e.trigger(i.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+o})}(t,r,a,o);e.config=s.config,e.samplerate=s.samplerate,e.channelCount=s.channelCount,e.codec=s.codec,e.manifestCodec=s.manifestCodec,d.b.log("parsed codec:"+e.codec+",rate:"+s.samplerate+",nb channel:"+s.channelCount)}}function m(e){return 9216e4/e}function E(e,t,r,i,n){var a=function(e,t,r,i,n){var a,o=void 0,s=e.length;return a=f(e,t),o=p(e,t),(o-=a)>0&&t+a+o<=s?{headerLength:a,frameLength:o,stamp:r+i*n}:undefined}(t,r,i,n,m(e.samplerate));if(a){var o=a.stamp,s=a.headerLength,d=a.frameLength,l={unit:t.subarray(r+s,r+s+d),pts:o,dts:o};return e.samples.push(l),e.len+=d,{sample:l,length:d+s}}return undefined}var _=r(7);var T=function(){function e(t,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=i,this.remuxer=r}return e.prototype.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},e.prototype.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(_.a.getID3Data(e,0)||[]).length,r=e.length;t<r;t++)if(y(e,t))return d.b.log("ADTS sync word found !"),!0;return!1},e.prototype.append=function(e,t,r,i){for(var n=this._audioTrack,a=_.a.getID3Data(e,0)||[],o=_.a.getTimeStamp(a),s=o?90*o:9e4*t,l=0,u=s,c=e.length,h=a.length,f=[{pts:u,dts:u,data:a}];h<c-1;)if(v(e,h)&&h+5<c){g(n,this.observer,e,h,n.manifestCodec);var p=E(n,e,h,s,l);if(!p){d.b.log("Unable to parse AAC frame");break}h+=p.length,u=p.sample.pts,l++}else _.a.isHeader(e,h)?(a=_.a.getID3Data(e,h),f.push({pts:u,dts:u,data:a}),h+=a.length):h++;this.remuxer.remux(n,{samples:[]},{samples:f,inputTimeScale:9e4},{samples:[]},t,r,i)},e.prototype.destroy=function(){},e}(),A=r(8),b={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,r,i,n){if(r+24>t.length)return undefined;var a=this.parseHeader(t,r);if(a&&r+a.frameLength<=t.length){var o=i+n*(9e4*a.samplesPerFrame/a.sampleRate),s={unit:t.subarray(r,r+a.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(s),e.len+=a.frameLength,{sample:s,length:a.frameLength}}return undefined},parseHeader:function(e,t){var r=e[t+1]>>3&3,i=e[t+1]>>1&3,n=e[t+2]>>4&15,a=e[t+2]>>2&3,o=e[t+2]>>1&1;if(1!==r&&0!==n&&15!==n&&3!==a){var s=3===r?3-i:3===i?3:4,d=1e3*b.BitratesMap[14*s+n-1],l=3===r?0:2===r?1:2,u=b.SamplingRateMap[3*l+a],c=e[t+3]>>6==3?1:2,h=b.SamplesCoefficients[r][i],f=b.BytesInSlot[i],p=8*h*f;return{sampleRate:u,channelCount:c,frameLength:parseInt(h*d/u+o,10)*f,samplesPerFrame:p}}return undefined},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),i=4;r&&r.frameLength&&(i=r.frameLength);var n=t+i;if(n===e.length||n+1<e.length&&this.isHeaderPattern(e,n))return!0}return!1}},w=b;var S=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return e.prototype.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,i=new Uint8Array(4),n=Math.min(4,t);if(0===n)throw new Error("no bytes available");i.set(e.subarray(r,r+n)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n},e.prototype.skipBits=function(e){var t=void 0;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},e.prototype.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return e>32&&d.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r},e.prototype.skipLZ=function(){var e=void 0;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},e.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},e.prototype.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},e.prototype.readBoolean=function(){return 1===this.readBits(1)},e.prototype.readUByte=function(){return this.readBits(8)},e.prototype.readUShort=function(){return this.readBits(16)},e.prototype.readUInt=function(){return this.readBits(32)},e.prototype.skipScalingList=function(e){var t=8,r=8,i=void 0;for(i=0;i<e;i++)0!==r&&(r=(t+this.readEG()+256)%256),t=0===r?t:r},e.prototype.readSPS=function(){var e,t,r,i,n=0,a=0,o=0,s=0,d=void 0,l=void 0,u=void 0,c=this.readUByte.bind(this),h=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),v=this.skipBits.bind(this),y=this.skipEG.bind(this),g=this.skipUEG.bind(this),m=this.skipScalingList.bind(this);if(c(),e=c(),h(5),v(3),c(),g(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var E=f();if(3===E&&v(1),g(),g(),v(1),p())for(l=3!==E?8:12,u=0;u<l;u++)p()&&m(u<6?16:64)}g();var _=f();if(0===_)f();else if(1===_)for(v(1),y(),y(),d=f(),u=0;u<d;u++)y();g(),v(1),t=f(),r=f(),0===(i=h(1))&&v(1),v(1),p()&&(n=f(),a=f(),o=f(),s=f());var T=[1,1];if(p()&&p())switch(c()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[c()<<8|c(),c()<<8|c()]}return{width:Math.ceil(16*(t+1)-2*n-2*a),height:(2-i)*(r+1)*16-(i?2:4)*(o+s),pixelRatio:T}},e.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}();var R=function(){function e(t,r,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.decryptdata=i,this.discardEPB=n,this.decrypter=new c(t,r,{removePKCS7Padding:!1})}return e.prototype.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},e.prototype.decryptAacSample=function(e,t,r,i){var n=e[t].unit,a=n.subarray(16,n.length-n.length%16),o=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),s=this;this.decryptBuffer(o,function(a){a=new Uint8Array(a),n.set(a,16),i||s.decryptAacSamples(e,t+1,r)})},e.prototype.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var i=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,i),!i)return}}},e.prototype.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),i=0,n=32;n<=e.length-16;n+=160,i+=16)r.set(e.subarray(n,n+16),i);return r},e.prototype.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var r=0,i=32;i<=e.length-16;i+=160,r+=16)e.set(t.subarray(r,r+16),i);return e},e.prototype.decryptAvcSample=function(e,t,r,i,n,a){var o=this.discardEPB(n.data),s=this.getAvcEncryptedData(o),d=this;this.decryptBuffer(s.buffer,function(s){n.data=d.getAvcDecryptedUnit(o,s),a||d.decryptAvcSamples(e,t,r+1,i)})},e.prototype.decryptAvcSamples=function(e,t,r,i){for(;;t++,r=0){if(t>=e.length)return void i();for(var n=e[t].units;!(r>=n.length);r++){var a=n[r];if(!(a.length<=48||1!==a.type&&5!==a.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,i,a,o),!o)return}}}},e}();var D={video:1,audio:2,id3:3,text:4},L=function(){function e(t,r,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=i,this.typeSupported=n,this.remuxer=r,this.sampleAes=null}return e.prototype.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new R(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var r=e._syncOffset(t);return!(r<0)&&(r&&d.b.warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?"),!0)},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),r=0;r<t;){if(71===e[r]&&71===e[r+188]&&71===e[r+376])return r;r++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":undefined,type:e,id:D[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===e?0:undefined,isAAC:"audio"===e||undefined,duration:"audio"===e?t:undefined}},e.prototype.resetInitSegment=function(t,r,i,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video",n),this._audioTrack=e.createTrack("audio",n),this._id3Track=e.createTrack("id3",n),this._txtTrack=e.createTrack("text",n),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=r,this.videoCodec=i,this._duration=n},e.prototype.resetTimeStamp=function(){},e.prototype.append=function(t,r,a,o){var s=void 0,l=t.length,u=void 0,c=void 0,h=void 0,f=void 0,p=!1;this.contiguous=a;var v=this.pmtParsed,y=this._avcTrack,g=this._audioTrack,m=this._id3Track,E=y.pid,_=g.pid,T=m.pid,A=this._pmtId,b=y.pesData,w=g.pesData,S=m.pesData,R=this._parsePAT,D=this._parsePMT,L=this._parsePES,C=this._parseAVCPES.bind(this),x=this._parseAACPES.bind(this),I=this._parseMPEGPES.bind(this),k=this._parseID3PES.bind(this),P=e._syncOffset(t);for(l-=(l+P)%188,s=P;s<l;s+=188)if(71===t[s]){if(u=!!(64&t[s+1]),c=((31&t[s+1])<<8)+t[s+2],(48&t[s+3])>>4>1){if((h=s+5+t[s+4])===s+188)continue}else h=s+4;switch(c){case E:u&&(b&&(f=L(b))&&f.pts!==undefined&&C(f,!1),b={data:[],size:0}),b&&(b.data.push(t.subarray(h,s+188)),b.size+=s+188-h);break;case _:u&&(w&&(f=L(w))&&f.pts!==undefined&&(g.isAAC?x(f):I(f)),w={data:[],size:0}),w&&(w.data.push(t.subarray(h,s+188)),w.size+=s+188-h);break;case T:u&&(S&&(f=L(S))&&f.pts!==undefined&&k(f),S={data:[],size:0}),S&&(S.data.push(t.subarray(h,s+188)),S.size+=s+188-h);break;case 0:u&&(h+=t[h]+1),A=this._pmtId=R(t,h);break;case A:u&&(h+=t[h]+1);var O=D(t,h,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(E=O.avc)>0&&(y.pid=E),(_=O.audio)>0&&(g.pid=_,g.isAAC=O.isAAC),(T=O.id3)>0&&(m.pid=T),p&&!v&&(d.b.log("reparse from beginning"),p=!1,s=P-188),v=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(i.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});b&&(f=L(b))&&f.pts!==undefined?(C(f,!0),y.pesData=null):y.pesData=b,w&&(f=L(w))&&f.pts!==undefined?(g.isAAC?x(f):I(f),g.pesData=null):(w&&w.size&&d.b.log("last AAC PES packet truncated,might overlap between fragments"),g.pesData=w),S&&(f=L(S))&&f.pts!==undefined?(k(f),m.pesData=null):m.pesData=S,null==this.sampleAes?this.remuxer.remux(g,y,m,this._txtTrack,r,a,o):this.decryptAndRemux(g,y,m,this._txtTrack,r,a,o)},e.prototype.decryptAndRemux=function(e,t,r,i,n,a,o){if(e.samples&&e.isAAC){var s=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){s.decryptAndRemuxAvc(e,t,r,i,n,a,o)})}else this.decryptAndRemuxAvc(e,t,r,i,n,a,o)},e.prototype.decryptAndRemuxAvc=function(e,t,r,i,n,a,o){if(t.samples){var s=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){s.remuxer.remux(e,t,r,i,n,a,o)})}else this.remuxer.remux(e,t,r,i,n,a,o)},e.prototype.destroy=function(){this._initPTS=this._initDTS=undefined,this._duration=0},e.prototype._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},e.prototype._parsePMT=function(e,t,r,i){var n,a=void 0,o={audio:-1,avc:-1,id3:-1,isAAC:!0};for(n=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<n;){switch(a=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!i){d.b.log("unkown stream type:"+e[t]);break}case 15:-1===o.audio&&(o.audio=a);break;case 21:-1===o.id3&&(o.id3=a);break;case 219:if(!i){d.b.log("unkown stream type:"+e[t]);break}case 27:-1===o.avc&&(o.avc=a);break;case 3:case 4:r?-1===o.audio&&(o.audio=a,o.isAAC=!1):d.b.log("MPEG audio found, not supported in this browser for now");break;case 36:d.b.warn("HEVC stream type found, not supported for now");break;default:d.b.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return o},e.prototype._parsePES=function(e){var t=0,r=void 0,i=void 0,n=void 0,a=void 0,o=void 0,s=void 0,l=void 0,u=void 0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&c.length>1;){var h=new Uint8Array(c[0].length+c[1].length);h.set(c[0]),h.set(c[1],c[0].length),c[0]=h,c.splice(1,1)}if(1===((r=c[0])[0]<<16)+(r[1]<<8)+r[2]){if((n=(r[4]<<8)+r[5])&&n>e.size-6)return null;192&(i=r[7])&&((s=536870912*(14&r[9])+4194304*(255&r[10])+16384*(254&r[11])+128*(255&r[12])+(254&r[13])/2)>4294967295&&(s-=8589934592),64&i?((l=536870912*(14&r[14])+4194304*(255&r[15])+16384*(254&r[16])+128*(255&r[17])+(254&r[18])/2)>4294967295&&(l-=8589934592),s-l>54e5&&(d.b.warn(Math.round((s-l)/9e4)+"s delta between PTS and DTS, align them"),s=l)):l=s),u=(a=r[8])+9,e.size-=u,o=new Uint8Array(e.size);for(var f=0,p=c.length;f<p;f++){var v=(r=c[f]).byteLength;if(u){if(u>v){u-=v;continue}r=r.subarray(u),v-=u,u=0}o.set(r,t),t+=v}return n&&(n-=a+3),{data:o,pts:s,dts:l,len:n}}return null},e.prototype.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var r=t.samples,i=r.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(i||this.contiguous)?(e.id=i,r.push(e)):t.dropped++}e.debug.length&&d.b.log(e.pts+"/"+e.dts+":"+e.debug)},e.prototype._parseAVCPES=function(e,t){var r=this,i=this._avcTrack,n=this._parseAVCNALu(e.data),a=void 0,o=this.avcSample,s=void 0,d=!1,l=void 0,u=this.pushAccesUnit.bind(this),c=function(e,t,r,i){return{key:e,pts:t,dts:r,units:[],debug:i}};e.data=null,o&&n.length&&!i.audFound&&(u(o,i),o=this.avcSample=c(!1,e.pts,e.dts,"")),n.forEach(function(t){switch(t.type){case 1:s=!0,o||(o=r.avcSample=c(!0,e.pts,e.dts,"")),o.frame=!0;var n=t.data;if(d&&n.length>4){var h=new S(n).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(o.key=!0)}break;case 5:s=!0,o||(o=r.avcSample=c(!0,e.pts,e.dts,"")),o.key=!0,o.frame=!0;break;case 6:s=!0,(a=new S(r.discardEPB(t.data))).readUByte();for(var f=0,p=0,v=!1,y=0;!v&&a.bytesAvailable>1;){f=0;do{f+=y=a.readUByte()}while(255===y);p=0;do{p+=y=a.readUByte()}while(255===y);if(4===f&&0!==a.bytesAvailable){if(v=!0,181===a.readUByte())if(49===a.readUShort())if(1195456820===a.readUInt())if(3===a.readUByte()){var g=a.readUByte(),m=31&g,E=[g,a.readUByte()];for(l=0;l<m;l++)E.push(a.readUByte()),E.push(a.readUByte()),E.push(a.readUByte());r._insertSampleInOrder(r._txtTrack.samples,{type:3,pts:e.pts,bytes:E})}}else if(p<a.bytesAvailable)for(l=0;l<p;l++)a.readUByte()}break;case 7:if(s=!0,d=!0,!i.sps){var _=(a=new S(t.data)).readSPS();i.width=_.width,i.height=_.height,i.pixelRatio=_.pixelRatio,i.sps=[t.data],i.duration=r._duration;var T=t.data.subarray(1,4),A="avc1.";for(l=0;l<3;l++){var b=T[l].toString(16);b.length<2&&(b="0"+b),A+=b}i.codec=A}break;case 8:s=!0,i.pps||(i.pps=[t.data]);break;case 9:s=!1,i.audFound=!0,o&&u(o,i),o=r.avcSample=c(!1,e.pts,e.dts,"");break;case 12:s=!1;break;default:s=!1,o&&(o.debug+="unknown NAL "+t.type+" ")}o&&s&&o.units.push(t)}),t&&o&&(u(o,i),this.avcSample=null)},e.prototype._insertSampleInOrder=function(e,t){var r=e.length;if(r>0){if(t.pts>=e[r-1].pts)e.push(t);else for(var i=r-1;i>=0;i--)if(t.pts<e[i].pts){e.splice(i,0,t);break}}else e.push(t)},e.prototype._getLastNalUnit=function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.length){var r=this._avcTrack.samples;e=r[r.length-1]}if(e){var i=e.units;t=i[i.length-1]}return t},e.prototype._parseAVCNALu=function(e){var t=0,r=e.byteLength,i=void 0,n=void 0,a=this._avcTrack,o=a.naluState||0,s=o,d=[],l=void 0,u=-1,c=void 0;for(-1===o&&(u=0,c=31&e[0],o=0,t=1);t<r;)if(i=e[t++],o)if(1!==o)if(i)if(1===i){if(u>=0)l={data:e.subarray(u,t-o-1),type:c},d.push(l);else{var h=this._getLastNalUnit();if(h&&(s&&t<=4-s&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-s)),(n=t-o-1)>0)){var f=new Uint8Array(h.data.byteLength+n);f.set(h.data,0),f.set(e.subarray(0,n),h.data.byteLength),h.data=f}}t<r?(u=t,c=31&e[t],o=0):o=-1}else o=0;else o=3;else o=i?0:2;else o=i?0:1;if(u>=0&&o>=0&&(l={data:e.subarray(u,r),type:c,state:o},d.push(l)),0===d.length){var p=this._getLastNalUnit();if(p){var v=new Uint8Array(p.data.byteLength+e.byteLength);v.set(p.data,0),v.set(e,p.data.byteLength),p.data=v}}return a.naluState=o,d},e.prototype.discardEPB=function(e){for(var t,r=e.byteLength,i=[],n=1,a=void 0;n<r-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(i.push(n+2),n+=2):n++;if(0===i.length)return e;t=r-i.length,a=new Uint8Array(t);var o=0;for(n=0;n<t;o++,n++)o===i[0]&&(o++,i.shift()),a[n]=e[o];return a},e.prototype._parseAACPES=function(e){var t,r,a=this._audioTrack,o=e.data,s=e.pts,l=this.aacOverFlow,u=this.aacLastPTS,c=void 0,h=void 0,f=void 0;if(l){var p=new Uint8Array(l.byteLength+o.byteLength);p.set(l,0),p.set(o,l.byteLength),o=p}for(h=0,r=o.length;h<r-1&&!v(o,h);h++);if(h){var y=void 0,_=void 0;if(h<r-1?(y="AAC PES did not start with ADTS header,offset:"+h,_=!1):(y="no ADTS header found in AAC PES",_=!0),d.b.warn("parsing error:"+y),this.observer.trigger(i.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:_,reason:y}),_)return}if(g(a,this.observer,o,h,this.audioCodec),c=0,t=m(a.samplerate),l&&u){var T=u+t;Math.abs(T-s)>1&&(d.b.log("AAC: align PTS for overlapping frames by "+Math.round((T-s)/90)),s=T)}for(;h<r;)if(v(o,h)&&h+5<r){var A=E(a,o,h,s,c);if(!A)break;h+=A.length,f=A.sample.pts,c++}else h++;l=h<r?o.subarray(h,r):null,this.aacOverFlow=l,this.aacLastPTS=f},e.prototype._parseMPEGPES=function(e){for(var t=e.data,r=t.length,i=0,n=0,a=e.pts;n<r;)if(w.isHeader(t,n)){var o=w.appendFrame(this._audioTrack,t,n,a,i);if(!o)break;n+=o.length,i++}else n++},e.prototype._parseID3PES=function(e){this._id3Track.samples.push(e)},e}();var C=function(){function e(t,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=i,this.remuxer=r}return e.prototype.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},e.prototype.resetTimeStamp=function(){},e.probe=function(e){var t=void 0,r=void 0,i=_.a.getID3Data(e,0);if(i&&_.a.getTimeStamp(i)!==undefined)for(t=i.length,r=Math.min(e.length-1,t+100);t<r;t++)if(w.probe(e,t))return d.b.log("MPEG Audio sync word found !"),!0;return!1},e.prototype.append=function(e,t,r,i){for(var n=_.a.getID3Data(e,0),a=_.a.getTimeStamp(n),o=a?90*a:9e4*t,s=n.length,d=e.length,l=0,u=0,c=this._audioTrack,h=[{pts:o,dts:o,data:n}];s<d;)if(w.isHeader(e,s)){var f=w.appendFrame(c,e,s,o,l);if(!f)break;s+=f.length,u=f.sample.pts,l++}else _.a.isHeader(e,s)?(n=_.a.getID3Data(e,s),h.push({pts:u,dts:u,data:n}),s+=n.length):s++;this.remuxer.remux(c,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,r,i)},e.prototype.destroy=function(){},e}();var x=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}();var I=Math.pow(2,32)-1,k=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.init=function(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t=void 0;for(t in e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:i};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,d,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,n))},e.box=function(e){for(var t=Array.prototype.slice.call(arguments,1),r=8,i=t.length,n=i,a=void 0;i--;)r+=t[i].byteLength;for((a=new Uint8Array(r))[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=255&r,a.set(e,4),i=0,r=8;i<n;i++)a.set(t[i],r),r+=t[i].byteLength;return a},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var i=Math.floor(r/(I+1)),n=Math.floor(r%(I+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,i){return e.box(e.types.moof,e.mfhd(t),e.traf(i,r))},e.moov=function(t){for(var r=t.length,i=[];r--;)i[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(i).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,i=[];r--;)i[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(i))},e.mvhd=function(t,r){r*=t;var i=Math.floor(r/(I+1)),n=Math.floor(r%(I+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,a)},e.sdtp=function(t){var r=t.samples||[],i=new Uint8Array(4+r.length),n=void 0,a=void 0;for(a=0;a<r.length;a++)n=r[a].flags,i[a+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e.box(e.types.sdtp,i)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var r=[],i=[],n=void 0,a=void 0,o=void 0;for(n=0;n<t.sps.length;n++)o=(a=t.sps[n]).byteLength,r.push(o>>>8&255),r.push(255&o),r=r.concat(Array.prototype.slice.call(a));for(n=0;n<t.pps.length;n++)o=(a=t.pps[n]).byteLength,i.push(o>>>8&255),i.push(255&o),i=i.concat(Array.prototype.slice.call(a));var s=e.box(e.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|t.sps.length].concat(r).concat([t.pps.length]).concat(i))),d=t.width,l=t.height,u=t.pixelRatio[0],c=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,255&d,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var r=t.id,i=t.duration*t.timescale,n=t.width,a=t.height,o=Math.floor(i/(I+1)),s=Math.floor(i%(I+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,a>>8&255,255&a,0,0]))},e.traf=function(t,r){var i=e.sdtp(t),n=t.id,a=Math.floor(r/(I+1)),o=Math.floor(r%(I+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,o>>24,o>>16&255,o>>8&255,255&o])),e.trun(t,i.length+16+20+8+16+8+8),i)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var i=t.samples||[],n=i.length,a=12+16*n,o=new Uint8Array(a),s=void 0,d=void 0,l=void 0,u=void 0,c=void 0,h=void 0;for(r+=8+a,o.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),s=0;s<n;s++)l=(d=i[s]).duration,u=d.size,c=d.flags,h=d.cts,o.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,u>>>24&255,u>>>16&255,u>>>8&255,255&u,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,61440&c.degradPrio,15&c.degradPrio,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*s);return e.box(e.types.trun,o)},e.initSegment=function(t){e.types||e.init();var r=e.moov(t),i=void 0;return(i=new Uint8Array(e.FTYP.byteLength+r.byteLength)).set(e.FTYP),i.set(r,e.FTYP.byteLength),i},e}();var P=function(){function e(t,r,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=r,this.typeSupported=i;var a=navigator.userAgent;this.isSafari=n&&n.indexOf("Apple")>-1&&a&&!a.match("CriOS"),this.ISGenerated=!1}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},e.prototype.resetInitSegment=function(){this.ISGenerated=!1},e.prototype.remux=function(e,t,r,n,a,o,s){if(this.ISGenerated||this.generateIS(e,t,a),this.ISGenerated){var l=e.samples.length,u=t.samples.length,c=a,h=a;if(l&&u){var f=(e.samples[0].dts-t.samples[0].dts)/t.inputTimeScale;c+=Math.max(0,f),h+=Math.max(0,-f)}if(l){e.timescale||(d.b.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,a));var p=this.remuxAudio(e,c,o,s);if(u){var v=void 0;p&&(v=p.endPTS-p.startPTS),t.timescale||(d.b.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,a)),this.remuxVideo(t,h,o,v,s)}}else if(u){var y=this.remuxVideo(t,h,o,0,s);y&&e.codec&&this.remuxEmptyAudio(e,c,o,y)}}r.samples.length&&this.remuxID3(r,a),n.samples.length&&this.remuxText(n,a),this.observer.trigger(i.a.FRAG_PARSED)},e.prototype.generateIS=function(e,t,r){var a=this.observer,o=e.samples,s=t.samples,l=this.typeSupported,u="audio/mp4",c={},h={tracks:c},f=this._initPTS===undefined,p=void 0,v=void 0;if(f&&(p=v=Infinity),e.config&&o.length&&(e.timescale=e.samplerate,d.b.log("audio sampling rate : "+e.samplerate),e.isAAC||(l.mpeg?(u="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3")),c.audio={container:u,codec:e.codec,initSegment:!e.isAAC&&l.mpeg?new Uint8Array:k.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(p=v=o[0].pts-e.inputTimeScale*r)),t.sps&&t.pps&&s.length){var y=t.inputTimeScale;t.timescale=y,c.video={container:"video/mp4",codec:t.codec,initSegment:k.initSegment([t]),metadata:{width:t.width,height:t.height}},f&&(p=Math.min(p,s[0].pts-y*r),v=Math.min(v,s[0].dts-y*r),this.observer.trigger(i.a.INIT_PTS_FOUND,{initPTS:p}))}Object.keys(c).length?(a.trigger(i.a.FRAG_PARSING_INIT_SEGMENT,h),this.ISGenerated=!0,f&&(this._initPTS=p,this._initDTS=v)):a.trigger(i.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},e.prototype.remuxVideo=function(e,t,r,a,o){var s,l,u,c=8,h=e.timescale,f=void 0,p=void 0,v=void 0,y=void 0,g=e.samples,m=[],E=g.length,_=this._PTSNormalize,T=this._initDTS,A=this.nextAvcDts,b=this.isSafari;if(0!==E){b&&(r|=g.length&&A&&(o&&Math.abs(t-A/h)<.1||Math.abs(g[0].pts-A-T)<h/5)),r||(A=t*h),g.forEach(function(e){e.pts=_(e.pts-T,A),e.dts=_(e.dts-T,A)}),g.sort(function(e,t){var r=e.dts-t.dts,i=e.pts-t.pts;return r||i||e.id-t.id});var w=g.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(w<0){d.b.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(w/90)+" ms to overcome this issue");for(var S=0;S<g.length;S++)g[S].dts+=w}var R=g[0];y=Math.max(R.dts,0),v=Math.max(R.pts,0);var D=Math.round((y-A)/90);r&&D&&(D>1?d.b.log("AVC:"+D+" ms hole between fragments detected,filling it"):D<-1&&d.b.log("AVC:"+-D+" ms overlapping between fragments detected"),y=A,g[0].dts=y,v=Math.max(v-D,A),g[0].pts=v,d.b.log("Video/PTS/DTS adjusted: "+Math.round(v/90)+"/"+Math.round(y/90)+",delta:"+D+" ms")),y,R=g[g.length-1],u=Math.max(R.dts,0),l=Math.max(R.pts,0,u),b&&(f=Math.round((u-y)/(g.length-1)));for(var L=0,C=0,x=0;x<E;x++){for(var I=g[x],P=I.units,O=P.length,N=0,M=0;M<O;M++)N+=P[M].data.length;C+=N,L+=O,I.length=N,I.dts=b?y+x*f:Math.max(I.dts,y),I.pts=Math.max(I.pts,I.dts)}var V=C+4*L+8;try{p=new Uint8Array(V)}catch(ie){return void this.observer.trigger(i.a.ERROR,{type:n.b.MUX_ERROR,details:n.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:V,reason:"fail allocating video mdat "+V})}var U=new DataView(p.buffer);U.setUint32(0,V),p.set(k.types.mdat,4);for(var F=0;F<E;F++){for(var B=g[F],G=B.units,j=0,K=void 0,$=0,H=G.length;$<H;$++){var W=G[$],Y=W.data,q=W.data.byteLength;U.setUint32(c,q),c+=4,p.set(Y,c),c+=q,j+=4+q}if(b)K=Math.max(0,f*Math.round((B.pts-B.dts)/f));else{if(F<E-1)f=g[F+1].dts-B.dts;else{var z=this.config,X=B.dts-g[F>0?F-1:F].dts;if(z.stretchShortVideoTrack){var Z=z.maxBufferHole,J=Math.floor(Z*h),Q=(a?v+a*h:this.nextAudioPts)-B.pts;Q>J?((f=Q-X)<0&&(f=X),d.b.log("It is approximately "+Q/90+" ms to the next segment; using duration "+f/90+" ms for the last video frame.")):f=X}else f=X}K=Math.round(B.pts-B.dts)}m.push({size:j,duration:f,cts:K,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:B.key?2:1,isNonSync:B.key?0:1}})}this.nextAvcDts=u+f;var ee=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,m.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var te=m[0].flags;te.dependsOn=2,te.isNonSync=0}e.samples=m,s=k.moof(e.sequenceNumber++,y,e),e.samples=[];var re={data1:s,data2:p,startPTS:v/h,endPTS:(l+f)/h,startDTS:y/h,endDTS:this.nextAvcDts/h,type:"video",hasAudio:!1,hasVideo:!0,nb:m.length,dropped:ee};return this.observer.trigger(i.a.FRAG_PARSING_DATA,re),re}},e.prototype.remuxAudio=function(e,t,r,a){var o=e.inputTimeScale,s=e.timescale,l=o/s,u=(e.isAAC?1024:1152)*l,c=this._PTSNormalize,h=this._initDTS,f=!e.isAAC&&this.typeSupported.mpeg,p=void 0,v=void 0,y=void 0,g=void 0,m=void 0,E=void 0,_=void 0,T=e.samples,A=[],b=this.nextAudioPts;if(r|=T.length&&b&&(a&&Math.abs(t-b/o)<.1||Math.abs(T[0].pts-b-h)<20*u),T.forEach(function(e){e.pts=e.dts=c(e.pts-h,t*o)}),0!==(T=T.filter(function(e){return e.pts>=0})).length){if(r||(b=a?t*o:T[0].pts),e.isAAC)for(var w=this.config.maxAudioFramesDrift,S=0,R=b;S<T.length;){var D,L=T[S];D=L.pts-R;var C=Math.abs(1e3*D/o);if(D<=-w*u)d.b.warn("Dropping 1 audio frame @ "+(R/o).toFixed(3)+"s due to "+Math.round(C)+" ms overlap."),T.splice(S,1),e.len-=L.unit.length;else if(D>=w*u&&C<1e4&&R){var I=Math.round(D/u);d.b.warn("Injecting "+I+" audio frame @ "+(R/o).toFixed(3)+"s due to "+Math.round(1e3*D/o)+" ms gap.");for(var P=0;P<I;P++){var O=Math.max(R,0);(y=x.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(d.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),y=L.unit.subarray()),T.splice(S,0,{unit:y,pts:O,dts:O}),e.len+=y.length,R+=u,S++}L.pts=L.dts=R,R+=u,S++}else Math.abs(D),L.pts=L.dts=R,R+=u,S++}for(var N=0,M=T.length;N<M;N++){var V=T[N],U=V.unit,F=V.pts;if(_!==undefined)v.duration=Math.round((F-_)/l);else{var B=Math.round(1e3*(F-b)/o),G=0;if(r&&e.isAAC&&B){if(B>0&&B<1e4)G=Math.round((F-b)/u),d.b.log(B+" ms hole between AAC samples detected,filling it"),G>0&&((y=x.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(y=U.subarray()),e.len+=G*y.length);else if(B<-12){d.b.log("drop overlapping AAC sample, expected/parsed/delta:"+(b/o).toFixed(3)+"s/"+(F/o).toFixed(3)+"s/"+-B+"ms"),e.len-=U.byteLength;continue}F=b}if(E=F,!(e.len>0))return;var j=f?e.len:e.len+8;p=f?0:8;try{g=new Uint8Array(j)}catch(X){return void this.observer.trigger(i.a.ERROR,{type:n.b.MUX_ERROR,details:n.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:j,reason:"fail allocating audio mdat "+j})}f||(new DataView(g.buffer).setUint32(0,j),g.set(k.types.mdat,4));for(var K=0;K<G;K++)(y=x.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(d.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),y=U.subarray()),g.set(y,p),p+=y.byteLength,v={size:y.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},A.push(v)}g.set(U,p);var $=U.byteLength;p+=$,v={size:$,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},A.push(v),_=F}var H=0,W=A.length;if(W>=2&&(H=A[W-2].duration,v.duration=H),W){this.nextAudioPts=b=_+l*H,e.len=0,e.samples=A,m=f?new Uint8Array:k.moof(e.sequenceNumber++,E/l,e),e.samples=[];var Y=E/o,q=b/o,z={data1:m,data2:g,startPTS:Y,endPTS:q,startDTS:Y,endDTS:q,type:"audio",hasAudio:!0,hasVideo:!1,nb:W};return this.observer.trigger(i.a.FRAG_PARSING_DATA,z),z}return null}},e.prototype.remuxEmptyAudio=function(e,t,r,i){var n=e.inputTimeScale,a=n/(e.samplerate?e.samplerate:n),o=this.nextAudioPts,s=(o!==undefined?o:i.startDTS*n)+this._initDTS,l=i.endDTS*n+this._initDTS,u=1024*a,c=Math.ceil((l-s)/u),h=x.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(d.b.warn("remux empty Audio"),h){for(var f=[],p=0;p<c;p++){var v=s+p*u;f.push({unit:h,pts:v,dts:v}),e.len+=h.length}e.samples=f,this.remuxAudio(e,t,r)}else d.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},e.prototype.remuxID3=function(e,t){var r=e.samples.length,n=void 0,a=e.inputTimeScale,o=this._initPTS,s=this._initDTS;if(r){for(var d=0;d<r;d++)(n=e.samples[d]).pts=(n.pts-o)/a,n.dts=(n.dts-s)/a;this.observer.trigger(i.a.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[],t=t},e.prototype.remuxText=function(e,t){e.samples.sort(function(e,t){return e.pts-t.pts});var r=e.samples.length,n=void 0,a=e.inputTimeScale,o=this._initPTS;if(r){for(var s=0;s<r;s++)(n=e.samples[s]).pts=(n.pts-o)/a;this.observer.trigger(i.a.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[],t=t},e.prototype._PTSNormalize=function(e,t){var r=void 0;if(t===undefined)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e},e}();var O=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(){},e.prototype.resetInitSegment=function(){},e.prototype.remux=function(e,t,r,n,a,o,s,d){var l=this.observer,u="";e&&(u+="audio"),t&&(u+="video"),l.trigger(i.a.FRAG_PARSING_DATA,{data1:d,startPTS:a,startDTS:a,type:u,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),l.trigger(i.a.FRAG_PARSED)},e}();var N=Object(l.a)(),M=function(){function e(t,r,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.typeSupported=r,this.config=i,this.vendor=n}return e.prototype.destroy=function(){var e=this.demuxer;e&&e.destroy()},e.prototype.push=function(e,t,r,n,a,o,s,d,l,u,h,f){if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var p=this.decrypter;null==p&&(p=this.decrypter=new c(this.observer,this.config));var v=this,y=void 0;try{y=N.now()}catch(g){y=Date.now()}p.decrypt(e,t.key.buffer,t.iv.buffer,function(e){var c=void 0;try{c=N.now()}catch(g){c=Date.now()}v.observer.trigger(i.a.FRAG_DECRYPTED,{stats:{tstart:y,tdecrypt:c}}),v.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,a,o,s,d,l,u,h,f)})}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,a,o,s,d,l,u,h,f)},e.prototype.pushDecrypted=function(e,t,r,a,o,s,d,l,u,c,h,f){var p=this.demuxer;if(!p||(d||l)&&!this.probe(e)){for(var v=this.observer,y=this.typeSupported,g=this.config,m=[{demux:L,remux:P},{demux:A.a,remux:O},{demux:T,remux:P},{demux:C,remux:P}],E=0,_=m.length;E<_;E++){var b=m[E],w=b.demux.probe;if(w(e)){var S=this.remuxer=new b.remux(v,g,y,this.vendor);p=new b.demux(v,S,g,y),this.probe=w;break}}if(!p)return void v.trigger(i.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=p}var R=this.remuxer;(d||l)&&(p.resetInitSegment(r,a,o,c),R.resetInitSegment()),d&&(p.resetTimeStamp(f),R.resetTimeStamp(f)),"function"==typeof p.setDecryptData&&p.setDecryptData(t),p.append(e,s,u,h)},e}();t.a=M},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(5),n=r.n(i),a=r(2),o=r(1),s=r(0),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var l=new Set(["hlsEventGeneric","hlsHandlerDestroying","hlsHandlerDestroyed"]),u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];this.handledEvents=i,this.useGenericHandler=!0,this.registerListeners()}return e.prototype.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},e.prototype.onHandlerDestroying=function(){},e.prototype.onHandlerDestroyed=function(){},e.prototype.isEventHandler=function(){return"object"===d(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent},e.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if(l.has(e))throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)},this)},e.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)},e.prototype.onEvent=function(e,t){this.onEventGeneric(e,t)},e.prototype.onEventGeneric=function(e,t){try{(function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)}).call(this,e,t).call()}catch(r){s.b.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),this.hls.trigger(o.a.ERROR,{type:a.b.OTHER_ERROR,details:a.a.INTERNAL_EXCEPTION,fatal:!1,event:e,err:r})}},e}(),c=r(8),h=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.method=null,this.key=null,this.iv=null,this._uri=null}return h(e,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=n.a.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),e}(),p=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var v=function(){function e(){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[],this._elementaryStreams=((t={})[e.ElementaryStreamTypes.AUDIO]=!1,t[e.ElementaryStreamTypes.VIDEO]=!1,t)}return e.prototype.addElementaryStream=function(e){this._elementaryStreams[e]=!0},e.prototype.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},e.prototype.createInitializationVector=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t},e.prototype.fragmentDecryptdataFromLevelkey=function(e,t){var r=e;return e&&e.method&&e.uri&&!e.iv&&((r=new f).method=e.method,r.baseuri=e.baseuri,r.reluri=e.reluri,r.iv=this.createInitializationVector(t)),r},p(e,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=n.a.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange&&!this.rawByteRange)return[];if(this._byteRange)return this._byteRange;var e=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var r=this.lastByteRangeEndOffset;e[0]=r||0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0],this._byteRange=e}return e}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}],[{key:"ElementaryStreamTypes",get:function(){return{AUDIO:"audio",VIDEO:"video"}}}]),e}();var y=/^(\d+)x(\d+)$/,g=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,m=function(){function e(t){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(r)&&(this[r]=t[r])}return e.prototype.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?Infinity:t},e.prototype.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null},e.prototype.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?Infinity:t},e.prototype.decimalFloatingPoint=function(e){return parseFloat(this[e])},e.prototype.enumeratedString=function(e){return this[e]},e.prototype.decimalResolution=function(e){var t=y.exec(this[e]);return null===t?undefined:{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t=void 0,r={};for(g.lastIndex=0;null!==(t=g.exec(e));){var i=t[2];0===i.indexOf('"')&&i.lastIndexOf('"')===i.length-1&&(i=i.slice(1,-1)),r[t[1]]=i}return r},e}(),E={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function _(e,t){return window.MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var T=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,A=/#EXT-X-MEDIA:(.*)/g,b=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),w=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,S=/\.(mp4|m4s|m4v|m4a)$/i,R=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.findGroup=function(e,t){if(!e)return null;for(var r=null,i=0;i<e.length;i++){var n=e[i];n.id===t&&(r=n)}return r},e.convertAVC1ToAVCOTI=function(e){var t=void 0,r=e.split(".");return r.length>2?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t},e.resolve=function(e,t){return n.a.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,r){var i=[],n=void 0;function a(e,t){["video","audio"].forEach(function(r){var i=e.filter(function(e){return function(e,t){var r=E[t];return!!r&&!0===r[e.slice(0,4)]}(e,r)});if(i.length){var n=i.filter(function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)});t[r+"Codec"]=n.length>0?n[0]:i[0],e=e.filter(function(e){return-1===i.indexOf(e)})}}),t.unknownCodecs=e}for(T.lastIndex=0;null!=(n=T.exec(t));){var o={},s=o.attrs=new m(n[1]);o.url=e.resolve(n[2],r);var d=s.decimalResolution("RESOLUTION");d&&(o.width=d.width,o.height=d.height),o.bitrate=s.decimalInteger("AVERAGE-BANDWIDTH")||s.decimalInteger("BANDWIDTH"),o.name=s.NAME,a([].concat((s.CODECS||"").split(/[ ,]+/)),o),o.videoCodec&&-1!==o.videoCodec.indexOf("avc1")&&(o.videoCodec=e.convertAVC1ToAVCOTI(o.videoCodec)),i.push(o)}return i},e.parseMasterPlaylistMedia=function(t,r,i){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:[],a=void 0,o=[],s=0;for(A.lastIndex=0;null!==(a=A.exec(t));){var d={},l=new m(a[1]);if(l.TYPE===i){if(d.groupId=l["GROUP-ID"],d.name=l.NAME,d.type=i,d["default"]="YES"===l.DEFAULT,d.autoselect="YES"===l.AUTOSELECT,d.forced="YES"===l.FORCED,l.URI&&(d.url=e.resolve(l.URI,r)),d.lang=l.LANGUAGE,d.name||(d.name=d.lang),n.length){var u=e.findGroup(n,d.groupId);d.audioCodec=u?u.codec:n[0].codec}d.id=s++,o.push(d)}}return o},e.parseLevelPlaylist=function(e,t,r,i,n){var a=0,o=0,d={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},l=new f,u=0,c=null,h=new v,p=void 0,y=void 0;for(b.lastIndex=0;null!==(p=b.exec(e));){var g=p[1];if(g){h.duration=parseFloat(g);var E=(" "+p[2]).slice(1);h.title=E||null,h.tagList.push(E?["INF",g,E]:["INF",g])}else if(p[3]){if(!isNaN(h.duration)){var _=a++;h.type=i,h.start=o,h.levelkey=l,h.sn=_,h.level=r,h.cc=u,h.urlId=n,h.baseurl=t,h.relurl=(" "+p[3]).slice(1),d.programDateTime&&(c?h.rawProgramDateTime?h.pdt=Date.parse(h.rawProgramDateTime):h.pdt=c.pdt+1e3*c.duration:h.pdt=Date.parse(d.programDateTime),h.endPdt=h.pdt+1e3*h.duration),d.fragments.push(h),c=h,o+=h.duration,h=new v}}else if(p[4]){if(h.rawByteRange=(" "+p[4]).slice(1),c){var T=c.byteRangeEndOffset;T&&(h.lastByteRangeEndOffset=T)}}else if(p[5])h.rawProgramDateTime=(" "+p[5]).slice(1),h.tagList.push(["PROGRAM-DATE-TIME",h.rawProgramDateTime]),d.programDateTime===undefined&&(d.programDateTime=new Date(new Date(Date.parse(p[5]))-1e3*o));else{for(p=p[0].match(w),y=1;y<p.length&&p[y]===undefined;y++);var A=(" "+p[y+1]).slice(1),R=(" "+p[y+2]).slice(1);switch(p[y]){case"#":h.tagList.push(R?[A,R]:[A]);break;case"PLAYLIST-TYPE":d.type=A.toUpperCase();break;case"MEDIA-SEQUENCE":a=d.startSN=parseInt(A);break;case"TARGETDURATION":d.targetduration=parseFloat(A);break;case"VERSION":d.version=parseInt(A);break;case"EXTM3U":break;case"ENDLIST":d.live=!1;break;case"DIS":u++,h.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":u=parseInt(A);break;case"KEY":var D=new m(A),L=D.enumeratedString("METHOD"),C=D.URI,x=D.hexadecimalInteger("IV");L&&(l=new f,C&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(L)>=0&&(l.method=L,l.baseuri=t,l.reluri=C,l.key=null,l.iv=x));break;case"START":var I=new m(A).decimalFloatingPoint("TIME-OFFSET");isNaN(I)||(d.startTimeOffset=I);break;case"MAP":var k=new m(A);h.relurl=k.URI,h.rawByteRange=k.BYTERANGE,h.baseurl=t,h.level=r,h.type=i,h.sn="initSegment",d.initSegment=h,h=new v;break;default:s.b.warn("line parsed but not handled: "+p)}}}return(h=c)&&!h.relurl&&(d.fragments.pop(),o-=h.duration),d.totalduration=o,d.averagetargetduration=o/d.fragments.length,d.endSN=a-1,d.startCC=d.fragments[0]?d.fragments[0].cc:0,d.endCC=u,!d.initSegment&&d.fragments.length&&d.fragments.every(function(e){return S.test(e.relurl)})&&(s.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(h=new v).relurl=d.fragments[0].relurl,h.baseurl=t,h.level=r,h.type=i,h.sn="initSegment",d.initSegment=h,d.needSidxRanges=!0),d},e}(),D=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var L=window.performance,C={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},x={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},I=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r,o.a.MANIFEST_LOADING,o.a.LEVEL_LOADING,o.a.AUDIO_TRACK_LOADING,o.a.SUBTITLE_TRACK_LOADING));return i.loaders={},i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.canHaveQualityLevels=function(e){return e!==C.AUDIO_TRACK&&e!==C.SUBTITLE_TRACK},t.mapContextToLevelType=function(e){switch(e.type){case C.AUDIO_TRACK:return x.AUDIO;case C.SUBTITLE_TRACK:return x.SUBTITLE;default:return x.MAIN}},t.getResponseUrl=function(e,t){var r=e.url;return r!==undefined&&0!==r.indexOf("data:")||(r=t.url),r},t.prototype.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,i=t.loader,n=new(r||i)(t);return e.loader=n,this.loaders[e.type]=n,n},t.prototype.getInternalLoader=function(e){return this.loaders[e.type]},t.prototype.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},t.prototype.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},t.prototype.destroy=function(){this.destroyInternalLoaders(),e.prototype.destroy.call(this)},t.prototype.onManifestLoading=function(e){e.m3u8||this.load(e.url,{type:C.MANIFEST,level:0,id:null})},t.prototype.onLevelLoading=function(e){this.load(e.url,{type:C.LEVEL,level:e.level,id:e.id})},t.prototype.onAudioTrackLoading=function(e){this.load(e.url,{type:C.AUDIO_TRACK,level:0,id:e.id})},t.prototype.onSubtitleTrackLoading=function(e){this.load(e.url,{type:C.SUBTITLE_TRACK,level:0,id:e.id})},t.prototype.load=function(e,t){var r=this.hls.config;s.b.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var i=this.getInternalLoader(t);if(i){var n=i.context;if(n&&n.url===e)return s.b.trace("playlist request ongoing"),!1;s.b.warn("aborting previous loader for type: "+t.type),i.abort()}var a=void 0,o=void 0,d=void 0,l=void 0;switch(t.type){case C.MANIFEST:a=r.manifestLoadingMaxRetry,o=r.manifestLoadingTimeOut,d=r.manifestLoadingRetryDelay,l=r.manifestLoadingMaxRetryTimeout;break;case C.LEVEL:a=0,o=r.levelLoadingTimeOut;break;default:a=r.levelLoadingMaxRetry,o=r.levelLoadingTimeOut,d=r.levelLoadingRetryDelay,l=r.levelLoadingMaxRetryTimeout}i=this.createInternalLoader(t),t.url=e,t.responseType=t.responseType||"";var u={timeout:o,maxRetry:a,retryDelay:d,maxRetryDelay:l},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return s.b.debug("Calling internal loader delegate for URL: "+e),i.load(t,u,c),!0},t.prototype.loadsuccess=function(e,t,r){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;if(r.isSidxRequest)return this._handleSidxRequest(e,r),void this._handlePlaylistLoaded(e,t,r,i);this.resetInternalLoader(r.type);var n=e.data;t.tload=L.now(),0===n.indexOf("#EXTM3U")?n.indexOf("#EXTINF:")>0||n.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,r,i):this._handleMasterPlaylist(e,t,r,i):this._handleManifestParsingError(e,r,"no EXTM3U delimiter",i)},t.prototype.loaderror=function(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;this._handleNetworkError(t,r)},t.prototype.loadtimeout=function(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;this._handleNetworkError(t,r,!0)},t.prototype._handleMasterPlaylist=function(e,r,i,n){var a=this.hls,d=e.data,l=t.getResponseUrl(e,i),u=R.parseMasterPlaylist(d,l);if(u.length){var c=u.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}),h=R.parseMasterPlaylistMedia(d,l,"AUDIO",c),f=R.parseMasterPlaylistMedia(d,l,"SUBTITLES");if(h.length){var p=!1;h.forEach(function(e){e.url||(p=!0)}),!1===p&&u[0].audioCodec&&!u[0].attrs.AUDIO&&(s.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main"}))}a.trigger(o.a.MANIFEST_LOADED,{levels:u,audioTracks:h,subtitles:f,url:l,stats:r,networkDetails:n})}else this._handleManifestParsingError(e,i,"no level found in manifest",n)},t.prototype._handleTrackOrLevelPlaylist=function(e,r,i,n){var a=this.hls,s=i.id,d=i.level,l=i.type,u=t.getResponseUrl(e,i),c=isNaN(s)?0:s,h=isNaN(d)?c:d,f=t.mapContextToLevelType(i),p=R.parseLevelPlaylist(e.data,u,h,f,c);if(p.tload=r.tload,l===C.MANIFEST){var v={url:u,details:p};a.trigger(o.a.MANIFEST_LOADED,{levels:[v],audioTracks:[],url:u,stats:r,networkDetails:n})}if(r.tparsed=L.now(),p.needSidxRanges){var y=p.initSegment.url;this.load(y,{isSidxRequest:!0,type:l,level:d,levelDetails:p,id:s,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else i.levelDetails=p,this._handlePlaylistLoaded(e,r,i,n)},t.prototype._handleSidxRequest=function(e,t){var r=c.a.parseSegmentIndex(new Uint8Array(e.data));r.references.forEach(function(e,r){var i=e.info,n=t.levelDetails.fragments[r];0===n.byteRange.length&&(n.rawByteRange=String(1+i.end-i.start)+"@"+String(i.start))}),t.levelDetails.initSegment.rawByteRange=String(r.moovEndOffset)+"@0"},t.prototype._handleManifestParsingError=function(e,t,r,i){this.hls.trigger(o.a.ERROR,{type:a.b.NETWORK_ERROR,details:a.a.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:r,networkDetails:i})},t.prototype._handleNetworkError=function(e,t){var r=arguments.length>2&&arguments[2]!==undefined&&arguments[2];s.b.info("A network error occured while loading a "+e.type+"-type playlist");var i=void 0,n=void 0,d=this.getInternalLoader(e);switch(e.type){case C.MANIFEST:i=r?a.a.MANIFEST_LOAD_TIMEOUT:a.a.MANIFEST_LOAD_ERROR,n=!0;break;case C.LEVEL:i=r?a.a.LEVEL_LOAD_TIMEOUT:a.a.LEVEL_LOAD_ERROR,n=!1;break;case C.AUDIO_TRACK:i=r?a.a.AUDIO_TRACK_LOAD_TIMEOUT:a.a.AUDIO_TRACK_LOAD_ERROR,n=!1;break;default:n=!1}d&&(d.abort(),this.resetInternalLoader(e.type)),this.hls.trigger(o.a.ERROR,{type:a.b.NETWORK_ERROR,details:i,fatal:n,url:d.url,loader:d,context:e,networkDetails:t})},t.prototype._handlePlaylistLoaded=function(e,r,i,n){var a=i.type,s=i.level,d=i.id,l=i.levelDetails;if(l.targetduration)if(t.canHaveQualityLevels(i.type))this.hls.trigger(o.a.LEVEL_LOADED,{details:l,level:s||0,id:d||0,stats:r,networkDetails:n});else switch(a){case C.AUDIO_TRACK:this.hls.trigger(o.a.AUDIO_TRACK_LOADED,{details:l,id:d,stats:r,networkDetails:n});break;case C.SUBTITLE_TRACK:this.hls.trigger(o.a.SUBTITLE_TRACK_LOADED,{details:l,id:d,stats:r,networkDetails:n})}else this._handleManifestParsingError(e,i,"invalid target duration",n)},D(t,null,[{key:"ContextType",get:function(){return C}},{key:"LevelType",get:function(){return x}}]),t}(u);var k=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r,o.a.FRAG_LOADING));return i.loaders={},i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){var t=this.loaders;for(var r in t){var i=t[r];i&&i.destroy()}this.loaders={},e.prototype.destroy.call(this)},t.prototype.onFragLoading=function(e){var t=e.frag,r=t.type,i=this.loaders,n=this.hls.config,a=n.fLoader,o=n.loader;t.loaded=0;var d=i[r];d&&(s.b.warn("abort previous fragment loader for type: "+r),d.abort()),d=i[r]=t.loader=n.fLoader?new a(n):new o(n);var l,u,c=void 0;c={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var h=t.byteRangeStartOffset,f=t.byteRangeEndOffset;isNaN(h)||isNaN(f)||(c.rangeStart=h,c.rangeEnd=f),l={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},d.load(c,l,u)},t.prototype.loadsuccess=function(e,t,r){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null,n=e.data,a=r.frag;a.loader=undefined,this.loaders[a.type]=undefined,this.hls.trigger(o.a.FRAG_LOADED,{payload:n,frag:a,stats:t,networkDetails:i})},t.prototype.loaderror=function(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,i=t.loader;i&&i.abort(),this.loaders[t.type]=undefined,this.hls.trigger(o.a.ERROR,{type:a.b.NETWORK_ERROR,details:a.a.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})},t.prototype.loadtimeout=function(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,i=t.loader;i&&i.abort(),this.loaders[t.type]=undefined,this.hls.trigger(o.a.ERROR,{type:a.b.NETWORK_ERROR,details:a.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})},t.prototype.loadprogress=function(e,t,r){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null,n=t.frag;n.loaded=e.loaded,this.hls.trigger(o.a.FRAG_LOAD_PROGRESS,{frag:n,stats:e,networkDetails:i})},t}(u);var P=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r,o.a.KEY_LOADING));return i.loaders={},i.decryptkey=null,i.decrypturl=null,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},u.prototype.destroy.call(this)},t.prototype.onKeyLoading=function(e){var t=e.frag,r=t.type,i=this.loaders[r],n=t.decryptdata,a=n.uri;if(a!==this.decrypturl||null===this.decryptkey){var d=this.hls.config;i&&(s.b.warn("abort previous key loader for type:"+r),i.abort()),t.loader=this.loaders[r]=new d.loader(d),this.decrypturl=a,this.decryptkey=null;var l,u,c;l={url:a,frag:t,responseType:"arraybuffer"},u={timeout:d.fragLoadingTimeOut,maxRetry:d.fragLoadingMaxRetry,retryDelay:d.fragLoadingRetryDelay,maxRetryDelay:d.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(l,u,c)}else this.decryptkey&&(n.key=this.decryptkey,this.hls.trigger(o.a.KEY_LOADED,{frag:t}))},t.prototype.loadsuccess=function(e,t,r){var i=r.frag;this.decryptkey=i.decryptdata.key=new Uint8Array(e.data),i.loader=undefined,this.loaders[i.type]=undefined,this.hls.trigger(o.a.KEY_LOADED,{frag:i})},t.prototype.loaderror=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),this.loaders[t.type]=undefined,this.hls.trigger(o.a.ERROR,{type:a.b.NETWORK_ERROR,details:a.a.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})},t.prototype.loadtimeout=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),this.loaders[t.type]=undefined,this.hls.trigger(o.a.ERROR,{type:a.b.NETWORK_ERROR,details:a.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},t}(u);var O="NOT_LOADED",N="APPENDING",M="PARTIAL",V="OK",U=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r,o.a.BUFFER_APPENDED,o.a.FRAG_BUFFERED,o.a.FRAG_LOADED));return i.bufferPadding=.2,i.fragments=Object.create(null),i.timeRanges=Object.create(null),i.config=r.config,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){this.fragments=null,this.timeRanges=null,this.config=null,u.prototype.destroy.call(this),e.prototype.destroy.call(this)},t.prototype.getBufferedFrag=function(e,t){var r=this.fragments,i=Object.keys(r).filter(function(i){var n=r[i];if(n.body.type!==t)return!1;if(!n.buffered)return!1;var a=n.body;return a.startPTS<=e&&e<=a.endPTS});if(0===i.length)return null;var n=i.pop();return r[n].body},t.prototype.detectEvictedFragments=function(e,t){var r=this,i=void 0,n=void 0;Object.keys(this.fragments).forEach(function(a){var o=r.fragments[a];if(!0===o.buffered){var s=o.range[e];if(s){i=s.time;for(var d=0;d<i.length;d++)if(n=i[d],!1===r.isTimeBuffered(n.startPTS,n.endPTS,t)){r.removeFragment(o.body);break}}}})},t.prototype.detectPartialFragments=function(e){var t=this,r=this.getFragmentKey(e),i=this.fragments[r];i&&(i.buffered=!0,Object.keys(this.timeRanges).forEach(function(r){if(!0===e.hasElementaryStream(r)){var n=t.timeRanges[r];i.range[r]=t.getBufferedTimes(e.startPTS,e.endPTS,n)}}))},t.prototype.getBufferedTimes=function(e,t,r){for(var i=[],n=void 0,a=void 0,o=!1,s=0;s<r.length;s++){if(n=r.start(s)-this.bufferPadding,a=r.end(s)+this.bufferPadding,e>=n&&t<=a){i.push({startPTS:Math.max(e,r.start(s)),endPTS:Math.min(t,r.end(s))});break}if(e<a&&t>n)i.push({startPTS:Math.max(e,r.start(s)),endPTS:Math.min(t,r.end(s))}),o=!0;else if(t<=n)break}return{time:i,partial:o}},t.prototype.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},t.prototype.getPartialFragment=function(e){var t=this,r=void 0,i=void 0,n=void 0,a=null,o=0;return Object.keys(this.fragments).forEach(function(s){var d=t.fragments[s];t.isPartial(d)&&(i=d.body.startPTS-t.bufferPadding,n=d.body.endPTS+t.bufferPadding,e>=i&&e<=n&&(r=Math.min(e-i,n-e),o<=r&&(a=d.body,o=r)))}),a},t.prototype.getState=function(e){var t=this.getFragmentKey(e),r=this.fragments[t],i=O;return r!==undefined&&(i=r.buffered?!0===this.isPartial(r)?M:V:N),i},t.prototype.isPartial=function(e){return!0===e.buffered&&(e.range.video!==undefined&&!0===e.range.video.partial||e.range.audio!==undefined&&!0===e.range.audio.partial)},t.prototype.isTimeBuffered=function(e,t,r){for(var i=void 0,n=void 0,a=0;a<r.length;a++){if(i=r.start(a)-this.bufferPadding,n=r.end(a)+this.bufferPadding,e>=i&&t<=n)return!0;if(t<=i)return!1}return!1},t.prototype.onFragLoaded=function(e){var t=e.frag;if(!isNaN(t.sn)&&!t.bitrateTest){var r=this.getFragmentKey(t),i={body:t,range:Object.create(null),buffered:!1};this.fragments[r]=i}},t.prototype.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach(function(e){var r=t.timeRanges[e];t.detectEvictedFragments(e,r)})},t.prototype.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},t.prototype.hasFragment=function(e){var t=this.getFragmentKey(e);return this.fragments[t]!==undefined},t.prototype.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},t.prototype.removeAllFragments=function(){this.fragments=Object.create(null)},t}(u),F={search:function(e,t){for(var r=0,i=e.length-1,n=null,a=null;r<=i;){var o=t(a=e[n=(r+i)/2|0]);if(o>0)r=n+1;else{if(!(o<0))return a;i=n-1}}return null}};var B=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.isBuffered=function(e,t){try{if(e)for(var r=e.buffered,i=0;i<r.length;i++)if(t>=r.start(i)&&t<=r.end(i))return!0}catch(n){}return!1},e.bufferInfo=function(e,t,r){try{if(e){var i=e.buffered,n=[],a=void 0;for(a=0;a<i.length;a++)n.push({start:i.start(a),end:i.end(a)});return this.bufferedInfo(n,t,r)}}catch(o){}return{len:0,start:t,end:t,nextStart:undefined}},e.bufferedInfo=function(e,t,r){var i=[],n=void 0,a=void 0,o=void 0,s=void 0,d=void 0;for(e.sort(function(e,t){var r=e.start-t.start;return r||t.end-e.end}),d=0;d<e.length;d++){var l=i.length;if(l){var u=i[l-1].end;e[d].start-u<r?e[d].end>u&&(i[l-1].end=e[d].end):i.push(e[d])}else i.push(e[d])}for(d=0,n=0,a=o=t;d<i.length;d++){var c=i[d].start,h=i[d].end;if(t+r>=c&&t<h)a=c,n=(o=h)-t;else if(t+r<c){s=c;break}}return{len:n,start:a,end:o,nextStart:s}},e}(),G=r(6),j=r.n(G),K=r(11),$=r.n(K),H=r(9);function W(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}var Y=r(4);var q=Object(Y.a)(),z=W(),X=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hls=t,this.id=r;var i=this.observer=new j.a,n=t.config;i.trigger=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];i.emit.apply(i,[e,e].concat(r))},i.off=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];i.removeListener.apply(i,[e].concat(r))};var d=function(e,r){(r=r||{}).frag=this.frag,r.id=this.id,t.trigger(e,r)}.bind(this);i.on(o.a.FRAG_DECRYPTED,d),i.on(o.a.FRAG_PARSING_INIT_SEGMENT,d),i.on(o.a.FRAG_PARSING_DATA,d),i.on(o.a.FRAG_PARSED,d),i.on(o.a.ERROR,d),i.on(o.a.FRAG_PARSING_METADATA,d),i.on(o.a.FRAG_PARSING_USERDATA,d),i.on(o.a.INIT_PTS_FOUND,d);var l={mp4:z.isTypeSupported("video/mp4"),mpeg:z.isTypeSupported("audio/mpeg"),mp3:z.isTypeSupported('audio/mp4; codecs="mp3"')},u=navigator.vendor;if(n.enableWorker&&"undefined"!=typeof Worker){s.b.log("demuxing in webworker");var c=void 0;try{c=this.w=$()(12),this.onwmsg=this.onWorkerMessage.bind(this),c.addEventListener("message",this.onwmsg),c.onerror=function(e){t.trigger(o.a.ERROR,{type:a.b.OTHER_ERROR,details:a.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},c.postMessage({cmd:"init",typeSupported:l,vendor:u,id:r,config:JSON.stringify(n)})}catch(h){s.b.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),c&&q.URL.revokeObjectURL(c.objectURL),this.demuxer=new H.a(i,l,n,u),this.w=undefined}}else this.demuxer=new H.a(i,l,n,u)}return e.prototype.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},e.prototype.push=function(e,t,r,i,n,a,o,d){var l=this.w,u=isNaN(n.startDTS)?n.start:n.startDTS,c=n.decryptdata,h=this.frag,f=!(h&&n.cc===h.cc),p=!(h&&n.level===h.level),v=h&&n.sn===h.sn+1,y=!p&&v;if(f&&s.b.log(this.id+":discontinuity detected"),p&&s.b.log(this.id+":switch detected"),this.frag=n,l)l.postMessage({cmd:"demux",data:e,decryptdata:c,initSegment:t,audioCodec:r,videoCodec:i,timeOffset:u,discontinuity:f,trackSwitch:p,contiguous:y,duration:a,accurateTimeOffset:o,defaultInitPTS:d},e instanceof ArrayBuffer?[e]:[]);else{var g=this.demuxer;g&&g.push(e,c,t,r,i,u,f,p,y,a,o,d)}},e.prototype.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case"init":q.URL.revokeObjectURL(this.w.objectURL);break;case o.a.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},e}();function Z(e,t,r){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(r);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(r)}}function J(e,t,r){var i=e[t],n=e[r],a=n.startPTS;isNaN(a)?n.start=r>t?i.start+i.duration:Math.max(i.start-n.duration,0):r>t?(i.duration=a-i.start,i.duration<0&&s.b.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):(n.duration=i.start-a,n.duration<0&&s.b.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!"))}function Q(e,t,r,i,n,a){var o=r;if(!isNaN(t.startPTS)){var s=Math.abs(t.startPTS-r);isNaN(t.deltaPTS)?t.deltaPTS=s:t.deltaPTS=Math.max(s,t.deltaPTS),o=Math.max(r,t.startPTS),r=Math.min(r,t.startPTS),i=Math.max(i,t.endPTS),n=Math.min(n,t.startDTS),a=Math.max(a,t.endDTS)}var d=r-t.start;t.start=t.startPTS=r,t.maxStartPTS=o,t.endPTS=i,t.startDTS=n,t.endDTS=a,t.duration=i-r;var l=t.sn;if(!e||l<e.startSN||l>e.endSN)return 0;var u,c=void 0,h=void 0;for(u=l-e.startSN,(c=e.fragments)[u]=t,h=u;h>0;h--)J(c,h,h-1);for(h=u;h<c.length-1;h++)J(c,h,h+1);return e.PTSKnown=!0,d}var ee={toString:function(e){for(var t="",r=e.length,i=0;i<r;i++)t+="["+e.start(i).toFixed(3)+","+e.end(i).toFixed(3)+"]";return t}};function te(e,t){t.fragments.forEach(function(t){if(t){var r=t.start+e;t.start=t.startPTS=r,t.endPTS=r+t.duration}}),t.PTSKnown=!0}function re(e,t,r){if(function(e,t,r){var i=!1;return t&&t.details&&r&&(r.endCC>r.startCC||e&&e.cc<r.startCC)&&(i=!0),i}(e,t,r)){var i=function(e,t){var r=e.fragments,i=t.fragments;if(i.length&&r.length){var n=function(e,t){for(var r=null,i=0;i<e.length;i+=1){var n=e[i];if(n&&n.cc===t){r=n;break}}return r}(r,i[0].cc);if(n&&(!n||n.startPTS))return n;s.b.log("No frag in previous level to align on")}else s.b.log("No fragments to align")}(t.details,r);i&&(s.b.log("Adjusting PTS using last level due to CC increase within current level"),te(i.start,r))}if(!1===r.PTSKnown&&t&&t.details&&t.details.fragments&&t.details.fragments.length){var n=t.details.programDateTime,a=(r.programDateTime-n)/1e3+t.details.fragments[0].start;isNaN(a)||(s.b.log("adjusting PTS using programDateTime delta, sliding:"+a.toFixed(3)),te(a,r))}}var ie=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,n=Array(i>1?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call.apply(e,[this,r].concat(n)));return o._tickInterval=null,o._tickTimer=null,o._tickCallCount=0,o._boundTick=o.tick.bind(o),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},t.prototype.hasInterval=function(){return!!this._tickInterval},t.prototype.hasNextTick=function(){return!!this._tickTimer},t.prototype.setInterval=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return!this._tickInterval&&(this._tickInterval=setInterval(this._boundTick,e),!0)}),t.prototype.clearInterval=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return!!this._tickInterval&&(clearInterval(this._tickInterval),this._tickInterval=null,!0)}),t.prototype.clearNextTick=function(){return!!this._tickTimer&&(clearTimeout(this._tickTimer),this._tickTimer=null,!0)},t.prototype.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=setTimeout(this._boundTick,0)),this._tickCallCount=0)},t.prototype.doTick=function(){},t}(u);function ne(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!Array.isArray(e)||!e.length||null===t)return null;if(t<e[0].pdt)return null;if(t>=e[e.length-1].endPdt)return null;for(var r=0;r<e.length;++r){var i=e[r];if(t<i.endPdt)return i}return null}function ae(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0,n=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0,a=void 0,o=e?t[e.sn-t[0].sn+1]:null;return r<i&&(r>i-n&&(n=0),a=o&&!oe(r,n,o)?o:F.search(t,oe.bind(null,r,n))),a}function oe(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,r=arguments[2],i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-i<=e?1:r.start-i>e&&r.start?-1:0}var se=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var de={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},le=function(e){function t(r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r,o.a.MEDIA_ATTACHED,o.a.MEDIA_DETACHING,o.a.MANIFEST_LOADING,o.a.MANIFEST_PARSED,o.a.LEVEL_LOADED,o.a.KEY_LOADED,o.a.FRAG_LOADED,o.a.FRAG_LOAD_EMERGENCY_ABORTED,o.a.FRAG_PARSING_INIT_SEGMENT,o.a.FRAG_PARSING_DATA,o.a.FRAG_PARSED,o.a.ERROR,o.a.AUDIO_TRACK_SWITCHING,o.a.AUDIO_TRACK_SWITCHED,o.a.BUFFER_CREATED,o.a.BUFFER_APPENDED,o.a.BUFFER_FLUSHED));return n.fragmentTracker=i,n.config=r.config,n.audioCodecSwap=!1,n._state=de.STOPPED,n.stallReported=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},t.prototype.onHandlerDestroyed=function(){this.state=de.STOPPED,this.fragmentTracker=null,e.prototype.onHandlerDestroyed.call(this)},t.prototype.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var i=r.startLevel;-1===i&&(i=0,this.bitrateTest=!0),this.level=r.nextLoadLevel=i,this.loadedmetadata=!1}t>0&&-1===e&&(s.b.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=de.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=de.STOPPED},t.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.clearInterval(),this.state=de.STOPPED,this.forceStartLoad=!1},t.prototype.doTick=function(){switch(this.state){case de.BUFFER_FLUSHING:this.fragLoadError=0;break;case de.IDLE:this._doTickIdle();break;case de.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=de.IDLE);break;case de.FRAG_LOADING_WAITING_RETRY:var t=window.performance.now(),r=this.retryDate;(!r||t>=r||this.media&&this.media.seeking)&&(s.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=de.IDLE);break;case de.ERROR:case de.STOPPED:case de.FRAG_LOADING:case de.PARSING:case de.PARSED:case de.ENDED:}this._checkBuffer(),this._checkFragmentChanged()},t.prototype._doTickIdle=function(){var e=this.hls,t=e.config,r=this.media;if(this.levelLastLoaded!==undefined&&(r||!this.startFragRequested&&t.startFragPrefetch)){var i=void 0;i=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var n=e.nextLoadLevel,a=this.levels[n];if(a){var d=a.bitrate,l=void 0;l=d?Math.max(8*t.maxBufferSize/d,t.maxBufferLength):t.maxBufferLength,l=Math.min(l,t.maxMaxBufferLength);var u=B.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,i,t.maxBufferHole),c=u.len;if(!(c>=l)){s.b.trace("buffer length of "+c.toFixed(3)+" is below max of "+l.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=n;var h=a.details;if(!h||h.live&&this.levelLastLoaded!==n)this.state=de.WAITING_LEVEL;else{var f=this.fragPrevious;if(!h.live&&f&&!f.backtracked&&f.sn===h.endSN&&!u.nextStart)if(Math.min(r.duration,f.start+f.duration)-Math.max(u.end,f.start)<=Math.max(.2,f.duration)){var p={};return this.altAudio&&(p.type="video"),this.hls.trigger(o.a.BUFFER_EOS,p),void(this.state=de.ENDED)}this._fetchPayloadOrEos(i,u,h)}}}}},t.prototype._fetchPayloadOrEos=function(e,t,r){var i=this.fragPrevious,n=this.level,a=r.fragments,o=a.length;if(0!==o){var d=a[0].start,l=a[o-1].start+a[o-1].duration,u=t.end,c=void 0;if(r.initSegment&&!r.initSegment.data)c=r.initSegment;else if(r.live){var h=this.config.initialLiveManifestSize;if(o<h)return void s.b.warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+h);if(null===(c=this._ensureFragmentAtLivePoint(r,u,d,l,i,a,o)))return}else u<d&&(c=a[0]);c||(c=this._findFragment(d,i,o,a,u,l,r)),c&&(c.encrypted?(s.b.log("Loading key for "+c.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+n),this._loadKey(c)):(s.b.log("Loading "+c.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+n+", currentTime:"+e.toFixed(3)+",bufferEnd:"+u.toFixed(3)),this._loadFragment(c)))}},t.prototype._ensureFragmentAtLivePoint=function(e,t,r,i,n,a,o){var d=this.hls.config,l=this.media,u=void 0,c=d.liveMaxLatencyDuration!==undefined?d.liveMaxLatencyDuration:d.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(r-d.maxFragLookUpTolerance,i-c)){var h=this.liveSyncPosition=this.computeLivePosition(r,e);s.b.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),t=h,l&&l.readyState&&l.duration>h&&(l.currentTime=h),this.nextLoadPosition=h}if(e.PTSKnown&&t>i&&l&&l.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(n)if(e.programDateTime)u=ne(a,n.endPdt+1);else{var f=n.sn+1;if(f>=e.startSN&&f<=e.endSN){var p=a[f-e.startSN];n.cc===p.cc&&(u=p,s.b.log("live playlist, switching playlist, load frag with next SN: "+u.sn))}u||(u=F.search(a,function(e){return n.cc-e.cc}))&&s.b.log("live playlist, switching playlist, load frag with same CC: "+u.sn)}u||(u=a[Math.min(o-1,Math.round(o/2))],s.b.log("live playlist, switching playlist, unknown, load middle frag : "+u.sn))}return u},t.prototype._findFragment=function(e,t,r,i,n,a,o){var d=this.hls.config,l=void 0,u=void 0;if(n<a?o.programDateTime?(u=ne(i,function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,r=arguments[2],i=0;if(r.programDateTime){var n=Date.parse(r.programDateTime);isNaN(n)||(i=1e3*t+n-1e3*e)}return i}(e,n,o)))&&!oe(n,d.maxFragLookUpTolerance,u)||(s.b.warn("Frag found by PDT search did not fit within tolerance; falling back to finding by SN"),u=ae(t,i,n,a,d.maxFragLookUpTolerance)):u=ae(t,i,n,a,d.maxFragLookUpTolerance):u=i[r-1],u){var c=(l=u).sn-o.startSN,h=t&&l.level===t.level,f=i[c-1],p=i[c+1];if(t&&l.sn===t.sn)if(h&&!l.backtracked)if(l.sn<o.endSN){var v=t.deltaPTS;v&&v>d.maxBufferHole&&t.dropped&&c?(l=f,s.b.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")):(l=p,s.b.log("SN just loaded, load next one: "+l.sn))}else l=null;else l.backtracked&&(p&&p.backtracked?(s.b.warn("Already backtracked from fragment "+p.sn+", will not backtrack to fragment "+l.sn+". Loading fragment "+p.sn),l=p):(s.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),l.dropped=0,f?(l=f).backtracked=!0:c&&(l=null)))}return l},t.prototype._loadKey=function(e){this.state=de.KEY_LOADING,this.hls.trigger(o.a.KEY_LOADING,{frag:e})},t.prototype._loadFragment=function(e){var t=this.fragmentTracker.getState(e);this.fragCurrent=e,this.startFragRequested=!0,isNaN(e.sn)||e.bitrateTest||(this.nextLoadPosition=e.start+e.duration),e.backtracked||t===O||t===M?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,this.hls.trigger(o.a.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new X(this.hls,"main")),this.state=de.FRAG_LOADING):t===N&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},t.prototype.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,I.LevelType.MAIN)},t.prototype.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},t.prototype._checkFragmentChanged=function(){var e=void 0,t=void 0,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((t=r.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),B.isBuffered(r,t)?e=this.getBufferedFrag(t):B.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var i=e;if(i!==this.fragPlaying){this.hls.trigger(o.a.FRAG_CHANGED,{frag:i});var n=i.level;this.fragPlaying&&this.fragPlaying.level===n||this.hls.trigger(o.a.LEVEL_SWITCHED,{level:n}),this.fragPlaying=i}}},t.prototype.immediateLevelSwitch=function(){if(s.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},t.prototype.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,B.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},t.prototype.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,r=void 0,i=void 0;if((t=this.getBufferedFrag(e.currentTime))&&t.startPTS>1&&this.flushMainBuffer(0,t.startPTS-1),e.paused)r=0;else{var n=this.hls.nextLoadLevel,a=this.levels[n],o=this.fragLastKbps;r=o&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*o)+1:0}if((i=this.getBufferedFrag(e.currentTime+r))&&(i=this.followingBufferedFrag(i))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(i.maxStartPTS,Number.POSITIVE_INFINITY)}}},t.prototype.flushMainBuffer=function(e,t){this.state=de.BUFFER_FLUSHING;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(o.a.BUFFER_FLUSHING,r)},t.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition)},t.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(s.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.backtracked=undefined})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},t.prototype.onMediaSeeking=function(){var e=this.media,t=e?e.currentTime:undefined,r=this.config;isNaN(t)||s.b.log("media seeking to "+t.toFixed(3));var i=this.mediaBuffer?this.mediaBuffer:e,n=B.bufferInfo(i,t,this.config.maxBufferHole);if(this.state===de.FRAG_LOADING){var a=this.fragCurrent;if(0===n.len&&a){var o=r.maxFragLookUpTolerance,d=a.start-o,l=a.start+a.duration+o;t<d||t>l?(a.loader&&(s.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=de.IDLE):s.b.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===de.ENDED&&(0===n.len&&(this.fragPrevious=0),this.state=de.IDLE);e&&(this.lastCurrentTime=t),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()},t.prototype.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:undefined;isNaN(t)||s.b.log("media seeked to "+t.toFixed(3)),this.tick()},t.prototype.onMediaEnded=function(){s.b.log("media ended"),this.startPosition=this.lastCurrentTime=0},t.prototype.onManifestLoading=function(){s.b.log("trigger BUFFER_RESET"),this.hls.trigger(o.a.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},t.prototype.onManifestParsed=function(e){var t=!1,r=!1,i=void 0;e.levels.forEach(function(e){(i=e.audioCodec)&&(-1!==i.indexOf("mp4a.40.2")&&(t=!0),-1!==i.indexOf("mp4a.40.5")&&(r=!0))}),this.audioCodecSwitch=t&&r,this.audioCodecSwitch&&s.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1;var n=this.config;(n.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(n.startPosition)},t.prototype.onLevelLoaded=function(e){var t=e.details,r=e.level,i=this.levels[this.levelLastLoaded],n=this.levels[r],a=t.totalduration,d=0;if(s.b.log("level "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+a),t.live){var l=n.details;l&&t.fragments.length>0?(!function(e,t){var r=Math.max(e.startSN,t.startSN)-t.startSN,i=Math.min(e.endSN,t.endSN)-t.startSN,n=t.startSN-e.startSN,a=e.fragments,o=t.fragments,d=0,l=void 0;if(t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment),i<r)t.PTSKnown=!1;else{for(var u=r;u<=i;u++){var c=a[n+u],h=o[u];h&&c&&(d=c.cc-h.cc,isNaN(c.startPTS)||(h.start=h.startPTS=c.startPTS,h.endPTS=c.endPTS,h.duration=c.duration,h.backtracked=c.backtracked,h.dropped=c.dropped,l=h))}if(d)for(s.b.log("discontinuity sliding from playlist, take drift into account"),u=0;u<o.length;u++)o[u].cc+=d;if(l)Q(t,l,l.startPTS,l.endPTS,l.startDTS,l.endDTS);else if(n>=0&&n<a.length){var f=a[n].start;for(u=0;u<o.length;u++)o[u].start+=f}t.PTSKnown=e.PTSKnown}}(l,t),d=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(d,l),t.PTSKnown&&!isNaN(d)?s.b.log("live playlist sliding:"+d.toFixed(3)):(s.b.log("live playlist - outdated PTS, unknown sliding"),re(this.fragPrevious,i,t))):(s.b.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,re(this.fragPrevious,i,t))}else t.PTSKnown=!1;if(n.details=t,this.levelLastLoaded=r,this.hls.trigger(o.a.LEVEL_UPDATED,{details:t,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var u=t.startTimeOffset;isNaN(u)?t.live?(this.startPosition=this.computeLivePosition(d,t),s.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(u<0&&(s.b.log("negative start time offset "+u+", count from end of last fragment"),u=d+a+u),s.b.log("start time offset found in playlist, adjust startPosition to "+u),this.startPosition=u),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===de.WAITING_LEVEL&&(this.state=de.IDLE),this.tick()},t.prototype.onKeyLoaded=function(){this.state===de.KEY_LOADING&&(this.state=de.IDLE,this.tick())},t.prototype.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag;if(this.state===de.FRAG_LOADING&&t&&"main"===r.type&&r.level===t.level&&r.sn===t.sn){var i=e.stats,n=this.levels[t.level],a=n.details;if(s.b.log("Loaded  "+t.sn+" of ["+a.startSN+" ,"+a.endSN+"],level "+t.level),this.bitrateTest=!1,this.stats=i,!0===r.bitrateTest&&this.hls.nextLoadLevel)this.state=de.IDLE,this.startFragRequested=!1,i.tparsed=i.tbuffered=window.performance.now(),this.hls.trigger(o.a.FRAG_BUFFERED,{stats:i,frag:t,id:"main"}),this.tick();else if("initSegment"===r.sn)this.state=de.IDLE,i.tparsed=i.tbuffered=window.performance.now(),a.initSegment.data=e.payload,this.hls.trigger(o.a.FRAG_BUFFERED,{stats:i,frag:t,id:"main"}),this.tick();else{this.state=de.PARSING;var d=a.totalduration,l=t.level,u=t.sn,c=this.config.defaultAudioCodec||n.audioCodec;this.audioCodecSwap&&(s.b.log("swapping playlist audio codec"),c===undefined&&(c=this.lastAudioCodec),c&&(c=-1!==c.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,s.b.log("Parsing "+u+" of ["+a.startSN+" ,"+a.endSN+"],level "+l+", cc "+t.cc);var h=this.demuxer;h||(h=this.demuxer=new X(this.hls,"main"));var f=this.media,p=!(f&&f.seeking)&&(a.PTSKnown||!a.live),v=a.initSegment?a.initSegment.data:[];h.push(e.payload,v,c,n.videoCodec,t,d,p,undefined)}}this.fragLoadError=0},t.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===de.PARSING){var i=e.tracks,n=void 0,a=void 0;if(i.audio&&this.altAudio&&delete i.audio,a=i.audio){var d=this.levels[this.level].audioCodec,l=navigator.userAgent.toLowerCase();d&&this.audioCodecSwap&&(s.b.log("swapping playlist audio codec"),d=-1!==d.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==a.metadata.channelCount&&-1===l.indexOf("firefox")&&(d="mp4a.40.5"),-1!==l.indexOf("android")&&"audio/mpeg"!==a.container&&(d="mp4a.40.2",s.b.log("Android: force audio codec to "+d)),a.levelCodec=d,a.id=e.id}for(n in(a=i.video)&&(a.levelCodec=this.levels[this.level].videoCodec,a.id=e.id),this.hls.trigger(o.a.BUFFER_CODECS,i),i){a=i[n],s.b.log("main track:"+n+",container:"+a.container+",codecs[level/parsed]=["+a.levelCodec+"/"+a.codec+"]");var u=a.initSegment;u&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(o.a.BUFFER_APPENDING,{type:n,data:u,parent:"main",content:"initSegment"}))}this.tick()}},t.prototype.onFragParsingData=function(e){var t=this,r=this.fragCurrent,i=e.frag;if(r&&"main"===e.id&&i.sn===r.sn&&i.level===r.level&&("audio"!==e.type||!this.altAudio)&&this.state===de.PARSING){var n=this.levels[this.level],a=r;if(isNaN(e.endPTS)&&(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),!0===e.hasAudio&&a.addElementaryStream(v.ElementaryStreamTypes.AUDIO),!0===e.hasVideo&&a.addElementaryStream(v.ElementaryStreamTypes.VIDEO),s.b.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(a.dropped=e.dropped,a.dropped)if(a.backtracked)s.b.warn("Already backtracked on this fragment, appending with the gap",a.sn);else{var d=n.details;if(!d||a.sn!==d.startSN)return s.b.warn("missing video frame(s), backtracking fragment",a.sn),this.fragmentTracker.removeFragment(a),a.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=de.IDLE,this.fragPrevious=a,void this.tick();s.b.warn("missing video frame(s) on first frag, appending with gap",a.sn)}else a.backtracked=!1;var l=Q(n.details,a,e.startPTS,e.endPTS,e.startDTS,e.endDTS),u=this.hls;u.trigger(o.a.LEVEL_PTS_UPDATED,{details:n.details,level:this.level,drift:l,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach(function(r){r&&r.length&&t.state===de.PARSING&&(t.appended=!0,t.pendingBuffering=!0,u.trigger(o.a.BUFFER_APPENDING,{type:e.type,data:r,parent:"main",content:"data"}))}),this.tick()}},t.prototype.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===de.PARSING&&(this.stats.tparsed=window.performance.now(),this.state=de.PARSED,this._checkAppendedParsed())},t.prototype.onAudioTrackSwitching=function(e){var t=!!e.url,r=e.id;if(!t){if(this.mediaBuffer!==this.media){s.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var i=this.fragCurrent;i.loader&&(s.b.log("switching to main audio track, cancel main fragment load"),i.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=de.IDLE}var n=this.hls;n.trigger(o.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),n.trigger(o.a.AUDIO_TRACK_SWITCHED,{id:r}),this.altAudio=!1}},t.prototype.onAudioTrackSwitched=function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(s.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=r,this.tick()},t.prototype.onBufferCreated=function(e){var t=e.tracks,r=void 0,i=void 0,n=!1;for(var a in t){var o=t[a];"main"===o.id?(i=a,r=o,"video"===a&&(this.videoBuffer=t[a].buffer)):n=!0}n&&r?(s.b.log("alternate track found, use "+i+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media},t.prototype.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==de.PARSING&&t!==de.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},t.prototype._checkAppendedParsed=function(){if(!(this.state!==de.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;s.b.log("main buffered : "+ee.toString(t.buffered)),this.fragPrevious=e;var r=this.stats;r.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),this.hls.trigger(o.a.FRAG_BUFFERED,{stats:r,frag:e,id:"main"}),this.state=de.IDLE}this.tick()}},t.prototype.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var r=!!this.media&&B.isBuffered(this.media,this.media.currentTime)&&B.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case a.a.FRAG_LOAD_ERROR:case a.a.FRAG_LOAD_TIMEOUT:case a.a.KEY_LOAD_ERROR:case a.a.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var i=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);s.b.warn("mediaController: frag loading failed, retry in "+i+" ms"),this.retryDate=window.performance.now()+i,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=de.FRAG_LOADING_WAITING_RETRY}else s.b.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=de.ERROR;break;case a.a.LEVEL_LOAD_ERROR:case a.a.LEVEL_LOAD_TIMEOUT:this.state!==de.ERROR&&(e.fatal?(this.state=de.ERROR,s.b.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==de.WAITING_LEVEL||(this.state=de.IDLE));break;case a.a.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==de.PARSING&&this.state!==de.PARSED||(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=de.IDLE):(s.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},t.prototype._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,s.b.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},t.prototype._checkBuffer=function(){var e=this.config,t=this.media;if(t&&0!==t.readyState){var r=t.currentTime,i=(this.mediaBuffer?this.mediaBuffer:t).buffered;if(!this.loadedmetadata&&i.length)this.loadedmetadata=!0,this._seekToStartPos();else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var n=!(t.paused&&t.readyState>1||t.ended||0===t.buffered.length),a=window.performance.now();if(r!==this.lastCurrentTime)this.stallReported&&(s.b.warn("playback not stuck anymore @"+r+", after "+Math.round(a-this.stalled)+"ms"),this.stallReported=!1),this.stalled=null,this.nudgeRetry=0;else if(n){var o=a-this.stalled,d=B.bufferInfo(t,r,e.maxBufferHole);if(!this.stalled)return void(this.stalled=a);o>=1e3&&this._reportStall(d.len),this._tryFixBufferStall(d,o)}}}},t.prototype.onFragLoadEmergencyAborted=function(){this.state=de.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},t.prototype.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;e&&this.fragmentTracker.detectEvictedFragments(v.ElementaryStreamTypes.VIDEO,e.buffered),this.state=de.IDLE,this.fragPrevious=null},t.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},t.prototype.computeLivePosition=function(e,t){var r=this.config.liveSyncDuration!==undefined?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)},t.prototype._tryFixBufferStall=function(e,t){var r=this.config,i=this.media.currentTime,n=this.fragmentTracker.getPartialFragment(i);n&&this._trySkipBufferHole(n),e.len>.5&&t>1e3*r.highBufferWatchdogPeriod&&(this.stalled=null,this._tryNudgeBuffer())},t.prototype._reportStall=function(e){var t=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,s.b.warn("Playback stalling at @"+r.currentTime+" due to low buffer"),t.trigger(o.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t.prototype._trySkipBufferHole=function(e){for(var t=this.hls,r=this.media,i=r.currentTime,n=0,d=0;d<r.buffered.length;d++){var l=r.buffered.start(d);if(i>=n&&i<l)return r.currentTime=Math.max(l,r.currentTime+.1),s.b.warn("skipping hole, adjusting currentTime from "+i+" to "+r.currentTime),this.stalled=null,void t.trigger(o.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+i+" to "+r.currentTime,frag:e});n=r.buffered.end(d)}},t.prototype._tryNudgeBuffer=function(){var e=this.config,t=this.hls,r=this.media,i=r.currentTime,n=(this.nudgeRetry||0)+1;if(this.nudgeRetry=n,n<e.nudgeMaxRetry){var d=i+n*e.nudgeOffset;s.b.log("adjust currentTime from "+i+" to "+d),r.currentTime=d,t.trigger(o.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else s.b.error("still stuck in high buffer @"+i+" after "+e.nudgeMaxRetry+", raise fatal error"),t.trigger(o.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.BUFFER_STALLED_ERROR,fatal:!0})},t.prototype._seekToStartPos=function(){var e=this.media,t=e.currentTime,r=e.seeking?t:this.startPosition;t!==r&&(s.b.log("target start position not buffered, seek to buffered.start(0) "+r+" from current time "+t+" "),e.currentTime=r)},se(t,[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,s.b.log("main stream:"+t+"->"+e),this.hls.trigger(o.a.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(ie),ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var he=window.performance,fe=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r,o.a.MANIFEST_LOADED,o.a.LEVEL_LOADED,o.a.AUDIO_TRACK_SWITCHED,o.a.FRAG_LOADED,o.a.ERROR));return i.canload=!1,i.currentLevelIndex=null,i.manualLevelIndex=-1,i.timer=null,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},t.prototype.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},t.prototype.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=undefined)}),null!==this.timer&&this.loadLevel()},t.prototype.stopLoad=function(){this.canload=!1},t.prototype.onManifestLoaded=function(e){var t=[],r=void 0,i={},n=null,d=!1,l=!1,u=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),c=[];if(e.levels.forEach(function(e){e.loadError=0,e.fragmentError=!1,d=d||!!e.videoCodec,l=l||!!e.audioCodec||!(!e.attrs||!e.attrs.AUDIO),u&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=undefined),(n=i[e.bitrate])?n.url.push(e.url):(e.url=[e.url],e.urlId=0,i[e.bitrate]=e,t.push(e)),e.attrs&&e.attrs.AUDIO&&Z(n||e,"audio",e.attrs.AUDIO),e.attrs&&e.attrs.SUBTITLES&&Z(n||e,"text",e.attrs.SUBTITLES)}),d&&l&&(t=t.filter(function(e){return!!e.videoCodec})),t=t.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||_(t))&&(!r||_(r))}),e.audioTracks&&(c=e.audioTracks.filter(function(e){return!e.audioCodec||_(e.audioCodec,"audio")})),t.length>0){r=t[0].bitrate,t.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=t;for(var h=0;h<t.length;h++)if(t[h].bitrate===r){this._firstLevel=h,s.b.log("manifest loaded,"+t.length+" level(s) found, first bitrate:"+r);break}this.hls.trigger(o.a.MANIFEST_PARSED,{levels:t,audioTracks:c,firstLevel:this._firstLevel,stats:e.stats,audio:l,video:d,altAudio:c.length>0&&d})}else this.hls.trigger(o.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},t.prototype.setLevelInternal=function(e){var t=this._levels,r=this.hls;if(e>=0&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){s.b.log("switching to level "+e),this.currentLevelIndex=e;var i=t[e];i.level=e,r.trigger(o.a.LEVEL_SWITCHING,i)}var n=t[e],d=n.details;if(!d||d.live){var l=n.urlId;r.trigger(o.a.LEVEL_LOADING,{url:n.url[l],level:e,id:l})}}else r.trigger(o.a.ERROR,{type:a.b.OTHER_ERROR,details:a.a.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},t.prototype.onError=function(e){if(e.fatal)e.type===a.b.NETWORK_ERROR&&this.clearTimer();else{var t=!1,r=!1,i=void 0;switch(e.details){case a.a.FRAG_LOAD_ERROR:case a.a.FRAG_LOAD_TIMEOUT:case a.a.KEY_LOAD_ERROR:case a.a.KEY_LOAD_TIMEOUT:i=e.frag.level,r=!0;break;case a.a.LEVEL_LOAD_ERROR:case a.a.LEVEL_LOAD_TIMEOUT:i=e.context.level,t=!0;break;case a.a.REMUX_ALLOC_ERROR:i=e.level,t=!0}i!==undefined&&this.recoverLevel(e,i,t,r)}},t.prototype.recoverLevel=function(e,t,r,i){var n=this,a=this.hls.config,o=e.details,d=this._levels[t],l=void 0,u=void 0,c=void 0;if(d.loadError++,d.fragmentError=i,r){if(!(this.levelRetryCount+1<=a.levelLoadingMaxRetry))return s.b.error("level controller, cannot recover from "+o+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);u=Math.min(Math.pow(2,this.levelRetryCount)*a.levelLoadingRetryDelay,a.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return n.loadLevel()},u),e.levelRetry=!0,this.levelRetryCount++,s.b.warn("level controller, "+o+", retry in "+u+" ms, current retry count is "+this.levelRetryCount)}(r||i)&&((l=d.url.length)>1&&d.loadError<l?(d.urlId=(d.urlId+1)%l,d.details=undefined,s.b.warn("level controller, "+o+" for level "+t+": switching to redundant URL-id "+d.urlId)):-1===this.manualLevelIndex?(c=0===t?this._levels.length-1:t-1,s.b.warn("level controller, "+o+": switch to "+c),this.hls.nextAutoLevel=this.currentLevelIndex=c):i&&(s.b.warn("level controller, "+o+": reload a fragment"),this.currentLevelIndex=null))},t.prototype.onFragLoaded=function(e){var t=e.frag;if(t!==undefined&&"main"===t.type){var r=this._levels[t.level];r!==undefined&&(r.fragmentError=!1,r.loadError=0,this.levelRetryCount=0)}},t.prototype.onLevelLoaded=function(e){var t=this,r=e.level;if(r===this.currentLevelIndex){var i=this._levels[r];i.fragmentError||(i.loadError=0,this.levelRetryCount=0);var n=e.details;if(n.live){var a=1e3*(n.averagetargetduration?n.averagetargetduration:n.targetduration),o=a,d=i.details;d&&n.endSN===d.endSN&&(o/=2,s.b.log("same live playlist, reload twice faster")),o-=he.now()-e.stats.trequest,o=Math.max(a/2,Math.round(o)),s.b.log("live playlist, reload in "+Math.round(o)+" ms"),this.timer=setTimeout(function(){return t.loadLevel()},o)}else this.clearTimer()}},t.prototype.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){var i=r.audioGroupIds.findIndex(function(e){return e===t});i!==r.urlId&&(r.urlId=i,this.startLoad())}},t.prototype.loadLevel=function(){if(s.b.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"===(void 0===e?"undefined":ue(e))&&e.url.length>0){var t=this.currentLevelIndex,r=e.urlId,i=e.url[r];s.b.log("Attempt loading level index "+t+" with URL-id "+r),this.hls.trigger(o.a.LEVEL_LOADING,{url:i,level:t,id:r})}}},ce(t,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,this._startLevel===undefined&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(this._startLevel===undefined){var e=this.hls.config.startLevel;return e!==undefined?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}]),t}(u),pe=r(7);function ve(e,t){var r=null;try{r=new window.Event("addtrack")}catch(i){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)}var ye=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r,o.a.MEDIA_ATTACHED,o.a.MEDIA_DETACHING,o.a.FRAG_PARSING_METADATA));return i.id3Track=undefined,i.media=undefined,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){u.prototype.destroy.call(this)},t.prototype.onMediaAttached=function(e){this.media=e.media,this.media},t.prototype.onMediaDetaching=function(){!function(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}(this.id3Track),this.id3Track=undefined,this.media=undefined},t.prototype.getID3Track=function(e){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return ve(r,this.media),r}return this.media.addTextTrack("metadata","id3")},t.prototype.onFragParsingMetadata=function(e){var t=e.frag,r=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var i=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,n=0;n<r.length;n++){var a=pe.a.getID3Frames(r[n].data);if(a){var o=r[n].pts,s=n<r.length-1?r[n+1].pts:t.endPTS;o===s&&(s+=1e-4);for(var d=0;d<a.length;d++){var l=a[d];if(!pe.a.isTimeStampFrame(l)){var u=new i(o,s,"");u.value=l,this.id3Track.addCue(u)}}}}},t}(u);var ge=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return e.prototype.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},e.prototype.getTotalWeight=function(){return this.totalWeight_},e.prototype.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}();var me=function(){function e(t,r,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hls=t,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new ge(r),this.fast_=new ge(i)}return e.prototype.sample=function(e,t){var r=8e3*t/(e=Math.max(e,this.minDelayMs_)),i=e/1e3;this.fast_.sample(i,r),this.slow_.sample(i,r)},e.prototype.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},e.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},e.prototype.destroy=function(){},e}(),Ee=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var _e=window.performance,Te=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r,o.a.FRAG_LOADING,o.a.FRAG_LOADED,o.a.FRAG_BUFFERED,o.a.ERROR));return i.lastLoadedFragLevel=0,i._nextAutoLevel=-1,i.hls=r,i.timer=null,i._bwEstimator=null,i.onCheck=i._abandonRulesCheck.bind(i),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){this.clearTimer(),u.prototype.destroy.call(this)},t.prototype.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r=this.hls,i=r.config,n=t.level,a=void 0,o=void 0;r.levels[n].details.live?(a=i.abrEwmaFastLive,o=i.abrEwmaSlowLive):(a=i.abrEwmaFastVoD,o=i.abrEwmaSlowVoD),this._bwEstimator=new me(r,o,a,i.abrEwmaDefaultEstimate)}},t.prototype._abandonRulesCheck=function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(r){var i=r.loader,n=e.minAutoLevel;if(!i||i.stats&&i.stats.aborted)return s.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var a=i.stats;if(t&&a&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var d=_e.now()-a.trequest,l=Math.abs(t.playbackRate);if(d>500*r.duration/l){var u=e.levels,c=Math.max(1,a.bw?a.bw/8:1e3*a.loaded/d),h=u[r.level],f=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,p=a.total?a.total:Math.max(a.loaded,Math.round(r.duration*f/8)),v=t.currentTime,y=(p-a.loaded)/c,g=(B.bufferInfo(t,v,e.config.maxBufferHole).end-v)/l;if(g<2*r.duration/l&&y>g){var m=void 0,E=void 0;for(E=r.level-1;E>n;E--){var _=u[E].realBitrate?Math.max(u[E].realBitrate,u[E].bitrate):u[E].bitrate;if((m=r.duration*_/(6.4*c))<g)break}m<y&&(s.b.warn("loading too slow, abort fragment loading and switch to level "+E+":fragLoadedDelay["+E+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+m.toFixed(1)+"<"+y.toFixed(1)+":"+g.toFixed(1)),e.nextLoadLevel=E,this._bwEstimator.sample(d,a.loaded),i.abort(),this.clearTimer(),e.trigger(o.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:a}))}}}}},t.prototype.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&!isNaN(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[t.level],i=(r.loaded?r.loaded.bytes:0)+e.stats.loaded,n=(r.loaded?r.loaded.duration:0)+e.frag.duration;r.loaded={bytes:i,duration:n},r.realBitrate=Math.round(8*i/n)}if(e.frag.bitrateTest){var a=e.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(e)}}},t.prototype.onFragBuffered=function(e){var t=e.stats,r=e.frag;if(!(!0===t.aborted||"main"!==r.type||isNaN(r.sn)||r.bitrateTest&&t.tload!==t.tbuffered)){var i=t.tparsed-t.trequest;s.b.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(i,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=i/1e3:this.bitrateTestDelay=0}},t.prototype.onError=function(e){switch(e.details){case a.a.FRAG_LOAD_ERROR:case a.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},t.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},t.prototype._findBestLevel=function(e,t,r,i,n,a,o,d,l){for(var u=n;u>=i;u--){var c=l[u].details,h=c?c.totalduration/c.fragments.length:t,f=!!c&&c.live,p=void 0;p=u<=e?o*r:d*r;var v=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,y=v*h/p;if(s.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(p)+"/"+v+"/"+h+"/"+a+"/"+y),p>v&&(!y||f&&!this.bitrateTestDelay||y<a))return u}return-1},Ee(t,[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,i=e.config,n=e.minAutoLevel,a=e.media,o=this.lastLoadedFragLevel,d=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,u=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,c=this._bwEstimator?this._bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,h=(B.bufferInfo(a,l,i.maxBufferHole).end-l)/u,f=this._findBestLevel(o,d,c,n,t,h,i.abrBandWidthFactor,i.abrBandWidthUpFactor,r);if(f>=0)return f;s.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=d?Math.min(d,i.maxStarvationDelay):i.maxStarvationDelay,v=i.abrBandWidthFactor,y=i.abrBandWidthUpFactor;if(0===h){var g=this.bitrateTestDelay;if(g)p=(d?Math.min(d,i.maxLoadingDelay):i.maxLoadingDelay)-g,s.b.trace("bitrate test took "+Math.round(1e3*g)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),v=y=1}return f=this._findBestLevel(o,d,c,n,t,h+p,v,y,r),Math.max(f,0)}}]),t}(u);var Ae=W(),be=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r,o.a.MEDIA_ATTACHING,o.a.MEDIA_DETACHING,o.a.MANIFEST_PARSED,o.a.BUFFER_RESET,o.a.BUFFER_APPENDING,o.a.BUFFER_CODECS,o.a.BUFFER_EOS,o.a.BUFFER_FLUSHING,o.a.LEVEL_PTS_UPDATED,o.a.LEVEL_UPDATED));return i._msDuration=null,i._levelDuration=null,i._live=null,i._objectUrl=null,i.onsbue=i.onSBUpdateEnd.bind(i),i.onsbe=i.onSBUpdateError.bind(i),i.pendingTracks={},i.tracks={},i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){u.prototype.destroy.call(this)},t.prototype.onLevelPtsUpdated=function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var i=this.sourceBuffer.audio;if(Math.abs(i.timestampOffset-e.start)>.1){var n=i.updating;try{i.abort()}catch(a){n=!0,s.b.warn("can not abort audio buffer: "+a)}n?this.audioTimestampOffset=e.start:(s.b.warn("change mpeg audio timestamp offset from "+i.timestampOffset+" to "+e.start),i.timestampOffset=e.start)}}},t.prototype.onManifestParsed=function(e){var t=e.audio,r=e.video||e.levels.length&&e.altAudio,i=0;e.altAudio&&(t||r)&&(i=(t?1:0)+(r?1:0),s.b.log(i+" sourceBuffer(s) expected")),this.sourceBufferNb=i},t.prototype.onMediaAttaching=function(e){var t=this.media=e.media;if(t){var r=this.mediaSource=new Ae;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),r.addEventListener("sourceopen",this.onmso),r.addEventListener("sourceended",this.onmse),r.addEventListener("sourceclose",this.onmsc),t.src=window.URL.createObjectURL(r),this._objectUrl=t.src}},t.prototype.onMediaDetaching=function(){s.b.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(t){s.b.warn("onMediaDetaching:"+t.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):s.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(o.a.MEDIA_DETACHED)},t.prototype.onMediaSourceOpen=function(){s.b.log("media source opened"),this.hls.trigger(o.a.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},t.prototype.checkPendingTracks=function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())},t.prototype.onMediaSourceClose=function(){s.b.log("media source closed")},t.prototype.onMediaSourceEnded=function(){s.b.log("media source ended")},t.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;s.b.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,r=this.segments.reduce(function(e,r){return r.parent===t?e+1:e},0),i={},n=this.sourceBuffer;for(var a in n)i[a]=n[a].buffered;this.hls.trigger(o.a.BUFFER_APPENDED,{parent:t,pending:r,timeRanges:i}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()},t.prototype.onSBUpdateError=function(e){s.b.error("sourceBuffer error:",e),this.hls.trigger(o.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.BUFFER_APPENDING_ERROR,fatal:!1})},t.prototype.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this.onsbue),r.removeEventListener("error",this.onsbe)}catch(i){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},t.prototype.onBufferCodecs=function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var r=this.mediaSource;r&&"open"===r.readyState&&this.checkPendingTracks()}},t.prototype.createSourceBuffers=function(e){var t=this.sourceBuffer,r=this.mediaSource;for(var i in e)if(!t[i]){var n=e[i],d=n.levelCodec||n.codec,l=n.container+";codecs="+d;s.b.log("creating sourceBuffer("+l+")");try{var u=t[i]=r.addSourceBuffer(l);u.addEventListener("updateend",this.onsbue),u.addEventListener("error",this.onsbe),this.tracks[i]={codec:d,container:n.container},n.buffer=u}catch(c){s.b.error("error while trying to add sourceBuffer:"+c.message),this.hls.trigger(o.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:c,mimeType:l})}}this.hls.trigger(o.a.BUFFER_CREATED,{tracks:e})},t.prototype.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},t.prototype.onBufferAppendFail=function(e){s.b.error("sourceBuffer error:",e.event),this.hls.trigger(o.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.BUFFER_APPENDING_ERROR,fatal:!1})},t.prototype.onBufferEos=function(e){var t=this.sourceBuffer,r=e.type;for(var i in t)r&&i!==r||t[i].ended||(t[i].ended=!0,s.b.log(i+" sourceBuffer now EOS"));this.checkEos()},t.prototype.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var i=e[r];if(!i.ended)return;if(i.updating)return void(this._needsEos=!0)}s.b.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(n){s.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},t.prototype.onBufferFlushing=function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()},t.prototype.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._live=t.live,this.updateMediaElementDuration())},t.prototype.updateMediaElementDuration=function(){var e,t=this.hls.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var r in this.sourceBuffer)if(!0===this.sourceBuffer[r].updating)return;e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(s.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=Infinity):(this._levelDuration>this._msDuration&&this._levelDuration>e||e===Infinity||isNaN(e))&&(s.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},t.prototype.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var i in r)t+=r[i].buffered.length}catch(n){s.b.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(o.a.BUFFER_FLUSHED)}},t.prototype.doAppending=function(){var e=this.hls,t=this.sourceBuffer,r=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void s.b.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(r&&r.length){var i=r.shift();try{var n=t[i.type];n?n.updating?r.unshift(i):(n.ended=!1,this.parent=i.parent,n.appendBuffer(i.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(l){s.b.error("error while trying to append buffer:"+l.message),r.unshift(i);var d={type:a.b.MEDIA_ERROR,parent:i.parent};22!==l.code?(this.appendError?this.appendError++:this.appendError=1,d.details=a.a.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry?(s.b.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),r=[],d.fatal=!0,e.trigger(o.a.ERROR,d)):(d.fatal=!1,e.trigger(o.a.ERROR,d))):(this.segments=[],d.details=a.a.BUFFER_FULL_ERROR,d.fatal=!1,e.trigger(o.a.ERROR,d))}}}},t.prototype.flushBuffer=function(e,t,r){var i=void 0,n=void 0,a=void 0,o=void 0,d=void 0,l=void 0,u=this.sourceBuffer;if(Object.keys(u).length){if(s.b.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var c in u)if(!r||c===r){if((i=u[c]).ended=!1,i.updating)return s.b.warn("cannot flush, sb updating in progress"),!1;try{for(n=0;n<i.buffered.length;n++)if(a=i.buffered.start(n),o=i.buffered.end(n),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(d=e,l=t):(d=Math.max(a,e),l=Math.min(o,t)),Math.min(l,o)-d>.5)return this.flushBufferCounter++,s.b.log("flush "+c+" ["+d+","+l+"], of ["+a+","+o+"], pos:"+this.media.currentTime),i.remove(d,l),!1}catch(h){s.b.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else s.b.warn("abort flushing too many retries");s.b.log("buffer flushed")}return!0},t}(u),we=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var Se=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r,o.a.FPS_DROP_LEVEL_CAPPING,o.a.MEDIA_ATTACHING,o.a.MANIFEST_PARSED,o.a.BUFFER_CODECS));return i.autoLevelCapping=Number.POSITIVE_INFINITY,i.firstLevel=null,i.levels=[],i.media=null,i.restrictedLevels=[],i.timer=null,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this._stopCapping())},t.prototype.onFpsDropLevelCapping=function(e){t.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},t.prototype.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},t.prototype.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&(e.video||e.levels.length&&e.altAudio)&&this._startCapping()},t.prototype.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this._startCapping()},t.prototype.onLevelsUpdated=function(e){this.levels=e.levels},t.prototype.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},t.prototype.getMaxLevel=function(e){var r=this;if(!this.levels)return-1;var i=this.levels.filter(function(i,n){return t.isLevelAllowed(n,r.restrictedLevels)&&n<=e});return t.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},t.prototype._startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},t.prototype._stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},t.isLevelAllowed=function(e){return-1===(arguments.length>1&&arguments[1]!==undefined?arguments[1]:[]).indexOf(e)},t.getMaxLevelByMediaSize=function(e,t,r){if(!e||e&&!e.length)return-1;for(var i,n,a=e.length-1,o=0;o<e.length;o+=1){var s=e[o];if((s.width>=t||s.height>=r)&&(i=s,!(n=e[o+1])||i.width!==n.width||i.height!==n.height)){a=o;break}}return a},we(t,[{key:"mediaWidth",get:function(){var e=void 0,r=this.media;return r&&(e=r.width||r.clientWidth||r.offsetWidth,e*=t.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0,r=this.media;return r&&(e=r.height||r.clientHeight||r.offsetHeight,e*=t.contentScaleFactor),e}}],[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(t){}return e}}]),t}(u);var Re=window.performance,De=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r,o.a.MEDIA_ATTACHING))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},t.prototype.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},t.prototype.checkFPS=function(e,t,r){var i=Re.now();if(t){if(this.lastTime){var n=i-this.lastTime,a=r-this.lastDroppedFrames,d=t-this.lastDecodedFrames,l=1e3*a/n,u=this.hls;if(u.trigger(o.a.FPS_DROP,{currentDropped:a,currentDecoded:d,totalDroppedFrames:r}),l>0&&a>u.config.fpsDroppedMonitoringThreshold*d){var c=u.currentLevel;s.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(-1===u.autoLevelCapping||u.autoLevelCapping>=c)&&(c-=1,u.trigger(o.a.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:u.currentLevel}),u.autoLevelCapping=c,u.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},t.prototype.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},t}(u);var Le=window,Ce=Le.performance,xe=Le.XMLHttpRequest,Ie=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return e.prototype.destroy=function(){this.abort(),this.loader=null},e.prototype.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},e.prototype.load=function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:Ce.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},e.prototype.loadInternal=function(){var e=void 0,t=this.context;e=this.loader=new xe;var r=this.stats;r.tfirst=0,r.loaded=0;var i=this.xhrSetup;try{if(i)try{i(e,t.url)}catch(n){e.open("GET",t.url,!0),i(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(n){return void this.callbacks.onError({code:e.status,text:n.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},e.prototype.readystatechange=function(e){var t=e.currentTarget,r=t.readyState,i=this.stats,n=this.context,a=this.config;if(!i.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===i.tfirst&&(i.tfirst=Math.max(Ce.now(),i.trequest)),4===r){var o=t.status;if(o>=200&&o<300){i.tload=Math.max(i.tfirst,Ce.now());var d=void 0,l=void 0;l="arraybuffer"===n.responseType?(d=t.response).byteLength:(d=t.responseText).length,i.loaded=i.total=l;var u={url:t.responseURL,data:d};this.callbacks.onSuccess(u,i,n,t)}else i.retry>=a.maxRetry||o>=400&&o<499?(s.b.error(o+" while loading "+n.url),this.callbacks.onError({code:o,text:t.statusText},n,t)):(s.b.warn(o+" while loading "+n.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),i.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)},e.prototype.loadtimeout=function(){s.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},e.prototype.loadprogress=function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var i=this.callbacks.onProgress;i&&i(r,this.context,null,t)},e}(),ke=(r(3),"undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null),Pe={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:undefined,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:undefined,liveMaxLatencyDuration:undefined,liveDurationInfinity:!1,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:undefined,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Ie,fLoader:undefined,pLoader:undefined,xhrSetup:undefined,licenseXhrSetup:undefined,abrController:Te,bufferController:be,capLevelController:Se,fpsController:De,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:undefined,requestMediaKeySystemAccessFunc:ke};var Oe=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();r(13);var Ne=function(){function e(){var t=this,r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=e.DefaultConfig;if((r.liveSyncDurationCount||r.liveMaxLatencyDurationCount)&&(r.liveSyncDuration||r.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var n in i)n in r||(r[n]=i[n]);if(r.liveMaxLatencyDurationCount!==undefined&&r.liveMaxLatencyDurationCount<=r.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(r.liveMaxLatencyDuration!==undefined&&(r.liveMaxLatencyDuration<=r.liveSyncDuration||r.liveSyncDuration===undefined))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(s.a)(r.debug),this.config=r,this._autoLevelCapping=-1;var a=this.observer=new j.a;a.trigger=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];a.emit.apply(a,[e,e].concat(r))},a.off=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];a.removeListener.apply(a,[e].concat(r))},this.on=a.on.bind(a),this.off=a.off.bind(a),this.once=a.once.bind(a),this.trigger=a.trigger.bind(a);var o=this.abrController=new r.abrController(this),d=new r.bufferController(this),l=new r.capLevelController(this),u=new r.fpsController(this),c=new I(this),h=new k(this),f=new P(this),p=new ye(this),v=this.levelController=new fe(this),y=new U(this),g=[v,this.streamController=new le(this,y)],m=r.audioStreamController;m&&g.push(new m(this,y)),this.networkControllers=g;var E=[c,h,f,o,d,l,u,p,y];if(m=r.audioTrackController){var _=new m(this);this.audioTrackController=_,E.push(_)}if(m=r.subtitleTrackController){var T=new m(this);this.subtitleTrackController=T,E.push(T)}if(m=r.emeController){var A=new m(this);this.emeController=A,E.push(A)}[r.subtitleStreamController,r.timelineController].forEach(function(e){e&&E.push(new e(t))}),this.coreComponents=E}return e.isSupported=function(){return e=W(),t=window.SourceBuffer||window.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove,!!r&&!!i;var e,t,r,i},Oe(e,null,[{key:"version",get:function(){return"0.10.1"}},{key:"Events",get:function(){return o.a}},{key:"ErrorTypes",get:function(){return a.b}},{key:"ErrorDetails",get:function(){return a.a}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:Pe},set:function(t){e.defaultConfig=t}}]),e.prototype.destroy=function(){s.b.log("destroy"),this.trigger(o.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1},e.prototype.attachMedia=function(e){s.b.log("attachMedia"),this.media=e,this.trigger(o.a.MEDIA_ATTACHING,{media:e})},e.prototype.detachMedia=function(){s.b.log("detachMedia"),this.trigger(o.a.MEDIA_DETACHING),this.media=null},e.prototype.loadSource=function(e){e=n.a.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),s.b.log("loadSource:"+e),this.url=e,this.trigger(o.a.MANIFEST_LOADING,{url:e})},e.prototype.startLoad=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:-1;s.b.log("startLoad("+e+")"),this.networkControllers.forEach(function(t){t.startLoad(e)})},e.prototype.stopLoad=function(){s.b.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},e.prototype.swapAudioCodec=function(){s.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},e.prototype.recoverMediaError=function(){s.b.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)},Oe(e,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){s.b.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){s.b.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){s.b.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){s.b.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){s.b.log("set startLevel:"+e);-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){s.b.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,i=0;i<r;i++){if((e[i].realBitrate?Math.max(e[i].realBitrate,e[i].bitrate):e[i].bitrate)>t)return i}return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),e}();t["default"]=Ne},function(e,t,r){function i(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var i=r(r.s=ENTRY_MODULE);return i["default"]||i}var n="[\\.|\\-|\\+|\\w|/|@]+",a="\\((/\\*.*?\\*/)?s?.*?("+n+").*?\\)";function o(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function s(e,t,i){var s={};s[i]=[];var d=t.toString(),l=d.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!l)return s;for(var u,c=l[1],h=new RegExp("(\\\\n|\\W)"+o(c)+a,"g");u=h.exec(d);)"dll-reference"!==u[3]&&s[i].push(u[3]);for(h=new RegExp("\\("+o(c)+'\\("(dll-reference\\s('+n+'))"\\)\\)'+a,"g");u=h.exec(d);)e[u[2]]||(s[i].push(u[1]),e[u[2]]=r(u[1]).m),s[u[2]]=s[u[2]]||[],s[u[2]].push(u[4]);return s}function d(e){return Object.keys(e).reduce(function(t,r){return t||e[r].length>0},!1)}e.exports=function(e,t){t=t||{};var n={main:r.m},a=t.all?{main:Object.keys(n)}:function(e,t){for(var r={main:[t]},i={main:[]},n={main:{}};d(r);)for(var a=Object.keys(r),o=0;o<a.length;o++){var l=a[o],u=r[l].pop();if(n[l]=n[l]||{},!n[l][u]&&e[l][u]){n[l][u]=!0,i[l]=i[l]||[],i[l].push(u);for(var c=s(e,e[l][u],l),h=Object.keys(c),f=0;f<h.length;f++)r[h[f]]=r[h[f]]||[],r[h[f]]=r[h[f]].concat(c[h[f]])}}return i}(n,e),o="";Object.keys(a).filter(function(e){return"main"!==e}).forEach(function(e){for(var t=0;a[e][t];)t++;a[e].push(t),n[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",o=o+"var "+e+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a[e].map(function(t){return JSON.stringify(t)+": "+n[e][t].toString()}).join(",")+"});\n"}),o=o+"("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a.main.map(function(e){return JSON.stringify(e)+": "+n.main[e].toString()}).join(",")+"})(self);";var l=new window.Blob([o],{type:"text/javascript"});if(t.bare)return l;var u=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(l),c=new window.Worker(u);return c.objectURL=u,c}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(9),n=r(1),a=r(0),o=r(6),s=r.n(o);t["default"]=function(e){var t=new s.a;t.trigger=function(e){for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];t.emit.apply(t,[e,e].concat(i))},t.off=function(e){for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];t.removeListener.apply(t,[e].concat(i))};var r=function(t,r){e.postMessage({event:t,data:r})};e.addEventListener("message",function(n){var o=n.data;switch(o.cmd){case"init":var s=JSON.parse(o.config);e.demuxer=new i.a(t,o.typeSupported,s,o.vendor);try{Object(a.a)(!0===s.debug)}catch(d){console.warn("demuxerWorker: unable to enable logs")}r("init",null);break;case"demux":e.demuxer.push(o.data,o.decryptdata,o.initSegment,o.audioCodec,o.videoCodec,o.timeOffset,o.discontinuity,o.trackSwitch,o.contiguous,o.duration,o.accurateTimeOffset,o.defaultInitPTS)}}),t.on(n.a.FRAG_DECRYPTED,r),t.on(n.a.FRAG_PARSING_INIT_SEGMENT,r),t.on(n.a.FRAG_PARSED,r),t.on(n.a.ERROR,r),t.on(n.a.FRAG_PARSING_METADATA,r),t.on(n.a.FRAG_PARSING_USERDATA,r),t.on(n.a.INIT_PTS_FOUND,r),t.on(n.a.FRAG_PARSING_DATA,function(t,r){var i=[],n={event:t,data:r};r.data1&&(n.data1=r.data1.buffer,i.push(r.data1.buffer),delete r.data1),r.data2&&(n.data2=r.data2.buffer,i.push(r.data2.buffer),delete r.data2),e.postMessage(n,i)})}},function(e,t){String.prototype.endsWith||function(){"use strict";var e=function(){try{var e={},t=Object.defineProperty,r=t(e,e,e)&&t}catch(i){}return r}(),t={}.toString,r=function(e){if(null==this)throw TypeError();var r=String(this);if(e&&"[object RegExp]"==t.call(e))throw TypeError();var i=r.length,n=String(e),a=n.length,o=i;if(arguments.length>1){var s=arguments[1];s!==undefined&&(o=s?Number(s):0)!=o&&(o=0)}var d=Math.min(Math.max(o,0),i)-a;if(d<0)return!1;for(var l=-1;++l<a;)if(r.charCodeAt(d+l)!=n.charCodeAt(l))return!1;return!0};e?e(String.prototype,"endsWith",{value:r,configurable:!0,writable:!0}):String.prototype.endsWith=r}()}])["default"]},e.exports=i()},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=r(69),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"requestVideoUrlsByVid",value:function(e){var t=this;e=e||{};var r=function(e){if("string"==typeof e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host+t.pathname}},i=function(e){var t=[];for(var r in e)t.push(r+"="+e[r]);return t.join("&")},a=function(e){var t="";try{window.localStorage&&(t=window.localStorage[e])}catch(r){}return t},o=function(e){e=e||10;var t=parseInt(+new Date)+"";if(t.length===e)return t;if(t.length>e)return t.substring(0,e);for(var r=e-t.length;r>0;)t="0"+t,r--;return t}(),s=(new Date).getDay(),d="7."+(0==s?7:s),l=n.$xx("10201",e.vid,"v1010",1,o,d),u="";try{u=location.href.replace(location.search,"")}catch(y){}var c=window!=top?r(document.referrer||""):document.location.host,h=function(r){if(r&&0==r.errCode&&r.vinfo){var i,n,a;try{i=JSON.parse(r.vinfo)}catch(y){console.log("requestVideoUrlsByVid parse json:",y)}i&&"o"==i.s&&i.vl&&i.vl.vi&&(3==i.dltype||8==i.dltype?(n=t.parseHls(i),a="hls"):1==i.dltype&&(n=t.parseMp4(i,{guid:e.guid}),a="mp4")),e.onSucc({urls:n.urls,m3u8:n.m3u8,type:a})}else e.onFail()},f="//vd.l.qq.com/proxyhttp",p={buid:"onlyvinfo",vinfoparam:i({appVer:"3.5.57",cKey:l,charge:0,defaultfmt:"auto",defn:"",defnpayver:0,defsrc:2,dtype:3,ehost:r(u),encryptVer:d,fhdswitch:0,flowid:e.flowid,guid:e.guid,host:c,isHLS:1,onlyGetinfo:!0,otype:"ojson",platform:"10201",refer:u,sdtfrom:"v1010",show1080p:0,sphttps:"https:"===location.protocol?1:0,spwm:4,tm:o,unid:a("txp-unid"),vid:e.vid,sphls:2,spgzip:1,dlver:2})};if(window.$&&window.$.ajax)$.ajax({method:"GET",type:"GET",url:f,crossDomain:!0,xhrFields:{withCredentials:!0},timeout:8e3,dataType:"jsonp",contentType:"application/javascript",data:p}).done(function(e){h(e)}).fail(function(t,r){e.onFail({err:r})});else{var v=new XMLHttpRequest;v.open("POST",f,!0),v.responseType="text",v.timeout="8000",v.withCredentials=!0,v.setRequestHeader("Content-type","text/plain"),v.send(JSON.stringify(p)),v.onload=function(){if(200===v.status&&v.response){var t;try{t=JSON.parse(v.response)}catch(y){console.log("requestVideoUrlsByVid parse json:",y)}h(t)}else e.onFail()},v.onerror=function(t){e.onFail({err:t})}}}},{key:"parseHls",value:function(e){var t=[],r=void 0,i=e.vl.vi[0]||void 0;if(i&&i.ul&&i.ul.ui&&i.ul.ui.length)for(var n,a=0,o=i.ul.ui.length;a<o;a++)(n=i.ul.ui[a]).url&&n.hls&&n.hls.pt?t.push(n.url+n.hls.pt):8==e.dltype&&t.push(n.url);return 8===e.dltype&&i&&i.ul&&(r=i.ul.m3u8),{urls:t,m3u8:r}}},{key:"parseMp4",value:function(e,t){var r,i=[],n=e.vl.vi[0]||void 0,a=n.cl.fc;if(!n.cl.ci&&n.fvkey&&n.fn&&n.ul&&n.ul.ui&&n.ul.ui.length)return i;if(!n.cl.ci||a!==n.cl.ci.length)return i;t.vkey=n.fvkey;for(var o=0;o<a;o++){r=this.getSplitFileName(n.fn,o+1),i=this.getInfoPath(n.ul,n.lnk,r,t);break}return{urls:i}}},{key:"getSplitFileName",value:function(e,t){if(0===t)return e;var r=e.lastIndexOf(".");return e.substr(0,r)+"."+t+e.substring(r)}},{key:"getInfoPath",value:function(e,t,r,i){for(var n=[],a={},o={},s=e.ui.length,d=0;d<s;d++)if(o={},(a=e.ui[d]).url){a.url&&-1===a.url.indexOf(t+".flv")&&-1===a.url.indexOf(t+".mp4")?o.url=a.url+r:o.url=a.url,a.vt&&(o.vt=parseInt(a.vt));var l=o.url.indexOf("?")>-1?"&":"?";o.url+=l+"guid="+i.guid+"&sdtfrom=&vkey="+i.vkey,n.push(o.url)}return n}}]),e}();e.exports=a},function(e,t,r){"use strict";var i={};i.ha=function(e){for(var t=[],r=0;r<64;)t[r]=0|4294967296*Math.abs(Math.sin(++r));function i(e,t){return((e>>1)+(t>>1)<<1)+(1&e)+(1&t)}return function(e){for(var r,n,a,o,s=[],d=unescape(encodeURI(e)),l=d.length,u=[r=1732584193,n=-271733879,~r,~n],c=0;c<=l;)s[c>>2]|=(d.charCodeAt(c)||128)<<c++%4*8;for(s[e=16*(l+8>>6)+14]=8*l,c=0;c<e;c+=16){for(l=u,o=0;o<64;)l=[a=l[3],i(r=l[1],(a=i(i(l[0],[r&(n=l[2])|~r&a,a&r|~a&n,r^n^a,n^(r|~a)][l=o>>4]),i(t[o],s[[o,5*o+1,3*o+5,7*o][l]%16+c])))<<(l=[7,12,17,22,5,9,14,20,4,11,16,23,6,10,15,21][4*l+o++%4])|a>>>32-l),r,n];for(o=4;o;)u[--o]=i(u[o],l[o])}for(e="";o<32;)e+=(u[o>>3]>>4*(1^7&o++)&15).toString(16);return e}}(),i.stringToHex=function(e){for(var t="",r=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),i=0;i<e.length;i++)t+=r[e.charCodeAt(i)>>4]+r[15&e.charCodeAt(i)];return t},i.hexToString=function(e){for(var t="",r="0x"==e.substr(0,2)?2:0;r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},i._Seed="#$#@#*ad",i.tempcalc=function(e,t){for(var r="",i=0;i<e.length;i++)r+=String.fromCharCode(e.charCodeAt(i)^t.charCodeAt(i%4));return r},i.u1=function(e,t){for(var r="",i=t;i<e.length;i+=2)r+=e.charAt(i);return r},i._urlStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i.urlenc=function(e,t,r){for(var n,a,o,s,d,l,u,c="",h=0;h<e.length;)n=e.charCodeAt(h++),a=e.charCodeAt(h++),o=e.charCodeAt(h++),15==h&&(c+="A",c+=t,c+=r),s=n>>2,d=(3&n)<<4|a>>4,l=(15&a)<<2|o>>6,u=63&o,isNaN(a)?l=u=64:isNaN(o)&&(u=64),c=c+i._urlStr.charAt(s)+i._urlStr.charAt(d)+i._urlStr.charAt(l)+i._urlStr.charAt(u);return c},i.$xx=function(e,t,r,n,a,o){var s="123456";if(o.length<3)return"err";if("7."!=o.substr(0,2))return"err";var d=o.substr(2);"1"==d&&(s="06fc1464"),"2"==d&&(s="4244ce1b"),"3"==d&&(s="77de31c5"),"4"==d&&(s="e0149fa2"),"5"==d&&(s="60394ced"),"6"==d&&(s="2da639f0"),"7"==d&&(s="c2f0cf9f");a=a||parseInt(+new Date/1e3),n=(""+n).charAt(0);return i.ha(s+t+a+"*#06#"+e)},e.exports=i},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=r(5);e.exports=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lsKey="gp-cacdc",this.conf=t,this.$dom=r,this.reset(),this.bindPlayerEvent()}return i(e,[{key:"bindPlayerEvent",value:function(){var e=this;this._filmFirstPlayListener=function(){e.onFilmFirstPlayListener()},this.conf.playerMsg&&this.conf.playerMsg.on("filmFirstPlay",this._filmFirstPlayListener)}},{key:"onFilmFirstPlayListener",value:function(){if(!this.filmFirstPlay){this.filmFirstPlay=!0;var e=this.getLSValue();if(this.errorByADBlock&&0==e)this.setLSValue(1);else if(this.hasShow){var t=Math.min(4,e+1);this.setLSValue(t)}this.reset()}}},{key:"unBindPlayerEvent",value:function(){this.conf.playerMsg&&this._filmFirstPlayListener&&this.conf.playerMsg.off("filmFirstPlay",this._filmFirstPlayListener)}},{key:"onAdPlaying",value:function(){this.setLSValue(0)}},{key:"isNeedShow",value:function(e){if(!this.showing){var t=this.getLSValue();this.errorByADBlock&&1==t?this.startDowndown(e,30):this.errorByADBlock&&2==t?this.startDowndown(e,45):this.errorByADBlock&&t>=3?this.startDowndown(e,60):e()}}},{key:"startDowndown",value:function(e,t){var r=this;this.hasShow=!0,this.showing=!0;var i=t,a=this.$dom.querySelector(".txp_cac_black_screen_em");n.removeClass(this.$dom,"txp_none"),a.innerHTML=""+t,this.conf.playerMsg&&this.conf.playerMsg.broadcast("blackScreenEvt",{bc:this.getLSValue()}),this.startDowndownID=setInterval(function(){console.log("back screen>>",i),i>0?(i--,a.innerHTML=""+i):(r.startDowndownID>0&&(clearInterval(r.startDowndownID),r.startDowndownID=0),e(),n.addClass(r.$dom,"txp_none"),r.showing=!1)},1e3)}},{key:"reset",value:function(){this.unBindPlayerEvent(),this.filmFirstPlay=!1,this.errorByADBlock=!1,this.hasShow=!1,this.showing=!1,this.$dom&&n.addClass(this.$dom,"txp_none"),this.startDowndownID>0&&(clearInterval(this.startDowndownID),this.startDowndownID=0)}},{key:"getLSValue",value:function(){try{if(window.localStorage)return+window.localStorage.getItem(this.lsKey)}catch(e){return 0}return 0}},{key:"setLSValue",value:function(e){try{window.localStorage&&window.localStorage.setItem(this.lsKey,e)}catch(t){}}}]),e}()},function(e,t,r){"use strict";var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],i=!0,n=!1,a=undefined;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);i=!0);}catch(d){n=!0,a=d}finally{try{!i&&s["return"]&&s["return"]()}finally{if(n)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a=function h(e,t,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(i===undefined){var n=Object.getPrototypeOf(e);return null===n?undefined:h(n,t,r)}if("value"in i)return i.value;var a=i.get;return a===undefined?undefined:a.call(r)};var o=r(4),s=r(7),d=r(19),l=r(20),u=r(1),c=r(0)("base/embedAd");e.exports=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.message=e.message,r.ready=!0,r.loadStatus=!1,r.startTime=new Date,r.getRes(),r.write(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s),n(t,[{key:"getRes",value:function(){var e=this.info.creative||[];if(!e.length)return{};var t=e[0],r=t.material&&t.material.length&&t.material[0]||{};this.material=r}},{key:"write",value:function(){var e=this;this.$dom&&Promise.all([this.loadRes(),l()]).then(function(r){var n=i(r,2),o=(n[0],n[1]);e.$dom.html(e.generateDom(o[e.info.adtype])),e.show(),"PVL"===e.info.adtype&&e.message.emit(u.REPORT_EVENT.AD_VIEW,{adInfo:e.info}),e.firstview=parseInt(window.performance.now(),10),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_loadReadyHandler",e).call(e)})["catch"](function(t){c.log(t),e.destroy()})}},{key:"loadRes",value:function(){var e=this;return this.material.url?(this.imageMaterial=new d({url:this.material.url}),new Promise(function(t,r){e.imageMaterial.load().then(function(r){var i=new Date;e.message.emit(u.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:e.info,adload:i-e.startTime,tpindex:1,oid:e.info.order_id}),e.loadStatus=!0,t(r)})["catch"](function(){e.message.emit(u.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:e.info,errorcode:2301}),r("image load failed")})})):Promise.reject("no url")}},{key:"generateDom",value:function(e){var t="",r=this.material.url,i=this.info.adtype,n="1"==e?"":"txp_none";switch(i){case"PPB":t='\n                    <img src="'+r+'" class="">\n                    <txpdiv class="txp_ad_mark '+n+'">\u5e7f\u544a</txpdiv>\n                ';break;case"PVL":t='\n                    <img src="'+r+'" width="200" class="txp_img">\n                    <txpdiv class="txp_ad_mark '+n+'">\u5e7f\u544a</txpdiv>\n                ';break;case"PDF":var a=this.info.extParams&&this.info.extParams.richdata;if(!a){var o=this.info.extParams&&Object.keys(this.info.extParams)[0];a=o&&decodeURIComponent(o)||"";try{a=Txplayer.util.getUrlParam("richdata",a),a=JSON.parse(a)}catch(s){a={}}}t='\n                    <img src="'+r+'" class="txp_definition_ad" style="width: 40px; height: 23px;">\n                    <txpdiv class="txp_definition_ad_text">'+(a.plugins&&a.plugins.title||"")+'</txpdiv>\n                    <txpdiv class="txp_ad_mark '+n+'">\u5e7f\u544a</txpdiv>\n                '}return t}},{key:"play",value:function(){this.show()}},{key:"stop",value:function(e){this.state!=o.END&&(this.hide(),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"stop",this).call(this,e))}},{key:"show",value:function(){this.isShow||(this.$dom&&this.$dom.removeClass("txp_none"),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"show",this).call(this))}},{key:"hide",value:function(){this.isShow&&(this.$dom&&(this.$dom.addClass("txp_none"),this.material&&this.material.url&&(this.message.emit(u.REPORT_EVENT.AD_END,{adInfo:this.info,adtt:new Date-this.startTime,firstview:this.firstview}),this.material=null)),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"hide",this).call(this))}},{key:"destroy",value:function(){this.imageMaterial&&this.imageMaterial.destroy(),this.stop()}}]),t}()},function(e,t,r){"use strict";var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function l(e,t,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(i===undefined){var n=Object.getPrototypeOf(e);return null===n?undefined:l(n,t,r)}if("value"in i)return i.value;var a=i.get;return a===undefined?undefined:a.call(r)};var a=r(0)("base/zcAd"),o=r(1),s=r(5),d=r(17);e.exports=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._name=e._name,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,d),i(t,[{key:"_loadReadyHandler",value:function(e){n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_loadReadyHandler",this).call(this,e),this.startEnterCountdown(e)}},{key:"stop",value:function(e){n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"stop",this).call(this,e),s.text(this.$dom.$enterCountdown.$countdownNum,""),s.hide(this.$dom.$enterCountdown.$countdown),s.hide(this.$dom.$enterCountdown.layer),clearInterval(this.enterCountdownTimer)}},{key:"startEnterCountdown",value:function(e){var t=10,r=this,i=this.$dom.$enterCountdown.$countdown,n=this.$dom.$enterCountdown.$countdownNum;s.text(n,t),"VipDisplay"!=e.displayCode&&s.show(i),s.show(this.$dom.$enterCountdown.layer),this.message.emit(o.TXPLAYER_EVENT.AD_ENTER_COUNTDOWN,e),this.enterCountdownTimer=setInterval(function(){(t-=1)>=0&&s.text(n,t),0==t&&(clearInterval(r.enterCountdownTimer),s.text(n,""),s.hide(i),s.hide(r.$dom.$enterCountdown.layer),r.message.emit(o.TXPLAYER_EVENT.AD_ENTER_COUNTDOWN_COMPLETE,e)),a.log("\u4e2d\u63d2\u5f00\u59cb\u5012\u8ba1\u65f6\uff1a",t)},1e3)}}]),t}()},function(e,t,r){"use strict";r(0)("base/endingAd");var i=r(17);e.exports=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._name=e._name,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i),t}()}]);
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(140)},47:function(a,b){!function(a){function b(c){var d=[["resolve","done",a.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",a.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",a.Callbacks({memory:1})]],e="pending",f={state:function(){return e},always:function(){return g.done(arguments).fail(arguments),this},then:function(){var c=arguments;return b(function(b){a.each(d,function(d,e){var h=a.isFunction(c[d])&&c[d];g[e[1]](function(){var c=h&&h.apply(this,arguments);if(c&&a.isFunction(c.promise))c.promise().done(b.resolve).fail(b.reject).progress(b.notify);else{var d=this===f?b.promise():this,g=h?[c]:arguments;b[e[0]+"With"](d,g)}})}),c=null}).promise()},promise:function(b){return null!=b?a.extend(b,f):f}},g={};return a.each(d,function(a,b){var c=b[2],h=b[3];f[b[1]]=c.add,h&&c.add(function(){e=h},d[1^a][2].disable,d[2][2].lock),g[b[0]]=function(){return g[b[0]+"With"](this===g?f:this,arguments),this},g[b[0]+"With"]=c.fireWith}),f.promise(g),c&&c.call(g,g),g}if("function"!=typeof a.Deferred){var c=Array.prototype.slice;a.when=function(d){var e,f,g,h=c.call(arguments),i=h.length,j=0,k=1!==i||d&&a.isFunction(d.promise)?i:0,l=1===k?d:b(),m=function(a,b,d){return function(f){b[a]=this,d[a]=arguments.length>1?c.call(arguments):f,d===e?l.notifyWith(b,d):--k||l.resolveWith(b,d)}};if(i>1)for(e=new Array(i),f=new Array(i),g=new Array(i);j<i;++j)h[j]&&a.isFunction(h[j].promise)?h[j].promise().done(m(j,g,h)).fail(l.reject).progress(m(j,f,e)):--k;return k||l.resolveWith(g,h),l.promise()},a.Deferred=b}}(Zepto)},48:function(a,b){!function(a){"function"!=typeof a.Callbacks&&(a.Callbacks=function(b){b=a.extend({},b);var c,d,e,f,g,h,i=[],j=!b.once&&[],k=function(a){for(c=b.memory&&a,d=!0,h=f||0,f=0,g=i.length,e=!0;i&&h<g;++h)if(i[h].apply(a[0],a[1])===!1&&b.stopOnFalse){c=!1;break}e=!1,i&&(j?j.length&&k(j.shift()):c?i.length=0:l.disable())},l={add:function(){if(i){var d=i.length,h=function(c){a.each(c,function(a,c){"function"==typeof c?b.unique&&l.has(c)||i.push(c):c&&c.length&&"string"!=typeof c&&h(c)})};h(arguments),e?g=i.length:c&&(f=d,k(c))}return this},remove:function(){return i&&a.each(arguments,function(b,c){for(var d;(d=a.inArray(c,i,d))>-1;)i.splice(d,1),e&&(d<=g&&--g,d<=h&&--h)}),this},has:function(b){return!(!i||!(b?a.inArray(b,i)>-1:i.length))},empty:function(){return g=i.length=0,this},disable:function(){return i=j=c=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,c||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return!i||d&&!j||(b=b||[],b=[a,b.slice?b.slice():b],e?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments)},fired:function(){return!!d}};return l})}(Zepto)},49:function(a,b){!function(a){function b(){}function c(a){g=[a]}function d(a,b,c){return a&&a.apply(b.context||b,c)}function e(a){return/\?/.test(a)?"&":"?"}function f(f){function n(a){X++||(Y(),S&&(A[U]={s:[a]}),O&&(a=O.apply(f,[a])),d(L,f,[a,v,f]),d(N,f,[f,v]))}function F(a){X++||(Y(),S&&a!=w&&(A[U]=a),d(M,f,[f,a]),d(N,f,[f,a]))}f=a.extend({},C,f);var G,H,I,J,K,L=f.success,M=f.error,N=f.complete,O=f.dataFilter,P=f.callbackParameter,Q=f.callback,R=f.cache,S=f.pageCache,T=f.charset,U=f.url,V=f.data,W=f.timeout,X=0,Y=b;return y&&y(function(a){a.done(L).fail(M),L=a.resolve,M=a.reject}).promise(f),f.abort=function(){!X++&&Y()},d(f.beforeSend,f,[f])===!1||X?f:(U=U||j,V=V?"string"==typeof V?V:a.param(V,f.traditional):j,U+=V?e(U)+V:j,P&&(U+=e(U)+encodeURIComponent(P)+"=?"),!R&&!S&&(U+=e(U)+"_"+(new Date).getTime()+"="),U=U.replace(/=\?(&|$)/,"="+Q+"$1"),S&&(G=A[U])?G.s?n(G.s[0]):F(G):(x[Q]=c,I=a(u)[0],I.id=m+B++,T&&(I[i]=T),D&&D.version()<11.6?(J=a(u)[0]).text="document.getElementById('"+I.id+"')."+p+"()":I[h]=h,E&&(I.htmlFor=I.id,I.event=o),I[q]=I[p]=I[r]=function(a){if(!I[s]||!/i/.test(I[s])){try{I[o]&&I[o]()}catch(b){}a=g,g=0,a?n(a[0]):F(k)}},I.src=U,Y=function(a){K&&clearTimeout(K),I[r]=I[q]=I[p]=null,z[t](I),J&&z[t](J)},z[l](I,H=z.firstChild),J&&z[l](J,H),K=W>0&&setTimeout(function(){F(w)},W)),f)}var g,h="async",i="charset",j="",k="error",l="insertBefore",m="_jqjsp",n="on",o=n+"click",p=n+k,q=n+"load",r=n+"readystatechange",s="readyState",t="removeChild",u="<script>",v="success",w="timeout",x=window,y=a.Deferred,z=a("head")[0]||document.documentElement,A={},B=0,C={callback:m,url:location.href},D=x.opera,E=!!a("<div>").html("<!--[if IE]><i><![endif]-->").find("i").length;f.setup=function(b){a.extend(C,b)},a.jsonp=f}(Txplayer.$)},140:function(a,b,c){function d(a){return i=Txplayer.$,this.dataset={},this.context=a,!h.mobile&&window.jQuery&&c(144),i.Deferred||c(47),i.Callbacks||c(48),i.jsonp||c(49),this.context.config.createPlayerAfterCssLoaded?this.init():void this.init()}var e=c(141),f=c(142),g=c(143),h=Txplayer.util,i=Txplayer.$;d.prototype={init:function(){return this.dataset.defer=Txplayer.$.Deferred(),Txplayer.dataset.pluginsPreload&&!this.context.config.containerId?(this.dataset.defer.reject(),this.dataset.defer):this.context.config.containerId?(this.dataset.$container=i("#"+this.context.config.containerId),this.dataset.ipadClass="txp_player_pad",this.dataset.miniSkinClass="txp_player_desktop_mini",this.dataset.v4MiniSkinClass="txp_player_mini",this.dataset.v4XsSkinClass="txp_player_xs",this.context.dataset.isWindowFocus=!0,this.dataset.$container&&this.dataset.$container.length?(this.loadHTML5PlayerSkin(),this.write(),this.exportsModuleApis(),void this.addEventListener()):(h.showError("[HtmlFrame\u521d\u59cb\u5316\u9519\u8bef]","\u6ca1\u627e\u5230id="+this.context.config.containerId+"\u7684dom\u8282\u70b9!"),this.dataset.defer.reject(),this.dataset.defer)):(h.showError("[HtmlFrame\u521d\u59cb\u5316\u9519\u8bef]","\u53c2\u6570containerId\u6ca1\u627e\u5230!"),this.dataset.defer.reject(),this.dataset.defer)},getModStyle:function(){function a(a){return a=a||"100%","number"==typeof a?parseInt(a)+"px":"string"==typeof a?a.indexOf("%")>-1?a:parseInt(a)+"px":a}var b=[];return b.push("width:"+a(this.context.config.width)),b.push("height:"+a(this.context.config.height)),b.join(";")},loadHTML5PlayerSkin:function(){if("flash"===this.context.config.playerType)return void this.dataset.defer.resolve();if(!Txplayer.dataset.disableLoadTxplayerCss){var a,b=this;return(a=Txplayer.dataset.H5PlayerStyleUrl[this.context.config.playerType])?void h.loadCss(a).done(function(){b.dataset.defer.resolve()}).fail(function(){h.showError("\u627e\u4e0d\u5230\u64ad\u653e\u5668\u7684\u76ae\u80a4\u6837\u5f0f\u6587\u4ef6",Txplayer.dataset.HdPlayerStyleUrl)}):void b.dataset.defer.resolve()}},write:function(){var a=this.context.config.useSVG?1:Txplayer.$.inArray(this.context.config.playerType,["html5hd","nintendo","ipadh5","chromehls","safarihls"])>-1?1:0,b="flash"!==this.context.config.playerType?'tabindex="-1"':"";if(a){document.createElement("txpdiv")}var c={useSVG:a,ie:h.browser.ie,playerid:"txplayer_"+this.context.config.playerId,mod_stype:this.getModStyle(),tabindex:b,gradient_top:"txp-frame-gradient-top"};a&&0===Txplayer.$("body ._txplayer_svg_sprite").length&&Txplayer.$("body").append(Txplayer.$.tmpl(f,{}));var d,g=["HtmlFrame.write Error:"],i=this,j=function(){g=g.join("\n"),i.context.msg.broadcast(Txplayer.apiList.privateApi.reportError,{msg:g,code:Txplayer.define.reportCode.JS_ERROR,stack:d})};try{var k=Txplayer.$.tmpl(e,c);this.dataset.$container.html(k),this.dataset.$playermod=this.dataset.$container.find("#"+c.playerid),this.context.dataset.$playermod=this.dataset.$playermod,this.dataset.$gradientTop=this.dataset.$container.find('[data-role="'+c.gradient_top+'"]'),this.dataset.$gradientTop.addClass(Txplayer.dataset.hideClass),"v.qq.com"===location.hostname&&this.context.config.showLogo!==!0||this.dataset.$playermod.addClass("txp_player_external"),Txplayer.dataset.maxId++}catch(l){g.push(l.message),d=l.stack}return g.length>1?void j():("ipadh5"===this.context.config.playerType&&this.dataset.$playermod.addClass(this.dataset.ipadClass),this.dataset.defer.then(function(){i.updateMiniSkinClass()}),void this.context.msg.on("ready",function(){i.context.dataset.playerWidth=i.context.dataset.$playermod.width(),i.context.dataset.playerHeight=i.context.dataset.$playermod.height()}))},updateMiniSkinClass:function(){if(this.context.config.useMiniSkin)if("v4"===this.context.config.version){var a=this.context.dataset.$playermod.width(),b=this.context.dataset.$playermod.height();if(0===a&&0===b)return;b<=255||a<=400?this.dataset.$playermod.addClass(this.dataset.v4XsSkinClass).addClass(this.dataset.v4MiniSkinClass):b<=265||a<=470?this.dataset.$playermod.removeClass(this.dataset.v4XsSkinClass).addClass(this.dataset.v4MiniSkinClass):(this.dataset.$playermod.removeClass(this.dataset.v4XsSkinClass).removeClass(this.dataset.v4MiniSkinClass),this.context.config.useMiniSkin=!1)}else this.dataset.$playermod.addClass(this.dataset.miniSkinClass);else"v4"===this.context.config.version?this.dataset.$playermod.removeClass(this.dataset.v4XsSkinClass).removeClass(this.dataset.v4MiniSkinClass):this.dataset.$playermod.removeClass(this.dataset.miniSkinClass),this.context.config.useMiniSkin=!1},resize:function(a){"object"!==i.type(a)||i.isEmptyObject(a)||!a.hasOwnProperty("width")&&!a.hasOwnProperty("height")||(this.dataset.$playermod.css(a),this.context.dataset.playerWidth=this.dataset.$container.width(),this.context.dataset.playerHeight=this.dataset.$container.height(),this.broadCaseResizeMsg())},autoResize:function(a){a=a||"width";var b={width:this.context.dataset.videoWidth,height:this.context.dataset.videoHeight};if(!(b&&b.width&&b.height))return!1;if("width"===a){var c=this.dataset.$playermod.width();this.resize({height:parseInt(c*(b.height/b.width))})}else{var d=this.dataset.$playermod.height();this.resize({width:parseInt(d*(b.width/b.height))})}},broadCaseResizeMsg:function(){var a={width:this.context.dataset.$playermod.width(),height:this.context.dataset.$playermod.height()};this.context.dataset.playerWidth=a.width,this.context.dataset.playerHeight=a.height,this.context.msg.broadcast("resize",a);try{this.context.userMsg.broadcast("resize",a)}catch(b){}this.autoToggleMiniSkin()},autoToggleMiniSkin:function(){if(this.context.config.miniSkinAdaptive){var a=this,b=function(b){b!=a.context.config.useMiniSkin&&(a.context.config.useMiniSkin=b,a.updateMiniSkinClass(),a.context.msg.broadcast("miniSkinChange"))};if("v4"===this.context.config.version){var c=this.context.dataset.$playermod.width(),d=this.context.dataset.$playermod.height();if(0===c&&0===d)return;b(d<=255||c<=400||d<=265||c<=470?!0:!1)}else b(this.context.dataset.playerWidth<=470?!0:!1)}},destroy:function(a){h.v4log("destroy:",a);var b=this;if("all"===a)for(var c in Txplayer.dataset._instance)Txplayer.dataset._instance[c]&&"function"===Txplayer.$.type(Txplayer.dataset._instance[c].destroy)&&Txplayer.dataset._instance[c].destroy();else if("HtmlFrame"===a)Txplayer.$.each(this.dataset.moduleApis,function(a,c){b.context.msg.off(a,c)}),Txplayer.$.each(this,function(a,b){b=null});else if("string"===Txplayer.$.type(a))b.context.msg.broadcast("destroyPlugin",a);else{b.dataset.$container.html("");var d=b.context.dataset.playerId;b.context.msg.broadcast("destroyPlugin"),Txplayer.dataset._instance[d]&&(Txplayer.dataset._instance[d]=null,delete Txplayer.dataset._instance[d])}},getPlayerSize:function(){return{width:this.context.dataset.playerWidth,height:this.context.dataset.playerHeight}},isPlayerInScreen:function(){return!!h.isInScreen(this.dataset.$container)},isWindowFocus:function(){return this.context.dataset.isWindowFocus},addEventListener:function(){function a(){c.context.dataset.isWindowFullscreen||c.context.dataset.isBrowserFullscreen?(c.context.dataset.isControlShow&&c.dataset.$playermod.css({cursor:"auto"}),clearTimeout(b),b=setTimeout(function(){h.v4log("timeout hide mouse",c.context.dataset.isControlShow),!c.context.dataset.isWindowFullscreen&&!c.context.dataset.isBrowserFullscreen||c.context.dataset.isControlShow?c.dataset.$playermod.css({cursor:"auto"}):c.dataset.$playermod.css({cursor:"none"})},5e3)):c.dataset.$playermod.css({cursor:"auto"})}var b,c=this;this.dataset.$playermod.on("click",function(a){var b=a.target,d=i(b),e=d.attr("data-report");e||(e=d.parent().attr("data-report")),e||(e=d.parent().parent().attr("data-report")),e&&c.context.msg.broadcast("reportUsrAction",{usr_action:e});var f=d.attr("data-action");if(b.nodeName&&b.nodeName.toLowerCase&&"a"===b.nodeName.toLowerCase()&&f)if("openTxVideo"===f){var g=h.getTxVideoPageURLByVid(c.context.dataset.vid);g&&window.open(g)}else if("openVIP"===f){c.context.msg.broadcast("pause"),c.context.msg.broadcast("showUIVipGuide",{openvip:!0});try{c.context.userMsg.broadcast("showUIVipGuide",{openvip:!0})}catch(j){}}else if("shareVIP"===f)try{c.context.dataset.openAccountData&&c.context.dataset.openAccountData[d.attr("data-click")]&&c.context.userMsg.broadcast("playerEmitCommonMsg",{type:"accountBannedTip",data:c.context.dataset.openAccountData[d.attr("data-click")]})}catch(j){}else"clickTips"===f?c.context.msg.broadcast("uiTipsClicked",{type:"html5",target:a.target}):"customTips"===f?c.context.userMsg.broadcast("customTipsClicked",{target:a.target}):"refresh"==f&&window.location.reload()}).on("mousemove",a),i(document).on("show",function(){c.context.dataset.isWindowFocus=!0}),i(document).on("hide",function(){c.context.dataset.isWindowFocus=!1}),this.context.msg.on("windowFullscreenChange",function(b){c.dataset.playerFullScreenChangeTimer&&(clearTimeout(c.dataset.playerFullScreenChangeTimer),c.dataset.playerFullScreenChangeTimer=null),c.dataset.playerFullScreenChangeTimer=setTimeout(function(){c.broadCaseResizeMsg()},300),b?c.dataset.$gradientTop.removeClass(Txplayer.dataset.hideClass):c.dataset.$gradientTop.addClass(Txplayer.dataset.hideClass),a()}),this.context.msg.on("browserFullscreenChange",function(b){c.dataset.playerFullScreenChangeTimer&&(clearTimeout(c.dataset.playerFullScreenChangeTimer),c.dataset.playerFullScreenChangeTimer=null),c.dataset.playerFullScreenChangeTimer=setTimeout(function(){c.broadCaseResizeMsg()},100),b?c.dataset.$gradientTop.removeClass(Txplayer.dataset.hideClass):c.dataset.$gradientTop.addClass(Txplayer.dataset.hideClass),a()}),i(window).on("resize",function(){c.dataset.documentResizeTimer&&(clearTimeout(c.dataset.documentResizeTimer),c.dataset.documentResizeTimer=null),c.dataset.documentResizeTimer=setTimeout(function(){c.broadCaseResizeMsg()},150),c.dataset.psjResizeTimer&&(clearTimeout(c.dataset.psjResizeTimer),c.dataset.psjResizeTimer=null),c.dataset.psjResizeTimer=setTimeout(function(){c.broadCaseResizeMsg(),clearTimeout(c.dataset.psjResizeTimer)},600)}),this.context.msg.on(h.getUniqueMsgKey("videoPlay"),function(a){"film"!==a.playListType||c.dataset.hasTrigger||(c.dataset.hasTrigger=!0,c.broadCaseResizeMsg())}),this.context.msg.on(h.getUniqueMsgKey("beforeVideoPlay"),function(a){c.dataset.hasTrigger||(c.dataset.hasTrigger=!0,c.broadCaseResizeMsg())})},exportsModuleApis:function(){var a=this;this.dataset.moduleApis={},this.dataset.moduleApis.resize=function(){return a.resize.apply(a,arguments)},this.dataset.moduleApis.destroy=function(){return a.destroy.apply(a,arguments)},this.dataset.moduleApis.getPlayerSize=function(){return a.getPlayerSize.apply(a,arguments)},this.dataset.moduleApis.autoResize=function(){return a.autoResize.apply(a,arguments)},this.dataset.moduleApis.isPlayerInScreen=function(){return a.isPlayerInScreen.apply(a,arguments)},this.dataset.moduleApis.isWindowFocus=function(){return a.isWindowFocus.apply(a,arguments)},i.extend(this.context.userApi,this.dataset.moduleApis),this.dataset.dataApis={},this.dataset.dataApis.isPlayerInScreen=function(b,c){c.data=a.isPlayerInScreen()},i.each(this.dataset.dataApis,function(b,c){a.context.msg.setData(b,c)})}},Txplayer.v4errcode=g,Txplayer.register("HtmlFrame",d)},141:function(a,b){a.exports='<% if(!useSVG){ %>\n  <div class="txp_player" id="<%=playerid%>" style="<%=mod_stype%>">\n    <div style="width:1px;height:1px;display:block;-webkit-user-select: auto;user-select: auto;"></div>\n  </div>\n<% }else{%>\n  <txpdiv class="txp_player txp_player_desktop txp_autohide_progress" id="<%=playerid%>" style="<%=mod_stype%>" <%=tabindex%>>\n  <div style="width:1px;height:1px;display:block;-webkit-user-select: auto;user-select: auto;"></div>\n  <txpdiv class="txp_gradient_top" data-role="<%=gradient_top%>"></txpdiv>\n  <txpdiv class="txp_gradient_bottom"></txpdiv>\n  </txpdiv>\n<% } %>'},142:function(a,b){a.exports='<svg class="_txplayer_svg_sprite txp_svg_sprite" display="none" version="1.1" xmlns="http://www.w3.org/2000/svg">\n\n\t<symbol id="txp_svg_collect" viewBox="0 0 36 36">\n\t\t<path d="M32.5 26H29v3.5a1.5 1.5 0 0 1-3 0V26h-3.5a1.5 1.5 0 1 1 0-3H26v-3.469a1.5 1.5 0 1 1 3 0V23h3.5a1.5 1.5 0 1 1 0 3zm.319-11.407c-.139.684-.716 1.209-1.442 1.209a1.5 1.5 0 0 1-1.5-1.5c0-.083.035-.154.048-.234l-.014-.002c.243-1.122.145-2.386-.598-3.584-.655-1.055-2.288-2.461-3.803-2.461-2.045 0-3.443.622-4.661 1.806l-3.358 3.182-3.485-3.207c-1.113-1.054-3.172-1.786-4.736-1.786-1.259 0-2.803.987-3.654 2.57-.975 1.809-.986 4.04.755 5.962l11.116 9.485.001-.001 1.015.928c.02.019.041.035.06.054l.004.004-.001.001c.256.269.419.629.419 1.03a1.5 1.5 0 0 1-1.5 1.5c-.435 0-.819-.191-1.093-.487L4.46 18.931c-3.285-3.209-3.285-8.357-.049-11.52C5.998 5.857 8.116 5 10.371 5c2.257 0 4.374.856 5.963 2.411l1.153 1.128 1.152-1.128C20.227 5.856 22.345 5 24.602 5c2.256 0 4.374.856 5.962 2.411a7.992 7.992 0 0 1 2.283 7.187l-.028-.005z"/>\n\t</symbol>\n\t<symbol id="txp_svg_collected" viewBox="0 0 36 36">\n\t\t<path d="M27 14.5a9.5 9.5 0 0 0-9.5 9.5c0 1.515.364 2.941.994 4.211l-1.507 1.28L3.96 18.431C.675 15.222.675 10.074 3.911 6.911 5.498 5.357 7.616 4.5 9.871 4.5c2.257 0 4.374.856 5.963 2.411l1.153 1.128 1.152-1.128C19.727 5.356 21.845 4.5 24.102 4.5c2.256 0 4.374.856 5.962 2.411a7.99 7.99 0 0 1 1.755 8.912A9.445 9.445 0 0 0 27 14.5zm0 2a7.5 7.5 0 1 1 0 15 7.5 7.5 0 0 1 0-15zm-4.042 9.485l1.811 1.81c.054.082.09.172.161.244a1.45 1.45 0 0 0 1.075.421 1.44 1.44 0 0 0 1.067-.418c.066-.066.097-.148.147-.222l3.851-3.851a1.463 1.463 0 1 0-2.069-2.07l-3.008 3.007-.978-.978a1.455 1.455 0 0 0-2.057 2.057z"/>\n\t</symbol>\n\t<symbol id="txp_svg_share" viewBox="0 0 36 36">\n\t\t<path d="M32.946 23.601l.023.009C30.694 29.675 24.86 34 18 34 9.163 34 2 26.837 2 18c0-6.095 3.42-11.372 8.435-14.072a1.48 1.48 0 0 1 .982-.387 1.5 1.5 0 0 1 1.5 1.5c0 .557-.317 1.023-.767 1.282l.032.064C7.927 8.523 5 12.915 5 18c0 7.18 5.82 13 13 13 5.577 0 10.319-3.518 12.165-8.45l.047.017c.154-.665.722-1.171 1.434-1.171a1.5 1.5 0 0 1 1.5 1.5c0 .26-.084.492-.2.705zM32 14.5a1.5 1.5 0 1 1-3 0V9.086l-9.455 9.455a1.498 1.498 0 0 1-2.117-2.117L26.852 7H21.5a1.5 1.5 0 0 1 0-3h8.929a1.47 1.47 0 0 1 .64.115c.546.224.931.758.931 1.385v9z"/>\n\t</symbol>\n\t<symbol id="txp_svg_play" viewBox="0 0 36 36">\n\t\t<path d="M25.8 18c0 .6-.3 1.1-.8 1.3L12.5 27c-.2.1-.5.2-.8.2-.8 0-1.5-.6-1.5-1.5V10c0-.8.7-1.5 1.5-1.5.3 0 .5.1.8.2l12.7 7.9c.4.5.6.9.6 1.4z"/>\n\t</symbol>\n\t<symbol id="txp_svg_replay" viewBox="0 0 36 36">\n\t\t<path d="M17.9 28c-4.9 0-9-3.6-9.8-8.3V19.4c0-.8.7-1.4 1.5-1.4s1.5.6 1.5 1.4c.8 3.8 4.5 6.2 8.3 5.4s6.2-4.5 5.4-8.3c-.7-3.2-3.5-5.6-6.9-5.6-1.8 0-3.6.7-4.8 2h1.3c.8 0 1.5.7 1.5 1.5s-.6 1.6-1.5 1.6h-4c-.8 0-1.5-.7-1.5-1.5v-4c0-.8.7-1.5 1.5-1.5.7 0 1.2.5 1.4 1.1C13.6 8.7 15.7 8 17.9 8c5.5 0 10 4.5 10 10s-4.4 10-10 10z" />\n\t</symbol>\n\t<symbol id="txp_svg_pause" viewBox="0 0 36 36">\n        <path d="M12 9h1c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1h-1c-.6 0-1-.4-1-1V10c0-.6.4-1 1-1zm11 0h1c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1h-1c-.6 0-1-.4-1-1V10c0-.6.4-1 1-1z" />\n    </symbol>\n\t<symbol id="txp_svg_search" viewBox="0 0 24 24">\n        <path d="M19.4 17.2L17.2 15c0.8-1.1 1.3-2.5 1.3-4 0-3.9-3.1-7-7-7s-7 3.1-7 7 3.1 7 7 7c1.5 0 2.8-0.4 3.9-1.2l2.2 2.2c0.5 0.5 1.3 0.5 1.8 0S19.9 17.7 19.4 17.2zM6.5 11c0-2.8 2.2-5 5-5s5 2.2 5 5 -2.2 5-5 5S6.5 13.8 6.5 11z"></path>\n    </symbol>\n\t<symbol id="svg_icon_refresh" viewBox="0 0 20 20">\n\t\t<path d="M10 19a9 9 0 0 1-9-8.999V10a1 1 0 1 1 2 0 7 7 0 1 0 7-7 6.952 6.952 0 0 0-4.877 2H7a1 1 0 0 1 0 2H3a1 1 0 0 1-1-1V2a1 1 0 0 1 2 0v1.314A8.935 8.935 0 0 1 10 1c4.971 0 9 4.029 9 9s-4.029 9-9 9z"/>\n\t</symbol>\n\t<symbol id="txp_svg_next" viewBox="0 0 36 36">\n        <path d="M26 9h1c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1h-1c-.6 0-1-.4-1-1V10c0-.6.4-1 1-1zm-14.8 1.3l9.2 6.6c.6.4.8 1.3.3 2-.1.1-.2.3-.3.3l-9.2 6.6c-.6.4-1.5.3-1.9-.3-.2-.3-.3-.6-.3-.9V11.4c0-.8.6-1.4 1.4-1.4.3 0 .6.1.8.3z" />\n    </symbol>\n    <symbol id="txp_svg_stop" viewBox="0 0 36 36">\n        <path d="M24 26H12c-1.1 0-2-0.9-2-2V12c0-1.1 0.9-2 2-2h12c1.1 0 2 0.9 2 2v12C26 25.1 25.1 26 24 26z"/>\n    </symbol>\n\t<symbol id="txp_svg_shop" viewBox="0 0 24 24">\n\t\t<path d="M18 13.836V14H8.793l-.552 2H18a2 2 0 1 1-2 2c0-.368.106-.707.278-1H8.722c.172.294.278.633.278 1a2 2 0 1 1-2-2h.206l.552-2H7v-.223L5.34 5H3V4h3v.01L6.147 4l.377 2H20v1h-.206L18 13.835zM18 19a1 1 0 1 0 0-2 1 1 0 0 0 0 2zM7 17a1 1 0 1 0 0 1.998 1 1 0 0 0 0-2zM6.714 7l1.134 6h9.357l1.575-6H6.714z"/>\n\t</symbol>\n\t<symbol id="txp_svg_eye" viewBox="0 0 24 24">\n\t\t<path d="M12 18c-5.468 0-9-6-9-6s3.533-6 9-6c5.467 0 9 6 9 6s-3.533 6-9 6zm0-11c-5.033 0-8 5-8 5s2.967 5 8 5c5.033 0 8-5 8-5s-2.967-5-8-5zm0 8a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0-5a2 2 0 1 0 0 3.998 2 2 0 0 0 0-4z"/>\n\t</symbol>\n\t<symbol id="txp_svg_volume" viewBox="0 0 20 20">\n        <path d="M16.714 15.593l-.01-.01a1 1 0 0 1-1.705-.708c0-.287.124-.542.317-.724C16.354 13.073 17 11.614 17 10s-.645-3.072-1.682-4.151A.993.993 0 0 1 15 5.125a1 1 0 0 1 1-1c.3 0 .561.139.744.348l.017-.016A7.969 7.969 0 0 1 19 10c0 2.178-.874 4.15-2.286 5.593zm-3.999 3.122a.956.956 0 0 1-.688.28c-.009 0-.018.005-.027.005a.984.984 0 0 1-.75-.357L5.818 15H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h3.818l5.432-3.643A.984.984 0 0 1 12 1c.009 0 .017.005.026.005a.954.954 0 0 1 .968.967c.001.01.006.018.006.028v16c0 .009-.005.017-.005.026a.959.959 0 0 1-.28.689zM6.75 6.643A.984.984 0 0 1 6 7H3v6h3c.304 0 .567.143.75.357l4.25 2.85V3.792L6.75 6.643z"></path>\n    </symbol>\n\t<symbol id="txp_svg_volume_mute" viewBox="0 0 20 20">\n\t\t<path d="M16.394 12.566A5.88 5.88 0 0 0 17 10a5.97 5.97 0 0 0-1.682-4.151.993.993 0 0 1-.318-.724 1 1 0 0 1 1-1c.3 0 .561.139.745.348l.016-.016A7.969 7.969 0 0 1 19 10a7.934 7.934 0 0 1-1.116 4.055l-1.49-1.489zM11 3.792L8.978 5.149 7.62 3.792l3.63-2.435A.984.984 0 0 1 12 1c.009 0 .017.005.026.005a.954.954 0 0 1 .968.967c.001.01.006.018.006.028v7.171l-2-2V3.792zm7.864 14.072a.999.999 0 0 1-1.414 0L2.136 2.55a1 1 0 1 1 1.415-1.415L18.864 16.45a1 1 0 0 1 0 1.414zM3.171 5l2 2H3v6h3c.304 0 .567.143.75.357l4.25 2.85v-3.379l2 2V18c0 .009-.005.017-.005.027a.955.955 0 0 1-.967.968c-.01 0-.019.005-.028.005a.984.984 0 0 1-.75-.357L5.818 15H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h1.171z"></path>\n\t</symbol>\n\n\t<symbol id="txp_svg_setting" viewBox="0 0 24 24">\n\t\t<path d="M21 11v2l-2 1v-.3c-.2.7-.5 1.5-.9 2.1l.2-.2.7 2.1-1.4 1.4-2.1-.7.2-.2c-.7.4-1.4.7-2.1.9h.4l-1 2h-2l-1-2h.3c-.7-.2-1.5-.5-2.1-.9l.2.2-2.1.7-1.4-1.4.7-2.1.2.2c-.4-.7-.7-1.4-.9-2.1v.3l-2-1v-2l2-1v.4c.2-.8.5-1.6 1-2.3l-.3.4-.7-2.2 1.4-1.4 2.1.7-.3.4c.7-.5 1.5-.8 2.3-1H10l1-2h2l1 2h-.4c.8.2 1.6.5 2.3.9l-.3-.3 2.1-.7 1.4 1.4-.7 2.1-.3-.3c.4.7.7 1.4.9 2.2V10l2 1zm-9-4c-2.8 0-5 2.2-5 5s2.2 5 5 5 5-2.2 5-5-2.2-5-5-5z"/>\n\t</symbol>\n\t<symbol id="txp_svg_bulb" viewBox="0 0 24 24">\n\t\t<path d="M15 16.317V17c0 .186-.065.35-.153.5.088.15.153.313.153.5v2a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-2c0-.186.064-.35.153-.5A.97.97 0 0 1 9 17v-.683A6.994 6.994 0 0 1 5 10a7 7 0 0 1 14 0 6.994 6.994 0 0 1-4 6.317zM10 20h4v-2h-4v2zm2-16a6 6 0 0 0-6 6c0 2.215 1.214 4.128 3 5.167V15c.452.36 1 .593 1 .593V17h4v-1.5s.462-.096 1-.5v.167c1.786-1.04 3-2.953 3-5.167a6 6 0 0 0-6-6z"/>\n\t</symbol>\n\t<symbol id="txp_svg_window" viewBox="0 0 24 24">\n\t\t<path d="M19 16H9a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1zm0-11H9v10h10V5zM5 19h10v-2h1v2a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h2v1H5v10z"/>\n\t</symbol>\n\t<symbol id="txp_svg_size_true" viewBox="0 0 24 24">\n\t\t<path d="M20 19H4c-.6 0-1-.4-1-1V6c0-.6.4-1 1-1h16c.6 0 1 .4 1 1v12c0 .6-.4 1-1 1zM5 7v10h14V7H5z"/>\n\t</symbol>\n\t<symbol id="txp_svg_size" viewBox="0 0 24 24">\n\t\t<path d="M20 19H4c-.6 0-1-.4-1-1V6c0-.6.4-1 1-1h16c.6 0 1 .4 1 1v12c0 .6-.4 1-1 1zM5 17h10V7H5v10zM19 7h-2v10h2V7z"/>\n\t</symbol>\n\t<symbol id="txp_svg_fake" viewBox="0 0 24 24">\n\t\t<path d="M20 20H4c-.6 0-1-.4-1-1V5c0-.6.4-1 1-1h16c.6 0 1 .4 1 1v14c0 .6-.4 1-1 1zM5 6v12h14V6H5zm12 11h-2c-.6 0-1-.4-1-1s.4-1 1-1h1v-1c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1zm0-6c-.6 0-1-.4-1-1V9h-1c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1v2c0 .6-.4 1-1 1zm-8 6H7c-.6 0-1-.4-1-1v-2c0-.6.4-1 1-1s1 .4 1 1v1h1c.6 0 1 .4 1 1s-.4 1-1 1zm0-8H8v1c0 .6-.4 1-1 1s-1-.4-1-1V8c0-.6.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1z"/>\n\t</symbol>\n\t<symbol id="txp_svg_fake_true" viewBox="0 0 24 24">\n\t\t<path d="M20 20H4c-.6 0-1-.4-1-1V5c0-.6.4-1 1-1h16c.6 0 1 .4 1 1v14c0 .6-.4 1-1 1zM5 6v12h14V6H5zm12 9h-1v1c0 .6-.4 1-1 1s-1-.4-1-1v-2c0-.6.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1zm0-4h-2c-.6 0-1-.4-1-1V8c0-.6.4-1 1-1s1 .4 1 1v1h1c.6 0 1 .4 1 1s-.4 1-1 1zm-8 6c-.6 0-1-.4-1-1v-1H7c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1v2c0 .6-.4 1-1 1zm0-6H7c-.6 0-1-.4-1-1s.4-1 1-1h1V8c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1z"/>\n\t</symbol>\n\t<symbol id="txp_svg_fullscreen" viewBox="0 0 24 24">\n\t\t<path d="M19.7 19.7c-.2.2-.5.3-.7.3h-4c-.6 0-1-.4-1-1s.4-1 1-1h1.6l-3.3-3.3c-.4-.4-.3-1.1.1-1.4.4-.4 1-.4 1.4 0l3.3 3.3V15c0-.6.4-1 1-1s1 .4 1 1v4c-.1.2-.2.5-.4.7zM19 10c-.6 0-1-.4-1-1V7.4l-3.3 3.3c-.4.4-1 .4-1.4 0-.4-.4-.4-1 0-1.4L16.6 6H15c-.6 0-1-.4-1-1s.4-1 1-1h4c.3 0 .5.1.7.3.2.2.3.5.3.7v4c0 .6-.4 1-1 1zM7.4 18H9c.6 0 1 .4 1 1s-.4 1-1 1H5c-.3 0-.5-.1-.7-.3-.2-.2-.3-.5-.3-.7v-4c0-.6.4-1 1-1s1 .4 1 1v1.6l3.3-3.3c.4-.4 1.1-.3 1.4.1.4.4.4 1 0 1.4L7.4 18zm1.9-7.3L6 7.4V9c0 .6-.4 1-1 1s-1-.4-1-1V5c0-.3.1-.5.3-.7.2-.2.5-.3.7-.3h4c.6 0 1 .4 1 1s-.4 1-1 1H7.4l3.3 3.3c.4.4.4 1 0 1.4-.4.4-1 .4-1.4 0z"/>\n\t</symbol>\n\t<symbol id="txp_svg_fullscreen_true" viewBox="0 0 24 24">\n\t\t<path d="M16.4 9H18c.6 0 1 .4 1 1s-.4 1-1 1h-4c-.3 0-.5-.1-.7-.3-.2-.2-.3-.5-.3-.7V6c0-.6.4-1 1-1s1 .4 1 1v1.6l3.3-3.3c.4-.4 1.1-.3 1.4.1.4.4.4 1 0 1.4L16.4 9zM10 19c-.6 0-1-.4-1-1v-1.6l-3.3 3.3c-.4.4-1 .4-1.4 0-.4-.4-.4-1 0-1.4L7.6 15H6c-.6 0-1-.4-1-1s.4-1 1-1h4c.3 0 .5.1.7.3.2.2.3.5.3.7v4c0 .5-.4 1-1 1zm0-8H6c-.6 0-1-.4-1-1s.4-1 1-1h1.6L4.3 5.7c-.4-.4-.4-1 .1-1.4.4-.4 1-.4 1.4 0L9 7.6V6c0-.6.4-1 1-1s1 .4 1 1v4c0 .3-.1.5-.3.7-.2.2-.5.3-.7.3zm4 2h4c.6 0 1 .4 1 1s-.4 1-1 1h-1.6l3.3 3.3c.4.4.4 1 0 1.4s-1 .4-1.4 0L15 16.4V18c0 .6-.4 1-1 1s-1-.4-1-1v-4c0-.3.1-.5.3-.7.2-.2.5-.3.7-.3z"/>\n\t</symbol>\n\t<symbol id="txp_svg_select" viewBox="0 0 12 12">\n\t\t<path d="M6 12c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6zM6 .9C3.2.9.9 3.2.9 6s2.3 5.1 5.1 5.1 5.1-2.3 5.1-5.1S8.8.9 6 .9z"/>\n\t</symbol>\n\t<symbol id="txp_svg_select_true" viewBox="0 0 12 12">\n\t\t<path d="M6 12c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6zM6 .9C3.2.9.9 3.2.9 6s2.3 5.1 5.1 5.1 5.1-2.3 5.1-5.1S8.8.9 6 .9zm-.3 7.4c-.3.3-.8.3-1.2 0L2.8 6.6c-.3-.3-.3-.8 0-1.2.3-.3.8-.3 1.2 0l1.2 1.2L8 3.7c.3-.3.8-.3 1.2 0 .3.3.3.8 0 1.2L5.7 8.3z"/>\n\t</symbol>\n\t<symbol id="txp_svg_link" viewBox="0 0 36 36">\n\t\t<path d="M26.5 26h-5c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5h5c2.5 0 4.5-2 4.5-4.5S29 14 26.5 14h-5c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5h5c4.1 0 7.5 3.4 7.5 7.5S30.6 26 26.5 26zM12 18.5c0-.8.7-1.5 1.5-1.5h9c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5h-9c-.8 0-1.5-.7-1.5-1.5zm2.5-4.5h-5C7 14 5 16 5 18.5S7 23 9.5 23h5c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5h-5C5.4 26 2 22.6 2 18.5S5.4 11 9.5 11h5c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5z"/>\n\t</symbol>\n\t<symbol id="txp_svg_icon_like" viewBox="0 0 20 20">\n\t\t<path d="M18.4 8.5l-2 9.4c-0.2 0.6-0.2 1.1-0.6 1.3 -0.4 0.3-1 0.2-1.9 0.2 -2.9 0-10.4 0-10.4 0l0-12 2.1-5c0 0 0.6-2 1.7-2 1.4 0 1.2 2 1.2 2s0 1.3 0 3c0 0.7 0.2 1 1 1 6.5 0 6.9 0 6.9 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 1.6-0.2 1.9 0.5C18.5 7.4 18.6 7.9 18.4 8.5zM1.5 19.5c-0.6 0-1-0.4-1-1v-10c0-0.6 0.4-1 1-1s1 0.4 1 1v10C2.5 19.1 2.1 19.5 1.5 19.5z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_loop" viewBox="0 0 36 36">\n        <path d="M13 13h8l-3-3-.8-.8c-.1-.1-.3-.2-.4-.2h-.5c-.2 0-.3.1-.3.3V11h-3c-2.8 0-5 2.2-5 5v4c0 2.4 1.7 4.4 4 4.9v-2.1c-1.2-.4-2-1.5-2-2.8v-4c0-1.7 1.3-3 3-3zm11-1.9v2.1c1.2.4 2 1.5 2 2.8v4c0 1.7-1.3 3-3 3h-8l3.1 3.1.8.8c.1.1.3.2.4.2h.5c.2 0 .3-.1.3-.3V25h3c2.8 0 5-2.2 5-5v-4c-.1-2.4-1.8-4.4-4.1-4.9z"/>\n    </symbol> \n\t<symbol id="txp_svg_loop_off" viewBox="0 0 36 36">\n        <path d="M16 11V9.3c0-.2.1-.3.3-.3h.5c.2 0 .3.1.4.2L21 13h-8c-1.7 0-3 1.3-3 3v4c0 1.7 1.3 3 3 3h1v2h-1c-2.8 0-5-2.2-5-5v-4c0-2.8 2.2-5 5-5h3zm4.1 11.2l2.8 2.8c.2.3.2.7 0 .9-.3.2-.7.2-.9 0l-2.8-2.8c-.2-.3-.2-.7 0-.9.3-.2.7-.2.9 0zM21 19c2.8 0 5 2.2 5 5s-2.2 5-5 5-5-2.2-5-5 2.2-5 5-5zm0 9c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4zm3-16.9c2.3.5 4 2.5 4 4.9v4c0 .6-.1 1.2-.3 1.8-.4-1-1-1.9-1.7-2.7V16c0-1.3-.8-2.4-2-2.8v-2.1z"></path>\n    </symbol>\n\t<symbol id="txp_svg_selected" viewBox="0 0 16 16">\n\t\t<path d="M1 8l5 5 9-10 -1-1 -8 9.2L2 7 1 8z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_icon_hot" viewBox="0 0 16 16">\n\t\t<path d="M8.5 4.25c-.547-1.879.5-3.11.5-3.11s-2.25.891-2.25 3.11c0 2.104 1.517 3.45-.068 3.45-.723-.022-1.228-.365-1.228-1.312 0-.851.546-1.619.546-1.619-1.313.696-3 2.153-3 5.556 0 2.517 2.289 4.811 4.5 4.811s4.5-2.105 4.5-4.622c0-4.046-2.975-4.493-3.5-6.264z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_popup" viewBox="0 0 20 20">\n\t\t<path d="M17 18H3c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h5c.6 0 1 .4 1 1s-.4 1-1 1H3v12h14v-3c0-.6.4-1 1-1s1 .4 1 1v3c0 1.1-.9 2-2 2zm2-10c0 .6-.4 1-1 1s-1-.4-1-1V5.4l-4.4 4.4c-.4.4-1 .4-1.4 0-.4-.4-.4-1 0-1.3L15.6 4H13c-.6 0-1-.4-1-1s.4-1 1-1h5c.5 0 .9.4 1 .9V8z"></path>\n\t</symbol>\n    <symbol id="txp_svg_hd" viewBox="0 0 28 28">\n        <path d="M13 6h-2.8c0.1 0.7 0.2 1.4 0.2 2.4v3.6H2.8V8.5c0-1 0-1.6 0.2-2.4H0.1c0.1 0.7 0.2 1.3 0.2 2.4v10.1c0 1.1 0 1.7-0.2 2.4h2.8c-0.1-0.8-0.2-1.3-0.2-2.4v-4.3h7.6v4.3c0 1.1 0 1.7-0.2 2.4H13c-0.1-0.8-0.2-1.3-0.2-2.4V8.5C12.8 7.4 12.9 6.8 13 6z"/>\n        <path d="M25.8 7.7C24.6 6.5 23.1 6 20.7 6h-3.4c-1.2 0-1.6 0-2.4-0.1 0.1 0.8 0.2 1.4 0.2 2.4v10.2c0 1.1 0 1.7-0.2 2.5 0.8 0 1.2-0.1 2.4-0.1h3.4c2.2 0 3.7-0.5 4.9-1.6 1.5-1.4 2.2-3.4 2.2-6C27.9 11 27.2 9 25.8 7.7zM23.9 17.6c-0.8 0.8-1.8 1.2-3.3 1.2h-3V8.3h3c1.6 0 2.6 0.3 3.4 1.1 0.9 0.9 1.3 2.2 1.3 4C25.3 15.2 24.8 16.6 23.9 17.6z"/>\n    </symbol>\n    <symbol id="txp_svg_lightning" viewBox="0 0 28 28">\n        <path d="M24 12.3c-0.1-0.1-0.1-0.1-0.2-0.1C23.7 12 23.5 12 23.4 12h-6.9l2.3-10c0-0.1 0-0.2 0-0.3 0-0.2-0.1-0.3-0.2-0.5 -0.3-0.3-0.7-0.3-1 0L4.2 14.8C4.1 14.9 4 15.1 4 15.3c0 0.2 0.1 0.4 0.2 0.5 0.1 0.1 0.3 0.2 0.5 0.2h7.1l-2.4 9.9c0 0.1 0 0.1 0 0.2 -0.1 0.3 0 0.5 0.2 0.7 0.1 0.1 0.3 0.2 0.5 0.2 0.2 0 0.4-0.1 0.5-0.2L24 13.2c0.1-0.1 0.2-0.3 0.2-0.5C24.2 12.6 24.1 12.4 24 12.3L24 12.3z"/>\n    </symbol>\n    <symbol id="txp_svg_vip_star_lg" viewBox="0 0 28 28">\n        <path d="M7.5 19.5C8.4 19.9 9.2 20 10 20c2.4 0 4.7-1 6.5-2.8 1.9-1.9 2.8-4.6 2.6-7.1l-1.4-0.2 -3.6-7.3L14 2.5c0 0-0.1 0-0.1 0.1l-3.6 7.3 -8.2 1.2c0 0-0.1 0-0.1 0.1v0.1l5.9 5.8L7.5 19.5zM7.3 20.6L6.6 25v0.1c0 0 0 0 0.1 0 0 0 0 0 0.1 0l6.5-3.5c-0.5 0.1-0.8 0.1-1.3 0.1C10.3 21.9 8.7 21.5 7.3 20.6zM18.7 19.2c-1.2 1.2-2.8 2-4.3 2.5l7 3.6c0 0 0 0 0.1 0h0.1c0 0 0.1-0.1 0-0.1l-1.3-7.9C19.8 17.9 19.3 18.6 18.7 19.2zM25.9 11.1l-4.7-0.7c0.5 2.2 0.1 4.4-1 6.5l5.8-5.5C26 11.3 26 11.3 25.9 11.1 26 11.1 25.9 11.1 25.9 11.1z"/>\n    </symbol>\n    <symbol id="txp_svg_clock" viewBox="0 0 28 28">\n        <path d="M14 0.5c-6.6 0-12 5.4-12 12 0 6.6 5.4 12 12 12 0.4 0 0.7 0 1.1-0.1 0.1 0 0.3 0.1 0.4 0.1 0.8 0 1.5-0.7 1.5-1.5 0-0.8-0.7-1.5-1.5-1.5 -0.1 0-0.1 0-0.2 0l0-0.1c-0.4 0.1-0.9 0.1-1.3 0.1 -5 0-9-4-9-9 0-5 4-9 9-9 5 0 9 4 9 9 0 2-0.7 3.9-1.8 5.4l0.2 0.1C21.1 18.3 21 18.6 21 19c0 0.8 0.7 1.5 1.5 1.5 0.8 0 1.4-0.6 1.5-1.4 1.3-1.9 2-4.2 2-6.6C26 5.9 20.6 0.5 14 0.5zM18.4 12.5h-3.1l-2.5-4.3c-0.4-0.7-1.3-0.9-2-0.5 -0.7 0.4-0.9 1.2-0.5 1.9l3 5.2c0.2 0.4 0.6 0.6 1 0.7 0.1 0 0.3 0.1 0.4 0.1h3.8c0.9 0 1.6-0.7 1.6-1.5C20 13.2 19.3 12.5 18.4 12.5z"/>\n    </symbol>\n    <symbol id="txp_svg_update" viewBox="0 0 28 28">\n        <path d="M13 16.4l0-5.9C13 9.7 13.7 9 14.5 9c0.8 0 1.5 0.6 1.4 1.4l0 4.6h2.4c0.9 0 1.6 0.7 1.6 1.5 0 0.8-0.7 1.5-1.6 1.5h-3.8c0 0-0.1 0-0.1 0 0 0 0 0 0 0 -0.8 0-1.5-0.6-1.5-1.4v0C13 16.5 13 16.5 13 16.4 13 16.5 13 16.5 13 16.4zM15 26c-6.7 0-12-5.4-12-12 0-1.9 0.4-3.7 1.2-5.2L2.9 9.1C2.1 9.3 1.3 8.8 1.1 8 0.9 7.2 1.3 6.4 2.1 6.2L7 4.9c0.8-0.2 1.6 0.3 1.8 1.1l1.3 4.8c0.2 0.8-0.3 1.6-1.1 1.8 -0.8 0.2-1.6-0.3-1.8-1.1l-0.4-1.4c-0.6 1.2-0.9 2.5-0.9 3.9 0 5 4 9 9 9 5 0 9-4 9-9 0-5-4-9-9-9 -0.1 0-0.1 0-0.2 0l0-0.1C14.6 5 14.6 5 14.5 5 13.6 5 13 4.3 13 3.5 13 2.7 13.6 2 14.5 2c0 0 0.1 0 0.1 0 0.1 0 0.3 0 0.4 0 6.7 0 12 5.4 12 12C27 20.6 21.6 26 15 26z"/>\n\t </symbol>\n\t <symbol id="txp_svg_close" viewBox="0 0 16 16">\n\t\t<path d="M9.275 8l4.461-4.461c0.352-0.352 0.352-0.923 0-1.275 -0.352-0.352-0.923-0.352-1.275 0L8 6.725 3.539 2.264c-0.352-0.352-0.923-0.352-1.275 0 -0.352 0.352-0.352 0.923 0 1.275L6.725 8l-4.461 4.461c-0.352 0.352-0.352 0.923 0 1.275 0.352 0.352 0.923 0.352 1.275 0L8 9.275l4.461 4.461c0.352 0.352 0.923 0.352 1.275 0 0.352-0.352 0.352-0.923 0-1.275L9.275 8z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_icon_report" viewBox="0 0 20 20">\n\t\t<path d="M8 9c-.552 0-1-.448-1-1v-3c0-.552.448-1 1-1s1 .448 1 1v3c0 .552-.448 1-1 1zm0 3c-.552 0-1-.448-1-1s.448-1 1-1 1 .448 1 1-.448 1-1 1zm6.323-1.086c-.116.424-.487.742-.948.742-.552 0-1-.448-1-1 0-.148.036-.285.094-.412l-.019-.01c.34-.675.55-1.427.55-2.235 0-2.762-2.239-5-5-5-2.762 0-5 2.238-5 5 0 2.761 2.239 5 5 5 .766 0 1.484-.186 2.133-.494l.013.03c.128-.059.267-.097.417-.097.552 0 1 .448 1 1 0 .471-.332.847-.771.954-.858.378-1.795.608-2.792.608-3.866 0-7-3.134-7-7s3.134-7 7-7 7 3.134 7 7c-.001 1.047-.261 2.024-.677 2.914z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_right_xs" viewBox="0 0 12 12">\n\t\t<path d="M4.4 10.4l-.8-.8L7.3 6 3.6 2.4l.8-.8 4 4L8 6l.4.4z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_refresh" viewBox="0 0 20 20">\n\t\t<path d="M10 19a9 9 0 0 1-9-8.999V10a1 1 0 1 1 2 0 7 7 0 1 0 7-7 6.952 6.952 0 0 0-4.877 2H7a1 1 0 0 1 0 2H3a1 1 0 0 1-1-1V2a1 1 0 0 1 2 0v1.314A8.935 8.935 0 0 1 10 1c4.971 0 9 4.029 9 9s-4.029 9-9 9z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_left_xs" viewBox="0 0 12 12">\n\t\t<path d="M7.7 10.4l-4-4 .4-.4-.4-.4 4-4 .8.8L4.8 6l3.7 3.6z"></path>\n\t</symbol>\n</svg>';
},143:function(a,b){var c={};c[445]=c[444]="\u7f51\u7edc\u8fde\u63a5\u4f3c\u4e4e\u51fa\u73b0\u95ee\u9898\uff0c",c[10001]=c[1]=c[2]=c[3]=c[4]=c[5]=c[30]=c[40]=c[41]=c[42]=c[50]=c[68]="\u89c6\u9891\u83b7\u53d6\u9014\u4e2d\u51fa\u73b0\u95ee\u9898\uff0c",c.defaultMsg=c[51]=c[52]=c[61]=c[62]=c[63]=c[65]=c[66]=c[69]=c[71]=c[73]=c[74]=c[76]=c[77]=c[81]=c[82]=c[86]=c["80.10"]=c[94]="\u8fd9\u4e2a\u89c6\u9891\u88ab\u5916\u661f\u4eba\u52ab\u8d70\uff0c\u6682\u65f6\u770b\u4e0d\u4e86\u4e86~",c[64]=c[100]="\u5f88\u9057\u61be\uff0c\u5bf9\u6b64\u89c6\u9891\u7684\u8bbf\u95ee\u6682\u65f6\u53d7\u9650",c[80.3]=c["80.10"]=c[80.11]=c[84]="\u6b64\u89c6\u9891\u5305\u542b\u654f\u611f\u4fe1\u606f\uff0c\u5df2\u88ab\u7ba1\u7406\u5458\u6349\u62ff~",c[80]=c[83]="\u6682\u65f6\u6ca1\u6709\u83b7\u5f97\u8be5\u89c6\u9891\u7248\u6743\uff0c\u52aa\u529b\u4e3a\u60a8\u4e89\u53d6\u4e2d~",c[80.1]="\u5f88\u62b1\u6b49\uff0c\u7531\u4e8e\u7248\u6743\u9650\u5236\uff0c\u60a8\u6240\u5728\u7684\u5730\u533a\u6682\u65f6\u65e0\u6cd5\u64ad\u653e\u8be5\u89c6\u9891",c[80.2]=c[80.7]=c[80.9]="\u6682\u65f6\u6ca1\u6709\u83b7\u5f97\u8be5\u89c6\u9891\u7248\u6743\uff0c\u52aa\u529b\u4e3a\u60a8\u4e89\u53d6\u4e2d~",c[69.4]=c[80.14]=c[-11111]="\u5e94\u7248\u6743\u65b9\u8981\u6c42\u672c\u7247\u91c7\u7528\u52a0\u5bc6\u683c\u5f0f\uff0c\u6b64\u6d4f\u89c8\u5668\u6682\u4e0d\u652f\u6301\u64ad\u653e",c.adblock="\u64ad\u653e\u5185\u5bb9\u88abadblock\u8bef\u62e6\u622a\u4e86\uff0c\u8bf7\u60a8\u5173\u95ed\u63d2\u4ef6\uff0c\u6216\u4f7f\u7528\u4e0b\u5217\u65b9\u5f0f\u89c2\u770b\uff1a",c.getPlatformErrorCode=function(a,b,c){var d="-",e="-",f="-";return c=c||"00",d=Txplayer.util.os.mac?"62":Txplayer.util.os.windows?"61":"66","getinfo"===a?e="101":"getkey"===a?e="102":"ad"===a?e="215":"player"===a&&(e="200"),"neterror"===b?f="140":"cgiInnerError"===b?(f="13",c&&(c=""+c),2===c.length&&(c="0"+c)):"h5video"===b?f="111":"aderror"===b&&(f="150"),Txplayer.util.localLog&&Txplayer.util.localLog("VIDEO_ERROR",{platform:d,type:e,module:f,code:c}),d+e+"."+f+c},a.exports=c},144:function(a,b){!function(a,b){b(a,jQuery)}("undefined"!=typeof window?window:this,function(a,b,c){"use strict";function d(){"hidden"!==e&&(g.hidden=i.pageVisibility?g[e]:c)}for(var e,f,g=a.document,h=["webkit","o","ms","moz",""],i=b.support||{},j=("onfocusin"in g&&"hasFocus"in g?"focusin focusout":"focus blur");(f=h.pop())!==c;)if(e=(f?f+"H":"h")+"idden",i.pageVisibility=g[e]!==c,i.pageVisibility){j=f+"visibilitychange";break}d(),b(/blur$/.test(j)?a:g).on(j,function(a){var c=a.type;b(g).triggerHandler(e&&g[e]||/^(?:blur|focusout)$/.test(c)?"hide":"show"),d()})})}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(265)},265:function(a,b,c){function d(a){f=Txplayer.$,this.msg=new Txplayer.Events,this.dataset={},this.context=a,this.init()}var e=Txplayer.util,f=Txplayer.$;d.prototype={init:function(){this.updatePlayListIndex(0),this.setPlayState(-1),this.context.dataset.playbackRate=1,this.context.dataset.videoCurrentTime=0,this.dataset.retryTimes=0,this.dataset.saveRetryTimes=0,this.dataset.hlsRetryTimes=0,this.write(),this.addEventListener(),this.exportsModuleApis(),this.loadSubPlugins(),this.resetVideoStatus()},loadSubPlugins:function(){var a=[];this.context.pluginConfig&&"array"===f.type(this.context.pluginConfig.subPlugins)&&(a=this.context.pluginConfig.subPlugins.slice(0));var b={msg:this.context.msg,userMsg:this.context.userMsg,dataset:this.context.dataset,userApi:this.context.userApi,$mod:{$videomod:this.dataset.$videomod}};e.loadPlugins.call(this,a,b)},remove:function(){this.dataset.$videomod.remove()},addEventListener:function(){this.initVideoEvents(),this.dealFilmMsgMoudle()},exportsModuleApis:function(){this.initUserApis(),this.initPrivateMsg(),this.initDataApis()}},e.extend(d.prototype,c(266)),e.extend(d.prototype,c(268)),e.extend(d.prototype,c(269)),e.extend(d.prototype,c(270)),e.extend(d.prototype,c(271)),e.extend(d.prototype,c(272)),e.extend(d.prototype,c(273)),e.extend(d.prototype,c(274)),e.extend(d.prototype,c(275)),e.extend(d.prototype,c(276)),e.extend(d.prototype,c(277)),e.extend(d.prototype,c(278)),e.extend(d.prototype,c(279)),Txplayer.register("v4HdPlayer",d)},266:function(a,b,c){var d=c(267);a.exports={write:function(){this.dataset.hasVideoHtmlWrited=!0,this.context.dataset.$playermod.append(this.buildHTML()),this.dataset.$videomod=this.context.dataset.$playermod.find('[data-role="'+this.dataset.renderData.videomod+'"]'),this.context.dataset.$videomod=this.dataset.$videomod,this.dataset.$video=this.dataset.$videomod.find("video"),this.context.userMsg.emit("write")},buildHTML:function(){var a=this,b={videomod:"txp-video-wrapper",data:{attrs:a.getAttrs().join(" "),videoStyle:a.getVideoStyles()}};this.dataset.renderData=b;var c=Txplayer.$.tmpl(d,b);return c},getAttrs:function(){var a={isUsePlayinline:"webkit-playsinline",isUseAirplay:"x-webkit-airplay",isUseControl:'controls="controls"',isUsePreload:['preload="auto"','preload="none"'],muted:"muted",isUseCrossOrigin:'crossOrigin="anonymous"'},b=[];for(var c in a)Txplayer.$.isArray(a[c])?this.context.config[c]===!0?b.push(a[c][0]):b.push(a[c][1]):this.context.config[c]===!0&&b.push(a[c]);return b},setVideoClass:function(a){if(a){var b=this;"array"===Txplayer.$.type(a.removeList)&&Txplayer.$(a.removeList).each(function(a,c){b.dataset.$video.hasClass(c)&&b.dataset.$video.removeClass(c)}),"array"===Txplayer.$.type(a.addList)&&Txplayer.$(a.addList).each(function(a,c){b.dataset.$video.addClass(c)})}},getVideoStyles:function(){var a=[];return a.push("background-color:#000;width:100%;height:100%;"),a.join(";")}}},267:function(a,b){a.exports='<txpdiv data-role="<%=videomod%>" class="txp_video_container">\n  <video style="<%=data.videoStyle%>" <%=data.attrs%> data-role="txp_video_tag" />\n  <video style="<%=data.videoStyle%>" <%=data.attrs%> data-role="txp_video_tag" />\n</txpdiv>'},268:function(a,b){var c=Txplayer.util;a.exports={videoHelper:function(a,b,d){if(!(a&&a.error&&a.error.code&&"pause"===b)){d=d||[];var e,f="play"===b,g=this,h=function(){var c;if(!f||!a||a.paused)return c=d&&d.length?a[b].apply(a,d):a[b]()};if(e=h(),e&&e.then)this.dataset.videoDef=e,e.then(function(){g.dataset.videoDef=null})["catch"](function(a){c.showError("[videoHelper error]",a),g.dataset.videoDef=null});else{if(this.dataset.videoDef)return;h()}return e}},stopVideo:function(a){a&&(Txplayer.$(a).removeAttr("src"),a.load&&a.load())},updateCurrentVideoUrl:function(a){a&&(a.indexOf("blob:")>-1||a.indexOf("mediasource:")>-1||(this.context.dataset.currentVideoUrl=a))},updateVideoStatus:function(a,b){a&&(a.status=b)},getVideoBufferedTime:function(a){if(a=a||{},this.isChrome56WithBugOfMp4())return 0;var b=a.video;if(!b||!b.buffered||!b.buffered.length)return 0;var c=0,d=b.currentTime,e=b.buffered.length;if(1===e)c=b.buffered.end(0);else for(var f=0,g=e;f<g;f++)if(d>=b.buffered.start(f)&&d<=b.buffered.end(f))if(g>f+1)for(var h=f+1;h<g;h++){var i=b.buffered.start(h)-b.buffered.end(h-1);if(!(0<=i&&i<=.2)){c=b.buffered.end(h-1);break}c=b.buffered.end(h)}else c=b.buffered.end(f);return c},resetVideoStatus:function(){var a=this;this.dataset.$video.each(function(b,c){c.index=b,0===b?c.isFocus=!0:c.isFocus=!1,a.updateVideoStatus(c,"IDLE"),c.src&&a.stopVideo(c)}),this.updateVideoDisplay()},updateVideoDisplay:function(){this.dataset.$video.each(function(a,b){b.isFocus===!0?b.style.display="block":b.style.display="none"})},setVideoPlayTime:function(a,b,c){var d=Txplayer.$;if(c="undefined"===d.type(c)||c,"number"===d.type(b)&&!isNaN(b)){if(0==b&&c)return void(0===this.context.dataset.playListIndex?(this.seekTo(a,b),this.videoHelper(a,"play")):this.videoHelper(a,"play"));this.seekTo(a,b),c&&this.videoHelper(a,"play")}}}},269:function(a,b){var c=Txplayer.util;a.exports={isFocusVideoBufferComplete:function(a){if(this.isChrome56WithBugOfMp4())return!1;var b=a||this.getFocusVideoTag(),c=this.getFocusVideoBuffer(a);return parseInt(b.duration)===parseInt(c)||parseInt(b.duration)===Math.ceil(c)},checkTimeisInBufferdRange:function(a){var b=this.getFocusVideoTag();if(!(b&&b.buffered&&b.buffered.length))return!1;if(this.isChrome56WithBugOfMp4()&&!this.context.dataset.useChromeHls)return 0==a||Math.abs(b.currentTime-a)<6&&Math.abs(b.currentTime-a)>2;for(var c,d=0,e=b.buffered.length;d<e;d++)if(c=b.buffered.end(d),c-=this.context.dataset.useHls?1:3,a>=b.buffered.start(d)&&a<=c)return!0;return!1},getFocusVideoTag:function(){var a;return this.dataset.$video.each(function(b,c){if(c.isFocus)return a=c,!1}),a},getFocusVideoBuffer:function(a){var b=a||this.getFocusVideoTag();return b&&b.buffered&&b.buffered.length?b.buffered.end(b.buffered.length-1):0},clearFocusVideoUrl:function(){var a=this.getFocusVideoTag();this.videoHelper(a,"pause"),this.stopVideo(a),this.updateVideoStatus(a,"IDLE")},isFocusVideoReady:function(){var a=this.getFocusVideoTag();return!(!a||!a.src)},setFocusVideoPlay:function(){var a=this.getFocusVideoTag();a.src?(this.videoHelper(a,"play"),this.updateVideoStatus(a,"PLAYING")):c.showInfo("play fail, video.src is null!")},setFocusVideoPause:function(){var a=this.getFocusVideoTag();a.src?(this.dataset.cachePauseAction=!1,this.videoHelper(a,"pause"),this.updateVideoStatus(a,"PAUSE")):("undefined"==typeof a.src&&(this.dataset.cachePauseAction=!0),c.showInfo("pause fail, video.src is null!"))},setFocusVideoCurrentTime:function(a){var b=Txplayer.$,c=Txplayer.util;c.v4log("setFocusVideoCurrentTime",a);var d=this.getFocusVideoTag(),e=this;return a.time>d.duration&&!(e.context.dataset.useHls&&c.browser.safari&&a.time<=e.context.dataset.duration)?void c.showError("setFocusVideoCurrentTime Error","time="+a.time+",duration="+d.duration):this.context.dataset.useChromeHls?(a.time&&(this.context.dataset.videoCurrentTime=a.time),void(e.context.dataset.hlsLoadStartTime&&e.context.dataset.hlsLoadStartTime==a.time?a.autoplay&&(e.dataset.cachePauseAction?e.setFocusVideoPause():e.videoHelper(d,"play")):this.context.msg.broadcast("setHlsCurrenTime",{video:d,currentTime:a.time,autoplay:a.autoplay}))):void("number"!==b.type(a.time)||isNaN(a.time)||(this.context.dataset.videoCurrentTime=a.time,this.setVideoPlayTime(d,a.time,a.autoplay)))},setFocusVideoUrl:function(a){var b=Txplayer.$,c=Txplayer.util;"string"===b.type(a)&&(a={url:a}),a.preload=a.preload||!0,a.autoplay=a.autoplay||!1;var d=this,e=d.getFocusVideoTag(),f=function(f){var g="";if(g="string"===b.type(f)?f:f.url,d.startBufferControl({video:e,src:g,hlsLoadStartTime:d.context.dataset.hlsLoadStartTime}),d.updateCurrentVideoUrl(g),d.context.dataset.useChromeHls&&g&&"function"==b.type(g.indexOf)&&g.indexOf(".m3u8")!=-1){!a.currentTime&&d.context.dataset.hlsLoadStartTime&&(a.currentTime=d.context.dataset.hlsLoadStartTime);var h=[];d.context.dataset.filmVideoData[0].urlArray.forEach(function(a,b){h.push(a.url)}),d.context.msg.broadcast("loadHlsSource",{p2pConfig:c.getP2pConfig(d.context),src:g,m3u8:f.m3u8,byterate:a.byteRate,video:e,currentTime:a.currentTime,autoplay:a.autoplay,fromSetDefinition:a.fromSetDefinition,m3u8Urls:h,reason:"setFocusVideoUrl"}),a.currentTime&&(d.context.dataset.videoCurrentTime=a.currentTime)}else{if(d.context.dataset.hlsLoadStartTime&&d.context.dataset.useHls&&(a.currentTime=d.context.dataset.hlsLoadStartTime,d.context.dataset.videoCurrentTime=a.currentTime,g=g.split("#t=")[0]+"#t="+Math.ceil(a.currentTime),d.updateCurrentVideoUrl(g),c.v4log("safari-hls setFocusVideoUrl dataset.hlsLoadStartTime",{src:g,hlsLoadStartTime:d.context.dataset.hlsLoadStartTime})),e.src!==g&&b(e).attr("src",g),a.preload)try{d.videoHelper(e,"load")}catch(i){c.showInfo(i,i.stack)}e.isFocus&&(c.showInfo("setFocusVideoUrl.setUrlAndPlay.isFocus"),a.autoplay=!0),a.currentTime&&!d.context.dataset.hlsLoadStartTime?(d.context.dataset.videoCurrentTime=a.currentTime,d.setVideoPlayTime(e,a.currentTime,a.autoplay)):a.autoplay&&(d.context.dataset.videoCurrentTime=d.context.dataset.hlsLoadStartTime||0,d.dataset.cachePauseAction?d.setFocusVideoPause():d.videoHelper(e,"play"))}};a&&a.hasOwnProperty("updateIndex")&&this.updatePlayListIndex(a.updateIndex),"string"===b.type(a.url)?f({url:a.url,m3u8:a.m3u8}):"function"!==b.type(a.getUrlSync)||a.preloading?a.preloading?(d.context.msg.broadcast("showLoading"),c.showInfo("\u6b63\u5728\u9884\u52a0\u8f7d\u4e2d",a)):c.showInfo("setFocusVideoUrl\u53c2\u6570\u9519\u8bef, \u627e\u4e0d\u5230getUrlSync",a):(c.showInfo("setFocusVideoUrl.getUrlSync","start"),a.getUrlSync().done(function(b){a.url=b,c.showInfo("setFocusVideoUrl.getUrlSync.setUrlAndPlay"),f(b)}).fail(function(a){}));var g=this.getPreloadVideoTag();g===e&&(g=this.dataset.$video[1]),g&&g.src&&this.clearPreloadVideoUrl()}}},270:function(a,b){var c=Txplayer.util;a.exports={isPreloadVideoBuffered:function(){var a=this.getPreloadVideoTag();return!!(a&&a.buffered&&a.buffered.length)},clearPreloadVideoUrl:function(){var a=this.getPreloadVideoTag();this.videoHelper(a,"pause"),this.stopVideo(a),this.updateVideoStatus(a,"IDLE")},getPreloadVideoTag:function(){var a=this.getFocusVideoTag(),b=this.dataset.$video.length,c=a.index,d=this,e=function(){return c++,c>=b&&(c=0),d.dataset.$video[c]};return e()},isPreloadVideoReady:function(a){a=a||{};var b=this.getPreloadVideoTag();if(!b)return c.error("checkPreloadVideoStatus error: can not find preload video!"),!1;if(!b.src)return!1;if(this.context.dataset.playList[this.context.dataset.playListIndex+1]&&this.context.dataset.playList[this.context.dataset.playListIndex+1].error)return!1;if("PRELOADING"===b.status)return!0;if("PRELOAD"===b.status){if(this.context.dataset.useChromeHls&&(b.src.indexOf("blob:")>-1||b.src.indexOf("mediasource:")>-1))return!0;var d=b.src,e=this.context.dataset.playListIndex+1;a.isPreloadFirstFilm&&(e=this.context.dataset.playListIndex),e>=this.context.dataset.playList.length&&(e=0);var f=this.context.dataset.playList[e];return d=d.split("#t=")[0],d===f.url}return!1},setPreloadVideoPlay:function(a){a=a||{};var b=this.getPreloadVideoTag(),d=this.getFocusVideoTag();d===b&&(d=this.dataset.$video[1]);var e=a.currentTime||b.currentTime;if(b&&d){if(!b.src)return void c.error("\u64ad\u653e\u5931\u8d25\uff1a\u9884\u52a0\u8f7d\u7684\u89c6\u9891\u6ca1\u627e\u5230\u64ad\u653e\u5730\u5740");a.isPreloadFirstFilm||a.noUpdateIndex||this.updatePlayListIndex(this.context.dataset.playListIndex+1),this.updateCurrentVideoUrl(this.context.dataset.playList[this.context.dataset.playListIndex].url),this.resetPlayListStatus("preloading"),d.isFocus=!1,b.isFocus=!0,this.updateVideoDisplay(),this.updateVideoStatus(b,"PLAYING"),this.updateVideoStatus(d,"IDLE"),this.videoHelper(d,"pause"),Txplayer.$(d).removeAttr("src"),"number"===Txplayer.$.type(e)&&this.setFocusVideoCurrentTime({time:e,autoplay:!0}),this.context.dataset.hasCallShowUIVipGuide=!1}},setPreloadVideoUrl:function(a){var b,c=this,d=Txplayer.$,e=Txplayer.util;a=a||{};var f=function(){return"string"===d.type(a)||!("object"!==d.type(a)||!a.url)};if((a.isPreloadFirstFilm||!this.isTheLastFilm()||f())&&this.context.dataset.playList){var g=this.getPreloadVideoTag(),h=this.context.dataset.playListIndex+1;a.isPreloadFirstFilm&&(h=0),h>=this.context.dataset.playList.length&&(h=this.context.dataset.playListIndex);var i=function(b){var f="";if(f="string"===d.type(b)?b:b.url,c.startBufferControl({video:g,src:f,hlsLoadStartTime:c.context.dataset.hlsLoadStartTime}),c.updateVideoStatus(g,"PRELOAD"),c.context.dataset.useChromeHls&&f&&"function"==d.type(f.indexOf)&&f.indexOf(".m3u8")!=-1){c.context.dataset.hlsLoadStartTime&&(a.currentTime=c.context.dataset.hlsLoadStartTime);var h=[];c.context.dataset.filmVideoData[0].urlArray.forEach(function(a,b){h.push(a.url)}),c.context.msg.broadcast("loadHlsSource",{p2pConfig:e.getP2pConfig(c.context),src:f,m3u8:b.m3u8,currentTime:a.currentTime,video:g,m3u8Urls:h,reason:"setPreloadVideoUrl"})}else{a.isPreloadFirstFilm&&c.context.msg.broadcast("setPreloadVideoUrlReport"),c.context.dataset.hlsLoadStartTime&&c.context.dataset.useHls&&(a.currentTime=c.context.dataset.hlsLoadStartTime,c.context.dataset.videoCurrentTime=a.currentTime,f=f.split("#t=")[0]+"#t="+Math.ceil(a.currentTime),e.v4log("safari-hls setPreloadVideoUrl dataset.hlsLoadStartTime",{src:f,hlsLoadStartTime:c.context.dataset.hlsLoadStartTime})),d(g).attr("src",f);try{c.videoHelper(g,"load")}catch(i){e.showInfo(i,i.stack)}}g.isFocus&&(e.showInfo("setPreloadVideoUrl.setUrlAndPlay.videoIsFocus"),a.autoplay=!0),f!=c.context.dataset.playList[c.context.dataset.playListIndex].url||a.isPreloadFirstFilm||(a.autoplay=!0,a.noUpdateIndex=!0),a.autoplay&&c.setPreloadVideoPlay(a),c.context.dataset.preloadStartTime=+new Date};b=a.url||this.context.dataset.playList[h];var j=a.m3u8||d.type("string"!==this.context.dataset.playList[h])&&this.context.dataset.playList[h].m3u8||"";"string"===d.type(b)?i({url:b,m3u8:j}):b&&b.url&&!a.preload&&b.url!==g.src?(b.preloading=!0,i({url:b.url,m3u8:j})):b&&"function"===d.type(b.getUrlSync)&&"PRELOADING"!=g.status&&(c.updateVideoStatus(g,"PRELOADING"),b.getUrlSync().done(function(c){b.url=c,e.showInfo("setPreloadVideoUrl.setUrlAndPlay",a),i(c)}).fail(function(a){c.updateVideoStatus(g,"IDLE")}))}}}},271:function(a,b){function c(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onLoadedmetadata",{isFocus:a.isFocus}),a.isFocus&&this.context.msg.broadcast("videoLoadedMetaData",{videoTag:a})}function d(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onCanplay",{isFocus:a.isFocus}),this.context.msg.broadcast("videoCanplay",{videoTag:a,playListType:this.context.dataset.currentPlayListType,index:this.context.dataset.playListIndex,isFocus:a.isFocus,src:a.src}),this.context.dataset.videoDuration=a.duration}function e(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onCanplayThrough",{isFocus:a.isFocus}),a.isFocus&&this.context.msg.broadcast("onCanplayThrough",{videoTag:a})}function f(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onPlay",{isFocus:a.isFocus,src:a.src}),a.src&&a.isFocus&&(this.context.msg.broadcast("videoPlay",{videoTag:a,playListType:this.context.dataset.currentPlayListType,index:this.context.dataset.playListIndex}),this.startWaitingFinder(),this.startVideoPlayingOnBadNet())}function g(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};a.isFocus&&(this.context.msg.broadcast("videoProgress",{videoTag:a}),a.buffered&&a.buffered.length&&a.buffered.end(a.buffered.length-1)===a.duration&&this.dataset.prevBuffered!==a.buffered.end(a.buffered.length-1)&&(this.dataset.prevBuffered=a.buffered.end(a.buffered.length-1),s.v4log("videoProgressDone",{isFocus:a.isFocus,Buffered:this.dataset.prevBuffered}),this.context.msg.broadcast("videoProgressDone",{videoTag:a,playListIndex:this.context.dataset.playListIndex,playListType:this.context.dataset.currentPlayListType})))}function h(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onWaiting",{isFocus:a.isFocus}),a.isFocus&&(this.context.msg.broadcast("videoWaiting",{videoTag:a,index:this.context.dataset.playListIndex,playListType:this.context.dataset.currentPlayListType,seeking:a.seeking}),this.setPlayState(3))}function i(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onSeeking",{isFocus:a.isFocus}),a.isFocus&&(this.context.dataset.isVideoSeeking=!0,this.context.msg.broadcast("videoSeeking",{videoTag:a,index:this.context.dataset.playListIndex,playListType:this.context.dataset.currentPlayListType,seeking:!0}))}function j(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onSeeked",{isFocus:a.isFocus}),a.isFocus&&(this.context.dataset.isVideoSeeking=!1,this.context.msg.broadcast("videoSeeked",{videoTag:a,index:this.context.dataset.playListIndex,playListType:this.context.dataset.currentPlayListType,seeking:!1}),(s.browser.ie&&"edge"===s.browser.ie.version||s.browser.safari)&&l.apply(this,Array.prototype.slice.call(arguments)))}function k(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};a.isFocus&&this.context.dataset.playbackRate&&a.playbackRate!=this.context.dataset.playbackRate&&(a.playbackRate=this.context.dataset.playbackRate)}function l(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};if(s.v4log("onPlaying",{isFocus:a.isFocus,src:a.src}),a.isFocus&&a.src){if(this.context.dataset.isPlayingAd)return s.v4log("pip pause>>>>"),void this.videoHelper(a,"pause");var b=this.context.dataset.playList[this.context.dataset.playListIndex];b&&(this.resetPlayListStatus("playing"),this.resetPlayListStatus("ended"),b.playing=!0),this.dataset.retryTimes=0,this.dataset.hlsRetryTimes=0,this.updateVideoStatus(a,"PLAYING"),this.setPlayState(1),this.context.msg.broadcast("videoPlaying",{videoTag:a,playListType:this.context.dataset.currentPlayListType,index:this.context.dataset.playListIndex}),this.setVideoPlaybackRate(),this.context.dataset.isSkippingTime||(this.context.dataset.isVideoSeeking=!1),this.context.dataset.isSkippingTime=!1}}function m(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onPause",{isFocus:a.isFocus}),a.isFocus&&(this.updateVideoStatus(a,"PAUSE"),this.context.dataset.isMinbufferControlPause||(this.context.msg.broadcast("videoPause",{videoTag:a,playListType:this.context.dataset.currentPlayListType,index:this.context.dataset.playListIndex,end:a.ended}),a.ended||this.setPlayState(2)))}function n(){var a=this.context.dataset.playList[this.context.dataset.playListIndex+1];if(a&&!a.preloading){var b=0;if(this.context.dataset.canPlayTime){for(var c=0;c<=this.context.dataset.playListIndex+1;c++)b+=parseInt(this.context.dataset.playList[c].data.duration,10);if(b>this.context.dataset.canPlayTime)return}(this.isFocusVideoBufferComplete()||this.isChrome56PlayAtTimeCount())&&(s.v4log("\u6b63\u5728\u81ea\u52a8\u9884\u52a0\u8f7d\u4e0b\u4e00\u8d34\u89c6\u9891"),this.setPreloadVideoUrl(),a.preloading=!0)}}function o(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};if(!a.isFocus)return s.v4log("\u9884\u52a0\u8f7d\u7684\u89c6\u9891\u53d1\u73b0\u64ad\u653e \u7acb\u9a6c\u6682\u505c"),void this.videoHelper(a,"pause");var b=parseInt(a.currentTime);if(b&&b!==this.dataset.prevCurrentTime){this.dataset.prevCurrentTime=b;var c=this.getPlayListDurationFromGetinfo();if(!this.context.dataset.useHls&&this.context.dataset.filmVideoData&&this.context.dataset.filmVideoData.length>1&&s.browser.chrome&&c>-1&&a.currentTime-c>.2&&!a.ended)return this.context.dataset.videoCurrentTime=c,this.videoHelper(a,"pause"),void Txplayer.$(a).trigger("ended",{from:"timeupdate"});this.context.dataset.videoCurrentTime=a.currentTime>c&&c>-1?c:a.currentTime,0==this.context.dataset.videoCurrentTime&&(this.context.dataset.videoCurrentTime=this.context.dataset.currentTime||0);var d=this.getVideoBufferedTime({video:a});this.context.dataset.bufferHealth=d-a.currentTime<0?0:parseInt(d-a.currentTime),this.context.dataset.videoBufferedTime=d,this.context.dataset.bufferedTime=this.getBufferdTime(),n.call(this),this.context.msg.broadcast("videoTimeUpdate",{videoTag:a,playListType:this.context.dataset.currentPlayListType,isTheLastFilm:this.isTheLastFilm()});try{this.context.userMsg.broadcast("timeupdate",{videoTag:a,currentTime:this.context.dataset.currentTime})}catch(e){}}}function p(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onEnd",{isFocus:a.isFocus});var b=arguments&&arguments[1]?arguments[1]:{};if(a.isFocus){if(this.context.dataset.isVideoSeeking=!1,a.duration===a.currentTime&&a.currentTime<this.context.dataset.duration-1&&this.context.dataset.useHls&&s.browser.safari&&!(this.context.dataset.canPlayTime&&this.context.dataset.currentTime>=this.context.dataset.canPlayTime))return void Txplayer.$(a).trigger("error");var c=this.context.dataset.playList[this.context.dataset.playListIndex];c&&(this.resetPlayListStatus("playing"),this.resetPlayListStatus("ended"),c.ended=!0);var d=this.isTheLastFilm();d?b.from&&"skipPrelude"==b.from&&(s.v4log("\u8df3\u8fc7\u7247\u5c3e\u4e3b\u52a8end","video.pause"),a.pause()):this.playTheNext(),this.updateVideoStatus(a,"IDLE"),s.v4log("broadcast-videoEnd",{isTheLastFilm:d,noHdAdPlugin:this.context.dataset.noHdAdPlugin||""}),d&&(this.context.dataset.isFilmEnded=!0),this.context.msg.broadcast("videoEnd",{videoTag:a,index:this.context.dataset.playListIndex,playListType:this.context.dataset.currentPlayListType,isTheLastFilm:d,isAllEnd:!!(d&&this.context.dataset.noHdAdPlugin||this.context.dataset.isEndingAdEnded),from:b&&b.from||"videoEvent"})}}function q(a,b,c){var d="";return a&&a.detail?"manifestLoadError"===a.detail||"levelLoadError"===a.detail?(d="05",d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video",d)):"fragLoadError"===a.detail?(d="08",d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video",d)):"manifestLoadLoadTimeOut"===a.detail||"levelLoadTimeOut"===a.detail?(d="06",d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video",d)):"fragLoadTimeOut"===a.detail?(d="09",d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video",d)):"timeout"===a.detail?(d="04",d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video",d)):"keyIdChange"===a.detail&&(d="10",d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video",d)):"film"==c&&b.error&&(d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video","0"+(b.error.code-1))),d}function r(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};this.context.dataset.videoWaitingReason=3,s.v4log("onError",arguments);var b=arguments&&arguments[1]?arguments[1]:{},c=a.isFocus?this.context.dataset.playListIndex:this.context.dataset.playListIndex+1,d=a.error&&a.error.code,e=3===d;!e||this.context.dataset.vid===u.vid&&this.context.config.playerType===u.playerType||(u.vid=this.context.dataset.vid,u.playerType=this.context.config.playerType,u.errorCode=d,u.isDecodeError=e,u.decodeErrorCount=0),e&&"undefined"!=typeof u.decodeErrorCount&&(u.decodeErrorCount++,u.decodeErrorCount<this.context.config.globalRetryTimes),!a.isFocus&&this.context.dataset.playList[this.context.dataset.playListIndex].preloading&&(c=this.context.dataset.playListIndex);var f=this.context.dataset.playList[c];if(f){var g=q(b,a,this.context.dataset.currentPlayListType);if(f.error=!0,f.errorCode=a.error&&a.error.code,(a.isFocus||(this.context.dataset.useChromeHls||this.stopVideo(a),this.context.dataset.useHls))&&(this.context.msg.broadcast("reportVideoError",{videoTag:a,type:this.context.dataset.currentPlayListType,index:this.context.dataset.playListIndex,code:g||a.error&&a.error.code||"",url:b.url||f.url||a.src||"",isFocus:a.isFocus}),!this.dataset.hasReportError)){if(this.dataset.retryTimes==this.context.config.globalRetryTimes||b.ckeyChange)return a._hlsDetail=b.detail||"",void this.triggerError(a,g,b);if(a.isFocus&&e&&u.decodeErrorCount>this.context.config.globalRetryTimes)return void this.triggerError(a,g,b);this.dataset.retryTimes++,1==this.dataset.retryTimes&&(this.dataset.saveRetryTimes++,this.saveRetryTimes(!0)),s.v4log("retryTimes",{retryTimes:this.dataset.retryTimes}),s.v4log("video\u51fa\u9519\u91cd\u8bd5\uff0c\u672c\u6b21\u91cd\u8bd5\u539f\u56e0\uff1a"+v[d]),f.error=!1,this.context.msg.broadcast("retryUrlsWhenErr",{currentTime:this.context.dataset.videoCurrentTime||0,index:this.context.dataset.playListIndex,isFocus:a.isFocus})}}}var s=Txplayer.util,t={},u={},v={1:"\u8bf7\u6c42\u4e2d\u6b62",2:"\u7f51\u7edc\u51fa\u9519",3:"\u89e3\u7801\u51fa\u9519",4:"\u8d44\u6e90\u4e0d\u652f\u6301"};t.triggerError=function(a,b){if(this.context.dataset.useChromeHls||!this.context.dataset.useChromeHls&&this.context.dataset.useHls&&s.browser.chrome){var c=a.error&&a.error.code||"",d=a.error&&a.error.message||"";return this.context.msg.broadcast("destroyHlsPlayer",{msg:a._hlsDetail+", code: "+c+", message: "+d}),this.clearPlaylist(),this.context.dataset.currentTime&&(this.context.dataset.connectionPlayTime=this.context.dataset.currentTime),this.dataset.hlsRetryTimes>=2?(this.dataset.retryTimes=0,s.v4log("chromehlsErrorSwitchToHtml5hd",{connectionPlayTime:this.context.dataset.connectionPlayTime}),delete this.context.dataset.hlsLoadStartTime,this.context.dataset.emeEnabled?this.context.msg.broadcast("error",{type:"hls",code:-11111,errCode:"-11111.2",exem:-2}):this.context.msg.broadcast("chromehlsErrorSwitchToHtml5hd",{code:b})):(this.dataset.retryTimes=0,s.v4log("chromehlsErrorSwitchToChromehls",{connectionPlayTime:this.context.dataset.connectionPlayTime}),this.context.msg.broadcast("chromehlsErrorSwitchToChromehls",{code:b})),void this.dataset.hlsRetryTimes++}var e={};a&&a.error?e.code=a.error.code:e.code=5,e.msg=Txplayer.v4errcode[e.code],e.type=this.context.dataset.currentPlayListType,e.videoTag=a,e.index=this.context.dataset.playListIndex,b&&(e.errCode=b),e.flowId=this.context.dataset.flowid,s.v4log("broadcast:error",e),this.context.msg.broadcast("error",e);try{this.context.userMsg.broadcast("error",e)}catch(f){}this.dataset.hasReportError=!0},t.initVideoEvents=function(){this.dataset.$video.on("loadedmetadata",c.bind(this)).on("canplay",d.bind(this)).on("canplaythrough",e.bind(this)).on("play",f.bind(this)).on("playing",l.bind(this)).on("progress",g.bind(this)).on("pause",m.bind(this)).on("timeupdate",o.bind(this)).on("ended",p.bind(this)).on("error",r.bind(this)).on("waiting",h.bind(this)).on("seeking",i.bind(this)).on("seeked",j.bind(this)).on("ratechange",k.bind(this))},a.exports=t},272:function(a,b){var c=Txplayer.util;a.exports={setVolume:function(a){var b;if("object"===Txplayer.$.type(a)?b=a.volume:(b=a,a={}),isNaN(b)||"number"!==Txplayer.$.type(b)||b>100&&b<0)return void c.showError("getVolume\u5931\u8d25","player.setVolume(volume),volume\u5fc5\u987b\u4e3a0-100\u7684\u6574\u6570");0==b?this.mute({broadcast:!1,isUserAction:a.isUserAction}):this.unMute({broadcast:!1,isUserAction:a.isUserAction}),this.dataset.$video.each(function(a,c){c.volume=b/100});var d=b!==this.context.dataset.volume;this.context.dataset.volume=b,this.context.msg.broadcast("volumeChange",{volume:b,isUserAction:!!a.isUserAction});try{d&&this.context.userMsg.broadcast("volumeChange",{volume:b,isUserAction:!!a.isUserAction})}catch(e){}a.showTips&&this.context.msg.broadcast("showUiVolumeTip",{volume:b})},getVolume:function(){return this.context.dataset.volume},mute:function(a){if(a=a||{},a.hasOwnProperty("broadcast")||(a.broadcast=!0),this.dataset.$video.each(function(a,b){b.muted=!0}),this.context.dataset.muted=!0,a.broadcast){try{this.context.userMsg.broadcast("volumeChange",{volume:0,isUserAction:!!a.isUserAction})}catch(b){}this.context.msg.broadcast("volumeChange",{volume:0,isUserAction:!!a.isUserAction})}a.showTips&&this.context.msg.broadcast("showUiVolumeTip",{mute:!0})},unMute:function(a){if(a=a||{},a.hasOwnProperty("broadcast")||(a.broadcast=!0),this.dataset.$video.each(function(a,b){b.muted=!1,b.removeAttribute("muted")}),this.context.dataset.muted=!1,a.broadcast){try{this.context.userMsg.broadcast("volumeChange",{volume:this.context.dataset.volume,isUserAction:!!a.isUserAction})}catch(b){}this.context.msg.broadcast("volumeChange",{volume:this.context.dataset.volume,isUserAction:!!a.isUserAction})}a.showTips&&this.context.msg.broadcast("showUiVolumeTip",{mute:!1})},volumeUp:function(a){var b=5;"number"===Txplayer.$.type(a)&&(b=parseInt(a));var c=this.getVolume();c+=b,c>100&&(c=100),this.setVolume(c)},volumeDown:function(a){var b=5;"number"===Txplayer.$.type(a)&&(b=parseInt(a));var c=this.getVolume();c-=b,c<0&&(c=0),this.setVolume(c)}}},273:function(a,b){function c(){var a=this;this.context.msg.on(d.getUniqueMsgKey("beforeVideoPlay"),function(b,c){a.resetVideoStatus(),a.context.dataset.retryTimesInLast5Play=0,a.context.dataset.bufferTimesInLast5Play=0,a.updateMinBuffer(),a.dataset.saveRetryTimes=0,a.dataset.retryTimes=0,a.dataset.bufferTimes=0,a.dataset.hasReportError=null,a.dataset.BUFFERINGTIME=0,a.context.dataset.bufferHealth=null,a.context.dataset.videoCurrentTime=0,a.context.dataset.videoBufferedTime=0,a.context.dataset.bufferedTime=0,a.context.dataset.bfTimeStart4564=0,a.context.dataset.bfTimeEnd4564=0,a.context.dataset.isVideoSeeking=!1,a.dataset.minBufferSpan=1,a.context.dataset.isFilmEnded=!1,a.context.dataset.isEndingAdEnded=!1,a.context.dataset.loadEnoughBuffer=!1,a.context.dataset.isMinbufferControlPause=!1,a.context.dataset.ckeytimeoutRetryCount=0,a.context.dataset.adExtras=void 0,a.context.dataset.isPreloadFilm=!1,a.setPlayState(-1),a.context.msg.broadcast("destroyHlsPlayer",{msg:"player init"}),a.context.msg.off("videoWaiting.loadEnoughBuffer"),a.clearFocusVideoUrl(),a.clearPlaylist("vidEnd",c)}),this.context.msg.on(d.getUniqueMsgKey("beforeVideoRePlay"),function(){a.clearPlaylist("vidEnd",a.context.dataset.vid)}),this.context.msg.on("loadEnoughBuffer",function(){a.context.msg.off("videoWaiting.loadEnoughBuffer"),a.context.msg.on("videoWaiting.loadEnoughBuffer",function(b){if(!b.seeking&&!a.context.dataset.isVideoSeeking&&!(a.context.dataset.isDefinitionSwitching||a.dataset.retryTimes>0)){a.dataset.bufferTimes++;var c=a.getFocusVideoTag();if(c){a.context.dataset.bfTimeStart4564=a.getVideoBufferedTime({video:c});var e=a.getVideoBufferedTime({video:c}),f=e-c.currentTime<0?0:parseInt(e-c.currentTime),g=a.context.dataset.canPlayTime||c.duration;d.v4log("\u7f13\u51b2\u7b56\u7565 - videoWaiting ",{bufferHealth:f,duration:g,minBuffer:a.context.dataset.minBuffer,bufferedTime:e})}a.context.msg.off("videoCanplay.EndOfTs"),a.context.msg.on("videoCanplay.EndOfTs",function(){if(a.context.msg.off("videoCanplay.EndOfTs"),a.context.dataset.useHls&&!a.context.dataset.isVideoSeeking&&!(a.context.dataset.isDefinitionSwitching||a.dataset.retryTimes>0)){var b=a.getFocusVideoTag();if(b){var c=a.getVideoBufferedTime({video:b}),e=c-b.currentTime<0?0:parseInt(c-b.currentTime),f=a.context.dataset.canPlayTime||b.duration;d.v4log("\u7f13\u51b2\u7b56\u7565 - videoCanplay ",{bufferHealth:e,duration:f,minBuffer:a.context.dataset.minBuffer,bufferedTime:c}),e<a.context.dataset.minBuffer&&f-c>a.context.dataset.minBuffer&&(a.context.msg.broadcast("pause",{from:"minbufferControl"}),a.context.dataset.isMinbufferControlPause=!0,a.context.msg.broadcast("minbufferControlStart"),a.context.msg.broadcast("showLoading"))}}}),a.context.msg.off("videoPlaying.minbufferControl"),a.context.msg.on("videoPlaying.minbufferControl",function(b){if(a.context.dataset.useHls&&(d.v4log("\u7f13\u51b2\u7b56\u7565-videoPlaying-before",{seeking:a.context.dataset.isVideoSeeking,
isDefinitionSwitching:a.context.dataset.isDefinitionSwitching,retryTimes:a.dataset.retryTimes}),a.context.msg.off("videoPlaying.minbufferControl"),!a.context.dataset.isVideoSeeking&&!(a.context.dataset.isDefinitionSwitching||a.dataset.retryTimes>0))){a.dataset.endVideoWaitingTime=+new Date;var c=b.videoTag,e=a.getVideoBufferedTime({video:c}),f=e-c.currentTime<0?0:parseInt(e-c.currentTime);f>=a.context.dataset.minBuffer&&(a.context.dataset.isMinbufferControlPause=!1,a.context.dataset.bfTimeEnd4564=e,a.context.dataset.videoWaitingReason=1,a.context.msg.broadcast("minbufferControlEnd"))}})}})}),this.context.msg.on("minbufferControlStart",function(){d.v4log("\u7f13\u51b2\u7b56\u7565-\u624b\u52a8\u6682\u505c\u4ee5\u540e-\u5f00\u59cb\u76d1\u542c\u4e0b\u8f7d\u4e8b\u4ef6minbufferControlStart"),a.context.msg.off("videoProgress.minbufferControl"),a.context.msg.on("videoProgress.minbufferControl",function(b){if(a.context.dataset.isMinbufferControlPause){var c=b.videoTag;if(!a.context.dataset.useHls)return a.context.dataset.isMinbufferControlPause&&(a.context.dataset.isMinbufferControlPause=!1,a.context.msg.broadcast("play",{from:"minbufferControl"})),d.v4log("\u7f13\u51b2\u7b56\u7565-chromehlsTomp4"),void a.context.msg.off("videoProgress.minbufferControl");var e=a.getVideoBufferedTime({video:c});a.context.dataset.bufferHealth=e-c.currentTime<0?0:parseInt(e-c.currentTime),a.context.dataset.bufferHealth>=a.context.dataset.minBuffer?(a.context.dataset.isMinbufferControlPause=!1,a.context.dataset.videoWaitingReason=2,a.context.dataset.bfTimeEnd4564=e,a.context.msg.broadcast("minbufferControlEnd"),a.context.msg.broadcast("play",{from:"minbufferControl"})):a.context.msg.broadcast("showLoading"),d.v4log("\u7f13\u51b2\u7b56\u7565-\u4e0b\u8f7d\u8fdb\u5ea6videoProgress",{bufferHealth:a.context.dataset.bufferHealth,minBuffer:a.context.dataset.minBuffer,isMinbufferControlPause:a.context.dataset.isMinbufferControlPause})}})}),this.context.msg.on("minbufferControlEnd",function(){a.context.msg.broadcast("hideLoading"),d.v4log("\u7f13\u51b2\u7b56\u7565-\u624b\u52a8\u6682\u505c\u6062\u590d\u64ad\u653e\u4ee5\u540e-\u7ed3\u675f\u76d1\u542c\u4e0b\u8f7d\u4e8b\u4ef6minbufferControlEnd"),a.context.msg.off("videoProgress.minbufferControl"),a.saveBufferTimes(!0),d.v4log("\u7f13\u51b2\u7b56\u7565-videoWaiting: ",{minBuffer:a.context.dataset.minBuffer,minBufferSpan:a.dataset.minBufferSpan}),a.context.dataset.minBuffer<14&&(a.context.dataset.minBuffer+=a.dataset.minBufferSpan,1===a.dataset.minBufferSpan&&(a.dataset.minBufferSpan=2))}),this.context.msg.on(d.getUniqueMsgKey("videoEnd"),function(b){(b.isAllEnd||b.isTheLastFilm)&&(a.updatePlayListIndex(0),a.clearPlaylist("vidEnd",a.context.dataset.vid),a.context.dataset.videoCurrentTime=0,a.context.dataset.currentTime=0,a.context.dataset.videoBufferedTime=0,a.context.dataset.bufferedTime=0),b.isAllEnd&&b.isTheLastFilm&&a.setPlayState(0),a.stopWaitingFinder(),a.stopVideoPlayingOnBadNet()}),this.context.msg.on(d.getUniqueMsgKey("error"),function(b){a.clearFocusVideoUrl(),a.clearPlaylist("vidEnd",a.context.dataset.vid),a.stopVideoPlayingOnBadNet(),a.stopWaitingFinder()}),this.context.msg.on("filmVideoShow",function(b){a.context.dataset.isPlayingAd=!1,a.context.msg.broadcast("isPlayingAdStatusChange",a.context.dataset.isPlayingAd,b),a.context.dataset.isPreloadFilm?a.setFocusVideoPlay():a.context.msg.broadcast("play",{isPreloadFirstFilm:!0})}),this.context.msg.on("filmVideoHide",function(b){a.context.dataset.isPlayingAd=!0,a.context.msg.broadcast("isPlayingAdStatusChange",a.context.dataset.isPlayingAd,b),a.context.msg.broadcast("pause")})}var d=Txplayer.util;a.exports={dealFilmMsgMoudle:c}},274:function(a,b){var c=Txplayer.util;a.exports={playTheNext:function(){if(!(this.context.dataset.canPlayTime>=this.context.dataset.currentTime)){if(this.isPreloadVideoReady())return void this.setPreloadVideoPlay();var a=this.context.dataset.playListIndex,b=(this.context.dataset.playList[a],this.context.dataset.playList[a+1]);if(b){if(this.updatePlayListIndex(a+1),b.error)return Txplayer.$(this.getFocusVideoTag()).trigger("error",{error:b.errorCode}),void this.resetPlayListStatus("error");c.showInfo("playTheNext",b),b.autoplay=!0,this.setFocusVideoUrl(b),this.resetPlayListStatus("playing"),b.playing=!0}}},play:function(a){if(this.context.dataset.playList&&0!=this.context.dataset.playList.length&&!this.context.dataset.disableHotKey){var b=this.context.dataset.playList[this.context.dataset.playListIndex];b&&(a&&"undefined"!=typeof a.autoplay?b.autoplay=a.autoplay:b.autoplay=!0,this.context.dataset.isDefinitionSwitching&&this.context.dataset.useChromeHls&&this.getFocusVideoTag().src&&(b.playing=!0),b.playing&&!b.error?this.setFocusVideoPlay():b.ended?this.playTheNext():b.error?Txplayer.$(this.getFocusVideoTag()).trigger("error"):b.preloading&&this.isPreloadVideoReady(a)?this.setPreloadVideoPlay(a):this.setFocusVideoUrl(b))}},stop:function(){this.setFocusVideoPause(),this.resetVideoStatus(),this.clearPlaylist(),this.setPlayState(0,{reason:"stop"});var a=this;["bufferedTime","currentTime","currentPlayListType","currentDefinitionFormat","currentDefinitionRate","currentVideoUrl","definition","bufferHealth","getinfoJSON","isLoadingAdEmpty","isDefinitionSwitching"].forEach(function(b){a.context.dataset[b]=null}),this.context.dataset.hasOwnProperty("isPlayingAd")&&(this.context.dataset.isPlayingAd=!1),this.context.msg.broadcast("userStopVideo",{})}}},275:function(a,b){var c=Txplayer.util;a.exports={resetFocusVideoUrl:function(a,b){var d=a.src;if(!this.context.dataset.useChromeHls&&!isNaN(b)){c.v4log("resetFocusVideoUrl",{time:b,src:d}),d=0==b?d.split("#t=")[0]:d.split("#t=")[0]+"#t="+Math.ceil(b);try{a.src=d,c.showInfo("resetFocusVideoUrl",d)}catch(e){}}},seekTo:function(a,b){var d=this,e=Txplayer.$,f=function(){try{if(d.checkTimeisInBufferdRange(b))return d.context.dataset.useChromeHls?void d.videoHelper(a,"play"):(a.currentTime=b,void d.videoHelper(a,"play"));if(d.context.dataset.retrySeekTo||c.browser.ie)return delete d.context.dataset.retrySeekTo,a&&a.duration&&(a.currentTime=b,d.videoHelper(a,"play")),void e(a).on("playing.HdPlayerSeekToPlayingHandler",function(){e(a).off("playing.HdPlayerSeekToPlayingHandler"),Math.abs(a.currentTime-b)>=5&&(a.currentTime=b,d.videoHelper(a,"play"))});c.v4log("seekTo resetFocusVideoUrl\u8bbe\u7f6ecurrentTime"),d.resetFocusVideoUrl(a,b),d.videoHelper(a,"play")}catch(f){}};f()}}},276:function(a,b){var c=Txplayer.util;a.exports={getPlayListDurationFromGetinfo:function(){var a=-1,b=this.context.dataset.playList[this.context.dataset.playListIndex];return b&&b.data&&b.data.duration&&(a=parseFloat(b.data.duration)),a},resetPlayListStatus:function(a){a&&Txplayer.$.each(this.context.dataset.playList||[],function(b,c){c.hasOwnProperty(a)&&(c[a]=!1)})},isTheLastOfPlayList:function(){if(!this.context.dataset.playList||0===this.context.dataset.playList.length)return!0;var a=this.context.dataset.playList[this.context.dataset.playListIndex+1];return!a},isTheLastFilm:function(){if(!this.context.dataset.playList||0===this.context.dataset.playList.length)return!0;var a=this.context.dataset.playList[this.context.dataset.playListIndex+1];return!a||(a.vid!=this.context.dataset.vid||!!(this.context.dataset.canPlayTime&&this.context.dataset.canPlayTime>=this.context.dataset.currentTime))},updatePlayListIndex:function(a){c.showInfo("updatePlayListIndex",a),"number"!==Txplayer.$.type(a)||a<0||this.context.dataset.playList&&this.context.dataset.playList.length&&a>=this.context.dataset.playList.length||(this.context.dataset.playListIndex=a,this.context.dataset.currentPlayListType="film")},addUrls2Player:function(a){var b={},d=this;if("array"===Txplayer.$.type(a)&&(b.data=a),"object"===Txplayer.$.type(a)&&"array"===Txplayer.$.type(a.data)&&(b=a),"array"!==Txplayer.$.type(b.data))return void c.showInfo("addUrls2Player \u53c2\u6570\u9519\u8bef");if(d.context.dataset.playList&&!b.clear||(d.context.dataset.playList=[],0!==d.context.dataset.playListIndex&&d.updatePlayListIndex(0)),b.data&&b.repalcePlayList===!0){var e=d.context.dataset.playList.length;if(b.data.length===e){var f=0;Txplayer.$(d.context.dataset.playList).each(function(a,c){d.context.dataset.playList[a]=b.data[f],f++})}else 0===e?d.context.dataset.playList=d.context.dataset.playList.concat(b.data):d.context.dataset.playList=b.data}else d.context.dataset.playList=d.context.dataset.playList.concat(b.data)},clearPlaylist:function(a,b){if(!this.context.dataset.playList)return void(this.context.dataset.playList=[]);if("vidEnd"===a&&b){var c=[];return Txplayer.$.each(this.context.dataset.playList,function(a,d){d.vid!==b&&c.push(d)}),this.context.dataset.playList=c,void this.updatePlayListIndex(0)}a||(this.context.dataset.playList=[]),0!==this.context.dataset.playListIndex&&this.updatePlayListIndex(0)}}},277:function(a,b){var c=Txplayer.util;a.exports={setPlayState:function(a,b){if(b=b||{},"number"===Txplayer.$.type(a)&&a!==this.context.dataset.playState){this.context.dataset.playState=a,this.context.msg.broadcast("playStateChange",{state:a,vid:this.context.dataset.vid,reason:b.reason||""});try{this.context.userMsg.broadcast("playStateChange",{state:a,vid:this.context.dataset.vid,reason:b.reason||""})}catch(c){}}},getPlayState:function(){return this.context.dataset.playState},setInternalPlaybackRate:function(a){if(a>=4||a<=.4)return void this.context.msg.broadcast("showUiPlaybackRateTip",a);if(this.context.dataset.playbackRate!==a){a=Math.round(100*a)/100,this.context.dataset.playbackRate=a,this.setVideoPlaybackRate(a),this.context.msg.broadcast("showUiPlaybackRateTip",a),this.context.msg.broadcast("playbackRateChange",a);try{this.context.userMsg.broadcast("playbackRateChange",a)}catch(b){}}},setVideoPlaybackRate:function(a){a=a||this.context.dataset.playbackRate,this.dataset.$video.each(function(b,c){c.playbackRate=a})},getPlaybackRate:function(){return this.context.dataset.playbackRate},setPlaybackRate:function(a){this.context.msg.broadcast("setPlaybackRate",a)},isChrome56WithBugOfMp4:function(){return"chromehls"!==this.context.config.playerType&&(this.context.dataset&&this.context.dataset.filmVideoData&&this.context.dataset.filmVideoData.length>1&&c.browser.chrome&&c.compareVersion(c.browser.chrome.version,"56.0.2924.10")>0)},isChrome56PlayAtTimeCount:function(){var a,b;return!!(this.isChrome56WithBugOfMp4()&&(a=this.getPlayListDurationFromGetinfo(),b=this.getFocusVideoTag(),a-30<=b.currentTime&&a>0))},getBufferdTime:function(){if(this.context.dataset.isPlayingAd)return 0;if(this.isChrome56WithBugOfMp4())return 0;var a=this.context.dataset.playListIndex,b=0;return Txplayer.$(this.context.dataset.filmVideoData).each(function(c,d){return c!==a&&void(b+=d.duration)}),b+=this.context.dataset.videoBufferedTime},saveRetryTimes:function(a){if(this.context.dataset.useHls){var b=c.getData(Txplayer.dataset.localStorageKey.retryTimes)||"[]",d=JSON.parse(b);if(a){var e=0==d.length?0:d.length-1;d[e]=this.dataset.saveRetryTimes}else{6==d.length&&d.shift(),this.context.dataset.retryTimesInLast5Play=0;for(var f=0;f<d.length;f++)this.context.dataset.retryTimesInLast5Play+=d[f];d.push(0)}c.v4log("\u7f13\u51b2\u7b56\u7565-saveRetryTimes",{retryArray:d,err:a}),c.setData(Txplayer.dataset.localStorageKey.retryTimes,JSON.stringify(d))}},saveBufferTimes:function(a){if(this.context.dataset.useHls){var b=c.getData(Txplayer.dataset.localStorageKey.bufferTimes)||"[]",d=JSON.parse(b);if(a){var e=0==d.length?0:d.length-1;d[e]=this.dataset.bufferTimes}else{6==d.length&&d.shift(),this.context.dataset.bufferTimesInLast5Play=0;for(var f=0;f<d.length;f++)this.context.dataset.bufferTimesInLast5Play+=d[f];d.push(0)}c.v4log("\u7f13\u51b2\u7b56\u7565-savebufferTimes",{bufferTimes:d,update:a}),c.setData(Txplayer.dataset.localStorageKey.bufferTimes,JSON.stringify(d))}}}},278:function(a,b){a.exports={initUserApis:function(){var a=this;this.dataset.moduleApis={},this.dataset.moduleApis.mute=this.mute.bind(this),this.dataset.moduleApis.unMute=this.unMute.bind(this),this.dataset.moduleApis.isMuted=function(){return!!a.context.dataset.muted},this.dataset.moduleApis.getPlayerState=this.getPlayState.bind(this),this.dataset.moduleApis.setVolume=this.setVolume.bind(this),this.dataset.moduleApis.getVolume=this.getVolume.bind(this),this.dataset.moduleApis.volumeUp=this.volumeUp.bind(this),this.dataset.moduleApis.volumeDown=this.volumeDown.bind(this),this.dataset.moduleApis.getPlaybackRate=this.getPlaybackRate.bind(this),this.dataset.moduleApis.setPlaybackRate=this.setPlaybackRate.bind(this),this.dataset.moduleApis.stop=this.stop.bind(this),this.dataset.moduleApis.showPcClientPop=function(b){a.context.msg.broadcast("showPcClientPop",b)},Txplayer.$.extend(this.context.userApi,this.dataset.moduleApis)},initPrivateMsg:function(){var a=this;this.dataset.privateApis={},this.dataset.privateApis.setVolume=this.setVolume.bind(this),this.dataset.privateApis.mute=this.mute.bind(this),this.dataset.privateApis.unMute=this.unMute.bind(this),this.dataset.privateApis.setInternalPlaybackRate=this.setInternalPlaybackRate.bind(this),this.dataset.privateApis.addUrls2Player=this.addUrls2Player.bind(this),this.dataset.privateApis.play=this.play.bind(this),this.dataset.privateApis.pause=this.setFocusVideoPause.bind(this),this.dataset.privateApis.setFocusVideoCurrentTime=this.setFocusVideoCurrentTime.bind(this),this.dataset.privateApis.setFocusVideoUrl=this.setFocusVideoUrl.bind(this),this.dataset.privateApis.setPreloadVideoUrl=this.setPreloadVideoUrl.bind(this),this.dataset.privateApis.setVideoClass=this.setVideoClass.bind(this),Txplayer.$.each(this.dataset.privateApis,function(b,c){a.context.msg.on(b,c)})},initDataApis:function(){var a=this;this.dataset.dataApis={},this.dataset.dataApis.getFocusVideoTag=function(b,c){c.data=a.getFocusVideoTag()},this.dataset.dataApis.checkTimeisInBufferdRange=function(b,c){c.data=a.checkTimeisInBufferdRange(b)},Txplayer.$.each(this.dataset.dataApis,function(b,c){a.context.msg.setData(b,c)})}}},279:function(a,b){var c=Txplayer.util;a.exports={startBufferControl:function(a){var b=this;if(!b.context.dataset.useHls)return void b.stopBufferControl();var c=Txplayer.util;if(b.context.dataset.loadEnoughBuffer)return void b.stopBufferControl();c.v4log("\u7f13\u51b2\u7b56\u7565-\u5f00\u59cb\u5b9a\u65f6\u5224\u65ad\u662f\u5426\u5230\u9996\u6b21\u53ef\u64ad\u72b6\u6001",a);var d=a.video||b.getFocusVideoTag();b.stopBufferControl(),this.dataset.bufferControl_TIMER=setInterval(function(){if(d.buffered&&d.buffered.length){var e=d.buffered.end(d.buffered.length-1)-d.buffered.start(d.buffered.length-1);c.v4log("\u7f13\u51b2\u7b56\u7565-\u9996\u6b21\u52a0\u8f7dBuffer\u8fdb\u5ea6",{hasBuffer:e,minBuffer:b.context.dataset.minBuffer}),c.v4log("step30-\u9996\u6b21\u52a0\u8f7dbuffer\u8fdb\u5ea6",{hasBuffer:e,minBuffer:b.context.dataset.minBuffer}),e>3&&(c.v4log("\u7f13\u51b2\u7b56\u7565-\u9996\u6b21\u52a0\u8f7dBuffer\u5b8c\u6210-\u629b\u51faloadEnoughBuffer\u4e8b\u4ef6"),b.context.msg.broadcast("loadEnoughBuffer",{src:a.src}),b.context.dataset.loadEnoughBuffer=!0,b.stopBufferControl())}},100)},stopBufferControl:function(){var a=this;a.dataset.bufferControl_TIMER&&(clearInterval(a.dataset.bufferControl_TIMER),a.dataset.bufferControl_TIMER=null)},updateMinBuffer:function(){var a=this;a.context.dataset.useHls&&(0==this.context.dataset.retryTimesInLast5Play&&this.context.dataset.bufferTimesInLast5Play<=3?this.context.dataset.minBuffer=5:this.context.dataset.retryTimesInLast5Play<=2&&this.context.dataset.bufferTimesInLast5Play<=6?this.context.dataset.minBuffer=6:this.context.dataset.retryTimesInLast5Play<=3&&this.context.dataset.bufferTimesInLast5Play<=10?this.context.dataset.minBuffer=8:(this.context.dataset.retryTimesInLast5Play>3||this.context.dataset.bufferTimesInLast5Play>9)&&(this.context.dataset.minBuffer=10),a.context.msg.off("getVideoUrlSuccess.updateMinBuffer"),a.context.msg.once("getVideoUrlSuccess.updateMinBuffer",function(){a.context.dataset.useHls&&a.context.dataset.duration&&a.context.dataset.duration<600&&(a.context.dataset.minBuffer-=2,c.v4log("\u7f13\u51b2\u7b56\u7565-updateMinBuffer-\u51cf2",{minBuffer:a.context.dataset.minBuffer,duration:a.context.dataset.duration||{}}))}),c.v4log("\u7f13\u51b2\u7b56\u7565-updateMinBuffer",{minBuffer:this.context.dataset.minBuffer,duration:this.context.dataset.duration||{}}))},startWaitingFinder:function(){this.dataset.waitingFinder_TIMER&&this.stopWaitingFinder();var a=this.getFocusVideoTag();if(a){var b,c=this;this.dataset.waitingFinder_TIMER=setInterval(function(){if(a.isFocus||(a=c.getFocusVideoTag()),b!==a.currentTime||a.paused||a.ended)c.dataset.isBadNetWork&&c.context.msg.broadcast("networkBadEnd",{videoTag:a,playListType:c.context.dataset.currentPlayListType,index:c.context.dataset.playListIndex}),c.dataset.isBadNetWork=!1;else{if(c.dataset.isBadNetWork)return;c.context.msg.broadcast("networkBadStart",{videoTag:a,playListType:c.context.dataset.currentPlayListType,isOnWaiting:3===c.getPlayState(),index:c.context.dataset.playListIndex}),c.dataset.isBadNetWork=!0}b=a.currentTime},1500)}},stopWaitingFinder:function(){this.dataset.waitingFinder_TIMER&&(clearInterval(this.dataset.waitingFinder_TIMER),this.dataset.waitingFinder_TIMER=null)},startVideoPlayingOnBadNet:function(){this.dataset.keepPlaying_TIMER&&this.stopVideoPlayingOnBadNet();var a,b,d,e=0,f=this,g=0,h=0;this.dataset.keepPlaying_TIMER=setInterval(function(){if(d=f.getFocusVideoTag(),0!=f.context.dataset.playState&&f.context.dataset.playState!=-1&&2!=f.context.dataset.playState&&!d.error&&d.src&&!d.paused&&!d.ended){if("BUFFERING"===d.status)return void f.addBufferingTime(d);a=f.getFocusVideoBuffer(),b=f.context.dataset.videoCurrentTime||0,h===a&&g===b?(f.updateVideoStatus(d,"BUFFER-CONFORM"),e++):(h=a,g=b,e=0,f.updateVideoStatus(d,"PLAYING")),e<5||(f.updateVideoStatus(d,"BUFFERING"),f.context.dataset.useChromeHls||(c.v4log("\u7f13\u51b2\u63a7\u5236-startVideoPlayingOnBadNet-\u5361\u987f\u76d1\u542c\u8d85\u8fc75s-reloadFocusVideoUrl",{status:d.status}),f.resetFocusVideoUrl(d,b),f.videoHelper(d,"load"),f.videoHelper(d,"play")),e=0,f.dataset.BUFFERINGTIME=0)}},1e3)},addBufferingTime:function(a){if(this.dataset.BUFFERINGTIME||(this.dataset.BUFFERINGTIME=0),this.dataset.BUFFERINGTIME++,this.dataset.BUFFERINGTIME>=30){if(this.context.dataset.useChromeHls&&this.dataset.BUFFERINGTIME<120)return;Txplayer.util.v4log("triggererror","startVideoPlayingOnBadNet"),Txplayer.$(a).trigger("error",{detail:"timeout"}),this.dataset.BUFFERINGTIME=0}},stopVideoPlayingOnBadNet:function(){this.dataset.keepPlaying_TIMER&&(clearInterval(this.dataset.keepPlaying_TIMER),this.dataset.keepPlaying_TIMER=null)}}}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(238)},238:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=c(239);d.prototype={init:function(){this.write(),this.addEventListerner()},write:function(){var a={shadow:"txp-shadow-mod"};this.dataset.renderData=a;var b=e.tmpl(g,a);this.context.$mod.$videomod.append(b),this.context.dataset.$shadow=this.context.$mod.$videomod.find("[data-role="+a.shadow+"]")},remove:function(){this.context.dataset.$shadow.remove()},initHDPlayerEvent:function(){var a=0,b=400,c=!1,d=this,e=function(){d.handlerClick()},g=function(){d.handlerDblClick()};this.context.dataset.$shadow.off("click.uishadow").off("dblclick.uishadow").on("click.uishadow",function(g){d.context.dataset.isRightClickMenu||(f.v4log("clickTigger: "),clearTimeout(a),a=setTimeout(function(){c||e(),c=!1},b))}).on("dblclick.uishadow",function(a){c=!0,g()})},handlerClick:function(){f.v4log("handlerClick: ");var a=this;try{a.context.userMsg.broadcast("userClickPlayBtn")}catch(b){}return a.context.dataset.getinfoJSON?void(1===a.context.dataset.playState?(a.context.msg.broadcast("pause"),a.context.msg.broadcast("userPausePlayer"),a.context.userMsg.broadcast("pause")):(a.context.msg.broadcast("playControl",{connectionPlayType:1}),a.context.msg.broadcast("userPlayPlayer"))):(a.context.msg.broadcast("beforeVideoRePlay"),a.context.msg.broadcast("playControl",{playStartTime:a.context.dataset.playStartTime,playEndTime:a.context.dataset.playEndTime,vid:a.context.dataset.vid,connectionPlayType:1}),void a.context.msg.broadcast("userPlayPlayer"))},handlerDblClick:function(){f.v4log("handlerDblClick: "),this.context.msg.broadcast("UiShadownDblClick")},addEventListerner:function(){f.mobile||this.initHDPlayerEvent()}},Txplayer.register("UiShadow",d)},239:function(a,b){a.exports='<txpdiv data-role="<%=shadow%>" class="txp_shadow"></txpdiv>'}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(103)},103:function(a,b,c){function d(){var a=Array.prototype.slice.call(arguments);a.unshift("[adapter]"),/debug|debugad/.test(location.search)&&window.console&&window.console.log&&window.console.log.apply(window.console,a)}function e(a){f=Txplayer.$,this.context=a,this.context.adApi={},this.dataset={loadingAdReporter:new j,adCreateParams:{},currentAdType:"",currentVideoAdType:"",videoEndForInsertAd:!1,adFirstPlay:!0,adMsg:new Txplayer.Events,adapterApi:{},adapterEvent:{},adEvent:{},adPlayer:null,waitForReport:{},adplayerLoadError:!1,startLoadAdMap:{}},this.context.dataset.isPlayingAd=!1,this.init()}var f,g=Txplayer.util,h=c(104),i=c(105),j=c(106),k=h.getPfEx(g),l=i.AD_TYPE,m=i.PLAYER_STATE,n=i.AD_EVENT,o=g.getUniqueMsgKey,p=e.prototype;p.init=function(){this.render(f),this.initAdapterApi(),this.initAdapterEvent(),this.initAdEvent(),this.exportsAdApis()},p.render=c(107),p.initAdapterApi=function(){var a=this.dataset.adapterApi,b=this,c=this.context;a.makeAdPlayer=function(a,c){function e(){if(!b.dataset.adPlayer){a.authData=b.context.dataset.txplayerAuth.raw();try{c(new window.TxpCreativePlayer(a))}catch(e){d(e)}}}"undefined"!=typeof window.TxpCreativePlayer?e():(d("pluginReady: ",window.TxpCreativePlayer),b.context.msg.on(o("pluginReady"),function(a){d("pluginReady: ",a),"TxpCreativePlayer"===a.name&&"undefined"!=typeof window.TxpCreativePlayer&&e()}),b.dataset.adplayerLoadTimeHandler||(b.dataset.adplayerLoadTimeHandler=setTimeout(function(){Txplayer.dataset.ready&&"undefined"==typeof window.TxpCreativePlayer&&(b.dataset.adplayerLoadError=!0,c())},5e3)))},a.initAd=function(){var a=h.getPu(b.context.config);try{b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.init)&&b.dataset.adPlayer.init({playerData:{playerPlatform:c.dataset.platform,playerWidth:c.dataset.playerWidth,playerHeight:c.dataset.playerHeight,playerLeft:0,playerTop:0,playtime:0,playerEndTime:b.context.dataset.playEndTime||c.dataset.duration,playerDuration:c.dataset.duration,playerFrom:h.getPlayerFrom(g),playerPf:h.getPf(b.getAdChannelId()),playerPfEx:k,playerVersion:Txplayer.dataset.ver,playerCid:c.dataset.cid||"",playerVid:c.dataset.vid,playerFlowid:c.dataset.flowid||"",playerGuid:c.dataset.guid||"",playerChid:b.getAdChannelId(),playerTpid:c.dataset.tpid,playerPt:c.dataset.businessId||"",playerPu:a,playerTrailerMode:c.dataset.trailerMode||!1,playerAdExt:c.dataset.adext||c.config.adext,playerType:c.config.playerType,playerIsSkipPrelude:c.dataset.skipPrelude,playerVptag:g.getPTAG()}})}catch(e){d(e)}},a.requestAdOrder=function(a){if(!c.dataset.noHdAdPlugin){var e=a.adtype;if(!e)return g.showError("\u5e7f\u544a\u8bf7\u6c42\u53c2\u6570\u9519\u8bef\uff0c\u6ca1\u6709adtype");var f=h.getDefaultAdRequestParams(b.getAdRequestParam(e));"undefined"!=typeof a.zcindex&&(f.zcindex=a.zcindex),c.config.usePreviewDomain&&(f.domain="l.cm.com",f.ehost=location.origin,f.auth_from=1);var i=(c.getinfo,h.getRequestor(a.adtype));i&&c.getinfo[i]&&!function(a){var e=+new Date;c.getinfo[i](f).always(function(f){var g=f.adcost||+new Date-e;f.adcost||(f.adcost=g);var i=b.getAdErrorCode(f);i?(c.msg.broadcast(h.getAdMsgName(a)+"End"),b.context.msg.broadcast("adPluginMsg",{name:"reportAd",adtype:a,reportData:{info:!0,data:{adcost:2101==i?-1:g||"",errorCode:i,adtype:a}}})):(f.adtype=a,d("broadcast: ",n.AD_ORDER_DATA_READY,", type: ",a),c.msg.broadcast(n.AD_ORDER_DATA_READY,f))})}(e)}},a.loadAd=function(c){if(c.adtype!==l.ZT||b.context.dataset.playState!=m.PLAYING)try{if(b.dataset.adFirstPlay&&(a.initAd(),b.dataset.adFirstPlay=!1),b.updateAdInfo(),b.dataset.adPlayer.setOrder(c),c.adtype!==l.VIDEO_MARK){var e=b.dataset.adPlayer.getOrdersByType(c.adtype)||[];if(c.adtype===l.LD){var f=b.dataset.adPlayer.getOrdersByType(l.PVL)||[];f.length&&(f.adtype="PVL",f.adcost=c.adcost,f.errorcode=c.errorcode,b.dataset.adPlayer.loadAd(f));var g=b.dataset.adPlayer.getOrdersByType(l.KB)||[];e=e.concat(g)}e.adtype=c.adtype,e.adcost=c.adcost,e.errorcode=c.errorcode,e.errMsg=c.orginStr||"";var i=0;c.videoErrorCode?(444===c.videoErrorCode&&(i=2103),i=2100):i=c.errorcode,b.reportAd({actionType:"info",step:1,adtype:c.adtype,errorCode:i,stepDuration:c.adcost>32e3?32e3:c.adcost}),c.adList&&"nintendo"!==b.context.config.playerType?(b.context.config.browserDisableAutoPlay&&b.dataset.adPlayer.muteAd(),b.dataset.adPlayer.loadAd(e)):(b.context.msg.broadcast("adPluginMsg",{name:"reportAd",adtype:c.adtype,reportData:{info:!0,data:{errMsg:c.orginStr,adcost:2101==c.errorcode?-1:c.adcost||"",errorCode:c.errorcode,adtype:c.adtype}}}),b.context.msg.broadcast(h.getAdMsgName(c.adtype)+"End"))}}catch(j){b.context.msg.broadcast(h.getAdMsgName(c.adtype)+"End"),d(j)}},a.playAd=function(a){b.dataset.adPlayer&&b.dataset.adPlayer.playAd(a)},a.pauseAd=function(a){b.dataset.adPlayer&&b.dataset.adPlayer.pauseAd(a)},a.stopAd=function(a){a!==l.LD&&a!==l.ZC&&a!==l.HT||(b.context.dataset.isPlayingAd=!1),b.dataset.adPlayer&&b.dataset.adPlayer.stopAd(a)},a.stopAllAd=function(){try{b.context.dataset.isPlayingAd=!1,b.dataset.adPlayer&&b.dataset.adPlayer.stopAllAd()}catch(a){d(a),b.dataset.$videoAdLayer.empty().addClass(Txplayer.dataset.hideClass)}},a.setVolume=function(a){b.dataset.adPlayer&&b.dataset.adPlayer.setAdVolume(a)},a.mute=function(a){b.dataset.adPlayer&&(a?b.dataset.adPlayer.muteAd():b.dataset.adPlayer.unMuteAd())},a.resize=function(a,c,d,e){var f,g,h,i,j=b.context.dataset.$playermod,k=j.width(),l=j.height(),m=j.find("video"),n=b.context.dataset.originalHwRate;if(n){var o=m.width(),p=m.height(),q=(p/o).toFixed(3);parseFloat(q)>=parseFloat(n)?(f=o,g=o*n):(g=p,f=p/n),d=(k-f)/2,e=(l-g)/2,h=f,i=g}else f=m.width(),g=m.height(),d=(k-f)/2,e=(l-g)/2;b.dataset.adPlayer&&(b.dataset.adPlayer.resizeAd({width:a,height:c,oWidth:h,oHeight:i,left:d,top:e}),b.dataset.adPlayer.init({playerData:{playerOWidth:h,playerOHeight:i,playerWidth:a,playerHeight:c,playerLeft:d,playerTop:e}}))},a.hideAdBeforeResize=function(){b.dataset.adPlayer&&b.dataset.adPlayer.hideAdBeforeResize()},a.setFullScreen=function(a){b.dataset.adPlayer&&b.dataset.adPlayer.setAdFullscreen(a)},a.setSmallWindow=function(a){setTimeout(function(){var c=b.context.dataset.$playermod.width(),d=b.context.dataset.$playermod.height();b.dataset.adPlayer&&b.dataset.adPlayer.resizeAd({width:c,height:d,oWidth:c,oHeight:d,left:0,top:0}),b.dataset.adPlayer&&b.dataset.adPlayer.setAdSmallWindow({isSmallWindow:a,width:c,height:d})},50)},a.setPosition=function(a){b.dataset.adPlayer&&b.dataset.adPlayer.setAdPosition(a)},a.report=function(a,c){b.dataset.adPlayer&&b.dataset.adPlayer.reportAd(a,c)},a.setPageWatchBuyData=function(){b.dataset.adPlayer&&b.dataset.adPlayer.setPageWatchBuyData()},a.clearPageWatchBuyData=function(){b.dataset.adPlayer&&b.dataset.adPlayer.clearPageWatchBuyData()},a.seekStart=function(a){b.dataset.adPlayer&&b.dataset.adPlayer.seekStart(a)},a.setPlayerData=function(a,c){var d={};d[a]=c,b.dataset.adPlayer&&b.dataset.adPlayer.setConf({playerData:d})}},p.initAdapterEvent=function(){var a=this.dataset.adapterEvent,b=this.dataset.adapterApi,c=this.context,e=this;a[o(n.VIDEO_AD_LAYER_SHOW)]=function(){e.dataset.$videoAdLayer.removeClass(Txplayer.dataset.hideClass)},a[o(n.VIDEO_AD_LAYER_HIDE)]=function(){e.context.dataset.disableHotKey=!1,e.dataset.$videoAdLayer.addClass(Txplayer.dataset.hideClass)},a[n.AD_ORDER_PPB_DATA_READY]=function(a){d(f," \u8ba2\u5355\u6570\u636e: ",a),a=a||{};var f=a.adtype;a.adtype||(f=l.PPB);var g=a;g.adtype=f,g.vid="",c.dataset.nextVid&&c.dataset.nextVideoInfo&&c.dataset.nextVideoInfo.vid&&(g.vid=c.dataset.nextVideoInfo.vid),g.errorcode=e.getAdErrorCode(a),0==g.errorcode&&(c.dataset.hasPpbRequest=!0),g.channel=h.getVideoType(),g.live=0,e.dataset.adPlayer?(e.context.dataset.$ppbAdLayer=e.context.dataset.$playermod.find('[data-role="txp-ui-control-preview-ad"]'),e.dataset.adPlayer.init({playerDom:{ppbAdLayer:e.context.dataset.$ppbAdLayer}}),b.loadAd(g)):e.createAdPlayer(g)},a[n.AD_ORDER_PDF_DATA_READY]=function(a){d(f," \u8ba2\u5355\u6570\u636e: ",a),a=a||{};var f=a.adtype;a.adtype||(f=l.PDF);var g=a;g.adtype=f,g.vid="",c.dataset.nextVid&&c.dataset.nextVideoInfo&&c.dataset.nextVideoInfo.vid&&(g.vid=c.dataset.nextVideoInfo.vid),g.errorcode=e.getAdErrorCode(a),g.channel=h.getVideoType(),g.live=0,e.dataset.adPlayer?(e.context.dataset.$pdfAdLayer=e.context.dataset.$playermod.find('[data-role="ui-definition-ad"]'),e.dataset.adPlayer.init({playerDom:{pdfAdLayer:e.context.dataset.$pdfAdLayer}}),b.loadAd(g)):e.createAdPlayer(g)},a[n.AD_ORDER_DATA_READY]=function(a){d(f," \u8ba2\u5355\u6570\u636e: ",a),a=a||{};var f=a.adtype;a.adtype||(f=l.LD);var g=a;g.adtype=f,g.vid="",c.dataset.nextVid&&c.dataset.nextVideoInfo&&c.dataset.nextVideoInfo.vid&&(g.vid=c.dataset.nextVideoInfo.vid),g.errorcode=e.getAdErrorCode(a),g.videoErrorCode=a.videoErrorCode,g.channel=h.getVideoType(),g.live=0,g.orginStr=a.orginStr||"",e.dataset.adPlayer?b.loadAd(g):e.createAdPlayer(g)},a[o("videoTimeUpdate")]=function(a){e.dataset.adPlayer&&e.dataset.adPlayer.setPlaytime(e.context.dataset.currentTime)},a[o("videoEnd")]=function(a){try{e.dataset.endingAdEmpty&&!a.isAllEnd&&a.isTheLastFilm?(c.msg.broadcast("endingAdEnd"),e.dataset.videoEndForInsertAd=!1,e.resetData()):!a.isAllEnd&&a.isTheLastFilm?(e.dataset.videoEndForInsertAd=!0,c.msg.broadcast("endingAdStart"),b.playAd(l.HT)):a.isAllEnd&&e.resetData()}catch(f){d(f)}},a[o("userSeekStart")]=function(){},a[o("seekStart")]=function(a){b.seekStart(a)},a[o("userPausePlayer")]=function(){e.context.dataset.currentTime&&(e.context.dataset.isPlayingAd||e.context.dataset.disableHotKey||(b.requestAdOrder({adtype:l.ZT}),b.setPlayerData("playerIsPausing",!0),b.pauseAd(l.PSJ),b.pauseAd(l.CZC)))},a[o("videoPlaying")]=function(){b.setPlayerData("playerIsPausing",!1),b.stopAd(l.ZT),"undefined"!=typeof window.TxpCreativePlayer&&window.TxpCreativePlayer.loadNextPart(),e.dataset.adPlayer&&e.dataset.adPlayer.init({playerData:{playerEndTime:e.context.dataset.playEndTime||e.context.dataset.duration}}),e.dataset.adMsg.broadcast("filmFirstPlay")},a[o("userStopVideo")]=function(){e.dataset.adapterApi.stopAllAd(),e.resetData()},a[o("beforeVideoRePlay")]=function(){e.dataset.adapterApi.stopAllAd(),e.resetData()},a[o("vidChange")]=function(){e.dataset.adapterApi.stopAllAd(),e.resetData(),e.updateAdInfo()},a[o("skipPreludeChange")]=function(a){e.dataset.adPlayer&&"function"===f.type(e.dataset.adPlayer.init)&&e.dataset.adPlayer.init({playerData:{playerIsSkipPrelude:e.context.dataset.skipPrelude}})},a[o("error")]=function(){e.dataset.adapterApi.stopAllAd(),e.resetData()},a[o("smallWindowModeChange")]=function(a){b.setSmallWindow(a.isSmallWindow)},a[o("windowFullscreenChange")]=function(a){b.setFullScreen(a)},a[o("videoScreenPercentChange")]=function(a){a/=100,setTimeout(function(){var c=e.context.dataset.$playermod.width(),f=e.context.dataset.$playermod.height(),g=c*a,h=f*a,i=g/a,j=h/a,k=(i-g)/2,l=(j-h)/2;b.resize(g,h,k,l),d("videoScreenPercentChange resize: ",g,h)},250)},a[o("resize")]=function(a){var c=a.width,e=a.height,f=a.left||0,g=a.top||0;e>c&&(e=parseInt(9*c/16,10),g=parseInt((a.height-e)/2,10)),d("resize resize: ",a.width,a.height),b.resize(c,e,f,g)},a[o("beforeResize")]=function(){b.hideAdBeforeResize()},a[o("beforeUiControlShow")]=function(){e.context.dataset.isControlShow||b.setPosition({bottom:50})},a[o("hideUiControl")]=function(){e.context.dataset.isControlShow&&b.setPosition({bottom:5})},a[o("volumeChange")]=function(a){if(a&&"undefined"!==f.type(a.volume)){var c=Math.min(80,a.volume);b.setVolume(c)}},a[o("adPluginMsg")]=function(a){var c;if("requestCgi"===a.name&&a.params){c=a.params;var d=c.toLowerCase()+"AdDataReady",i=h.getDefaultAdRequestParams(e.getAdRequestParam(c));e.context.config.usePreviewDomain&&(i.domain="l.cm.com",i.ehost=location.origin,i.auth_from=1);var j=(e.context.getinfo,h.getRequestor(c));if("function"===f.type(e.context.getinfo[j])){var l=+new Date;e.context.getinfo[j](i).always(function(a){var b=a.adcost||+new Date-l;a.adcost||(a.adcost=b);var f=e.getAdErrorCode(a);f?e.context.msg.broadcast("adPluginMsg",{name:"reportAd",adtype:c,reportData:{info:!0,data:{adcost:2101==f?-1:b||"",errorCode:f,adtype:c}}}):e.context.msg.broadcast(d,a)})}}else if("reportAd"===a.name){if(c=a.adtype||"",!c)return;a.reportData.info&&(a.reportData.data.playerData={playerFrom:h.getPlayerFrom(g),playerPf:h.getPf(e.getAdChannelId()),playerPfEx:k,playerVersion:Txplayer.dataset.ver,playerDuration:e.context.dataset.duration,playerChid:e.getAdChannelId(),playerVid:e.context.dataset.vid,playerCid:e.context.dataset.cid,playerTpid:e.context.dataset.tpid,playerFlowid:e.context.dataset.flowid,playerGuid:e.context.dataset.guid});var m=b.report(c,a.reportData);m||(e.dataset.waitForReport[c]=a)}else if("stopAd"===a.name){if(!a.adtype)return;b.stopAd(a.adtype)}},a[o("relevanceAd_close")]=function(){b.stopAd(l.BS)},a[o("watchAndBuyList")]=function(){b.setPageWatchBuyData()},f.each(a,function(a,b){c.msg.on(a,b)}),this.context.userMsg.on("1080pVipGuideClose.hdplayerad",function(a){a&&"closeSkipAd"===a.action&&e.dataset.currentVideoAdType&&b.playAd(e.dataset.currentVideoAdType)})},p.initAdEvent=function(){var a=this.context,b=this.dataset.adEvent,c=this.dataset.adapterApi,e=this,g=this.dataset.loadingAdReporter;b.requestOrderEvt=function(a){a&&a.adtype&&c.requestAdOrder({adtype:a.adtype})},b.showAdEvt=function(b){b&&b.adtype===l.PSJ&&c.resize&&c.resize(e.context.dataset.playerWidth,e.context.dataset.playerHeight),b&&b.adtype===l.BS&&a.msg.broadcast("adShowToClosePlayPoint",b)},b.getAdInfoEvt=function(a){var b=a.adtype,c=h.getAdMsgName(a.adtype);e.dataset[c+"Empty"]=a.isEmpty,b===l.LD&&(e.context.dataset.isLoadingAdEmpty=a.isEmpty),a.isEmpty||b!==l.LD||(e.context.dataset.isPlayingAd=!0,e.dataset.canPreloadP2P=!1)},b.loadStartEvt=function(a){a.index=+a.index;var b=+new Date;e.dataset.startLoadAdMap[a.adtype]||(e.dataset.startLoadAdMap[a.adtype]=[]),e.dataset.startLoadAdMap[a.adtype].push({vid:a.vid,duration:a.duration,index:a.index,time:b}),a.adtype===l.LD&&g.addStep25({vid:a.vid,duration:parseInt(a.duration/1e3,10),index:a.index,loadStartTime:b})},b.loadReadyEvt=function(b){var d=b.adtype,f=h.getAdMsgName(b.adtype);if(d===l.LD)a.msg.broadcast(f+"Start");else if(d===l.ZC)var g=setTimeout(function(){e.context.dataset.$shadow.css("pointer-events","none"),e.context.dataset.disableHotKey=!0,e.context.msg.broadcast("disableProgress"),e.context.msg.broadcast("disablePlayBtn"),e.context.msg.broadcast("disableDefinitionBtn"),clearTimeout(g)},500);else d===l.HT&&e.dataset.videoEndForInsertAd&&(a.msg.broadcast(f+"Start"),c.playAd(l.HT));if(e.dataset.waitForReport[d]){var i=e.dataset.waitForReport[d];e.dataset.adapterApi.report(i.adtype,i.reportData),delete e.dataset.waitForReport[d]}},b.loadProgressEvt=function(a){a.adtype===l.LD&&e.context.msg.broadcast("adLoadProgress",{speed:a.speed})},b.loadCompleteEvt=function(b){b.index=+b.index,b.adtype===l.LD&&(g.step25({index:b.index,loadCompleteTime:+new Date}),b.isAllEnd&&!a.dataset.hasTriggerPreload&&(a.dataset.hasTriggerPreload=!0,e.context.msg.broadcast("loadingAdLoadComplete",b)))},b.enterCountdownEvt=function(a){a.adtype===l.ZC&&(e.context.dataset.isDuringZcCountdown=!0)},b.enterCountdownCompleteEvt=function(b){b.adtype===l.ZC&&(e.context.dataset.isDuringZcCountdown=!1,a.dataset.$shadow.css("pointer-events","initial"),a.dataset.playState!==m.NOT_START&&a.dataset.playState!==m.END&&(a.msg.broadcast("insertAdStart"),c.playAd(l.ZC)))},b.playStartEvt=function(a){a.index=+a.index,a.actionType="playStart",e.reportAd(a),e.context.msg.broadcast("hideUiTips"),a.adtype===l.LD&&(e.context.dataset.hasLdAd=!0,e.context.dataset.isLoadingAdEmpty=!1),[l.LD,l.ZC,l.HT,l.ZT].indexOf(a.adtype)>-1&&(e.dataset.currentVideoAdType=a.adtype),e.dataset.currentAdType=a.adtype,e.context.dataset.currentAdType=a.adtype,a.adtype===l.LD&&g.step25({index:a.index,vid:a.vid,playStartTime:+new Date})},b.playEndEvt=function(a){if(a.adtype===l.LD){var b=g.getItem({step:25,index:a.index}),c=+new Date;g.step25({index:a.index,playEndTime:c,playduration:b&&b.playStartTime?parseFloat((c-b.playStartTime)/1e3,10):""})}},b.playErrorEvt=function(a){a.actionType="playError",e.reportAd(a);var b=g.getItem({step:25,index:a.index}),c=+new Date;g.step25({index:a.index,playEndTime:+new Date,errorCode:a.errorCode||"",playduration:b&&b.playStartTime?parseInt((c-b.playStartTime)/1e3,10):""}),a.isAllEnd&&(e.context.dataset.hasLdAd||(e.context.dataset.isLoadingAdEmpty=!0)),Txplayer.util.localLog("AD_PLAY_ERROR","ERROR_CODE:"+a.errorCode)},b.blackScreenEvt=function(a){e.context.msg.broadcast("adVideoShow"),e.context.msg.broadcast("filmVideoHide","loadingad"),e.context.dataset.adblockWaringCount=a?a.bc:0},b.stopAdEvt=function(a){try{if(e.context.dataset.currentAdType="",a.adtype!==l.LD&&a.adtype!==l.HT&&a.adtype!==l.ZC||e.context.msg.broadcast(h.getAdMsgName(a.adtype)+"End"),a.adtype===l.LD){var b=+new Date,c=g.getItem({step:25,index:-1});g.addStep35({loadingAdEndTime:b}),g.step25({index:-1,playEndTime:+new Date,playduration:c&&c.playStartTime?parseInt((b-c.playStartTime)/1e3,10):""})}}catch(f){d(f)}},f.each(b,function(a,b){e.dataset.adMsg.on(a,b)})},p.reportAd=function(a){a=a||{};var b=a.adtype,c=0,d=+new Date,e=this.dataset.startLoadAdMap[b];if(!a.stepDuration&&e&&e.length>0)for(var f=0,g=e.length;f<g;f++)if(e[f].index==a.index){c=d-e[f].time,"number"==typeof c&&c>1e4&&1===a.index&&(c=1e4);break}if(1==a.step){if(a.stepDuration<=0)return}else if(a.stepDuration<=0||c<=0)return;var h=window.performance&&window.performance.now()||0,i=a.adtype,j="undefined"!=typeof a.errorMessage?a.errorMessage:"";j="undefined"!=typeof a.actionType?j+";actionType:"+a.actionType:j,j="undefined"!=typeof a.preload?j+";preload:"+a.preload:j,j="undefined"!=typeof a.vid?j+";vid:"+a.vid:j,this.context.msg.broadcast("reportAdInfo",{version:Txplayer.appVersion,adtype:i,step:a.step||2,step_duration:a.stepDuration||c,step_code:a.errorCode||0,step_index:a.index||1,firstview_duration:parseInt(h,10),ext_info:j,src:a.src,step_dcode:a.detailErrCode||0})},p.exportsAdApis=function(){var a=this;this.dataset.adApis={};var b=this.dataset.adApis;b.getAdRequestParam=function(b){b=b||l.LD;var c=h.getDefaultAdRequestParams(a.getAdRequestParam(b));return a.context.config.usePreviewDomain&&(c.ehost=location.origin,c.auth_from=1),c},b.getAdCreateParams=function(){return a.dataset.adCreateParams},b.getAdReportData=function(){var b=a.dataset.loadingAdReporter,c={adtype:l.LD,adDuration:0,playAdDuration:0,list:[]};return b&&b.map&&f.each(b.map,function(a,d){if("step25"===a){var e=b.map.step25||[];e.forEach(function(a){a.loadCompleteTime||(a.loadCompleteTime=a.playStartTime||""),c.list.push(a),a.duration&&(c.adDuration+=a.duration),a.playduration&&(c.playAdDuration+=a.playduration)})}else if("step35"===a){var f=b.map.step35||[];f.forEach(function(a){c.loadingAdEndTime=a.loadingAdEndTime})}}),c},f.extend(this.context.adApi,b)},p.createAdPlayer=function(a){var b=this,c=this.dataset.adapterApi,d=this.dataset,e=this.context,i={playerDom:{player:e.dataset.$videomod[0],pvlAdLayer:e.dataset.$pvlAdLayer,ppbAdLayer:e.dataset.$ppbAdLayer,pdfAdLayer:e.dataset.$pdfAdLayer,videoAdLayer:d.$videoAdLayer[0],videoAdCountdownLayer:d.$videoAdCountdownLayer[0],interactiveAdLayer:d.$interactiveAdLayer[0]},playerMsg:this.dataset.adMsg,playerMethod:{showOpenVIPGuide:function(){return g.mobile&&!g.os.ipad?function(){g.txLoginOnMobile&&"function"===f.type(g.txLoginOnMobile.isLogin)&&g.txLoginOnMobile.isLogin(function(a){0===a?g.txLoginOnMobile.goLogin():location.href="http://film.qq.com/weixin/upay.html?aid=V0$$4:1"})}:"function"===f.type(e.config.showOpenVIPGuide)?function(){b.context.dataset.isWindowFullscreen&&b.context.msg.broadcast("exitWindowFullscreen"),b.context.dataset.isBrowserFullscreen&&b.context.msg.broadcast("exitBrowserFullscreen"),e.config.showOpenVIPGuide()}:void 0}(),getUserType:e.config.getUserType||function(){},getAdChannelId:b.getAdChannelId,getControlStatus:function(){return b.context.dataset.isControlShow},getPlayState:function(){return b.context.dataset.playState},userPlay:function(){b.context.userApi.play&&b.context.userApi.play()},userPausePlayer:function(){b.context.msg.broadcast("pause"),b.context.msg.broadcast("userPausePlayer")},toggleWindowFullScreen:function(){b.context.userApi.toggleWindowFullScreen&&b.context.userApi.toggleWindowFullScreen()},isLogin:function(a){b.context.config.loginHandler&&"function"==f.type(b.context.config.loginHandler.isLogin)&&b.context.config.loginHandler.isLogin(a)},isSmallWindow:function(){return b.context.dataset.isSmallWindowMode},isWindowFullscreen:function(){return b.context.userApi.isWindowFullscreen&&b.context.userApi.isWindowFullscreen()},upBarrageZindex:function(){b.context.dataset.$barrageMod&&b.context.dataset.$barrageMod.css("z-index",5)},resetBarrageZindex:function(){b.context.dataset.$barrageMod&&b.context.dataset.$barrageMod.css("z-index",3)},getVolume:function(){return e.dataset.muted?0:Math.min(80,e.dataset.volume)},getBrowserDisableIframeAutoPlay:function(){var a=Txplayer.util.browser,b=Txplayer.util.os,c=Txplayer.util.compareVersion;return b.mac&&a.safari&&c(a.safari.version,"11.0")>=1||a.chrome&&c(a.chrome.version,"66.0")>=1}},playerData:{playerVolume:Math.min(80,e.dataset.volume),playerPf:h.getPf(b.getAdChannelId()),playerChid:b.getAdChannelId(),playerVid:e.dataset.vid,playerCid:e.dataset.cid,playerTpid:e.dataset.tpid,playerPt:e.dataset.businessId||"",playerTrailerMode:e.dataset.trailerMode||!1,playerType:e.config.playerType,playerWidth:e.dataset.$playermod&&e.dataset.$playermod.width()||e.dataset.playerWidth,playerHeight:e.dataset.$playermod&&e.dataset.$playermod.height()||e.dataset.playerHeight,playerIsControlShow:e.dataset.isControlShow,playerIsBrowserFullscreen:e.dataset.isBrowserFullscreen,playerEndTime:e.dataset.playEndTime||e.dataset.duration,playerIsSkipPrelude:e.dataset.skipPrelude,playerVptag:g.getPTAG()},util:g};this.dataset.adCreateParams=i,c.makeAdPlayer(i,function(d){d?(b.dataset.adPlayer=d,c.loadAd(a)):b.context.msg.broadcast(h.getAdMsgName(a.adtype)+"End")})},p.resetData=function(){var a=this,b=this.dataset;b.adFirstPlay=!0,b.currentAdType="",b.currentVideoAdType="",b.videoEndForInsertAd=!1,b.playedTime=0,b.loadingAdReporter.clear(),b.startLoadAdMap={},a.context.dataset.hasLdAd=!1,a.context.dataset.currentAdType="",clearTimeout(b.endingAdTimeoutHandler),clearTimeout(b.adplayerLoadTimeHandler),this.context.dataset.hasTriggerPreload=!1,this.context.dataset.$shadow.css("pointer-events","initial"),this.dataset.waitForReport={},this.dataset.adapterApi.clearPageWatchBuyData()},p.getAdChannelId=function(){var a=this;return a.context.config&&a.context.config.hasOwnProperty("chid")&&""!==a.context.config.chid?a.context.config.chid:g.getAdChannelId()},p.getAdErrorCode=function(a){a=a||{};var b=0;return a.requestOk?a.adList&&a.adLoc||(b=2102):b=2101,b},p.updateAdInfo=function(){try{var a=(this.dataset.adapterApi,this.context.dataset.currentPercent?this.context.dataset.currentPercent/100:1),b=this.context.dataset.$playermod.width(),c=this.context.dataset.$playermod.height(),d=b*a,e=c*a,f=d/a,g=e/a,h=(f-d)/2,i=(g-e)/2;this.dataset.adPlayer.init({playerData:{playerOWidth:d,playerOHeight:e,playerWidth:d,playerHeight:e,playerLeft:h,playerTop:i,playerIsSkipPrelude:this.context.dataset.playerIsSkipPrelude}})}catch(j){}},p.getAdRequestParam=function(a){var b={};b.adtype=a,b.ad_type=a===l.LD?l[b.adtype]+"|"+l.KB+"|"+l.PVL:l[b.adtype],b.chid=this.getAdChannelId()||0,b.channelId=this.context.config.channelId,b.pf=h.getPf(b.chid),b.pf_ex=k,b.adaptor=2,b.live=0,b.cid=b.cid||this.context.dataset.cid||"",b.vid=b.vid||this.context.dataset.vid||"",b.rfid=g.getData(i.RFID),b.pt=this.context.dataset.businessId||"",b.flowid=this.context.dataset.flowid||"",b.trailerMode=this.context.dataset.trailerMode,b.isAnNewPlayAction=this.context.dataset.isAnNewPlayAction,b.adext=this.context.dataset.adext||this.context.config.adext,b.playerType=this.context.config.playerType,b.vptag=g.getPTAG(),b.guid=this.context.dataset.guid,b.platform=this.context.dataset.platform,b.adPage=this.context.config.adPage,b.tpid=this.context.config.tpid,b.pu=h.getPu(this.context.config)||0,b.from=h.getPlayerFrom(g);var c=this.context.dataset.txplayerAuth.ad();return g.extend(b,c),b},Txplayer.register("HdAdAdapter",e)},104:function(a,b,c){var d=c(105),e=(d.AD_STATUS,d.AD_LOC_TIME,d.AD_TYPE);a.exports={getVideoType:function(){var a="";return window.COVER_INFO&&window.COVER_INFO.typeid?a=+window.COVER_INFO.typeid:window.VIDEO_INFO&&window.VIDEO_INFO.type&&(a=+window.VIDEO_INFO.type),a},removeUrlParams:function(a){if("string"==typeof a){var b=document.createElement("a");return b.href=a,b.protocol+"//"+b.host+b.pathname}},getDefaultAdRequestParams:function(a){var b=this.removeUrlParams(document.referrer)||"";if(!b&&top!==window)try{b=this.removeUrlParams(top.location.href)||""}catch(c){}var d={pf:a.pf,ad_type:a.ad_type,pf_ex:a.pf_ex,url:this.removeUrlParams(location.href),refer:b,ty:"web",plugin:"1.0.0",v:Txplayer.dataset.ver,coverid:a.cid,vid:a.vid,pt:a.pt,flowid:a.flowid,vptag:a.vptag,pu:a.pu,chid:a.chid,adaptor:a.adaptor,dtype:1,live:a.live,resp_type:"json",guid:a.guid,req_type:1,from:a.from,appversion:Txplayer.appVersion};if(a.uid&&(d.uid=a.uid),a.tkn&&(d.tkn=a.tkn),a.lt&&(d.lt=a.lt),a.platform&&(d.platform=a.platform),a.opid&&(d.opid=a.opid),a.atkn&&(d.atkn=a.atkn),a.appid&&(d.appid=a.appid),a.adauthext&&(d.adauthext=a.adauthext),a.tpid&&(d.tpid=a.tpid),a.adtype===e.LD&&a.rfid&&(d.rfid=a.rfid),a.trailerMode&&(d.page="traileMode",d.trailerMode=1),"coolOpen"===a.playerType&&(d.page="coolOpen",a.isAnNewPlayAction?d.channelId=1:d.channelId=2),"page_langSwitch"===a.adext)d.page="langSwitch";else if(a.adext){var f=a.adext;f=f.split("|");for(var g=/(\w+)\_(\w+)/,h=0,i=f.length;h<i;h++){var j=f[h].match(g);3===j.length&&(d[j[1]]=j[2])}}return a.adPage&&(d.page=a.adPage),a.channelId&&(d.channelId=a.channelId),d},getAdMsgName:function(a){var b="";switch(a){case"LD":b="loadingAd";break;case"HT":b="endingAd";break;case"ZC":b="insertAd";break;case"ZT":b="pauseAd";break;case"IVB":b="ivbAd";break;case"PVL":b="pvlAd";break;case"PSJ":b="yaliuAd"}return b},getRequestor:function(a){var b="";switch(a){case"LD":b="loadingAd";break;case"HT":b="requestEndingAd";break;case"ZC":b="requestInsertAd";break;case"ZT":b="requestPauseAd";break;case"PPB":b="requestPpbAd";break;case"PDF":b="requestPdfAd";break;case"IVB":b="requestIvbAd";break;case"PSJ":b="requestYaliuAd"}return b},getPfEx:function(a){var b=this.getExtensionPlatform(a);return"mac"===b||"pc"===b?"pc":b},getPu:function(a){return"function"===Txplayer.$.type(a.getUserType)?a.getUserType():""},getExtensionPlatform:function(a){return a.os.iphone?"iphone":a.os.ipad?"ipad":a.os.android?"android":a.os.mac?"mac":a.os.windows?"pc":""},getPlayerFrom:function(a){var b=this.getExtensionPlatform(a);return"ipad"===b?6:0},getPf:function(a){if(Txplayer.util.inNewIframe())return"out";var b=location.hostname;return"v.qq.com"===b||"film.qq.com"===b||8===a?"in":"out"}}},105:function(a,b){a.exports={RFID:"TxpCreativePlayer-rfid",AD_EVENT:{AD_ORDER_DATA_READY:"onAdOrderDataReady",AD_ORDER_PPB_DATA_READY:"ppbAdDataReady",AD_ORDER_PDF_DATA_READY:"pdfAdDataReady",VIDEO_AD_LAYER_SHOW:"adVideoShow",VIDEO_AD_LAYER_HIDE:"adVideoHide"},PLAYER_STATE:{NOT_START:-1,END:0,PLAYING:1,PAUSE:2,LOADING:3},AD_TYPE:{LD:"LD",HT:"HT",ZC:"ZC",ZT:"ZT",KB:"KB",PSJ:"PSJ",PPB:"PPB",PVL:"PVL",ZI:"ZI",BS:"BS",PDF:"PDF",VIDEO_MARK:"PSJ|BS|ZI|ZC|CZC|VIN",CZC:"CZC"},LD_AD_REG:/LD|KB/,VIDEO_AD_REG:/LD|KB|ZC|HT/}},106:function(a,b){function c(){this.map={}}var d=c.prototype;d.add=function(a){var b="step"+a.step;this.map[b]||(this.map[b]=[]),delete a.step;var c=this.map[b],d=0;c.forEach(function(b,c){b.index===a.index&&(d=1)}),d||c.push(a)},d.clear=function(){this.map={}},d.addStep25=function(a){a.step=25,this.add(a)},d.addStep35=function(a){a.step=35,this.add(a)},d.getItem=function(a){var b=this.map["step"+a.step]||[],c={};return a.index===-1?b.length>0?b[b.length-1]:{}:(b.forEach(function(b){if(b.index===a.index)return c=b,!1}),c)},d.step25=function(a){var b=this.map.step25||[],c=b[b.length-1];if(b.forEach(function(b,c){if(b.index===a.index)for(var d in a)a.hasOwnProperty(d)&&(b[d]=a[d])}),a.index===-1&&c)for(var d in a)a.hasOwnProperty(d)&&"index"!==d&&(c[d]=a[d])},a.exports=c},107:function(a,b){a.exports=function(a){var b={videoAdLayer:"hd-ad-adapter-adlayer",videoAdCountdownLayer:"hd-ad-adapter-videoadcountdownlayer",interActiveAdLayer:"hd-ad-adapter-interactivelayer"},c=this.context.dataset.$videomod;c.after('<txpdiv data-role="'+b.videoAdLayer+'"></txpdiv>'),c.after('<txpdiv data-role="'+b.interActiveAdLayer+'"></txpdiv>'),c.after('<txpdiv data-role="'+b.videoAdCountdownLayer+'">');var d=this.context.dataset.$videomod.parent();this.dataset.$videoAdLayer=d.find('[data-role="'+b.videoAdLayer+'"]'),this.dataset.$interactiveAdLayer=d.find('[data-role="'+b.interActiveAdLayer+'"]'),this.dataset.$videoAdCountdownLayer=d.find('[data-role="'+b.videoAdCountdownLayer+'"]'),this.dataset.$videoAdLayer.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",zIndex:4,backgroundColor:"#000"}).addClass(Txplayer.dataset.hideClass),this.dataset.$interactiveAdLayer.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",zIndex:4,pointerEvents:"none"}).addClass(Txplayer.dataset.hideClass),this.dataset.$videoAdCountdownLayer.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",zIndex:4,pointerEvents:"none"}).addClass(Txplayer.dataset.hideClass)}}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(219)},83:function(a,b){a.exports='<txpdiv data-role="<%=poster%>" class="txp_poster"></txpdiv>'},219:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=c(83);d.prototype={init:function(){this.dataset.showPoster=!0,this.context.config.poster===!1?this.dataset.showPoster=!1:"string"===e.type(this.context.config.poster)&&(this.context.dataset.poster=this.context.config.poster),this.write(),this.initDisplay(),this.addEventListerner(),this.exportsModuleApis()},initDisplay:function(){function a(){if(c.context.dataset.poster||(f.mobile?c.context.dataset.poster=f.getMobileVideoPosterByVid(b,0):c.context.dataset.poster=f.getPcVideoPosterByVid(b)),c.context.dataset.poster){var a={"background-image":"url("+c.context.dataset.poster+")","background-size":"cover"};c.dataset.$poster.css(a),c.show()}}if((!this.context.config.official||!this.context.dataset.autoplay&&!this.context.config.autoplay)&&this.dataset.showPoster){var b=this.context.dataset.vid||this.context.config.vid,c=this;b?a():this.context.msg.on("ready",function(){b=c.context.dataset.vid,a()})}},write:function(){var a={poster:"txp-ui-poster"};this.dataset.renderData=a;var b=e.tmpl(g,a);this.context.dataset.$playermod.append(b),this.dataset.$poster=this.context.dataset.$playermod.find('[data-role="'+a.poster+'"]')},remove:function(){this.dataset.$poster.remove&&this.dataset.$poster.remove()},setPoster:function(a){"string"===e.type(a)&&(this.context.dataset.poster=a,this.initDisplay())},getPoster:function(){return this.context.dataset.poster},hide:function(){this.dataset.$poster.addClass(Txplayer.dataset.hideClass)},show:function(){this.dataset.$poster.removeClass(Txplayer.dataset.hideClass)},addEventListerner:function(){var a=this,b=this.context.dataset.playState,c=this.context.dataset.isPlayingAd;(e.inArray(b,[0,1,3])>-1||c)&&this.hide(),this.dataset.eventsList={},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("videoPlay")]=function(){f.mobile||a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(){a.context.dataset.poster=null,a.initDisplay(),a.context.dataset.autoplay&&a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("playStateChange")]=function(b){b=b||{},0===b.state&&(f.mobile||(a.context.dataset.poster=null),a.initDisplay())},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)}),this.dataset.$poster.on("click",function(){a.context.dataset.$shadow.trigger("click")}).on("dblclick",function(){a.context.dataset.$shadow.trigger("dblclick")})},exportsModuleApis:function(){this.dataset.moduleApis={},this.dataset.moduleApis.getPoster=this.getPoster.bind(this),this.dataset.moduleApis.setPoster=this.setPoster.bind(this),e.extend(this.context.userApi,this.dataset.moduleApis)}},Txplayer.register("UiPoster",d)}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(264)},264:function(a,b){function c(a){d=Txplayer.$,this.dataset={},this.context=a,this.init()}var d=Txplayer.$,e=Txplayer.util;c.prototype={init:function(){this.addEventListener()},getDefaultParams:function(){this.dataset.format=this.context.dataset.currentDefinitionFormat||"",this.dataset.rate=this.context.dataset.currentDefinitionRate||"",this.dataset.cdnID=this.context.dataset.cdnID;var a=e.getLoginID(),b=this.context.dataset.txplayerAuth.raw(),c=this.context.dataset.platform,d={hc_main_login:b.main_login,hc_vuserid:b.vuserid||Txplayer.util.cookie.get("vuserid"),hc_openid:b.openid,hc_appid:b.appid,loginid:a.loginId,loginex:a.loginIdEx,logintype:a.logintype,guid:this.context.dataset.guid||"",longitude:"",latitude:"",vip:this.isVip(),online:navigator.onLine?1:0,p2p:this.context.dataset.useP2P?1:0,downloadkit:this.context.dataset.useP2P?1:0,resolution:[screen.width,screen.height,window.devicePixelRatio||1].join("*"),testid:this.context.dataset.reportTestId||"",osver:[e.os.name,e.os.version].join(" "),playerver:"",playertype:1,uip:this.context.dataset.reportUsrIP||"",confid:"",cdnip:this.context.dataset.hlsServerIP||"",cdnid:this.dataset.cdnID||"",cdnuip:this.context.dataset.hlsClientIP||"",freetype:"",sstrength:"",network:"",speed:"",device:"",appver:this.context.dataset.testVer,p2pver:"",url:location.href,refer:document.referrer,ua:e.getReportUA(),ptag:e.getPTAG(),flowid:this.context.dataset.flowid,platform:c||"",dltype:this.context.dataset.useHls?this.context.dataset.dltype||3:1,vid:this.context.dataset.vid||this.context.config.vid,cid:this.context.dataset.cid||"",fmt:this.dataset.format||"",rate:this.dataset.rate||"",clip:this.context.dataset.reportClip||"",status:this.context.dataset.reportStatus||"",type:this.context.dataset.reportType||"",duration:this.context.dataset.duration||"",ext:{dltype:this.context.dataset.useHls?this.context.dataset.dltype||3:1,m3u8:0},drm:this.context.dataset.emeEnabled?1:0};if(this.context.dataset.getinfoJSON){d.ext.dltype=this.context.dataset.getinfoJSON.dltype;var f=this.context.dataset.getinfoJSON.vl;f&&f.vi&&f.vi[0]&&f.vi[0].ul&&f.vi[0].ul.m3u8&&(d.ext.m3u8=1)}return d.ext.dltype&&(d.ext=JSON.stringify(d.ext)),1==this.context.dataset.isQuic?(d.proto="libquic",d.protover=this.context.dataset.quicVer||""):(d.proto="tcp",d.protover="tcp00"),d},isVip:function(){var a="";return this.context&&this.context.config&&"function"===d.type(this.context.config.getUserType)&&(a=2==this.context.config.getUserType()?1:0),a},resetDataset:function(){this.dataset={},this.context.dataset.cdnID="",this.context.dataset.currentVideoUrl="",this.context.dataset.urlIndex=0,this.context.dataset.isQuic=0,this.context.dataset.quicVer=""},report:function(a,b){if(b=b||"4501",this.dataset.hasOwnProperty("sequence")||(this.dataset.sequence=-1),"4564"!=b&&++this.dataset.sequence,a.hasOwnProperty("seq")&&""!==a.seq||(a.seq=this.dataset.sequence||0),"4564"==b)for(var c in a)(70!=a.step&&d.inArray(c,["step","flowid","data"])==-1||70==a.step&&d.inArray(c,["step","flowid","data","ftime","vid","url","refer","loginid","logintype","ua"])==-1)&&delete a[c];var f="//btrace.video.qq.com/kvcollect?BossId=4501&Pwd=142347456&";"4564"==b&&(f="//btrace.video.qq.com/kvcollect?BossId=4564&Pwd=213967996&"),f+=d.param(a),Txplayer.imgRpt?e.requestViaImage(f):e.fetch({url:f,credentials:"include"})},step0:function(){var a={code:"",quic:this.context.dataset.isQuic||0,quicver:this.context.dataset.quicVer||"",stime:this.context.config.pageInitTime};a=d.extend(this.getDefaultParams(),{data:JSON.stringify(a)}),a.step=0,this.report(a)},step5:function(){var a=this.context.config.playerInitTime||this.context.dataset.playerCreateStartTime,b={quic:this.context.dataset.isQuic||0,quicver:this.context.dataset.quicVer||"",stime:a,etime:this.context.dataset.playerCreateEndTime,code:this.context.dataset.errorCodeOfStep5||""};b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=5,this.report(b)},step15:function(a){a=a||{};var b={ip:this.context.dataset.reportUsrIP,quic:this.context.dataset.isQuic||0,quicver:this.context.dataset.quicVer||"",stime:a.startTime,etime:a.endTime,code:""};"timeout"===a.err?b.code=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","03"):a.err&&!a.hasOwnProperty("code")?b.code=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","01"):a.err&&a.hasOwnProperty("code")&&(b.code=Txplayer.v4errcode.getPlatformErrorCode("getinfo","cgiInnerError",a.code+"")),b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=15,this.report(b)},step20:function(a){a=a||{};var b={ip:this.context.dataset.reportUsrIP,quic:this.context.dataset.isQuic||0,quicver:this.context.dataset.quicVer||"",stime:a.startTime,etime:a.endTime,code:a.errCode||""};b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=20,this.report(b)},step25:function(){if(this.dataset.adReportData&&this.dataset.adReportData.list&&0!=this.dataset.adReportData.list.length){var a=[],b=this;this.dataset.adReportData.list.forEach(function(c,d){c.playStartTime&&c.loadStartTime&&c.playStartTime-c.loadStartTime<=200&&(c.loadStartTime=c.loadCompleteTime=c.playStartTime),a.push({vid:c.vid||"",format:"",stime:c.loadStartTime||"",letime:c.loadCompleteTime||"",pstime:c.playStartTime||"",petime:c.playEndTime||"",playduration:c.playduration||0,duration:c.duration||0,quic:b.context.dataset.isQuic||0,quicver:b.context.dataset.quicVer||"",code:c.errorCode||""})});var c=d.extend(this.getDefaultParams(),{data:JSON.stringify(a)});c.step=25,this.report(c)}},step30:function(a){a=a||{};var b={stime:this.dataset.playTime||"",etime:this.dataset.playingTime||+new Date,p2p_ctime:this.context.dataset.connectionPlayTime,p2p_pretime:this.context.dataset.skipPrelude?this.context.dataset.playStartTime:0,bufferduration:"",vt:this.context.dataset.cdnID||"",url:a.url||this.context.dataset.currentVideoUrl||"",urlindex:this.context.dataset.urlIndex,quic:this.context.dataset.isQuic||0,quicver:this.context.dataset.quicVer||"",code:this.dataset.errorCodeOfStep30||""};this.dataset.hlsPlayTimeTheFirstTime&&(b.stime=this.dataset.hlsPlayTimeTheFirstTime),this.dataset.hlsFirstFragementLoadEndTime&&(this.context.dataset.hasLdAd&&(b.etime=this.dataset.hlsFirstFragementLoadEndTime),e.v4log("step30-\u9996\u6b21\u52a0\u8f7d\u89c6\u9891\u8017\u65f6(m3u8\u5f00\u59cb\u5230\u7b2c\u4e00\u4e2ats30%\u4e0b\u8f7d\u5b8c)",{stime:this.dataset.hlsPlayTimeTheFirstTime,etiem:this.dataset.hlsFirstFragementLoadEndTime,costtime:this.dataset.hlsFirstFragementLoadEndTime-this.dataset.hlsPlayTimeTheFirstTime})),e.v4log("step30-\u9996\u6b21\u52a0\u8f7d\u89c6\u9891\u8017\u65f6(\u6bcf\u9694100ms\u8f6e\u8be2video\u7684buffer\uff0c\u7b49buffer\u65f6\u957f\u5927\u4e8e3\u79d2",{stime:this.dataset.hlsPlayTimeTheFirstTime,etiem:this.dataset.playingTime,costtime:this.dataset.playingTime-this.dataset.hlsPlayTimeTheFirstTime}),"undefined"!=typeof this.context.dataset.adblockWaringCount&&(b.cacdc=this.context.dataset.adblockWaringCount,this.context.dataset.adblockWaringCount=void 0),b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=30,this.report(b)},step31:function(){var a={type:this.context.dataset.useChromeHls?2:1,stime:this.dataset.switchDefnPlayTime,etime:this.dataset.switchDefnPlayingTime,bufferduration:"",url:"",urlindex:this.context.dataset.urlIndex,vt:this.context.dataset.cdnID,quic:this.context.dataset.isQuic||0,quicver:this.context.dataset.quicVer||"",code:this.dataset.errorCodeOfStep31||""};a=d.extend(this.getDefaultParams(),{data:JSON.stringify(a)}),a.step=31,this.report(a)},step35:function(){if(!(this.dataset.waitingStartTime&&this.dataset.waitingEndTime&&this.dataset.waitingEndTime-this.dataset.waitingStartTime<=200)&&!(this.dataset.waitingDuration<200)&&this.context.dataset.currentTime&&!(this.context.dataset.bfTimeStart4564&&this.context.dataset.bfTimeStart4564-this.context.dataset.currentTime>=5)){if(this.context.dataset.useChromeHls){this.context.msg.broadcast("reportChromeHlsError",0);var a=this.context.dataset.definition;this.context.msg.broadcast("setChromeHlsData",{k:"__stuck__",v:{defn:a&&a.replace("auto-","")||"",vid:this.context.dataset.vid}})}var b=this.context.dataset.currentVideoUrl,c={val:[{reason:"",scene:1!=this.context.dataset.playbackRate?2:1,format:this.context.dataset.currentDefinitionFormat||"",ptime:this.context.dataset.currentTime||"",stime:this.dataset.waitingStartTime||"",etime:this.dataset.waitingEndTime||"",code:this.dataset.errorCodeOfStep35||"",quic:this.context.dataset.isQuic||0,quicver:this.context.dataset.quicVer||"",url:b}],tcount:1,tduration:this.dataset.waitingDuration||""};e.v4log("\u7f13\u51b2\u7b56\u7565-reportstep35",c),c=d.extend(this.getDefaultParams(),{data:JSON.stringify(c)}),c.step=35,this.report(c)}},step40:function(a){a=a||{};var b={tcount:1,tbcount:0,tbduration:this.dataset.seekWaitingDuration||0,quic:this.context.dataset.isQuic||0,quicver:this.context.dataset.quicVer||"",val:{format:this.context.dataset.currentDefinitionFormat,pstime:a.currentTimeWhenSeekStart||this.dataset.currentTimeWhenSeekStart||"",petime:a.currentTimeWhenSeekEnd||"",code:this.dataset.errorCodeOfStep40||""}};this.dataset.seekWaitingStartTime&&a.isSeekOfWaiting?(b.val.lstime=this.dataset.seekWaitingStartTime,b.val.letime=this.dataset.seekEndTime,b.tbcount=1):(b.val.lstime=0,b.val.letime=0,b.tbduration=0),b.val=[b.val],b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=40,this.report(b),delete this.dataset.seekWaitingDuration},step45:function(){var a={reason:"",auto:1,format:this.context.dataset.currentDefinitionFormat||"",pstime:this.dataset.switchDefnStartVideoTime||"",petime:this.dataset.switchDefnEndVideoTime||"",lstime:this.dataset.switchDefnPlayTime||"",letime:this.dataset.switchDefnPlayingTime||+new Date,url:this.context.dataset.currentVideoUrl||"",urlindex:this.context.dataset.urlIndex,vt:this.context.dataset.cdnID,quic:this.context.dataset.isQuic||0,quicver:this.context.dataset.quicVer||"",code:this.dataset.errorCodeOfStep45||""};a=d.extend(this.getDefaultParams(),{data:JSON.stringify(a)}),a.step=45,this.report(a)},step50:function(a){var b=a||this.getStep50Data();try{var c=JSON.parse(b.data);c.code&&c.code.indexOf("13083")>0?(this.report(b,"4564"),c.code="",b.data=JSON.stringify(c),this.report(b)):(b.data.quic=this.context.dataset.isQuic||0,b.data.quicver=this.context.dataset.quicVer||"",this.report(b))}catch(d){}this.handlerStep50Data("delete",b.vid)},getStep50Data:function(a){a=a||{};var b={reason:a.reason||0,etime:+new Date,playduration:this.dataset.userPlayedTime,quic:this.context.dataset.isQuic||0,quicver:this.context.dataset.quicVer||"",code:this.dataset.errorCodeOfStep50||""};return b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=50,b.seq=this.dataset.sequence?this.dataset.sequence+1:1,b},autoReportStep50:function(a){a=a||{},a.hasOwnProperty("limitTime")||(a.limitTime=!0);var b=this.handlerStep50Data("get");if("object"==d.type(b))for(var c in b)if("object"===d.type(b[c])&&(!a.prevVid||a.prevVid===c)){if(a.limitTime&&+new Date-b[c].updateTime<3e4)continue;delete b[c].updateTime,this.step50(b[c]),this.handlerStep50Data("delete",b[c].vid)}},autoSaveStep50Data:function(){var a=this.getStep50Data({reason:1});a&&a.vid&&(a.updateTime=+new Date,this.handlerStep50Data("save",this.context.dataset.vid,a))},handlerStep50Data:function(a,b,c){if("delete"!==a&&"save"!==a||b){var f,g,h,i=Txplayer.dataset.localStorageKey.userPlayedTime;f=e.getData(i),f||(f="{}");try{g=JSON.parse(f)}catch(j){h=!0}if(h||!g||"object"!=d.type(g))return void e.delData(i);if("delete"===a&&g[b])delete g[b],e.setData(i,JSON.stringify(g));else{if("get"===a)return b?g[b]:g;"save"===a&&c&&(g[b]=c,e.setData(i,JSON.stringify(g)))}}},deleteErrorCodes:function(){for(var a in this.dataset)a&&0==a.indexOf("errorCodeOfStep")&&delete this.dataset[a]},step36:function(a){a=a||{};var b={type:a.type,format:this.context.dataset.currentDefinitionFormat,tcount:a.retryTimes,ptime:this.context.dataset.currentTime,stime:this.dataset.playTime,etime:+new Date,url:a.url||"",code:a.code||"",appver:Txplayer.dataset.ver,guid:this.context.dataset.guid||""};this.dataset.hlsPlayTime&&(b.stime=this.dataset.hlsPlayTime),b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=36,this.report(b,"4564")},step15_4564:function(a){a=a||{};var b={stime:a.startTime,etime:a.endTime,code:a.errCode||"",ip:this.context.dataset.reportUsrIP||"",url:a.url||""};b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=15,this.report(b,"4564")},step20_4564:function(a){a=a||{};var b={stime:a.startTime,etime:a.endTime,code:a.errCode||"",ip:this.context.dataset.reportUsrIP||"",url:a.url||""};b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=20,this.report(b,"4564")},step35_4564:function(){if(!(this.dataset.waitingStartTime&&this.dataset.waitingEndTime&&this.dataset.waitingEndTime-this.dataset.waitingStartTime<=200)&&!(this.dataset.waitingDuration<200)&&this.context.dataset.currentTime){var a="1."+this.context.dataset.videoWaitingReason,b={reason:a||"",appver:Txplayer.dataset.ver,stime:this.dataset.waitingStartTime||"",etime:this.dataset.waitingEndTime||"",ptime:this.context.dataset.currentTime||"",btime:this.context.dataset.bfTimeStart4564||"",betime:this.context.dataset.bfTimeEnd4564||"",duration:this.dataset.waitingDuration||"",code:this.dataset.errorCodeOfStep35||"",ip:this.context.dataset.reportUsrIP||"",url:this.context.dataset.currentVideoUrl||"",format:this.context.dataset.currentDefinitionFormat||"",scene:this.context.dataset.playbackRate||"",dltype:this.context.dataset.useHls?this.context.dataset.dltype||3:1};b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=35,this.context.dataset.bfTimeStart4564=0,this.context.dataset.bfTimeEnd4564=0,this.context.dataset.videoWaitingReason="",this.report(b,"4564")}},addEventListener:function(){var a=this,b=0;this.autoReportStep50(),this.context.msg.on("beforeVideoPlay",function(){a.dataset.hlsPlayTimeTheFirstTime=null,a.dataset.hlsPlayTime=null,a.dataset.hasReportAd=!1,a.dataset.hlsFirstFragementLoadStartTime=null,a.dataset.hlsFirstFragementLoadEndTime=null}),this.context.msg.on("getVideoUrlSuccess",function(){delete a.dataset.switchDefnPlayingTime,delete a.dataset.switchDefnPlayTime}),this.context.config.pageInitTime&&this.step0(),this.context.dataset.isReady?a.step5():this.context.msg.on("ready",function(){a.step5()}),this.context.msg.on("getinfoFinish",function(b){a.step15_4564({startTime:b.startTime,endTime:b.endTime,url:b.getinfoURL,errCode:b.errCode||""}),b&&b.err&&!b.isLastRetry||a.step15(b)}),this.context.msg.on("getkeyFinish",function(b){a.step20_4564({startTime:b.startTime,endTime:b.endTime,url:b.getkeyURL,errCode:b.errCode||""}),b&&b.err&&!b.isLastRetry&&!b.em||a.step20(b)}),this.context.msg.on("videoPlaying",function(b){if(b=b||{},"film"===b.playListType){if(a.dataset.hasReportAd)return;a.dataset.adReportData=a.context.adApi&&a.context.adApi.getAdReportData(),a.step25(),a.dataset.hasReportAd=!0;var c=a.dataset.playTime||"",d=a.dataset.playingTime||+new Date;a.dataset.hlsPlayTimeTheFirstTime&&(c=a.dataset.hlsPlayTimeTheFirstTime),a.dataset.hlsFirstFragementLoadEndTime&&a.context.dataset.hasLdAd&&(d=a.dataset.hlsFirstFragementLoadEndTime);var e=d-c;a.context.msg.broadcast("setChromeHlsData",{k:"onplay",v:{start_play_cost:e||""}})}}),this.context.msg.on("videoPlay.h5report-step30",function(b){"film"===b.playListType&&(a.dataset.playTime||(a.dataset.playTime=+new Date,e.v4log("videoPlay.h5report-step30",{playTime:a.dataset.playTime})),a.dataset.currentVideoIndex=b.index)}),this.context.msg.on("setPreloadVideoUrlReport.h5report-step30",function(){a.dataset.playTime||(a.dataset.playTime=+new Date,e.v4log("setPreloadVideoUrlReport.h5report-step30",{playTime:a.dataset.playTime}))}),this.context.msg.on("hlsStartPlay.h5report-step30",function(b){a.dataset.hlsPlayTimeTheFirstTime||(a.dataset.hlsPlayTimeTheFirstTime=+new Date),b.forceUpdate&&(a.dataset.hlsPlayTimeTheFirstTime=b.stime),e.v4log("hlsStartPlay",{hlsPlayTime:a.dataset.hlsPlayTimeTheFirstTime}),a.dataset.hlsPlayTime=+new Date}),this.context.msg.on("hlsFirstFragementLoadFinish",function(b){a.dataset.hlsFirstFragementLoadEndTime||(e.v4log("step30-\u52a0\u8f7d\u5b8c\u7b2c\u4e00\u5e27\u753b\u9762",{time:b.time,loaded:b.loaded}),a.dataset.hlsFirstFragementLoadEndTime=b.time)}),this.context.msg.on("loadEnoughBuffer.h5report-step30",function(b){var c=a.dataset.hasOwnProperty("playingTime");e.v4log("loadEnoughBuffer",+new Date),a.dataset.playingTime=+new Date,e.v4log("loadEnoughBuffer",{playingTime:a.dataset.playingTime}),e.v4log("step30-loadEnoughBuffer: ",{time:a.dataset.playingTime}),a.deleteErrorCodes(),c||a.step30({url:b.src})}),this.context.msg.on("videoCanplay.h5report-step30",function(c){if(e.v4log("videoCanplay",+new Date),b=0,"film"===c.playListType&&!a.context.dataset.useHls){var d=a.dataset.hasOwnProperty("playingTime");a.dataset.playingTime=+new Date,a.deleteErrorCodes(),d||(e.v4log("MP4videoCanplay",{playingTime:a.dataset.playingTime}),a.step30({url:c.src}))}}),this.context.msg.on("setDefinitionStart",function(b){a.dataset.switchDefnStartVideoTime=a.context.dataset.currentTime;var c=function(){a.context.msg.off("videoPlay.h5report-step31"),a.context.msg.off("videoPlaying.h5report-step31"),a.context.msg.off("reportVideoError.h5report-step31")};a.context.msg.once("videoPlay.h5report-step31",function(b){a.dataset.switchDefnPlayTime=+new Date}),a.context.msg.once("videoPlaying.h5report-step31",function(b){a.dataset.switchDefnHasReported=a.dataset.hasOwnProperty("switchDefnPlayingTime"),a.dataset.switchDefnPlayingTime=+new Date,a.dataset.currentVideoIndex=b.index,c()})}),this.context.msg.on("setDefinitionDone",function(b){b&&b.hasOwnProperty("hlsDefinitionEndTime")&&(a.dataset.switchDefnPlayTime=a.dataset.switchDefnPlayingTime=b.hlsDefinitionEndTime),a.dataset.switchDefnEndVideoTime=a.context.dataset.currentTime,a.step45(),a.dataset.switchDefnHasReported||a.step31()}),this.context.msg.on("setDefinitionFail",function(b){a.dataset.switchDefnEndVideoTime=a.context.dataset.currentTime,b.errCode&&(a.dataset.errorCodeOfStep45=b.errCode,a.step45(),delete a.dataset.errorCodeOfStep45)});var c=function(){a.dataset.hasOwnProperty("waitingTimes")||(a.dataset.waitingTimes=0),a.dataset.waitingTimes++},f=function(){var b=a.dataset.waitingEndTime-a.dataset.waitingStartTime;b>3e4&&(b=3e4),"number"!==d.type(a.dataset.waitingDuration)&&(a.dataset.waitingDuration=0),a.dataset.waitingDuration=b},g=function(b){e.v4log("\u7f13\u51b2\u63a7\u5236-step35\u66f4\u65b0\u7f13\u51b2\u5f00\u59cb\u65f6\u95f4",{waitingTimes:a.dataset.waitingTimes}),a.dataset.waitingTimes>20||(a.dataset.waitingStartTime=+new Date,c(),a.context.dataset.loadEnoughBuffer||(a.context.msg.off("videoPlaying.h5report-step35"),a.context.msg.once("videoPlaying.h5report-step35",function(){a.dataset.waitingEndTime=+new Date,f(),delete a.dataset.errorCodeOfStep35,a.step35(),a.context.dataset.videoWaitingReason=8,a.step35_4564()})))};this.context.msg.on("videoWaiting",function(b){e.v4log("videoWaiting",{isVideoSeeking:a.context.dataset.isVideoSeeking}),b&&!b.seeking&&"film"===b.playListType&&a.dataset.hasOwnProperty("playingTime")&&(a.context.dataset.isVideoSeeking||a.context.dataset.isDefinitionSwitching||g(b))}),this.context.msg.on("networkBadStart",function(b){"film"===b.playListType&&(b.isOnWaiting||a.context.dataset.isVideoSeeking||a.context.dataset.isDefinitionSwitching||a.dataset.hasOwnProperty("playingTime")&&g(b))}),this.context.msg.on("minbufferControlEnd",function(b){a.context.dataset.loadEnoughBuffer&&(a.dataset.hasOwnProperty("waitingTimes")&&a.dataset.waitingTimes>20||a.dataset.hasOwnProperty("waitingStartTime")&&(a.dataset.waitingEndTime=+new Date,f(),delete a.dataset.errorCodeOfStep35,a.step35(),a.step35_4564()))});var h=function(){return a.dataset.userSeekTimes>32||(a.dataset.hasOwnProperty("userSeekTimes")||(a.dataset.userSeekTimes=1),!1)};this.context.msg.on("seekStart",function(b){b&&b.isUserAction===!1||h()||(b.currentTimeWhenSeekStart&&(a.dataset.currentTimeWhenSeekStart=b.currentTimeWhenSeekStart),a.dataset.seekStartTime=+new Date,"number"!==d.type(a.dataset.seekTimes)&&(a.dataset.seekTimes=0),a.dataset.seekTimes+=1,a.context.msg.off("videoWaiting.h5report-step40"),a.context.msg.off("reportVideoError.h5report-step40"),a.context.msg.once("videoPlaying.h5report-step40",function(b){b&&b.seeking&&"film"===b.playListType&&(a.context.msg.off("videoWaiting.h5report-step40"),a.context.msg.off("reportVideoError.h5report-step40"))}))}),this.context.msg.on("seekEnd",function(b){if((!b||b.isUserAction!==!1)&&!h()&&(a.dataset.seekEndTime=+new Date,a.context.msg.off("videoWaiting.h5report-step40"),a.context.msg.off("reportVideoError.h5report-step40"),b&&b.seekStartTime&&b.seekEndTime)){var c=b.seekEndTime-b.seekStartTime,d=c>200;d&&(a.dataset.seekWaitingDuration=c,a.dataset.seekWaitingStartTime=b.seekStartTime),delete a.dataset.errorCodeOfStep40,a.step40({currentTimeWhenSeekStart:b.currentTimeWhenSeekStart,currentTimeWhenSeekEnd:b.currentTimeWhenSeekEnd,isSeekOfWaiting:d}),delete a.dataset.seekWaitingStartTime,a.dataset.userSeekTimes+=1}}),this.context.msg.on("videoTimeUpdate",function(b){return b&&"film"===b.playListType?("number"!=typeof a.dataset.userPlayedTime&&(a.dataset.userPlayedTime=0),a.dataset.userPlayedTime++,void a.autoSaveStep50Data()):void a.autoSaveStep50Data()}),this.context.msg.on("videoEnd.h5report-step50",function(b){b&&"film"===b.playListType&&b.isTheLastFilm&&(e.v4log("videoEnd-step50"),a.step50(),delete a.dataset.userPlayedTime)}),this.context.msg.on("error.h5report-step50",function(b){b&&"film"!==b.type&&"cgi"!==b.type||(b&&b.errCode&&(a.dataset.errorCodeOfStep50=b.errCode,a.dataset.hasOwnProperty("playingTime")||(a.dataset.errorCodeOfStep30=b.errCode)),!a.dataset.hasOwnProperty("playingTime")&&a.dataset.errorCodeOfStep30?(a.step30(),delete a.dataset.errorCodeOfStep30):a.dataset.hasOwnProperty("playingTime")&&(a.dataset.errorCodeOfStep31?(a.step31(),a.dataset.errorCodeOfStep45=a.dataset.errorCodeOfStep31,a.step45(),delete a.dataset.errorCodeOfStep45,delete a.dataset.errorCodeOfStep31):a.dataset.errorCodeOfStep40?(a.step40(),delete a.dataset.errorCodeOfStep40):a.dataset.errorCodeOfStep35&&(a.step35(),a.step35_4564(),delete a.dataset.errorCodeOfStep35)),a.dataset.step50_TIMER&&(clearTimeout(a.dataset.step50_TIMER),a.dataset.step50_TIMER=null),a.dataset.step50_TIMER=setTimeout(function(){a.step50(),delete a.dataset.errorCodeOfStep50},50))}),this.context.msg.on("vidChange",function(c,d){e.v4log("vidChange-autoReportStep50"),a.autoReportStep50({limitTime:!1,prevVid:d}),b=0,a.resetDataset()}),this.context.msg.on("bulletNumShow",function(){var b=a.context.msg.listeners("playStateChange.float").length,c="";d("script").each(function(a,b){b.src&&b.src.indexOf("vplay")!=-1&&(c=b.src)});var e={open:1,event:b,type:3,"switch":a.context.dataset.flashBulletSwitchStatus?1:0,state:a.context.dataset.playState>0?a.context.dataset.playState:100,vplaysrc:c};e=d.extend(a.getDefaultParams(),{data:JSON.stringify(e)}),e.step=70,a.report(e,"4564")}),this.context.msg.on("reportVideoError",function(c){if(c=c||{},"film"===c.type){var d;a.dataset.hasOwnProperty("playingTime")?a.context.dataset.isDefinitionSwitching?(d=3,a.dataset.errorCodeOfStep31=c.code):a.context.dataset.isVideoSeeking?(d=2,a.dataset.errorCodeOfStep40=c.code):(d=1,a.dataset.errorCodeOfStep35=c.code):(d=0,a.dataset.errorCodeOfStep30=c.code),c.url&&c.url.indexOf&&c.url.indexOf("blob:")>-1&&(c.url=a.context.dataset.currentVideoUrl),a.step36({type:d,code:c.code,url:c.url,retryTimes:b++})}})}},Txplayer.register("v4H5Report",c)}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(295)},66:function(a,b){var c={unstarted:-1,ended:0,playing:1,paused:2,buffering:3,cued:4,stop:5},d={msd:"\u6d41\u7545180P",sd:"\u6807\u6e05270P",hd:"\u9ad8\u6e05480P",shd:"\u8d85\u6e05720P",fhd:"\u84dd\u51491080P",uhd:"4K"};a.exports={playerstate:c,definitionMap:d}},295:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util;c(66).definitionMap;d.prototype={init:function(){this.dataset.dataKey=Txplayer.dataset.localStorageKey.playTime,this.dataset.videoPlayedIndex=-1,this.addEventListener(),this.exportsModuleApis()},resetDataset:function(){if(this.dataset.isGetinfoDone){var a=["videoPlayedIndex","isGetinfoDone","dataKey","prevDefinition","setDefinitionStartTime","hasReportLoadingadLoadTime","filmFirstPlayingTime"];for(var b in this.dataset)e.inArray(b,a)>-1||("realPlayTime_TIMER"!==b&&"totalPlayTime_TIMER"!==b||clearInterval(this.dataset[b]),delete this.dataset[b])}},resetDatasetOnVidChange:function(){var a=["hasGetVplayPageRecoReport","isGetinfoDone","setDefinitionStartTime","hasReportLoadingadLoadTime","filmFirstPlayingTime","timeupdateCounter"],b=this;e.each(a,function(a,c){delete b.dataset[c]}),"coolOpen"===this.context.config.playerType&&(Txplayer.dataset.vplayPageRecoReport=null)},getVplayPageRecoReport:function(){try{var a=sessionStorage.getItem("report_recomm_player");a?Txplayer.dataset.vplayPageRecoReport=a:"coolOpen"===this.context.config.playerType&&(Txplayer.dataset.vplayPageRecoReport=a),sessionStorage.removeItem("report_recomm_player")}catch(b){}},getDefaultReportData:function(){var a=this;!this.dataset.hasGetVplayPageRecoReport&&this.context.config.reportRecomm&&(this.dataset.hasGetVplayPageRecoReport=!0,"coolOpen"===this.context.config.playerType?setTimeout(function(){a.getVplayPageRecoReport()}):this.getVplayPageRecoReport());var b=this.context.dataset.txplayerAuth.raw(),c={uin:Txplayer.util.getQQFromCookie(),vid:this.context.dataset.vid||"",coverid:this.context.dataset.cid||"",pid:this.context.dataset.playerId||"",guid:this.context.dataset.guid||"",cmid:this.context.dataset.guid||"",unid:this.context.dataset.unid||"",vt:this.getCDNChannelId(),type:this.getBusinessType(),url:document.URL,bi:this.getCurrentVideoDuration(),bt:this.context.dataset.duration||"",version:Txplayer.dataset.ver||"",platform:this.context.dataset.platform,format:this.context.dataset.currentDefinitionFormat||"",defn:this.context.dataset.definition||"",ctime:f.dateFormat(),ptag:f.getPTAG(),isvip:-1,tpid:this.context.dataset.tpid||"",pversion:this.context.config.playerType,hc_uin:Txplayer.util.getQQFromCookie(),hc_main_login:b.main_login,hc_vuserid:b.vuserid||Txplayer.util.cookie.get("vuserid"),hc_openid:b.openid,hc_appid:b.appid,hc_pvid:Txplayer.util.cookie.get("pgv_pvid"),hc_ssid:Txplayer.util.cookie.get("psessionid"),hc_qq:Txplayer.util.getQQFromCookie(),ua:f.getReportUA(),hh_ua:f.getReportUA(),ckey:this.context.dataset.ckey||"",iformat:this.context.dataset.currentDefinitionFormat||"",hh_ref:f.getTopFrameUrl(),vurl:this.context.dataset.currentVideoUrl||"",v_idx:this.dataset.videoPlayedIndex||0,rcd_info:Txplayer.dataset.vplayPageRecoReport||"",extrainfo:this.context.config.extrainfo||"",bucket_id:Txplayer.util.cookie.get("bucket_id"),drm:this.context.dataset.emeEnabled?1:0};return this.context&&this.context.config&&"function"===e.type(this.context.config.getUserType)&&(c.isvip=2==this.context.config.getUserType()?1:0),c.triggerplay=this.context.config.triggerplay||"undefined"==typeof this.context.config.triggerplay?1:0,c},reportStep3:function(a){var b={step:3,val:0===this.context.dataset.connectionPlayType?1:2,idx:this.context.dataset.connectionPlayType,c_info:this.context.config.getOuterReportData(),pcplatform:f.getPcPlatform()},c={width:this.context.dataset.playerWidth,height:this.context.dataset.playerHeight};c&&c.width&&c.height&&(b.diagonal=parseInt(Math.sqrt(Math.pow(c.width,2)+Math.pow(c.height,2)))),b.isfocustab=this.context.dataset.isWindowFocus,b.isvisible=this.context.msg.getData("isPlayerInScreen"),b.isfocustab=b.isfocustab?1:0,b.isvisible=b.isvisible?1:0,this.doBossReport(b)},reportStep4:function(){var a={step:4,val:this.context.dataset.playList.length,val1:1,bi:this.context.dataset.hasOwnProperty("isPlayingAd")?2:1,idx:this.context.dataset.connectionPlayType,c_info:this.context.config.getOuterReportData(),pcplatform:f.getPcPlatform()},b={width:this.context.dataset.playerWidth,height:this.context.dataset.playerHeight};b&&b.width&&b.height&&(a.diagonal=parseInt(Math.sqrt(Math.pow(b.width,2)+Math.pow(b.height,2)))),a.isfocustab=this.context.dataset.isWindowFocus,a.isvisible=this.context.msg.getData("isPlayerInScreen"),a.isfocustab=a.isfocustab?1:0,a.isvisible=a.isvisible?1:0,a.reportFrom=this.context.config.reportFrom,this.doBossReport(a)},reportStep5:function(a){a=a||{};var b;a.isEnd?b={step:5,val:1e3*a.realtime,val1:a.isEnd?1:2,val2:a.totaltime_pip||0,bi:a.totaltime}:(b=a,b.val1=a.isEnd?1:2,b.val=1e3*a.realtime,b.bi=a.totaltime,b.step=5,delete b.isEnd,delete b.realtime,delete b.totaltime),b.idx=this.context.dataset.connectionPlayType;var c={width:this.context.dataset.playerWidth,height:this.context.dataset.playerHeight};c&&c.width&&c.height&&(b.diagonal=parseInt(Math.sqrt(Math.pow(c.width,2)+Math.pow(c.height,2)))),a.vid&&(b.vid=a.vid),b.isfocustab=this.context.dataset.isWindowFocus,b.isvisible=this.context.msg.getData("isPlayerInScreen"),b.isfocustab=b.isfocustab?1:0,b.isvisible=b.isvisible?1:0,b.c_info=this.context.config.getOuterReportData(),b.pcplatform=f.getPcPlatform(),this.doBossReport(b)},reportStep6:function(a){var b={step:6,val:a.firstLoadTime,val1:this.getReport6Status(),val2:1,idx:this.context.dataset.connectionPlayType,bi:"",bt:"",c_info:this.context.config.getOuterReportData(),pcplatform:f.getPcPlatform()},c={width:this.context.dataset.playerWidth,height:this.context.dataset.playerHeight};if(c&&c.width&&c.height&&(b.diagonal=parseInt(Math.sqrt(Math.pow(c.width,2)+Math.pow(c.height,2)))),b.isfocustab=this.context.dataset.isWindowFocus,b.isvisible=this.context.msg.getData("isPlayerInScreen"),b.isfocustab=b.isfocustab?1:0,b.isvisible=b.isvisible?1:0,this.dataset.adReportData&&this.dataset.adReportData.list.length>0&&this.dataset.adReportData.loadingAdEndTime&&this.dataset.adReportData.loadingadProgressedTime){var d=this.dataset.adReportData.list[0].playEndTime,e=this.dataset.adReportData.list[0].loadCompleteTime;d&&e&&(b.bi=d-e)}this.doBossReport(b)},reportStep7:function(a){var b={step:7,val:0,val1:0,idx:this.context.dataset.connectionPlayType,c_info:this.context.config.getOuterReportData(),pcplatform:f.getPcPlatform()};this.doBossReport(b)},reportStep70:function(a){var b={step:70,val:a};this.doBossReport(b)},reportStep30:function(a){var b={step:30,val:a.loadTime,val1:a.hasOwnProperty("val1")?a.val1:0,val2:2,bi:this.context.dataset.videoDuration};this.context.dataset.useHls?b.val2=3:"html5hd"===this.context.config.playerType?b.val2=1:"ipadh5"!==this.context.config.playerType&&"h5"!==this.context.config.playerType||(b.val2=2),this.doBossReport(b)},reportStep50:function(a){var b={step:50,val:a.loadTime||"",val1:a.hasOwnProperty("val1")?a.val1:0,val2:1,bi:this.context.dataset.videoDuration};this.context.dataset.useHls?b.val2=3:"html5hd"===this.context.config.playerType?b.val2=1:"ipadhtml5"!==this.context.config.playerType&&"h5"!==this.context.config.playerType||(b.val2=2),this.doBossReport(b)},reportStep60:function(a){var b={step:60,val:a.seekCostTime,val1:a.hasOwnProperty("val1")?a.val1:0,val2:1,bi:this.context.dataset.videoDuration};this.context.dataset.useHls?b.val2=3:"html5hd"===this.context.config.playerType?b.val2=1:"ipadh5"!==this.context.config.playerType&&"h5"!==this.context.config.playerType||(b.val2=2),this.doBossReport(b)},reportStep31_51:function(a){if(a.hasOwnProperty("waitingTime")){var b=a.waitingTime>1e4;a.waitingTime=b?1e4:a.waitingTime;var c={step:a.step,val:a.waitingTime,val1:b,val2:1,bi:this.context.dataset.videoDuration||this.context.dataset.duration,bt:this.context.dataset.duration};this.context.dataset.useHls?c.val2=3:"html5hd"===this.context.config.playerType?c.val2=1:"ipadh5"!==this.context.config.playerType&&"h5"!==this.context.config.playerType||(c.val2=2),this.doBossReport(c)}},reportStep35:function(a){a=a||{};var b;this.dataset.loadingadEndTime=this.dataset.adReportData.loadingAdEndTime,this.context.dataset.adDuration=this.dataset.adReportData.adDuration,"number"!==e.type(this.dataset.filmFirstPlayingTime)||"number"!==e.type(this.dataset.loadingadEndTime)&&"number"!==e.type(this.dataset.filmFirstPlayTime)||(b=this.dataset.filmFirstPlayingTime-(this.dataset.loadingadEndTime||this.dataset.filmFirstPlayTime)),Txplayer.util.v4log("4298-Step35-loading\u5e7f\u544a\u5207\u6b63\u7247\u8017\u65f6",{swtichTime:b,filmFirstPlayingTime:this.dataset.filmFirstPlayingTime,filmFirstPlayTime:this.dataset.filmFirstPlayTime,loadingadEndTime:this.dataset.loadingadEndTime});var c={step:35,val:a.swtichTime||b,val1:"",val2:this.context.dataset.adDuration||0,bi:this.context.dataset.videoDuration};"number"===e.type(this.context.dataset.preloadStartTime)&&"number"===e.type(this.dataset.loadingadEndTime)&&(c.val1=this.dataset.loadingadEndTime-this.context.dataset.preloadStartTime),this.doBossReport(c)},reportStep55:function(a){var b={step:55,val:a.swtichTime,val1:"",val2:a.prevFilmDuration,bi:this.context.dataset.videoDuration};this.doBossReport(b)},reportStep100:function(a){var b={step:100,val:a.costTime,val1:a.val1,val2:1,bi:this.context.dataset.videoDuration,predefn:a.predefn};this.context.dataset.useHls?b.val2=3:"html5hd"===this.context.config.playerType?b.val2=1:"ipadh5"!==this.context.config.playerType&&"h5"!==this.context.config.playerType||(b.val2=2),this.doBossReport(b)},reportStep1011:function(a){var b={step:"1011",val1:0,val2:0,vt:0};b.val=a.costTime,a.err?a.code?(b.val1=3,b.val2=a.code):(b.val1=2,b.val2=444):b.val1=1,this.doBossReport(b)},reportStep1003:function(a){var b={step:"1003",val1:0,val2:0,vt:0};b.val=a.costTime,a.err?a.code?(b.val1=3,b.val2=a.code):a.code||!a.filename||a.key?(b.val1=2,b.val2=445):(b.val1=4,b.val2=445):b.val1=1,this.doBossReport(b)},getCDNChannelId:function(){var a=this.context.dataset.filmVideoData,b=this.context.dataset.playListIndex;return a&&a[b]?a[b].vt:""},getCurrentVideoDuration:function(){var a=this.context.dataset.filmVideoData,b=this.context.dataset.playListIndex;return a&&a[b]?a[b].duration:""},getBusinessType:function(){var a=this.context.dataset.getinfoJSON;return a&&a.vl&&a.vl.vi&&a.vl.vi[0]&&"object"===e.type(a.vl.vi[0])&&a.vl.vi[0].hasOwnProperty("type")?a.vl.vi[0].type:""},doBossReport:function(a){var b,c,d={};if(d=e.extend(this.getDefaultReportData(),a),d&&d.bi&&(d.bi=parseInt(d.bi)),d&&d.bt&&(d.bt=parseInt(d.bt)),"html5hd"!==this.context.config.playerType&&f.mobile?"ipadh5"===this.context.config.playerType||f.os.ipad?(b="4299",c="694498052"):"h5"===this.context.config.playerType||f.os.android||f.os.ios?(b="2865",c="1698957057"):(b="2865",c="1698957057"):(b="4298",c="686148428"),"4298"===b&&(d.cpay=this.context.dataset.isNeedPay?1:0,d.tpay=this.context.dataset.userPayStatus||0,d.dltype=this.context.dataset.useHls?this.context.dataset.dltype||3:1,this.context.config.clientReportInfo)){var g=this.context.config.clientReportInfo;for(var h in g)g.hasOwnProperty(h)&&"undefined"!=typeof g[h]&&(d["clt_"+h]=g[h]||"")}var i="//btrace.video.qq.com/kvcollect?BossId={bossid}&Pwd={pwd}".replace("{bossid}",b).replace("{pwd}",c);i+="&"+e.param(d),f.report(i)},playTimeHeartBeatStart:function(){var a=this;this.dataset.realPlayTime_TIMER||(this.dataset.realPlayTime_TIMER=setInterval(function(){a.dataset.realPlayTime||(a.dataset.realPlayTime=0),a.dataset.realPlayTime+=5,a.saveData()},5e3)),this.dataset.totalPlayTime_TIMER||(this.dataset.totalPlayTime_TIMER=setInterval(function(){a.dataset.totalPlayTime||(a.dataset.totalPlayTime=0),a.dataset.totalPlayTime+=5,a.dataset.totalPlayTime_pip||(a.dataset.totalPlayTime_pip=0),a.context.dataset.isPIP&&(a.dataset.totalPlayTime_pip+=5),a.context.dataset.userTotalPlayedTime=a.dataset.totalPlayTime},5e3))},playTimeHeartBeatStop:function(a){clearInterval(this.dataset.totalPlayTime_TIMER),delete this.dataset.totalPlayTime_TIMER,a&&(clearInterval(this.dataset.realPlayTime_TIMER),delete this.dataset.realPlayTime_TIMER)},saveData:function(){var a,b=f.getData(this.dataset.dataKey),c=this.context.dataset.vid;if(b)try{a=JSON.parse(b)}catch(d){a={}}else a={};return c?(a[c]={lastupdate:+new Date,realtime:this.dataset.realPlayTime,totaltime:this.dataset.totalPlayTime,totaltime_pip:this.dataset.totalPlayTime_pip},a[c]=e.extend(this.getDefaultReportData(),a[c]),void f.setData(this.dataset.dataKey,JSON.stringify(a))):void f.showError("saveData Error","\u627e\u4e0d\u5230vid")},getData:function(){var a,b=f.getData(this.dataset.dataKey),c=this.context.dataset.vid;if(b)try{a=JSON.parse(b)}catch(d){a={}}else a={};return c?a[c]:void f.showError("getData Error","\u627e\u4e0d\u5230vid")},clearData:function(a){var b,c=f.getData(this.dataset.dataKey);if(a=a||this.context.dataset.vid,c)try{b=JSON.parse(c)}catch(d){b={}}else b={};return a?(b[a]&&delete b[a],void f.setData(this.dataset.dataKey,JSON.stringify(b))):void f.showError("clearData Error","\u627e\u4e0d\u5230vid")},reportPlayTimeWhenPageInit:function(){var a,b=f.getData(this.dataset.dataKey),c=this,d=function(a,b){if(a){var d=parseInt(+new Date/1e3),e=parseInt(parseInt(a.lastupdate)/1e3);d-e<=180||(a.isEnd=!1,c.reportStep5(a),c.clearData(b))}};try{a=JSON.parse(b)}catch(e){a={}}for(var g in a)d(a[g],g)},reportPlayTimeOnEnded:function(){var a,b=f.getData(this.dataset.dataKey),c=this,d=this.context.dataset.vid,e=function(a,b){a=a&&a[b]?a[b]:null,a&&(a.isEnd=!0,c.reportStep5(a),c.clearData(b))};try{a=JSON.parse(b)}catch(g){a={}}e(a,d)},reportPlayTimeOnBeforeVideoPlay:function(a){if(a){var b,c=f.getData(this.dataset.dataKey),d=this,e=a,g=function(a,b){a=a&&a[b]?a[b]:null,a&&(a.isEnd=!0,a.vid=b,d.reportStep5(a),d.clearData(b))};try{b=JSON.parse(c)}catch(h){b={}}g(b,e)}},getVideoAreaLevel:function(){var a=this.context.dataset.getinfoJSON;return a&&a.vl&&a.vl.vi&&a.vl.vi.length&&a.vl.vi[0]?a.vl.vi[0].level:""},reportLoginUserPlayTime:function(a){if(a=a||!1,"v.qq.com"===location.hostname||"film.qq.com"===location.hostname){var b;if(this.context.config&&"function"===e.type(this.context.config.getUserType))try{b=this.context.config.getUserType()}catch(c){}"number"!==e.type(b)||b<=0||this.context.msg.broadcast("reportLoginUserPlayTime",{isend:a})}},getReport6Status:function(){return this.context.dataset.isLoadingAdEmpty||this.context.dataset.noHdAdPlugin?1:this.dataset.isFilmBuffered?2:3},reportPlayView:function(){var a="";if(f.inWhichDomain("qzone")&&(a=f.inNewIframe()?f.removeUrlParams(document.referrer):f.removeUrlParams(location.href)),(f.os.mac||f.os.windows)&&(f.isInIframe()||!f.isInIframe()&&"v.qq.com"!==location.hostname)){var b={lv_irt_id:f.cookie.get("uuid")||"",dm:"v.qq.com",ua:navigator.userAgent,r:+new Date,vid:this.context.dataset.vid,sr:screen.width+"x"+screen.height,ul:navigator.language||navigator.browserLanguage||"",tv:"0.0.7",pt:this.context.dataset.title||"\u817e\u8baf\u89c6\u9891",guid:this.context.dataset.guid||"",url:"https://v.qq.com/x/page/"+this.context.dataset.vid+".html",from:f.inNewIframe()?f.removeUrlParams(document.referrer):"https://v.qq.com/x/page/"+this.context.dataset.vid+".html",playing_url:a},c=new Image;c.src="//tj.video.qq.com/fcgi-bin/set_cookie?"+e.param(b)}},reportIrs:function(){var a=this.context.config.playerType||"";if(a=a.toLowerCase(),f.inArray(["h5","h5tiny"],a)===-1&&("v.qq.com"===location.hostname||"film.qq.com"===location.hostname)){var b=new Image(1,1);this.context.dataset.vid&&(b.src="//v12-"+this.context.dataset.vid.toLowerCase()+".z.irs01.com?p=v12&ts="+ +new Date)}},addEventListener:function(){var a=this;this.addAdReport(),this.context.msg.on("beforeVideoPlay",function(b,c){b=b||{},a.dataset.videoPlayedIndex++,a.reportStep3(b.isNewPlay),a.reportIrs(),a.reportPlayView(),a.reportPlayTimeOnBeforeVideoPlay(c)}),this.context.msg.on("vidChange",function(b,c){a.resetDataset()}),this.context.msg.on("getVideoUrlSuccess",function(b,c){a.resetDataset(),setTimeout(function(){a.reportStep4(),a.dataset.isGetinfoDone=!0,a.context.dataset.reportVideoLevel=a.getVideoAreaLevel(),a.context.dataset.reportCDNChannelId=a.getCDNChannelId(),a.context.dataset.reportBusinessType=a.getBusinessType()},0)}),this.context.msg.on("vidChange",function(){a.resetDatasetOnVidChange()}),this.context.msg.on("videoPause",function(){a.context.dataset.isPlayingAd||a.playTimeHeartBeatStop()}),this.context.msg.on("videoPlay",function(b){"film"!==b.playListType||0!==b.index||a.dataset.filmFirstPlayTime||(a.dataset.filmFirstPlayTime=+new Date),"film"===b.playListType&&b.index>0&&(a.dataset.filmPlayTime||(a.dataset.filmPlayTime={}),a.dataset.filmPlayTime[b.index]||(a.dataset.filmPlayTime[b.index]=+new Date))}),this.context.msg.on("videoPlaying",function(b){b&&"film"===b.playListType&&(a.dataset.filmFirstPlayingTime||(a.dataset.filmFirstPlayingTime=+new Date,a.dataset.adReportData=a.getAdReportData(),a.reportStep6({firstLoadTime:a.dataset.filmFirstPlayingTime-a.dataset.filmFirstPlayTime}),a.reportStep35())),b&&"film"===b.playListType&&a.playTimeHeartBeatStart(),b&&"film"===b.playListType&&0===b.index&&!a.dataset.filmPlayingTime&&a.dataset.filmFirstPlayTime&&(a.dataset.filmPlayingTime=+new Date,a.reportStep30({loadTime:a.dataset.filmPlayingTime-(a.dataset.preloadStartTime||a.dataset.filmFirstPlayTime)})),b&&"film"===b.playListType&&b.index>0&&a.dataset.filmPlayTime&&(a.dataset.filmPlayingTime||(a.dataset.filmPlayingTime={}),a.dataset.filmPlayingTime[b.index]||(a.dataset.filmPlayingTime[b.index]=+new Date,a.reportStep50({loadTime:a.dataset.filmPlayingTime[b.index]-a.dataset.filmPlayTime[b.index]})))}),this.context.msg.on("videoWaiting",function(b){if(!a.context.dataset.isPlayingAd&&!("film"!==b.playListType||b&&b.videoTag&&0===b.videoTag.buffered.length)){var c=a.context.dataset.isVideoSeeking;if(!c&&!b.seeking&&(a.dataset.waitingTimes||(a.dataset.waitingTimes=0),1!==a.dataset.waitingTimes)){a.dataset.waitingTimes++;var d,e="videoTimeUpdate.waiting_report",f=+new Date;a.context.msg.off(e),a.context.msg.once(e,function(){var c;d=+new Date,c=0===b.index?31:51,a.reportStep31_51({step:c,waitingTime:d-f})})}}}),this.context.msg.on("networkBadStart",function(b){if("film"===b.playListType&&!b.isOnWaiting){var c=a.context.dataset.isVideoSeeking;if(!c){a.dataset.waitingTimes?a.dataset.waitingTimes++:a.dataset.waitingTimes=1;var d,e="networkBadEnd.waiting_report",f=+new Date;a.context.msg.off(e),a.context.msg.once(e,function(){var c;d=+new Date,c=0===b.index?31:51,a.reportStep31_51({step:c,waitingTime:d-f})})}}}),this.context.msg.on("videoEnd",function(b){if("film"===b.playListType&&(a.dataset.waitingTimes=0),"film"===b.playListType&&!b.isTheLastFilm){var c,d=+new Date,e=b.videoTag.duration||a.context.dataset.videoDuration;a.context.msg.once("videoPlaying.switch_film_section_report",function(){c=+new Date,a.reportStep55({swtichTime:c-d,prevFilmDuration:e})})}"film"===b.playListType&&b.isTheLastFilm&&(a.playTimeHeartBeatStop(!0),a.reportPlayTimeOnEnded(),a.reportLoginUserPlayTime(!0))}),this.context.msg.on("videoTimeUpdate",function(b){b&&"film"===b.playListType&&(a.dataset.timeupdateCounter?a.dataset.timeupdateCounter+=1:a.dataset.timeupdateCounter=1,a.dataset.timeupdateCounter%300===0&&a.reportLoginUserPlayTime(!1))}),this.context.msg.on("getinfoFinish",function(b){b=b||{},a.reportStep1011(b)}),this.context.msg.on("getkeyStart",function(){a.dataset.getkeyStartTime=+new Date}),this.context.msg.on("getkeyFinish",function(b){b=b||{},a.dataset.getkeyEndTime=+new Date,a.reportStep1003(b)}),this.context.msg.on("ready",function(){a.reportPlayTimeWhenPageInit()}),this.context.msg.on("seekStart",function(){a.dataset.filmSeekStartTime=+new Date}),this.context.msg.on("seekEnd",function(){a.dataset.filmSeekEndTime=+new Date,a.reportStep60({seekCostTime:a.dataset.filmSeekEndTime-a.dataset.filmSeekStartTime})}),this.context.msg.on("seekFail",function(){a.dataset.filmSeekFailTime=+new Date,a.reportStep60({val1:1,seekCostTime:a.dataset.filmSeekFailTime-a.dataset.filmSeekStartTime})}),this.context.msg.on("setDefinitionStart",function(){a.dataset.setDefinitionStartTime=+new Date,a.dataset.prevDefinition=a.context.dataset.definition}),this.context.msg.on("setDefinitionDone",function(){a.dataset.setDefinitionDoneTime=+new Date,a.reportStep100({costTime:a.dataset.setDefinitionDoneTime-a.dataset.setDefinitionStartTime,val1:2,predefn:a.dataset.prevDefinition})}),this.context.msg.on("setDefinitionFail",function(b){a.dataset.setDefinitionFailTime=+new Date,a.reportStep100({costTime:a.dataset.setDefinitionFailTime-a.dataset.setDefinitionStartTime,val1:3,predefn:a.dataset.prevDefinition})}),this.context.msg.on("videoPlay",function(b){if(b=b||{},!b||"film"===b.playListType){var c=+new Date;a.dataset.hasOwnProperty("_1_bufferFailTime")||0!==b.index||(a.context.msg.off("error._1_bufferFailTime"),a.context.msg.once("error._1_bufferFailTime",function(b){a.context.msg.off("videoPlaying._1_bufferFailTime"),a.dataset._1_bufferFailTime=+new Date,a.reportStep30({loadTime:a.dataset._1_bufferFailTime-c,val1:1})}),a.context.msg.once("videoPlaying._1_bufferFailTime",function(){a.context.msg.off("error._1_bufferFailTime")})),!a.dataset.hasOwnProperty("_2_bufferFailTime")&&b.index>0&&(a.context.msg.once("error._2_bufferFailTime",function(b){a.context.msg.off("videoPlaying._2_bufferFailTime"),a.dataset._2_bufferFailTime=+new Date,a.reportStep50({loadTime:a.dataset._2_bufferFailTime-c,val1:1})}),a.context.msg.once("videoPlaying._2_bufferFailTime",function(){a.context.msg.off("error._2_bufferFailTime")}))}})},setExtrainfo:function(a){this.context.config.extrainfo=a||""},setClientReportInfo:function(a){this.context.config.clientReportInfo=a||{}},setOuterReportData:function(a){this.context.config.outerReportData=a},exportsModuleApis:function(){this.dataset.moduleApis={},this.dataset.moduleApis.setExtrainfo=this.setExtrainfo.bind(this),this.dataset.moduleApis.setClientReportInfo=this.setClientReportInfo.bind(this),this.dataset.moduleApis.setOuterReportData=this.setOuterReportData.bind(this),e.extend(this.context.userApi,this.dataset.moduleApis)},addAdReport:function(){var a=this;this.context.msg.on("loadingAdStart",function(b,c){a.dataset.loadingadPlayingTime||(a.dataset.loadingadPlayingTime=+new Date,a.reportStep7())})},getAdReportData:function(){return this.context.adApi&&this.context.adApi.getAdReportData()}},Txplayer.register("v4HdPlayerReport",d)}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(187)},187:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=c(188);d.prototype={init:function(){this.write(),this.addEventListerner()},write:function(){var a={loading:"txp-ui-loading",continuePlay:"txp-ui-continue-play",hide:Txplayer.dataset.hideClass},b=e.tmpl(g,a);this.context.dataset.$playermod.append(b),this.dataset.$loading=this.context.dataset.$playermod.find('[data-role="'+a.loading+'"]'),this.dataset.$continue=this.context.dataset.$playermod.find('[data-role="'+a.continuePlay+'"]')},remove:function(){this.dataset.$loading.remove()},isNeedShowLoading:function(){if(1==this.context.dataset.playState||0==this.context.dataset.playState||2==this.context.dataset.playState)return!1;var a=this.context.msg.getData("checkTimeisInBufferdRange",this.context.dataset.videoCurrentTime);if(!a||3==this.context.dataset.playState)return!this.context.dataset.isPlayingAd},stopTimer:function(){this.dataset.timer&&(clearTimeout(this.dataset.timer),this.dataset.timer=null)},hide:function(){this.stopTimer(),this.dataset.isShowing&&(this.context.dataset.isMinbufferControlPause||(this.dataset.$loading.addClass(Txplayer.dataset.hideClass),this.dataset.isShowing=!1))},show:function(){if(!this.dataset.isShowing&&this.dataset.isPlayed){var a=this,b=function(){a.dataset.$loading.removeClass(Txplayer.dataset.hideClass),a.dataset.isShowing=!0};this.stopTimer(),this.dataset.timer=setTimeout(function(){a.isNeedShowLoading()&&b()},50)}},addEventListerner:function(){var a=this;this.dataset.eventsList={},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(){a.hide(),a.dataset.isPlayed=!0},this.dataset.eventsList[f.getUniqueMsgKey("isPlayingAdStatusChange")]=function(b){b&&(a.dataset.isPlayed=!0,a.hide())},this.dataset.eventsList[f.getUniqueMsgKey("videoSeeked")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("networkBadEnd")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("videoLoadstart")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("videoSeeking")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("videoWaiting")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("networkBadStart")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("showLoading")]=function(){a.context.dataset.isPlayingAd||(a.dataset.$loading.removeClass(Txplayer.dataset.hideClass),a.dataset.isShowing=!0)},this.dataset.eventsList[f.getUniqueMsgKey("hideLoading")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("showContinuePlay")]=function(b){if("number"==typeof b){var c=parseInt(b/60),d=parseInt(b%60),e="\u4e0a\u6b21\u89c2\u770b\u81f3"+(c?c+"\u5206":"")+d+"\u79d2\uff0c\u6b63\u5728\u4e3a\u4f60\u7eed\u64ad";a.dataset.$continue.text(e),a.dataset.$continue.removeClass(Txplayer.dataset.hideClass),setTimeout(function(){a.dataset.$continue.addClass(Txplayer.dataset.hideClass)},3e3)}},this.dataset.eventsList[f.getUniqueMsgKey("error")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(){a.dataset.isPlayed=null},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)})}},Txplayer.register("UiLoading",d)},188:function(a,b){a.exports='<txpdiv  class="txp_overlay_loading">\n  <txpdiv class="txp_text <%=hide%>" data-role="<%=continuePlay%>"></txpdiv>\n  <txpdiv class="txp_icon_loading <%=hide%>" data-role="<%=loading%>"></txpdiv>\n</txpdiv>'}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(189)},189:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=c(190);c(191);d.prototype={init:function(){this.dataset.adFlag=!1,this.write(),this.addEventListerner()},write:function(){var a={loading:"txp-ui-loading-with-ad",speed:"txp-ui-loading-with-ad-speed",canvas:"txp-ui-loading-with-ad-canvas",pvlAdLayer:"txp-ui-loading-with-ad-layer",hide:Txplayer.dataset.hideClass,hideLoadingSlogan:this.context.config.hideLoadingSlogan},b=e.tmpl(g,a);this.context.dataset.$playermod.append(b),this.dataset.$loading=this.context.dataset.$playermod.find('[data-role="'+a.loading+'"]'),this.context.dataset.$loading=this.dataset.$loading,this.dataset.$speed=this.context.dataset.$playermod.find('[data-role="'+a.speed+'"]'),this.dataset.$canvas=this.context.dataset.$playermod.find('[data-role="'+a.canvas+'"]'),this.context.dataset.$pvlAdLayer=this.context.dataset.$playermod.find('[data-role="'+a.pvlAdLayer+'"]')},remove:function(){this.dataset.$loading.remove()},getSpeedStart:function(){if(!this.dataset.timer){var a=this;this.dataset.timer=setInterval(function(){var b=a.context.dataset.videoDownloadSpeed||0;b<=0||a.dataset.$speed.html(f.formatDownloadSpeed(b))},200)}},getSpeedStop:function(){this.dataset.timer&&(clearInterval(this.dataset.timer),this.dataset.timer=null)},isNeedShowLoading:function(){if(1==this.context.dataset.playState||0==this.context.dataset.playState||2==this.context.dataset.playState)return!1;var a=this.context.msg.getData("checkTimeisInBufferdRange",this.context.dataset.videoCurrentTime);if(!a)return!0},hide:function(){this.dataset.showTimer&&(clearTimeout(this.dataset.showTimer),this.dataset.showTimer=null),this.context.dataset.isImgAdLoadingShowing&&(this.context.dataset.disableCalcDownloadSpeed=!0,this.dataset.$loading.addClass(Txplayer.dataset.hideClass),this.dataset.$speed.html(""),this.getSpeedStop(),this.context.msg.broadcast("adPluginMsg",{name:"stopAd",adtype:"PVL"}),this.context.dataset.isImgAdLoadingShowing=!1)},show:function(){if(!this.context.dataset.isImgAdLoadingShowing&&!this.dataset.isPlayed&&!this.dataset.showTimer){var a=this;this.dataset.showTimer=setTimeout(function(){a.dataset.showTimer=null,a.isNeedShowLoading()&&(f.v4log("showLoadingWithad"),a.context.dataset.disableCalcDownloadSpeed=!1,a.dataset.$loading.removeClass(Txplayer.dataset.hideClass),a.getSpeedStart(),a.context.dataset.isImgAdLoadingShowing=!0)},50)}},getAdFlag:function(){return this.dataset.adFlag=1===this.context.adApi.getAdTagConfig("PVL"),this.dataset.adFlag},updateAdFlagInHtml:function(){this.getAdFlag()?this.dataset.$adflag.removeClass("txp_none"):this.dataset.$adflag.addClass("txp_none")},addEventListerner:function(){var a=this;this.dataset.eventsList={},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(){a.dataset.isPlayed=!0,a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("videoTimeUpdate")]=function(){a.dataset.isPlayed=!0,a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("isPlayingAdStatusChange")]=function(b){b&&(a.dataset.isPlayed=!0,a.hide())},this.dataset.eventsList[f.getUniqueMsgKey("hlsStartPlay")]=function(){a.dataset.isPlayed||a.show()},this.dataset.eventsList[f.getUniqueMsgKey("videoPlay")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("userPlayPlayer")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("beforeVideoPlay")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("error")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("showUIVipGuide")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(){a.reset()},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)})},reset:function(){this.context.dataset.disableCalcDownloadSpeed=!0,this.dataset.isPlayed=null}},Txplayer.register("UiLoadingWithAD",d)},190:function(a,b){a.exports='<txpdiv data-role="<%=loading%>" class="txp_overlay_loading <%=hide%>">\n  <txpdiv class="txp_overlay_loading_content">\n    <txpdiv class="txp_overlay_loading_ad" data-role="<%=pvlAdLayer%>"></txpdiv>\n    <% if (!hideLoadingSlogan) { %>\n    <img class="txp_overlay_loading_slogan" src="//vm.gtimg.cn/tencentvideo/txp/style/img/slogan.png" style="width:165px">\n    <txpdiv class="txp_overlay_loading_name">\u817e\u8baf\u89c6\u9891 v.qq.com</txpdiv>\n    <% } %>\n    <txpdiv data-role="<%=speed%>" class="txp_overlay_loading_speed"></txpdiv>\n    <txpdiv  class="txp_overlay_loading_canvas">\n      <canvas data-role="<%=canvas%>" width="800" height="450"></canvas>\n    </txpdiv>\n  </txpdiv>\n</txpdiv>'},191:function(a,b){var c={frameRate:24,stageHeight:450,stageWidth:600,bgColor:null,definitionPool:[{frameActionList:[[0,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:245,t:"MC",id:2,a:0,d:0,x:382.8}],["tE","1-2",4,{alpha:.23,y:229.3,scaleX:1.15,scaleY:1.15,x:377}],["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:270.7,t:"MC",id:4,a:0,d:1,x:207.3}],["pE",{n:"5-5",y:293,t:"MC",id:5,a:0,d:2,x:405}],["pE",{n:"7-6",y:259,t:"MC",id:6,a:0,d:3,x:193}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"9-7",y:270.7,t:"MC",id:7,a:0,d:4,x:190.7}],["pE",{n:"11-9",y:313,t:"MC",id:9,a:0,d:5,x:257}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:322.6,t:"MC",id:10,sY:.81,a:0,d:6,sX:.81,x:287.6}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:285.6,t:"MC",id:11,sY:.92,a:0,d:7,sX:.92,x:229.2}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:269,t:"MC",id:12,a:0,d:8,x:363.1}]],[5,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:225.4,sX:1.19,sY:1.19,a:.29,x:375.5}]],[6,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:221.5,sX:1.23,sY:1.23,a:.36,x:374.1}],["tE","1-2",3,{alpha:.53,y:209.7,scaleX:1.34,scaleY:1.34,x:369.8}],["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:267.3,sX:1.03,sY:1.03,a:.09,x:205.5}]],[7,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:263.9,sX:1.05,sY:1.05,a:.17,x:203.6}]],[8,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:260.4,sX:1.08,sY:1.08,a:.26,x:201.8}]],[9,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:257,sX:1.1,sY:1.1,a:.34,x:199.9}],["pE",{n:"5-5",y:324,a:0,x:423}],["tE","5-5",30,{alpha:.86,y:250.5,scaleX:1,scaleY:1,x:440.4}]],[10,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:205.8,sX:1.38,sY:1.38,a:.59,x:368.3}],["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:253.6,sX:1.13,sY:1.13,a:.43,x:198.1}],["tE","3-4",2,{alpha:.6,y:246.7,scaleX:1.18,scaleY:1.18,x:194.4}]],[11,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:202,sX:1.42,sY:1.42,a:.65,x:366.9}],["tE","1-2",2,{alpha:.55,y:196.9,scaleX:1.36,scaleY:1.36,x:369.9}]],[13,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:243.3,sX:1.2,sY:1.2,a:.68,x:192.5}]],[14,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:194.3,sX:1.32,sY:1.32,a:.5,x:371.4}],["tE","1-2",5,{alpha:.25,y:181.7,scaleX:1.16,scaleY:1.16,x:378.7}],["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:239.9,sX:1.23,sY:1.23,a:.77,x:190.7}]],[15,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:236.4,sX:1.25,sY:1.25,a:.86,x:188.8}]],[16,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:233,sX:1.28,sY:1.28,a:.94,x:187}],["tE","3-4",8,{alpha:.11,y:193.1,scaleX:1.28,scaleY:1.28,x:199.5}]],[20,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:179.2,sX:1.13,sY:1.13,a:.2,x:380.2}],["pE",{n:"7-6",y:256.8,sX:1.01,sY:1.01,a:.04,x:192.6}],["tE","7-6",4,{alpha:.2,y:248,scaleX:1.04,scaleY:1.04,x:190.9}]],[21,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:176.7,sX:1.1,sY:1.1,a:.15,x:381.6}]],[22,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:174.2,sX:1.06,sY:1.06,a:.1,x:383.2}]],[23,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:171.6,sX:1.03,sY:1.03,a:.05,x:384.7}]],[24,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:169,a:0,x:386}]],[25,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:188,sX:1.28,sY:1.28,a:0,x:201}],["pE",{n:"7-6",y:245.8,sX:1.05,sY:1.05,a:.25,x:190.4}]],[26,["pE",{n:"7-6",y:243.6,sX:1.06,sY:1.06,a:.29,x:190.1}],["tE","7-6",4,{alpha:.45,y:234.8,scaleX:1.1,scaleY:1.1,x:188.3}]],[31,["pE",{n:"7-6",y:232.5,sX:1.1,sY:1.1,a:.49,x:188}]],[32,["pE",{n:"7-6",y:230.4,sX:1.11,sY:1.11,a:.53,x:187.5}],["tE","7-6",4,{alpha:.7,y:221.5,scaleX:1.15,scaleY:1.15,x:185.8}]],[35,["pE",{n:"11-9",y:309.1,sX:1.02,sY:1.02,a:.04,x:257.8}],["tE","11-9",9,{alpha:.4,y:273.5,scaleX:1.21,scaleY:1.21,x:265.4}]],[37,["pE",{n:"7-6",y:219.3,sX:1.16,sY:1.16,a:.74,x:185.4}]],[38,["pE",{n:"7-6",y:217.1,sX:1.17,sY:1.17,a:.78,x:185}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:316.9,sX:.82,sY:.82,a:.04,x:286.9}],["tE","13-10",8,{alpha:.36,y:271.2,scaleX:.92,scaleY:.92,x:281.2}]],[39,["pE",{n:"7-6",y:214.9,sX:1.17,sY:1.17,a:.82,x:184.5}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"9-7",y:267.3,a:.02,x:189.3}],["tE","9-7",13,{alpha:.29,y:223.4,scaleX:1,scaleY:1,x:171.4}]],[40,["pE",{n:"5-5",y:248,a:.89,x:441}],["tE","5-5",30,{alpha:.03,y:192.9,scaleX:1,scaleY:1,x:423.6}],["pE",{n:"7-6",y:212.7,sX:1.18,sY:1.18,a:.86,x:184.2}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:310,sX:.92,sY:.92,a:0,x:229.2}]],[41,["pE",{n:"7-6",y:210.5,sX:1.19,sY:1.19,a:.9,x:183.7}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:306.4,sX:.95,sY:.95,a:.02,x:227.3}]],[42,["pE",{n:"7-6",y:208.3,sX:1.2,sY:1.2,a:.94,x:183.3}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:302.9,sX:.98,sY:.98,a:.04,x:225.2}]],[43,["pE",{n:"7-6",y:204.9,sX:1.19,sY:1.19,a:.9,x:183.7}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:299.2,sX:1.01,sY:1.01,a:.06,x:223.2}]],[44,["pE",{n:"7-6",y:201.6,sX:1.18,sY:1.18,a:.87,x:184}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:295.6,sX:1.04,sY:1.04,a:.08,x:221.2}],["tE","15-11",7,{alpha:.22,y:270.6,scaleX:1.26,scaleY:1.26,x:207.2}]],[45,["pE",{n:"7-6",y:198.3,sX:1.18,sY:1.18,a:.83,x:184.5}],["tE","7-6",11,{alpha:.41,y:161.6,scaleX:1.09,scaleY:1.09,x:188.8}],["pE",{n:"11-9",y:269.5,sX:1.24,sY:1.24,a:.44,x:266.2}],["tE","11-9",2,{alpha:.52,y:261.7,scaleX:1.28,scaleY:1.28,x:267.9}]],[47,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:265.4,sX:.93,sY:.93,a:.4,x:280.4}]],[48,["pE",{n:"11-9",y:257.8,sX:1.3,sY:1.3,a:.56,x:268.8}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:259.8,sX:.94,sY:.94,a:.44,x:279.8}],["tE","13-10",2,{alpha:.52,y:248.3,scaleX:.97,scaleY:.97,x:278.3}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:267.1,sX:1.02,sY:1.02,a:.02,x:364}]],[49,["pE",{n:"11-9",y:254.4,sX:1.28,sY:1.28,a:.54,x:268.7}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:265,sX:1.04,sY:1.04,a:.04,x:364.8}]],[50,["pE",{n:"11-9",y:250.9,sX:1.25,sY:1.25,a:.51,x:268.5}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:263.1,sX:1.06,sY:1.06,a:.06,x:365.7}]],[51,["pE",{n:"11-9",y:247.5,sX:1.23,sY:1.23,a:.48,x:268.4}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:242.6,sX:.98,sY:.98,a:.56,x:277.6}],["tE","13-10",5,{alpha:.37,y:210.7,scaleX:.84,scaleY:.84,x:284.7}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:261.1,sX:1.08,sY:1.08,a:.08,x:366.6}]],[52,["pE",{n:"11-9",y:244,sX:1.21,sY:1.21,a:.46,x:268.3}],["tE","11-9",2,{alpha:.41,y:237.2,scaleX:1.16,scaleY:1.16,x:268.1}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:267,sX:1.29,sY:1.29,a:.24,x:205.3}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:259.2,sX:1.1,sY:1.1,a:.1,x:367.5}],["tE","17-12",8,{alpha:.26,y:243.4,scaleX:1.25,scaleY:1.25,x:374.5}]],[53,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"9-7",y:220,a:.31,x:170}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:260.6,sX:1.34,sY:1.34,a:.21,x:206.9}],["tE","15-11",4,{alpha:.12,y:234.6,scaleX:1.57,scaleY:1.57,x:213.6}]],[54,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"9-7",y:216.6,sX:.98,sY:.98,a:.29,x:171.5}]],[55,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"9-7",y:213,sX:.96,sY:.96,a:.27,x:172.9}],["tE","9-7",13,{alpha:.02,y:167.5,scaleX:.71,scaleY:.71,x:191.8}],["pE",{n:"11-9",y:233.8,sX:1.14,sY:1.14,a:.39,x:268}],["tE","11-9",4,{alpha:.29,y:220.1,scaleX:1.05,scaleY:1.05,x:267.5}]],[57,["pE",{n:"7-6",y:158.3,sX:1.08,sY:1.08,a:.38,x:189.1}],["tE","7-6",2,{alpha:.3,y:151.7,scaleX:1.06,scaleY:1.06,x:189.9}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:204.3,sX:.81,sY:.81,a:.34,x:286.2}]],[58,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:197.9,sX:.78,sY:.78,a:.3,x:287.5}],["tE","13-10",5,{alpha:.11,y:166,scaleX:.64,scaleY:.64,x:294.6}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:228,sX:1.62,sY:1.62,a:.09,x:215.3}]],[59,["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:221.6,sX:1.68,sY:1.68,a:.07,x:217}]],[60,["pE",{n:"7-6",y:148.3,sX:1.06,sY:1.06,a:.26,x:190.3}],["tE","7-6",4,{alpha:.11,y:135,scaleX:1.02,scaleY:1.02,x:191.9}],["pE",{n:"11-9",y:216.7,sX:1.02,sY:1.02,a:.27,x:267.4}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:215.1,sX:1.73,sY:1.73,a:.05,x:218.7}]],[61,["pE",{n:"11-9",y:213.2,sX:1,sY:1,a:.24,x:267.2}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:208.5,sX:1.79,sY:1.79,a:.02,x:220.3}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:241.4,sX:1.27,sY:1.27,a:.28,x:375.4}],["tE","17-12",9,{alpha:.03,y:197,scaleX:1.67,scaleY:1.67,x:358}]],[62,["pE",{n:"11-9",y:209.9,sX:.98,sY:.98,a:.22,x:267.1}],["tE","11-9",2,{alpha:.17,y:203,scaleX:.93,scaleY:.93,x:266.9}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:202,sX:1.84,sY:1.84,a:0,x:222}]],[64,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:159.6,sX:.61,sY:.61,a:.07,x:296}]],[65,["pE",{n:"7-6",y:131.6,sX:1.02,sY:1.02,a:.07,x:192.3}],["pE",{n:"11-9",y:199.6,sX:.91,sY:.91,a:.14,x:266.7}],["tE","11-9",5,{alpha:.02,y:182.4,scaleX:.79,scaleY:.79,x:266.1}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:153.2,sX:.58,sY:.58,a:.04,x:297.4}]],[66,["pE",{n:"7-6",y:128.4,sX:1.01,sY:1.01,a:.04,x:192.7}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:146.9,sX:.55,sY:.55,a:0,x:298.8}]],[67,["pE",{n:"7-6",y:125,a:0,x:193}]],[69,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"9-7",y:164,sX:.69,sY:.69,a:0,x:193.3}]],[71,["pE",{n:"5-5",y:191,a:0,x:423}],["pE",{n:"11-9",y:179,sX:.77,sY:.77,a:0,x:266}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:192,sX:1.71,sY:1.71,a:0,x:356}]]],totalFrames:72,rect:{x:190.7,y:245,height:100.3,width:273.5}},{graphics:[["f","#70DF00"],["p","ACKEVQg5AAgpgpQgogogAg5QAAg5AogpQApgoA5AAQA6gAAoAoQApApAAA5QAAA5gpAoQgoApg5AA"],["ef"]],rect:{x:0,y:0,height:27.7,width:27.7}},{frameActionList:[[0,["pE",{n:"1-1",t:"SH",id:1,sY:2.94,d:0,sX:2.94}]]],totalFrames:1,rect:{x:0,y:0,height:81.4,width:81.4}},{graphics:[["f","#FF920B"],["p","AAADrQAAhhBFhFQBFhEBiAAQBiAABFBFQBFBFAABiQAABihFBFQhFBFhhAAQhhAAhFhFQhEhFAAhh"],["ef"]],rect:{x:0,y:0,height:47,width:47}},{frameActionList:[[0,["pE",{n:"1-3",t:"SH",id:3,sY:1.04,d:0,sX:1.04}]]],totalFrames:1,rect:{x:0,y:0,height:49,width:49}},{frameActionList:[[0,["pE",{n:"1-1",t:"SH",id:1,sY:.38,d:0,sX:.38}]]],totalFrames:1,rect:{x:0,y:0,height:10.5,width:10.5}},{frameActionList:[[0,["pE",{n:"1-3",t:"SH",id:3,sY:.16,d:0,sX:.16}]]],totalFrames:1,rect:{x:0,y:0,height:7.5,width:7.5}},{frameActionList:[[0,["pE",{n:"1-1",t:"SH",d:0,id:1}]]],totalFrames:1,rect:{x:0,y:0,height:27.7,width:27.7}},{graphics:[["f","#44BFFB"],["p","AH4D8QAABphKBKQhKBKhoAAQhoAAhKhKQhJhKAAhoQAAhoBKhKQBKhJBpAAQBpAABKBKQBKBKAABp"],["ef"]],rect:{x:0,y:0,height:50.4,width:50.4}},{frameActionList:[[0,["pE",{n:"1-8",t:"SH",id:8,sY:.17,d:0,sX:.17}]]],totalFrames:1,rect:{x:0,y:0,height:8.5,width:8.5}},{frameActionList:[[0,["pE",{n:"1-3",t:"SH",id:3,sY:.6,d:0,sX:.6}]]],totalFrames:1,rect:{x:0,y:0,height:28,width:28}},{frameActionList:[[0,["pE",{n:"1-8",t:"SH",d:0,id:8}]]],totalFrames:1,rect:{x:0,y:0,height:50.4,width:50.4}},{frameActionList:[[0,["pE",{n:"1-3",t:"SH",d:0,id:3}]]],totalFrames:1,rect:{x:0,y:0,height:47,width:47}}]};a.exports=c}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(120)},120:function(a,b){function c(a){d=Txplayer.$,this.dataset={},this.context=a,this.init()}var d=Txplayer.$,e=(Txplayer.apiList,Txplayer.util);c.prototype={init:function(){this.dataset.maxHistoryPlayTimeList=50,this.dataset.useConnectionPlay=this.context.config.useConnectionPlay,this.context.dataset.historyDefinition=this.getHistoryDefinition(),this.context.config&&"v3"==this.context.config.version&&(this.dataset.adMuteHistory=this.getAdMuteHistory()),this.context.dataset.historyPlayTime=this.getHistoryPlayTime(),this.addEventListener()},savePlaytimeData:function(a){var b,c=e.getData(Txplayer.dataset.localStorageKey.historyPlayTime),d=this.context.dataset.vid,f=0;if(c)try{b=JSON.parse(c)}catch(g){b={}}else b={};if(!d)return void e.showError("savePlaytimeData Error","\u627e\u4e0d\u5230vid");for(var h in b)f++;f>=this.dataset.maxHistoryPlayTimeList&&(b={}),b[d]=a,this.context.dataset.historyPlayTime=JSON.stringify(b),e.setData(Txplayer.dataset.localStorageKey.historyPlayTime,JSON.stringify(b))},getHistoryPlayTime:function(){var a,b=e.getData(Txplayer.dataset.localStorageKey.historyPlayTime),c=this.context.dataset.vid;if(c||(c=this.context.config.vid),b)try{a=JSON.parse(b)}catch(d){a={}}else a={};return c?a[c]:void e.showError("getHistoryPlayTime Error","\u627e\u4e0d\u5230vid")},clearPlaytimeData:function(){var a,b=e.getData(Txplayer.dataset.localStorageKey.historyPlayTime),c=this.context.dataset.vid;if(b)try{a=JSON.parse(b)}catch(d){a={}}else a={};return c?(delete a[c],this.context.dataset.historyPlayTime=JSON.stringify(a),void e.setData(Txplayer.dataset.localStorageKey.historyPlayTime,JSON.stringify(a))):void e.showError("clearPlaytimeData Error","\u627e\u4e0d\u5230vid")},saveDefinitionData:function(a){a&&(this.context.dataset.historyDefinition=a,e.setData(Txplayer.dataset.localStorageKey.historyDefinition,a))},getHistoryDefinition:function(){var a=e.getData(Txplayer.dataset.localStorageKey.historyDefinition);return"mp4"==a&&(a=""),a},saveAdMuteData:function(a){this.dataset.adMuteHistory=JSON.stringify(a),e.setData(Txplayer.dataset.localStorageKey.adMuteHistory,a)},getAdMuteHistory:function(){return this.dataset.adMuteHistory=e.getData(Txplayer.dataset.localStorageKey.adMuteHistory),e.getData(Txplayer.dataset.localStorageKey.adMuteHistory)},addEventListener:function(){var a=this;this.dataset.eventsList={},this.context.config&&"v3"==this.context.config.version&&(this.dataset.eventsList[e.getUniqueMsgKey("videoPlay")]=function(b){if(b&&"film"!==b.playListType){var c="true"===a.dataset.adMuteHistory;a.context.msg.broadcast("adMuteStateUpdate",{mute:c})}},this.dataset.eventsList[e.getUniqueMsgKey("adMuteChange")]=function(b){b&&b.hasOwnProperty("mute")&&a.saveAdMuteData(b.mute)}),this.dataset.eventsList[e.getUniqueMsgKey("videoTimeUpdate")]=function(b){if(b)if(b.currentTime&&parseInt(b.currentTime)%3===0)a.savePlaytimeData(parseInt(b.currentTime));else{if(b&&"film"!==b.playListType)return;if(b&&b.videoTag&&b.videoTag.currentTime&&parseInt(b.videoTag.currentTime)%3===0){var c=a.context.dataset.currentTime;a.savePlaytimeData(parseInt(c))}}},this.dataset.eventsList[e.getUniqueMsgKey("videoEnd")]=function(b){"film"===b.playListType&&(b.isAllEnd||b.isTheLastFilm)&&a.clearPlaytimeData()},this.dataset.eventsList[e.getUniqueMsgKey("definitionChange")]=function(b){a.saveDefinitionData(b)},d.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)})}},Txplayer.register("HdPlayerHistory",c)}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(123)},123:function(a,b,c){function d(a){g=Txplayer.$,this.context=a,this.context.dataset.hasChromeHlsPlugin=!0,this.dataset={},this._hls=null,this._video=null,this.addEventListener()}var e,f,g=Txplayer.$,h=Txplayer.util,i=c(124),j={debug:1==h.getUrlParam("debughls"),manifestLoadingMaxRetry:2,manifestLoadingRetryDelay:100,manifestLoadingTimeOut:1e4,levelLoadingMaxRetry:2,levelLoadingRetryDelay:100,levelLoadingTimeOut:1e4,fragLoadingRetryDelay:10,fragLoadingMaxRetry:3,fragLoadingTimeOut:3e4,maxBufferLength:240,maxMaxBufferLength:240,autoStartLoad:!1};d.prototype={destroyHlsPlayer:function(){this._hls&&(this._hls.destroy(),this._hls=null),this._video&&(this._video=null)},createHlsPlayer:function(a,b){b.video.isFocus&&this.destroyHlsPlayer(),e=null,f=null,a=a||j,a.p2pConfig=b.p2pConfig,this._hls=new i(a),this.initHlsEvent()},loadHlsSource:function(a){if(a.src&&a.video){g.extend({},j);if(a.fromSetDefinition&&this._hls)h.v4log("setInfo",{p2pConfig:a.p2pConfig}),this._hls&&this._hls.setInfo&&this._hls.setInfo(a.p2pConfig),this.addDefinition(a);else{h.v4log("setInfo",{p2pConfig:a.p2pConfig}),this._hls&&this._hls.setInfo&&this._hls.setInfo(a.p2pConfig),this.createHlsPlayer(null,a),this._hls.attachMedia(a.video);var b=a.src;a.m3u8?(this.initSetCurrenTime(a),this._hls.loadSource({m3u8:a.m3u8,url:a.src})):(this._hls.loadSource({url:b}),this.initSetCurrenTime(a)),this.dataset.level=0,this.dataset.urlsNum=1,this.dataset.hasSetDefinitionFail=null}}},dealSrc:function(a){var b="#EXTM3U\n#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH="+this.context.dataset.currentDefinitionRate+",NAME="+this.context.dataset.definition+"\n"+a+"\n";return"data:appliction/x-mpegurl,"+encodeURIComponent(b)},addDefinition:function(a){this.dataset.urlsNum++;var b="#EXTM3U\n#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH="+this.context.dataset.currentDefinitionRate+",NAME="+this.context.dataset.definition+"\n"+a.src+"\n",c=this._hls.coreComponents[0].parseMasterPlaylist(b,encodeURIComponent(b));c[0].url=[c[0].url],c[0].urlId=0,this._hls.levelController._levels.push(c[0]),this._hls.nextLevel=this.dataset.urlsNum-1,a.autoplay&&this._video&&this._video.play()},_startLoad:function(a){var b=this;if(a.currentTime){b._hls.config.startPosition=a.currentTime;var c,d=function(a){if(!b._video)return c&&window.clearInterval(c),void(c=window.setInterval(function(){d(a)},50));if(window.clearInterval(c),c=null,b._hls.startLoad(a.currentTime),b._hls.config.startPosition=0,a.autoplay){var e=a.video.play();e&&e["catch"]&&e["catch"](function(a){h.v4log("hls-play-catch2",a)})}};d(a)}else b._hls.startLoad(),b.setCurrenTime(a)},initSetCurrenTime:function(a){if(a.video){h&&h.v4log("hls-initSetCurrenTime",{src:a.src,currentTime:a.currentTime});var b=this;this._hls.on(i.Events.MANIFEST_PARSED,function(c,d){b._startLoad(a);var e=d&&d.levels&&d.levels[0]&&d.levels[0].details;e&&b.context.msg.broadcast("videoHlsManifestParsed",e)})}},setCurrenTime:function(a){h&&h.v4log("hls-setCurrenTime",a);var b;a.hasOwnProperty("currentTime")&&!isNaN(a.currentTime)?a.autoplay?(b=a.video.play(),b&&b.then?b.then(function(){a.video.currentTime=a.currentTime})["catch"](function(b){a.video.currentTime=a.currentTime,h.v4log("setCurrentTime: hls-play-catch",b)}):a.video.currentTime=a.currentTime):a.video.currentTime=a.currentTime:a.autoplay&&(b=a.video.play(),b&&b["catch"]&&b["catch"](function(a){h.v4log("hls-play-catch1",a)}))},initHlsEvent:function(){var a=this;this._hls.on(i.Events.LEVEL_SWITCHED,function(b,c){h.v4log("LEVEL_SWITCHED",{urlsNum:a.dataset.urlsNum,level:a.dataset.level,currentLevel:a._hls&&a._hls.currentLevel}),a._hls&&a.dataset.urlsNum>1&&a.dataset.level!=a._hls.currentLevel&&a.context.dataset.useChromeHls&&(h.v4log("\u5df2\u6210\u529f\u4e3a\u60a8\u5207\u6362\u6e05\u6670\u5ea6"),a.dataset.level=a._hls.currentLevel,a.context.dataset.playList[a.context.dataset.playListIndex].playing=!0,a.context.msg.broadcast("videoPlaying.h5report-step31",{index:0}),a.context.msg.broadcast("videoPlaying.switch_definition",{hlsDefinitionEndTime:+new Date}),a.context.msg.broadcast("showUiTips",{text:"\u5df2\u6210\u529f\u4e3a\u60a8\u5207\u6362\u6e05\u6670\u5ea6",time:3}))}),this._hls.on(i.Events.MEDIA_ATTACHING,function(a,b){h.v4log("hls-MEDIA_ATTACHING",{stime:+new Date})}),this._hls.on(i.Events.MEDIA_ATTACHED,function(b,c){h.v4log("hls-MEDIA_ATTACHED",{stime:+new Date}),a._video=c.media}),this._hls.on(i.Events.MANIFEST_LOADING,function(b,c){h.v4log("hls-MANIFEST_LOADING",{stime:+new Date}),a.context.msg.broadcast("hlsStartPlay",{stime:+new Date})}),this._hls.on(i.Events.MEDIA_DETACHED,function(b,c){a._video=null}),this._hls.on(i.Events.ERROR,function(b,c){if(h.v4log("Hls.Events.ERROR",c),c.fatal)switch(c.tsUrl="",c.frag&&c.frag.url&&(c.tsUrl=c.frag.url),c.type){case i.ErrorTypes.MEDIA_ERROR:"bufferAppendError"==c.details&&(a.context.dataset.videoWaitingReason=4,g(a._video).trigger("waiting"),g(a._video).trigger("error",{detail:c.details,url:c.tsUrl})),"bufferStalledError"==c.details&&(a.context.dataset.videoWaitingReason=5,g(a._video).trigger("waiting"),g(a._video).trigger("error",{detail:c.details,url:c.tsUrl}));break;case i.ErrorTypes.NETWORK_ERROR:h.v4log("NETWORK_ERROR",{detail:c.details}),a.context.dataset.videoWaitingReason=6,g(a._video).trigger("waiting"),g(a._video).trigger("error",{detail:c.details,url:c.tsUrl});break;default:a.context.dataset.videoWaitingReason=7,g(a._video).trigger("error",{detail:c.details,url:c.tsUrl})}}),this._hls.on(i.Events.FRAG_LOAD_PROGRESS,function(b,c){c&&c.stats&&a.context.msg.broadcast("hlsProgress",{loaded:c.stats.loaded,total:c.stats.total}),c&&c.stats&&c.stats.loaded>0&&c.frag&&0===c.frag.loadIdx&&(c.stats.loaded/c.stats.total>.3&&a.context.msg.broadcast("hlsFirstFragementLoadFinish",{time:+new Date,loaded:c.stats.loaded}),h.v4log("step30-\u5f53\u524d\u52a0\u8f7d\u8fdb\u5ea6",{time:+new Date,loaded:c.stats.loaded,percent:c.stats.loaded/c.stats.total}))}),this._hls.on(i.Events.BUFFER_FULL_ERROR,function(a,b){h.v4log("BUFFER_FULL_ERROR",b)})},handleMediaError:function(a){var b=this,c=(new Date).getTime();!e||c-e>3e3?(e=(new Date).getTime(),this._hls.recoverMediaError()):!f||c-f>3e3?(f=(new Date).getTime(),this._hls.swapAudioCodec(),this._hls.recoverMediaError()):g(b._video).trigger("error",{detail:a.details,url:a.tsUrl})},remove:function(){this.destroyHlsPlayer()},addEventListener:function(){var a=this;a.context.msg.on("loadHlsSource",function(b){h.v4log("hlshelper-broadcast:loadHlsSource"),a.loadHlsSource(b)}),a.context.msg.on("destroyHlsPlayer",function(){h.v4log("hlshelper-broadcast:destroyHlsPlayer"),a.destroyHlsPlayer()}),a.context.msg.on("setHlsCurrenTime",function(b){h.v4log("hlshelper-broadcast:setHlsCurrenTime"),a.setCurrenTime(b)}),a.context.msg.on("reportChromeHlsLog",function(b){a.context.dataset.useChromeHls&&(h.v4log("hlshelper-broadcast:ReportHlsLog"),i.postLog&&i.postLog(b&&b.code||0))}),a.context.msg.on("reportChromeHlsError",function(a){h.v4log("hlshelper-broadcast:ReportHlsError",a),i.setPlayerError&&i.setPlayerError(a)})}},Txplayer.register("HlsHelper",d)},124:function(a,b){!function(c){if("object"==typeof b&&"undefined"!=typeof a)a.exports=c();else if("function"==typeof define&&define.amd)define([],c);else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.Hls=c()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;var k=new Error('Uncaught, unspecified "error" event. ('+b+")");throw k.context=b,k}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),c.apply(this,f)}else if(g(c))for(f=Array.prototype.slice.call(arguments,1),j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f);return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned&&(c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,"function"==typeof console.trace)),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else if(c)for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.prototype.listenerCount=function(a){if(this._events){var b=this._events[a];if(e(b))return 1;if(b)return b.length}return 0},d.listenerCount=function(a,b){return a.listenerCount(b)}},{}],2:[function(b,c,d){!function(b){var e=/^((?:[^\/;?#]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,f=/^([^\/;?#]*)(.*)$/,g=/(?:\/|^)\.(?=\/)/g,h=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,i={buildAbsoluteURL:function(a,b,c){if(c=c||{},a=a.trim(),b=b.trim(),!b){if(!c.alwaysNormalize)return a;var d=this.parseURL(a);if(!g)throw new Error("Error trying to parse base URL.");return d.path=i.normalizePath(d.path),i.buildURLFromParts(d)}var e=this.parseURL(b);if(!e)throw new Error("Error trying to parse relative URL.");if(e.scheme)return c.alwaysNormalize?(e.path=i.normalizePath(e.path),i.buildURLFromParts(e)):b;var g=this.parseURL(a);if(!g)throw new Error("Error trying to parse base URL.");if(!g.netLoc&&g.path&&"/"!==g.path[0]){var h=f.exec(g.path);g.netLoc=h[1],g.path=h[2]}g.netLoc&&!g.path&&(g.path="/");var j={scheme:g.scheme,netLoc:e.netLoc,path:null,params:e.params,query:e.query,fragment:e.fragment};if(!e.netLoc&&(j.netLoc=g.netLoc,"/"!==e.path[0]))if(e.path){var k=g.path,l=k.substring(0,k.lastIndexOf("/")+1)+e.path;j.path=i.normalizePath(l)}else j.path=g.path,e.params||(j.params=g.params,e.query||(j.query=g.query));return null===j.path&&(j.path=c.alwaysNormalize?i.normalizePath(e.path):e.path),i.buildURLFromParts(j)},parseURL:function(a){var b=e.exec(a);return b?{scheme:b[1]||"",netLoc:b[2]||"",path:b[3]||"",params:b[4]||"",query:b[5]||"",fragment:b[6]||""}:null},normalizePath:function(a){for(a=a.split("").reverse().join("").replace(g,"");a.length!==(a=a.replace(h,"")).length;);return a.split("").reverse().join("")},buildURLFromParts:function(a){return a.scheme+a.netLoc+a.path+a.params+a.query+a.fragment}};"object"==typeof d&&"object"==typeof c?c.exports=i:"function"==typeof a&&a.amd?a([],function(){return i}):"object"==typeof d?d.URLToolkit=i:b.URLToolkit=i}(this)},{}],3:[function(a,b,c){var d=arguments[3],e=arguments[4],f=arguments[5],g=JSON.stringify;b.exports=function(a,b){function c(a){q[a]=!0;for(var b in e[a][1]){var d=e[a][1][b];q[d]||c(d)}}for(var h,i=Object.keys(f),j=0,k=i.length;j<k;j++){var l=i[j],m=f[l].exports;if(m===a||m&&m["default"]===a){h=l;break}}if(!h){h=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var n={},j=0,k=i.length;j<k;j++){var l=i[j];n[l]=l}e[h]=[Function(["require","module","exports"],"("+a+")(self)"),n]}var o=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[h]=h,e[o]=[Function(["require"],"var f = require("+g(h)+");(f.default ? f.default : f)(self);"),p];var q={};c(o);var r="("+d+")({"+Object.keys(q).map(function(a){return g(a)+":["+e[a][0]+","+g(e[a][1])+"]"}).join(",")+"},{},["+g(o)+"])",s=window.URL||window.webkitURL||window.mozURL||window.msURL,t=new Blob([r],{type:"text/javascript"});if(b&&b.bare)return t;var u=s.createObjectURL(t),v=new Worker(u);return v.objectURL=u,v}},{}],4:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.hlsDefaultConfig=void 0;var e=a(5),f=d(e),g=a(8),h=d(g),i=a(9),j=d(i),k=a(10),l=d(k),m=a(59),n=d(m),o=a(7),p=d(o),q=a(6),r=d(q),s=a(50),t=d(s),u=a(16),v=d(u),w=a(15),x=d(w),y=a(14),z=d(y);c.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:n["default"],fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:f["default"],bufferController:h["default"],capLevelController:j["default"],fpsController:l["default"],audioStreamController:r["default"],audioTrackController:p["default"],subtitleStreamController:z["default"],subtitleTrackController:x["default"],timelineController:v["default"],cueHandler:t["default"],enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",stretchShortVideoTrack:!1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0}},{10:10,14:14,15:15,16:16,5:5,50:50,59:59,6:6,7:7,8:8,9:9}],5:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(37),n=d(m),o=a(33),p=a(54),q=a(52),r=d(q),s=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].FRAG_LOADING,j["default"].FRAG_LOADED,j["default"].FRAG_BUFFERED,j["default"].ERROR));return c.lastLoadedFragLevel=0,c._nextAutoLevel=-1,c.hls=a,c.timer=null,c._bwEstimator=null,c.onCheck=c._abandonRulesCheck.bind(c),c}return g(b,a),h(b,[{key:"destroy",value:function(){this.clearTimer(),l["default"].prototype.destroy.call(this)}},{key:"onFragLoading",value:function(a){var b=a.frag;if("main"===b.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var c=this.hls,d=a.frag.level,e=c.levels[d].details.live,f=c.config,g=void 0,h=void 0;e?(g=f.abrEwmaFastLive,h=f.abrEwmaSlowLive):(g=f.abrEwmaFastVoD,h=f.abrEwmaSlowVoD),this._bwEstimator=new r["default"](c,h,g,f.abrEwmaDefaultEstimate)}this.fragCurrent=b}}},{key:"_abandonRulesCheck",value:function(){var a=this.hls,b=a.media,c=this.fragCurrent,d=c.loader,e=a.minAutoLevel;if(!d||d.stats&&d.stats.aborted)return p.logger.warn("frag loader destroy or aborted, disarm abandonRules"),void this.clearTimer();var f=d.stats;if(b&&(!b.paused&&0!==b.playbackRate||!b.readyState)&&c.autoLevel&&c.level){var g=performance.now()-f.trequest,h=Math.abs(b.playbackRate);if(g>500*c.duration/h){var i=a.levels,k=Math.max(1,f.bw?f.bw/8:1e3*f.loaded/g),l=i[c.level],m=l.realBitrate?Math.max(l.realBitrate,l.bitrate):l.bitrate,o=f.total?f.total:Math.max(f.loaded,Math.round(c.duration*m/8)),q=b.currentTime,r=(o-f.loaded)/k,s=(n["default"].bufferInfo(b,q,a.config.maxBufferHole).end-q)/h;if(s<2*c.duration/h&&r>s){var t=void 0,u=void 0;for(u=c.level-1;u>e;u--){var v=i[u].realBitrate?Math.max(i[u].realBitrate,i[u].bitrate):i[u].bitrate;if(t=c.duration*v/(6.4*k),t<s)break}t<r&&(p.logger.warn("loading too slow, abort fragment loading and switch to level "+u+":fragLoadedDelay["+u+"]<fragLoadedDelay["+(c.level-1)+"];bufferStarvationDelay:"+t.toFixed(1)+"<"+r.toFixed(1)+":"+s.toFixed(1)),a.nextLoadLevel=u,this._bwEstimator.sample(g,f.loaded),d.abort(),this.clearTimer(),a.trigger(j["default"].FRAG_LOAD_EMERGENCY_ABORTED,{frag:c,stats:f}))}}}}},{key:"onFragLoaded",value:function(a){var b=a.frag;if("main"===b.type&&!isNaN(b.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=b.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var c=this.hls.levels[b.level],d=(c.loaded?c.loaded.bytes:0)+a.stats.loaded,e=(c.loaded?c.loaded.duration:0)+a.frag.duration;c.loaded={bytes:d,duration:e},c.realBitrate=Math.round(8*d/e)}if(a.frag.bitrateTest){var f=a.stats;f.tparsed=f.tbuffered=f.tload,this.onFragBuffered(a)}}}},{key:"onFragBuffered",value:function(a){var b=a.stats,c=a.frag;if(!(b.aborted===!0||1!==c.loadCounter||"main"!==c.type||isNaN(c.sn)||c.bitrateTest&&b.tload!==b.tbuffered)){var d=b.tparsed-b.trequest;p.logger.log("latency/loading/parsing/append/kbps:"+Math.round(b.tfirst-b.trequest)+"/"+Math.round(b.tload-b.tfirst)+"/"+Math.round(b.tparsed-b.tload)+"/"+Math.round(b.tbuffered-b.tparsed)+"/"+Math.round(8*b.loaded/(b.tbuffered-b.trequest))),this._bwEstimator.sample(d,b.loaded),b.bwEstimate=this._bwEstimator.getEstimate(),c.bitrateTest?this.bitrateTestDelay=d/1e3:this.bitrateTestDelay=0}}},{key:"onError",value:function(a){switch(a.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){clearInterval(this.timer),this.timer=null}},{key:"_findBestLevel",value:function(a,b,c,d,e,f,g,h,i){for(var j=e;j>=d;j--){var k=i[j],l=k.details,m=l?l.totalduration/l.fragments.length:b,n=!!l&&l.live,o=void 0;o=j<=a?g*c:h*c;var q=i[j].realBitrate?Math.max(i[j].realBitrate,i[j].bitrate):i[j].bitrate,r=q*m/o;if(p.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+j+"/"+Math.round(o)+"/"+q+"/"+m+"/"+f+"/"+r),o>q&&(!r||n&&!this.bitrateTestDelay||r<f))return j}return-1}},{key:"nextAutoLevel",get:function(){var a=this._nextAutoLevel,b=this._bwEstimator;if(!(a===-1||b&&b.canEstimate()))return a;var c=this._nextABRAutoLevel;return a!==-1&&(c=Math.min(a,c)),c},set:function(a){this._nextAutoLevel=a}},{key:"_nextABRAutoLevel",get:function(){var a=this.hls,b=a.maxAutoLevel,c=a.levels,d=a.config,e=a.minAutoLevel,f=a.media,g=this.lastLoadedFragLevel,h=this.fragCurrent?this.fragCurrent.duration:0,i=f?f.currentTime:0,j=f&&0!==f.playbackRate?Math.abs(f.playbackRate):1,k=this._bwEstimator?this._bwEstimator.getEstimate():d.abrEwmaDefaultEstimate,l=(n["default"].bufferInfo(f,i,d.maxBufferHole).end-i)/j,m=this._findBestLevel(g,h,k,e,b,l,d.abrBandWidthFactor,d.abrBandWidthUpFactor,c);if(m>=0)return m;p.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var o=h?Math.min(h,d.maxStarvationDelay):d.maxStarvationDelay,q=d.abrBandWidthFactor,r=d.abrBandWidthUpFactor;if(0===l){var s=this.bitrateTestDelay;if(s){var t=h?Math.min(h,d.maxLoadingDelay):d.maxLoadingDelay;o=t-s,p.logger.trace("bitrate test took "+Math.round(1e3*s)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*o)+" ms"),q=r=1}}return m=this._findBestLevel(g,h,k,e,b,l+o,q,r,c),Math.max(m,0)}}]),b}(l["default"]);c["default"]=s},{33:33,34:34,35:35,37:37,52:52,54:54}],6:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(48),j=d(i),k=a(37),l=d(k),m=a(25),n=d(m),o=a(35),p=d(o),q=a(34),r=d(q),s=a(38),t=d(s),u=a(55),v=d(u),w=a(33),x=a(54),y=a(51),z={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS"},A=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,p["default"].MEDIA_ATTACHED,p["default"].MEDIA_DETACHING,p["default"].AUDIO_TRACKS_UPDATED,p["default"].AUDIO_TRACK_SWITCHING,p["default"].AUDIO_TRACK_LOADED,p["default"].KEY_LOADED,p["default"].FRAG_LOADED,p["default"].FRAG_PARSING_INIT_SEGMENT,p["default"].FRAG_PARSING_DATA,p["default"].FRAG_PARSED,p["default"].ERROR,p["default"].BUFFER_CREATED,p["default"].BUFFER_APPENDED,p["default"].BUFFER_FLUSHED,p["default"].INIT_PTS_FOUND));return c.config=a.config,c.audioCodecSwap=!1,c.ticks=0,c._state=z.STOPPED,c.ontick=c.tick.bind(c),c.initPTS=[],c.waitingFragment=null,c.videoTrackCC=null,c}return g(b,a),h(b,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),r["default"].prototype.destroy.call(this),this.state=z.STOPPED}},{key:"onInitPtsFound",value:function(a){var b=a.id,c=a.frag.cc,d=a.initPTS;"main"===b&&(this.initPTS[c]=d,this.videoTrackCC=c,x.logger.log("InitPTS for cc:"+c+" found from video track:"+d),this.state===z.WAITING_INIT_PTS&&this.tick())}},{key:"startLoad",value:function(a){if(this.tracks){var b=this.lastCurrentTime;this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.fragLoadError=0,b>0&&a===-1?(x.logger.log("audio:override startPosition with lastCurrentTime @"+b.toFixed(3)),this.state=z.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:a,this.state=z.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=a,this.state=z.STOPPED}},{key:"stopLoad",value:function(){var a=this.fragCurrent;a&&(a.loader&&a.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=z.STOPPED}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){var a,b,c,d=this.hls,e=d.config;switch(this.state){case z.ERROR:case z.PAUSED:case z.BUFFER_FLUSHING:break;case z.STARTING:this.state=z.WAITING_TRACK,this.loadedmetadata=!1;break;case z.IDLE:var f=this.tracks;if(!f)break;if(!this.media&&(this.startFragRequested||!e.startFragPrefetch))break;if(this.loadedmetadata)a=this.media.currentTime;else if(a=this.nextLoadPosition,void 0===a)break;var g=this.mediaBuffer?this.mediaBuffer:this.media,h=l["default"].bufferInfo(g,a,e.maxBufferHole),i=h.len,k=h.end,m=this.fragPrevious,n=e.maxMaxBufferLength,o=this.audioSwitch,q=this.trackId;if((i<n||o)&&q<f.length){if(c=f[q].details,"undefined"==typeof c){this.state=z.WAITING_TRACK;break}if(!o&&!c.live&&m&&m.sn===c.endSN&&(!this.media.seeking||this.media.duration-k<m.duration/2)){this.hls.trigger(p["default"].BUFFER_EOS,{type:"audio"}),this.state=z.ENDED;break}var r=c.fragments,s=r.length,t=r[0].start,u=r[s-1].start+r[s-1].duration,v=void 0;if(o)if(c.live&&!c.PTSKnown)x.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),k=0;else if(k=a,c.PTSKnown&&a<t){if(!(h.end>t||h.nextStart))return;x.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=t+.05}if(c.initSegment&&!c.initSegment.data)v=c.initSegment;else if(k<=t){if(v=r[0],null!==this.videoTrackCC&&v.cc!==this.videoTrackCC&&(v=(0,y.findFragWithCC)(r,this.videoTrackCC)),c.live&&v.loadIdx&&v.loadIdx===this.fragLoadIdx){var A=h.nextStart?h.nextStart:t;return x.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(A+.05)),void(this.media.currentTime=A+.05)}}else{var B=void 0,C=e.maxFragLookUpTolerance,D=m?r[m.sn-r[0].sn+1]:void 0,E=function(a){var b=Math.min(C,a.duration);return a.start+a.duration-b<=k?1:a.start-b>k&&a.start?-1:0};k<u?(k>u-C&&(C=0),B=D&&!E(D)?D:j["default"].search(r,E)):B=r[s-1],B&&(v=B,t=B.start,m&&v.level===m.level&&v.sn===m.sn&&(v.sn<c.endSN?(v=r[v.sn+1-c.startSN],x.logger.log("SN just loaded, load next one: "+v.sn)):v=null))}if(v)if(v.decryptdata&&null!=v.decryptdata.uri&&null==v.decryptdata.key)x.logger.log("Loading key for "+v.sn+" of ["+c.startSN+" ,"+c.endSN+"],track "+q),this.state=z.KEY_LOADING,d.trigger(p["default"].KEY_LOADING,{frag:v});else{if(x.logger.log("Loading "+v.sn+", cc: "+v.cc+" of ["+c.startSN+" ,"+c.endSN+"],track "+q+", currentTime:"+a+",bufferEnd:"+k.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,v.loadCounter){v.loadCounter++;var F=e.fragLoadingLoopThreshold;if(v.loadCounter>F&&Math.abs(this.fragLoadIdx-v.loadIdx)<F)return void d.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:v})}else v.loadCounter=1;v.loadIdx=this.fragLoadIdx,this.fragCurrent=v,this.startFragRequested=!0,isNaN(v.sn)||(this.nextLoadPosition=v.start+v.duration),d.trigger(p["default"].FRAG_LOADING,{frag:v}),this.state=z.FRAG_LOADING}}break;case z.WAITING_TRACK:b=this.tracks[this.trackId],b&&b.details&&(this.state=z.IDLE);break;case z.FRAG_LOADING_WAITING_RETRY:var G=performance.now(),H=this.retryDate;g=this.media;var I=g&&g.seeking;(!H||G>=H||I)&&(x.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=z.IDLE);break;case z.WAITING_INIT_PTS:if(void 0===this.initPTS[this.videoTrackCC])break;var J=this.waitingFragment;if(J){var K=J.frag.cc;this.videoTrackCC!==K?(x.logger.warn("Waiting fragment CC ("+K+") does not match video track CC ("+this.videoTrackCC+")"),this.waitingFragment=null,this.state=z.IDLE):(this.state=z.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=z.IDLE;break;case z.STOPPED:case z.FRAG_LOADING:case z.PARSING:case z.PARSED:case z.ENDED:}}},{key:"onMediaAttached",value:function(a){var b=this.media=this.mediaBuffer=a.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),b.addEventListener("seeking",this.onvseeking),b.addEventListener("ended",this.onvended);var c=this.config;this.tracks&&c.autoStartLoad&&this.startLoad(c.startPosition)}},{key:"onMediaDetaching",value:function(){var a=this.media;a&&a.ended&&(x.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var b=this.tracks;b&&b.forEach(function(a){a.details&&a.details.fragments.forEach(function(a){a.loadCounter=void 0})}),a&&(a.removeEventListener("seeking",this.onvseeking),a.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){this.state===z.ENDED&&(this.state=z.IDLE),this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()}},{key:"onMediaEnded",value:function(){this.startPosition=this.lastCurrentTime=0}},{key:"onAudioTracksUpdated",value:function(a){x.logger.log("audio tracks updated"),this.tracks=a.audioTracks}},{key:"onAudioTrackSwitching",value:function(a){var b=!!a.url;this.trackId=a.id,this.fragCurrent=null,this.state=z.PAUSED,this.waitingFragment=null,b?this.timer||(this.timer=setInterval(this.ontick,100)):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),b&&(this.audioSwitch=!0,this.state=z.IDLE,void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold)),this.tick()}},{key:"onAudioTrackLoaded",value:function(a){var b=a.details,c=a.id,d=this.tracks[c],e=b.totalduration,f=0;if(x.logger.log("track "+c+" loaded ["+b.startSN+","+b.endSN+"],duration:"+e),b.live){var g=d.details;g&&b.fragments.length>0?(t["default"].mergeDetails(g,b),f=b.fragments[0].start,b.PTSKnown?x.logger.log("live audio playlist sliding:"+f.toFixed(3)):x.logger.log("live audio playlist - outdated PTS, unknown sliding")):(b.PTSKnown=!1,x.logger.log("live audio playlist - first load, unknown sliding"));
}else b.PTSKnown=!1;if(d.details=b,!this.startFragRequested){if(this.startPosition===-1){var h=b.startTimeOffset;isNaN(h)?this.startPosition=0:(x.logger.log("start time offset found in playlist, adjust startPosition to "+h),this.startPosition=h)}this.nextLoadPosition=this.startPosition}this.state===z.WAITING_TRACK&&(this.state=z.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===z.KEY_LOADING&&(this.state=z.IDLE,this.tick())}},{key:"onFragLoaded",value:function(a){var b=this.fragCurrent,c=a.frag;if(this.state===z.FRAG_LOADING&&b&&"audio"===c.type&&c.level===b.level&&c.sn===b.sn){var d=this.tracks[this.trackId],e=d.details,f=e.totalduration,g=b.level,h=b.sn,i=b.cc,j=this.config.defaultAudioCodec||d.audioCodec||"mp4a.40.2",k=this.stats=a.stats;if("initSegment"===h)this.state=z.IDLE,k.tparsed=k.tbuffered=performance.now(),e.initSegment.data=a.payload,this.hls.trigger(p["default"].FRAG_BUFFERED,{stats:k,frag:b,id:"audio"}),this.tick();else{this.state=z.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new n["default"](this.hls,"audio"));var l=this.initPTS[i],m=e.initSegment?e.initSegment.data:[];if(e.initSegment||void 0!==l){this.pendingBuffering=!0,x.logger.log("Demuxing "+h+" of ["+e.startSN+" ,"+e.endSN+"],track "+g);var o=!1;this.demuxer.push(a.payload,m,j,null,b,f,o,l)}else x.logger.log("unknown video PTS for continuity counter "+i+", waiting for video PTS before demuxing audio frag "+h+" of ["+e.startSN+" ,"+e.endSN+"],track "+g),this.waitingFragment=a,this.state=z.WAITING_INIT_PTS}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(a){var b=this.fragCurrent,c=a.frag;if(b&&"audio"===a.id&&c.sn===b.sn&&c.level===b.level&&this.state===z.PARSING){var d=a.tracks,e=void 0;if(d.video&&delete d.video,e=d.audio){e.levelCodec=e.codec,e.id=a.id,this.hls.trigger(p["default"].BUFFER_CODECS,d),x.logger.log("audio track:audio,container:"+e.container+",codecs[level/parsed]=["+e.levelCodec+"/"+e.codec+"]");var f=e.initSegment;if(f){var g={type:"audio",data:f,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[g]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(p["default"].BUFFER_APPENDING,g))}this.tick()}}}},{key:"onFragParsingData",value:function(a){var b=this,c=this.fragCurrent,d=a.frag;if(c&&"audio"===a.id&&"audio"===a.type&&d.sn===c.sn&&d.level===c.level&&this.state===z.PARSING){var e=this.trackId,f=this.tracks[e],g=this.hls;isNaN(a.endPTS)&&(a.endPTS=a.startPTS+c.duration,a.endDTS=a.startDTS+c.duration),x.logger.log("parsed "+a.type+",PTS:["+a.startPTS.toFixed(3)+","+a.endPTS.toFixed(3)+"],DTS:["+a.startDTS.toFixed(3)+"/"+a.endDTS.toFixed(3)+"],nb:"+a.nb),t["default"].updateFragPTSDTS(f.details,c,a.startPTS,a.endPTS);var h=this.audioSwitch,i=this.media,j=!1;if(h&&i)if(i.readyState){var k=i.currentTime;x.logger.log("switching audio track : currentTime:"+k),k>=a.startPTS&&(x.logger.log("switching audio track : flushing all audio"),this.state=z.BUFFER_FLUSHING,g.trigger(p["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),j=!0,this.audioSwitch=!1,g.trigger(p["default"].AUDIO_TRACK_SWITCHED,{id:e}))}else this.audioSwitch=!1,g.trigger(p["default"].AUDIO_TRACK_SWITCHED,{id:e});var l=this.pendingData;this.audioSwitch||([a.data1,a.data2].forEach(function(b){b&&b.length&&l.push({type:a.type,data:b,parent:"audio",content:"data"})}),!j&&l.length&&(l.forEach(function(a){b.state===z.PARSING&&(b.pendingBuffering=!0,b.hls.trigger(p["default"].BUFFER_APPENDING,a))}),this.pendingData=[],this.appended=!0)),this.tick()}}},{key:"onFragParsed",value:function(a){var b=this.fragCurrent,c=a.frag;b&&"audio"===a.id&&c.sn===b.sn&&c.level===b.level&&this.state===z.PARSING&&(this.stats.tparsed=performance.now(),this.state=z.PARSED,this._checkAppendedParsed())}},{key:"onBufferCreated",value:function(a){var b=a.tracks.audio;b&&(this.mediaBuffer=b.buffer,this.loadedmetadata=!0)}},{key:"onBufferAppended",value:function(a){if("audio"===a.parent){var b=this.state;b!==z.PARSING&&b!==z.PARSED||(this.pendingBuffering=a.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==z.PARSED||this.appended&&this.pendingBuffering)){var a=this.fragCurrent,b=this.stats,c=this.hls;if(a){this.fragPrevious=a,b.tbuffered=performance.now(),c.trigger(p["default"].FRAG_BUFFERED,{stats:b,frag:a,id:"audio"});var d=this.mediaBuffer?this.mediaBuffer:this.media;x.logger.log("audio buffered : "+v["default"].toString(d.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,c.trigger(p["default"].AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=z.IDLE}this.tick()}}},{key:"onError",value:function(a){var b=a.frag;if(!b||"audio"===b.type)switch(a.details){case w.ErrorDetails.FRAG_LOAD_ERROR:case w.ErrorDetails.FRAG_LOAD_TIMEOUT:if(!a.fatal){var c=this.fragLoadError;c?c++:c=1;var d=this.config;if(c<=d.fragLoadingMaxRetry){this.fragLoadError=c,b.loadCounter=0;var e=Math.min(Math.pow(2,c-1)*d.fragLoadingRetryDelay,d.fragLoadingMaxRetryTimeout);x.logger.warn("audioStreamController: frag loading failed, retry in "+e+" ms"),this.retryDate=performance.now()+e,this.state=z.FRAG_LOADING_WAITING_RETRY}else x.logger.error("audioStreamController: "+a.details+" reaches max retry, redispatch as fatal ..."),a.fatal=!0,this.state=z.ERROR}break;case w.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case w.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case w.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case w.ErrorDetails.KEY_LOAD_ERROR:case w.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==z.ERROR&&(this.state=a.fatal?z.ERROR:z.IDLE,x.logger.warn("audioStreamController: "+a.details+" while loading frag,switch to "+this.state+" state ..."));break;case w.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===a.parent&&(this.state===z.PARSING||this.state===z.PARSED)){var f=this.mediaBuffer,g=this.media.currentTime,h=f&&l["default"].isBuffered(f,g)&&l["default"].isBuffered(f,g+.5);if(h){var i=this.config;i.maxMaxBufferLength>=i.maxBufferLength&&(i.maxMaxBufferLength/=2,x.logger.warn("audio:reduce max buffer length to "+i.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*i.fragLoadingLoopThreshold),this.state=z.IDLE}else x.logger.warn("buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=z.BUFFER_FLUSHING,this.hls.trigger(p["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}}},{key:"onBufferFlushed",value:function(){var a=this,b=this.pendingData;b&&b.length?(x.logger.log("appending pending audio data on Buffer Flushed"),b.forEach(function(b){a.hls.trigger(p["default"].BUFFER_APPENDING,b)}),this.appended=!0,this.pendingData=[],this.state=z.PARSED):(this.state=z.IDLE,this.fragPrevious=null,this.tick())}},{key:"state",set:function(a){if(this.state!==a){var b=this.state;this._state=a,x.logger.log("audio stream:"+b+"->"+a)}},get:function(){return this._state}}]),b}(r["default"]);c["default"]=A},{25:25,33:33,34:34,35:35,37:37,38:38,48:48,51:51,54:54,55:55}],7:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(54),n=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].MANIFEST_LOADING,j["default"].MANIFEST_LOADED,j["default"].AUDIO_TRACK_LOADED));return c.ticks=0,c.ontick=c.tick.bind(c),c}return g(b,a),h(b,[{key:"destroy",value:function(){l["default"].prototype.destroy.call(this)}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){this.updateTrack(this.trackId)}},{key:"onManifestLoading",value:function(){this.tracks=[],this.trackId=-1}},{key:"onManifestLoaded",value:function(a){var b=this,c=a.audioTracks||[],d=!1;this.tracks=c,this.hls.trigger(j["default"].AUDIO_TRACKS_UPDATED,{audioTracks:c});var e=0;c.forEach(function(a){return a["default"]?(b.audioTrack=e,void(d=!0)):void e++}),d===!1&&c.length&&(m.logger.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)}},{key:"onAudioTrackLoaded",value:function(a){a.id<this.tracks.length&&(m.logger.log("audioTrack "+a.id+" loaded"),this.tracks[a.id].details=a.details,a.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*a.details.targetduration)),!a.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))}},{key:"setAudioTrackInternal",value:function(a){if(a>=0&&a<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=a,m.logger.log("switching to audioTrack "+a);var b=this.tracks[a],c=this.hls,d=b.type,e=b.url,f={id:a,type:d,url:e};c.trigger(j["default"].AUDIO_TRACK_SWITCH,f),c.trigger(j["default"].AUDIO_TRACK_SWITCHING,f);var g=b.details;!e||void 0!==g&&g.live!==!0||(m.logger.log("(re)loading playlist for audioTrack "+a),c.trigger(j["default"].AUDIO_TRACK_LOADING,{url:e,id:a}))}}},{key:"updateTrack",value:function(a){if(a>=0&&a<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=a,m.logger.log("updating audioTrack "+a);var b=this.tracks[a],c=b.url,d=b.details;!c||void 0!==d&&d.live!==!0||(m.logger.log("(re)loading playlist for audioTrack "+a),this.hls.trigger(j["default"].AUDIO_TRACK_LOADING,{url:c,id:a}))}}},{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(a){this.trackId===a&&void 0!==this.tracks[a].details||this.setAudioTrackInternal(a)}}]),b}(l["default"]);c["default"]=n},{34:34,35:35,54:54}],8:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(54),n=a(33),o=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].MEDIA_ATTACHING,j["default"].MEDIA_DETACHING,j["default"].MANIFEST_PARSED,j["default"].BUFFER_RESET,j["default"].BUFFER_APPENDING,j["default"].BUFFER_CODECS,j["default"].BUFFER_EOS,j["default"].BUFFER_FLUSHING,j["default"].LEVEL_PTS_UPDATED,j["default"].LEVEL_UPDATED));return c._msDuration=null,c._levelDuration=null,c.onsbue=c.onSBUpdateEnd.bind(c),c.onsbe=c.onSBUpdateError.bind(c),c.pendingTracks={},c.tracks={},c}return g(b,a),h(b,[{key:"destroy",value:function(){l["default"].prototype.destroy.call(this)}},{key:"onLevelPtsUpdated",value:function(a){var b=a.type,c=this.tracks.audio;if("audio"===b&&c&&"audio/mpeg"===c.container){var d=this.sourceBuffer.audio,e=Math.abs(d.timestampOffset-a.start);if(e>.1){var f=d.updating;try{d.abort()}catch(g){f=!0,m.logger.warn("can not abort audio buffer: "+g)}f?this.audioTimestampOffset=a.start:(m.logger.warn("change mpeg audio timestamp offset from "+d.timestampOffset+" to "+a.start),d.timestampOffset=a.start)}}}},{key:"onManifestParsed",value:function(a){var b=a.audio,c=a.video,d=0;a.altAudio&&(b||c)&&(d=(b?1:0)+(c?1:0),m.logger.log(d+" sourceBuffer(s) expected")),this.sourceBufferNb=d}},{key:"onMediaAttaching",value:function(a){var b=this.media=a.media;if(b){var c=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),c.addEventListener("sourceopen",this.onmso),c.addEventListener("sourceended",this.onmse),c.addEventListener("sourceclose",this.onmsc),b.src=URL.createObjectURL(c)}}},{key:"onMediaDetaching",value:function(){m.logger.log("media source detaching");var a=this.mediaSource;if(a){if("open"===a.readyState)try{a.endOfStream()}catch(b){m.logger.warn("onMediaDetaching:"+b.message+" while calling endOfStream")}a.removeEventListener("sourceopen",this.onmso),a.removeEventListener("sourceended",this.onmse),a.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this.media.src),this.media.removeAttribute("src"),this.media.load()),this.mediaSource=null,this.media=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(j["default"].MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){m.logger.log("media source opened"),this.hls.trigger(j["default"].MEDIA_ATTACHED,{media:this.media});var a=this.mediaSource;a&&a.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()}},{key:"checkPendingTracks",value:function(){var a=this.pendingTracks,b=Object.keys(a).length;b&&(this.sourceBufferNb<=b||0===this.sourceBufferNb)&&(this.createSourceBuffers(a),this.pendingTracks={},this.doAppending())}},{key:"onMediaSourceClose",value:function(){m.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){m.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){if(this.audioTimestampOffset){var a=this.sourceBuffer.audio;m.logger.warn("change mpeg audio timestamp offset from "+a.timestampOffset+" to "+this.audioTimestampOffset),a.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var b=this.parent,c=this.segments.reduce(function(a,c){return c.parent===b?a+1:a},0);this.hls.trigger(j["default"].BUFFER_APPENDED,{parent:b,pending:c}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()}},{key:"onSBUpdateError",value:function(a){m.logger.error("sourceBuffer error:",a),this.hls.trigger(j["default"].ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var a=this.sourceBuffer;for(var b in a){var c=a[b];try{this.mediaSource.removeSourceBuffer(c),c.removeEventListener("updateend",this.onsbue),c.removeEventListener("error",this.onsbe)}catch(d){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}},{key:"onBufferCodecs",value:function(a){if(0===Object.keys(this.sourceBuffer).length){for(var b in a)this.pendingTracks[b]=a[b];var c=this.mediaSource;c&&"open"===c.readyState&&this.checkPendingTracks()}}},{key:"createSourceBuffers",value:function(a){var b=this.sourceBuffer,c=this.mediaSource;for(var d in a)if(!b[d]){var e=a[d],f=e.levelCodec||e.codec,g=e.container+";codecs="+f;m.logger.log("creating sourceBuffer("+g+")");try{var h=b[d]=c.addSourceBuffer(g);h.addEventListener("updateend",this.onsbue),h.addEventListener("error",this.onsbe),this.tracks[d]={codec:f,container:e.container},e.buffer=h}catch(i){m.logger.error("error while trying to add sourceBuffer:"+i.message),this.hls.trigger(j["default"].ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:i,mimeType:g})}}this.hls.trigger(j["default"].BUFFER_CREATED,{tracks:a})}},{key:"onBufferAppending",value:function(a){this._needsFlush||(this.segments?this.segments.push(a):this.segments=[a],this.doAppending())}},{key:"onBufferAppendFail",value:function(a){m.logger.error("sourceBuffer error:",a.event),this.hls.trigger(j["default"].ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferEos",value:function(a){var b=this.sourceBuffer,c=a.type;for(var d in b)c&&d!==c||b[d].ended||(b[d].ended=!0,m.logger.log(d+" sourceBuffer now EOS"));this.checkEos()}},{key:"checkEos",value:function(){var a=this.sourceBuffer,b=this.mediaSource;if(!b||"open"!==b.readyState)return void(this._needsEos=!1);for(var c in a){var d=a[c];if(!d.ended)return;if(d.updating)return void(this._needsEos=!0)}m.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{b.endOfStream()}catch(e){m.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}},{key:"onBufferFlushing",value:function(a){this.flushRange.push({start:a.startOffset,end:a.endOffset,type:a.type}),this.flushBufferCounter=0,this.doFlush()}},{key:"onLevelUpdated",value:function(a){var b=a.details;0!==b.fragments.length&&(this._levelDuration=b.totalduration+b.fragments[0].start,this.updateMediaElementDuration())}},{key:"updateMediaElementDuration",value:function(){var a=this.media,b=this.mediaSource,c=this.sourceBuffer,d=this._levelDuration;if(null!==d&&a&&b&&c&&0!==a.readyState&&"open"===b.readyState){for(var e in c)if(c[e].updating)return;null===this._msDuration&&(this._msDuration=b.duration);var f=a.duration;(d>this._msDuration&&d>f||f===1/0||isNaN(f))&&(m.logger.log("Updating mediasource duration to "+d.toFixed(3)),this._msDuration=b.duration=d)}}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var a=this.flushRange[0];if(!this.flushBuffer(a.start,a.end,a.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var b=0,c=this.sourceBuffer;try{for(var d in c)b+=c[d].buffered.length}catch(e){m.logger.error("error while accessing sourceBuffer.buffered")}this.appended=b,this.hls.trigger(j["default"].BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var a=this.hls,b=this.sourceBuffer,c=this.segments;if(Object.keys(b).length){if(this.media.error)return this.segments=[],void m.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(c&&c.length){var d=c.shift();try{var e=d.type,f=b[e];f?f.updating?c.unshift(d):(f.ended=!1,this.parent=d.parent,f.appendBuffer(d.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(g){m.logger.error("error while trying to append buffer:"+g.message),c.unshift(d);var h={type:n.ErrorTypes.MEDIA_ERROR,parent:d.parent};if(22===g.code)return this.segments=[],h.details=n.ErrorDetails.BUFFER_FULL_ERROR,h.fatal=!1,void a.trigger(j["default"].ERROR,h);if(this.appendError?this.appendError++:this.appendError=1,h.details=n.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>a.config.appendErrorMaxRetry)return m.logger.log("fail "+a.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),c=[],h.fatal=!0,void a.trigger(j["default"].ERROR,h);h.fatal=!1,a.trigger(j["default"].ERROR,h)}}}}},{key:"flushBuffer",value:function(a,b,c){var d,e,f,g,h,i,j=this.sourceBuffer;if(Object.keys(j).length){if(m.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+a+"/"+b),this.flushBufferCounter<this.appended){for(var k in j)if(!c||k===c){if(d=j[k],d.ended=!1,d.updating)return m.logger.warn("cannot flush, sb updating in progress"),!1;try{for(e=0;e<d.buffered.length;e++)if(f=d.buffered.start(e),g=d.buffered.end(e),navigator.userAgent.toLowerCase().indexOf("firefox")!==-1&&b===Number.POSITIVE_INFINITY?(h=a,i=b):(h=Math.max(f,a),i=Math.min(g,b)),Math.min(i,g)-h>.5)return this.flushBufferCounter++,m.logger.log("flush "+k+" ["+h+","+i+"], of ["+f+","+g+"], pos:"+this.media.currentTime),d.remove(h,i),!1}catch(l){m.logger.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else m.logger.warn("abort flushing too many retries");m.logger.log("buffer flushed")}return!0}}]),b}(l["default"]);c["default"]=o},{33:33,34:34,35:35,54:54}],9:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=function(a){function b(a){return e(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].FPS_DROP_LEVEL_CAPPING,j["default"].MEDIA_ATTACHING,j["default"].MANIFEST_PARSED))}return g(b,a),h(b,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onFpsDropLevelCapping",value:function(a){b.isLevelAllowed(a.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(a.droppedLevel)}},{key:"onMediaAttaching",value:function(a){this.media=a.media instanceof HTMLVideoElement?a.media:null}},{key:"onManifestParsed",value:function(a){var b=this.hls;this.restrictedLevels=[],b.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=a.levels,b.firstLevel=this.getMaxLevel(a.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var a=this.levels?this.levels.length:0;if(a){var b=this.hls;b.autoLevelCapping=this.getMaxLevel(a-1),b.autoLevelCapping>this.autoLevelCapping&&b.streamController.nextLevelSwitch(),this.autoLevelCapping=b.autoLevelCapping}}}},{key:"getMaxLevel",value:function(a){var c=this;if(!this.levels)return-1;var d=this.levels.filter(function(d,e){return b.isLevelAllowed(e,c.restrictedLevels)&&e<=a});return b.getMaxLevelByMediaSize(d,this.mediaWidth,this.mediaHeight)}},{key:"mediaWidth",get:function(){var a=void 0,c=this.media;return c&&(a=c.width||c.clientWidth||c.offsetWidth,a*=b.contentScaleFactor),a}},{key:"mediaHeight",get:function(){var a=void 0,c=this.media;return c&&(a=c.height||c.clientHeight||c.offsetHeight,a*=b.contentScaleFactor),a}}],[{key:"isLevelAllowed",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return b.indexOf(a)===-1}},{key:"getMaxLevelByMediaSize",value:function(a,b,c){if(!a||a&&!a.length)return-1;for(var d=function(a,b){return!b||(a.width!==b.width||a.height!==b.height)},e=a.length-1,f=0;f<a.length;f+=1){var g=a[f];if((g.width>=b||g.height>=c)&&d(g,a[f+1])){e=f;break}}return e}},{key:"contentScaleFactor",get:function(){var a=1;try{a=window.devicePixelRatio}catch(b){}return a}}]),b}(l["default"]);c["default"]=m},{34:34,35:35}],10:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(54),n=function(a){function b(a){return e(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].MEDIA_ATTACHING))}return g(b,a),h(b,[{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1}},{key:"onMediaAttaching",value:function(a){var b=this.hls.config;if(b.capLevelOnFPSDrop){var c=this.video=a.media instanceof HTMLVideoElement?a.media:null;"function"==typeof c.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),b.fpsDroppedMonitoringPeriod)}}},{key:"checkFPS",value:function(a,b,c){var d=performance.now();if(b){if(this.lastTime){var e=d-this.lastTime,f=c-this.lastDroppedFrames,g=b-this.lastDecodedFrames,h=1e3*f/e,i=this.hls;if(i.trigger(j["default"].FPS_DROP,{currentDropped:f,currentDecoded:g,totalDroppedFrames:c}),h>0&&f>i.config.fpsDroppedMonitoringThreshold*g){var k=i.currentLevel;m.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+k),k>0&&(i.autoLevelCapping===-1||i.autoLevelCapping>=k)&&(k-=1,i.trigger(j["default"].FPS_DROP_LEVEL_CAPPING,{level:k,droppedLevel:i.currentLevel}),i.autoLevelCapping=k,i.streamController.nextLevelSwitch())}}this.lastTime=d,this.lastDroppedFrames=c,this.lastDecodedFrames=b}}},{key:"checkFPSInterval",value:function(){var a=this.video;if(a)if(this.isVideoPlaybackQualityAvailable){var b=a.getVideoPlaybackQuality();this.checkFPS(a,b.totalVideoFrames,b.droppedVideoFrames)}else this.checkFPS(a,a.webkitDecodedFrameCount,a.webkitDroppedFrameCount)}}]),b}(l["default"]);c["default"]=n},{34:34,35:35,54:54}],11:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(27),n=d(m),o=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].MEDIA_ATTACHED,j["default"].MEDIA_DETACHING,j["default"].FRAG_PARSING_METADATA));return c.id3Track=void 0,c.media=void 0,c}return g(b,a),h(b,[{key:"destroy",value:function(){l["default"].prototype.destroy.call(this)}},{key:"onMediaAttached",value:function(a){this.media=a.media,this.media&&(this.id3Track=this.media.addTextTrack("metadata","id3"),this.id3Track.mode="hidden")}},{key:"onMediaDetaching",value:function(){this.media=void 0}},{key:"onFragParsingMetadata",value:function(a){for(var b=a.frag,c=a.samples,d=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,e=0;e<c.length;e++){var f=n["default"].getID3Frames(c[e].data);if(f){var g=c[e].pts,h=e<c.length-1?c[e+1].pts:b.endPTS;g===h&&(h+=1e-4);for(var i=0;i<f.length;i++){var j=f[i];if(!n["default"].isTimeStampFrame(j)){var k=new d(g,h,"");k.value=j,this.id3Track.addCue(k)}}}}}}]),b}(l["default"]);c["default"]=o},{27:27,34:34,35:35}],12:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(54),n=a(33),o=a(37),p=d(o),q=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].MANIFEST_LOADED,j["default"].LEVEL_LOADED,j["default"].FRAG_LOADED,j["default"].ERROR));return c.ontick=c.tick.bind(c),c._manualLevel=-1,c}return g(b,a),h(b,[{key:"destroy",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this._manualLevel=-1}},{key:"startLoad",value:function(){this.canload=!0;var a=this._levels;a&&a.forEach(function(a){a.loadError=0;var b=a.details;b&&b.live&&(a.details=void 0)}),this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(a){var b,c=[],d=[],e={},f=!1,g=!1,h=this.hls,i=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),k=function(a,b){return MediaSource.isTypeSupported(a+"/mp4;codecs="+b)};if(a.levels.forEach(function(a){a.videoCodec&&(f=!0),i&&a.audioCodec&&a.audioCodec.indexOf("mp4a.40.34")!==-1&&(a.audioCodec=void 0),(a.audioCodec||a.attrs&&a.attrs.AUDIO)&&(g=!0);var b=e[a.bitrate];void 0===b?(e[a.bitrate]=c.length,a.url=[a.url],a.urlId=0,c.push(a)):c[b].url.push(a.url)}),f&&g?c.forEach(function(a){a.videoCodec&&d.push(a)}):d=c,d=d.filter(function(a){var b=a.audioCodec,c=a.videoCodec;return(!b||k("audio",b))&&(!c||k("video",c))}),d.length){b=d[0].bitrate,d.sort(function(a,b){return a.bitrate-b.bitrate}),this._levels=d;for(var l=0;l<d.length;l++)if(d[l].bitrate===b){this._firstLevel=l,m.logger.log("manifest loaded,"+d.length+" level(s) found, first bitrate:"+b);break}h.trigger(j["default"].MANIFEST_PARSED,{levels:d,firstLevel:this._firstLevel,stats:a.stats,audio:g,video:f,altAudio:a.audioTracks.length>0})}else h.trigger(j["default"].ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:h.url,reason:"no level with compatible codecs found in manifest"})}},{key:"setLevelInternal",value:function(a){var b=this._levels,c=this.hls;if(a>=0&&a<b.length){if(this.timer&&(clearTimeout(this.timer),this.timer=null),this._level!==a){m.logger.log("switching to level "+a),this._level=a;var d=b[a];d.level=a,c.trigger(j["default"].LEVEL_SWITCH,d),c.trigger(j["default"].LEVEL_SWITCHING,d);
}var e=b[a],f=e.details;if(!f||f.live===!0){var g=e.urlId;c.trigger(j["default"].LEVEL_LOADING,{url:e.url[g],level:a,id:g})}}else c.trigger(j["default"].ERROR,{type:n.ErrorTypes.OTHER_ERROR,details:n.ErrorDetails.LEVEL_SWITCH_ERROR,level:a,fatal:!1,reason:"invalid level idx"})}},{key:"onError",value:function(a){if(!a.fatal){var b=a.details,c=this.hls,d=void 0,e=void 0,f=!1;switch(b){case n.ErrorDetails.FRAG_LOAD_ERROR:case n.ErrorDetails.FRAG_LOAD_TIMEOUT:case n.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case n.ErrorDetails.KEY_LOAD_ERROR:case n.ErrorDetails.KEY_LOAD_TIMEOUT:d=a.frag.level;break;case n.ErrorDetails.LEVEL_LOAD_ERROR:case n.ErrorDetails.LEVEL_LOAD_TIMEOUT:d=a.context.level,f=!0;break;case n.ErrorDetails.REMUX_ALLOC_ERROR:d=a.level}if(void 0!==d){e=this._levels[d],e.loadError?e.loadError++:e.loadError=1;var g=e.url.length;if(g>1&&e.loadError<g)e.urlId=(e.urlId+1)%g,e.details=void 0,m.logger.warn("level controller,"+b+" for level "+d+": switching to redundant stream id "+e.urlId);else{var h=this._manualLevel===-1&&d;if(h)m.logger.warn("level controller,"+b+": switch-down for next fragment"),c.nextAutoLevel=Math.max(0,d-1);else if(e&&e.details&&e.details.live)m.logger.warn("level controller,"+b+" on live stream, discard"),f&&(this._level=void 0);else if(b===n.ErrorDetails.LEVEL_LOAD_ERROR||b===n.ErrorDetails.LEVEL_LOAD_TIMEOUT){var i=c.media,j=i&&p["default"].isBuffered(i,i.currentTime)&&p["default"].isBuffered(i,i.currentTime+.5);if(j){var k=c.config.levelLoadingRetryDelay;m.logger.warn("level controller,"+b+", but media buffered, retry in "+k+"ms"),this.timer=setTimeout(this.ontick,k),a.levelRetry=!0}else m.logger.error("cannot recover "+b+" error"),this._level=void 0,this.timer&&(clearTimeout(this.timer),this.timer=null),a.fatal=!0}}}}}},{key:"onFragLoaded",value:function(a){var b=a.frag;if(b&&"main"===b.type){var c=this._levels[b.level];c&&(c.loadError=0)}}},{key:"onLevelLoaded",value:function(a){var b=a.level;if(b===this._level){var c=this._levels[b];c.loadError=0;var d=a.details;if(d.live){var e=1e3*(d.averagetargetduration?d.averagetargetduration:d.targetduration),f=c.details;f&&d.endSN===f.endSN&&(e/=2,m.logger.log("same live playlist, reload twice faster")),e-=performance.now()-a.stats.trequest,e=Math.max(1e3,Math.round(e)),m.logger.log("live playlist, reload in "+e+" ms"),this.timer=setTimeout(this.ontick,e)}else this.timer=null}}},{key:"tick",value:function(){var a=this._level;if(void 0!==a&&this.canload){var b=this._levels[a];if(b&&b.url){var c=b.urlId;this.hls.trigger(j["default"].LEVEL_LOADING,{url:b.url[c],level:a,id:c})}}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(a){var b=this._levels;b&&b.length>a&&(this._level===a&&void 0!==b[a].details||this.setLevelInternal(a))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(a){this._manualLevel=a,void 0===this._startLevel&&(this._startLevel=a),a!==-1&&(this.level=a)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(a){this._firstLevel=a}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var a=this.hls.config.startLevel;return void 0!==a?a:this._firstLevel}return this._startLevel},set:function(a){this._startLevel=a}},{key:"nextLoadLevel",get:function(){return this._manualLevel!==-1?this._manualLevel:this.hls.nextAutoLevel},set:function(a){this.level=a,this._manualLevel===-1&&(this.hls.nextAutoLevel=a)}}]),b}(l["default"]);c["default"]=q},{33:33,34:34,35:35,37:37,54:54}],13:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(48),j=d(i),k=a(37),l=d(k),m=a(25),n=d(m),o=a(35),p=d(o),q=a(34),r=d(q),s=a(38),t=d(s),u=a(55),v=d(u),w=a(33),x=a(54),y={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},z=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,p["default"].MEDIA_ATTACHED,p["default"].MEDIA_DETACHING,p["default"].MANIFEST_LOADING,p["default"].MANIFEST_PARSED,p["default"].LEVEL_LOADED,p["default"].KEY_LOADED,p["default"].FRAG_LOADED,p["default"].FRAG_LOAD_EMERGENCY_ABORTED,p["default"].FRAG_PARSING_INIT_SEGMENT,p["default"].FRAG_PARSING_DATA,p["default"].FRAG_PARSED,p["default"].ERROR,p["default"].AUDIO_TRACK_SWITCHING,p["default"].AUDIO_TRACK_SWITCHED,p["default"].BUFFER_CREATED,p["default"].BUFFER_APPENDED,p["default"].BUFFER_FLUSHED));return c.config=a.config,c.audioCodecSwap=!1,c.ticks=0,c._state=y.STOPPED,c.ontick=c.tick.bind(c),c}return g(b,a),h(b,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),r["default"].prototype.destroy.call(this),this.state=y.STOPPED}},{key:"startLoad",value:function(a){if(this.levels){var b=this.lastCurrentTime,c=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var d=c.startLevel;d===-1&&(d=0,this.bitrateTest=!0),this.level=c.nextLoadLevel=d,this.loadedmetadata=!1}b>0&&a===-1&&(x.logger.log("override startPosition with lastCurrentTime @"+b.toFixed(3)),a=b),this.state=y.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=a,this.tick()}else this.forceStartLoad=!0,this.state=y.STOPPED}},{key:"stopLoad",value:function(){var a=this.fragCurrent;a&&(a.loader&&a.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=y.STOPPED,this.forceStartLoad=!1}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){switch(this.state){case y.ERROR:break;case y.BUFFER_FLUSHING:this.fragLoadError=0;break;case y.IDLE:this._doTickIdle();break;case y.WAITING_LEVEL:var a=this.levels[this.level];a&&a.details&&(this.state=y.IDLE);break;case y.FRAG_LOADING_WAITING_RETRY:var b=performance.now(),c=this.retryDate;(!c||b>=c||this.media&&this.media.seeking)&&(x.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=y.IDLE);break;case y.ERROR:case y.STOPPED:case y.FRAG_LOADING:case y.PARSING:case y.PARSED:case y.ENDED:}this._checkBuffer(),this._checkFragmentChanged()}},{key:"_doTickIdle",value:function(){var a=this.hls,b=a.config,c=this.media;if(void 0===this.levelLastLoaded||c||!this.startFragRequested&&b.startFragPrefetch){var d=void 0;d=this.loadedmetadata?c.currentTime:this.nextLoadPosition;var e=a.nextLoadLevel,f=this.levels[e];if(f){var g=f.bitrate,h=void 0;h=g?Math.max(8*b.maxBufferSize/g,b.maxBufferLength):b.maxBufferLength,h=Math.min(h,b.maxMaxBufferLength);var i=l["default"].bufferInfo(this.mediaBuffer?this.mediaBuffer:c,d,b.maxBufferHole),j=i.len;if(!(j>=h)){x.logger.trace("buffer length of "+j.toFixed(3)+" is below max of "+h.toFixed(3)+". checking for more payload ..."),this.level=a.nextLoadLevel=e;var k=f.details;if("undefined"==typeof k||k.live&&this.levelLastLoaded!==e)return void(this.state=y.WAITING_LEVEL);var m=this.fragPrevious;if(!k.live&&m&&m.sn===k.endSN&&j&&!i.nextStart){var n=Math.min(c.duration,m.start+m.duration);if(n-Math.max(i.end,m.start)<=Math.max(.2,m.duration)){var o={};return this.altAudio&&(o.type="video"),this.hls.trigger(p["default"].BUFFER_EOS,o),void(this.state=y.ENDED)}}this._fetchPayloadOrEos(d,i,k)}}}}},{key:"_fetchPayloadOrEos",value:function(a,b,c){var d=this.fragPrevious,e=this.level,f=c.fragments,g=f.length;if(0!==g){var h=f[0].start,i=f[g-1].start+f[g-1].duration,j=b.end,k=void 0;if(c.initSegment&&!c.initSegment.data)k=c.initSegment;else if(c.live){var l=this.config.initialLiveManifestSize;if(g<l)return void x.logger.warn("Can not start playback of a level, reason: not enough fragments "+g+" < "+l);if(k=this._ensureFragmentAtLivePoint(c,j,h,i,d,f,g),null===k)return}else j<h&&(k=f[0]);k||(k=this._findFragment(h,d,g,f,j,i,c)),k&&this._loadFragmentOrKey(k,e,c,a,j)}}},{key:"_ensureFragmentAtLivePoint",value:function(a,b,c,d,e,f,g){var h=this.hls.config,i=this.media,j=void 0,k=void 0!==h.liveMaxLatencyDuration?h.liveMaxLatencyDuration:h.liveMaxLatencyDurationCount*a.targetduration;if(b<Math.max(c-h.maxFragLookUpTolerance,d-k)){var l=this.liveSyncPosition=this.computeLivePosition(c,a);x.logger.log("buffer end: "+b.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+l.toFixed(3)),b=l,i&&i.readyState&&i.duration>l&&(i.currentTime=l),this.nextLoadPosition=l}if(a.PTSKnown&&b>d&&i&&i.readyState)return null;if(this.startFragRequested&&!a.PTSKnown){if(e){var m=e.sn+1;m>=a.startSN&&m<=a.endSN&&(j=f[m-a.startSN],x.logger.log("live playlist, switching playlist, load frag with next SN: "+j.sn))}j||(j=f[Math.min(g-1,Math.round(g/2))],x.logger.log("live playlist, switching playlist, unknown, load middle frag : "+j.sn))}return j}},{key:"_findFragment",value:function(a,b,c,d,e,f,g){var h=this.hls.config,i=void 0,k=void 0,l=h.maxFragLookUpTolerance,m=b?d[b.sn-d[0].sn+1]:void 0,n=function(a){var b=Math.min(l,a.duration);return a.start+a.duration-b<=e?1:a.start-b>e&&a.start?-1:0};if(e<f?(e>f-l&&(l=0),k=m&&!n(m)?m:j["default"].search(d,n)):k=d[c-1],k){i=k;var o=i.sn-g.startSN,p=b&&i.level===b.level,q=d[o-1],r=d[o+1];if(b&&i.sn===b.sn)if(p&&!i.backtracked)if(i.sn<g.endSN){var s=b.deltaPTS;s&&s>h.maxBufferHole&&b.dropped&&o?(i=q,x.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),b.loadCounter--):(i=r,x.logger.log("SN just loaded, load next one: "+i.sn))}else i=null;else i.backtracked&&(r&&r.backtracked?(x.logger.warn("Already backtracked from fragment "+r.sn+", will not backtrack to fragment "+i.sn+". Loading fragment "+r.sn),i=r):(x.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),i.dropped=0,q?(q.loadCounter&&q.loadCounter--,i=q,i.backtracked=!0):o&&(i=null)))}return i}},{key:"_loadFragmentOrKey",value:function(a,b,c,d,e){var f=this.hls,g=f.config;if(!a.decryptdata||null==a.decryptdata.uri||null!=a.decryptdata.key){if(x.logger.log("Loading "+a.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+b+", currentTime:"+d.toFixed(3)+",bufferEnd:"+e.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,a.loadCounter){a.loadCounter++;var h=g.fragLoadingLoopThreshold;if(a.loadCounter>h&&Math.abs(this.fragLoadIdx-a.loadIdx)<h)return void f.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:a})}else a.loadCounter=1;return a.loadIdx=this.fragLoadIdx,this.fragCurrent=a,this.startFragRequested=!0,isNaN(a.sn)||(this.nextLoadPosition=a.start+a.duration),a.autoLevel=f.autoLevelEnabled,a.bitrateTest=this.bitrateTest,f.trigger(p["default"].FRAG_LOADING,{frag:a}),this.demuxer||(this.demuxer=new n["default"](f,"main")),void(this.state=y.FRAG_LOADING)}x.logger.log("Loading key for "+a.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+b),this.state=y.KEY_LOADING,f.trigger(p["default"].KEY_LOADING,{frag:a})}},{key:"getBufferedFrag",value:function(a){return j["default"].search(this._bufferedFrags,function(b){return a<b.startPTS?-1:a>b.endPTS?1:0})}},{key:"followingBufferedFrag",value:function(a){return a?this.getBufferedFrag(a.endPTS+.5):null}},{key:"_checkFragmentChanged",value:function(){var a,b,c=this.media;if(c&&c.readyState&&c.seeking===!1&&(b=c.currentTime,b>1*this.lastCurrentTime&&(this.lastCurrentTime=b),l["default"].isBuffered(c,b)?a=this.getBufferedFrag(b):l["default"].isBuffered(c,b+.1)&&(a=this.getBufferedFrag(b+.1)),a)){var d=a;if(d!==this.fragPlaying){this.hls.trigger(p["default"].FRAG_CHANGED,{frag:d});var e=d.level;this.fragPlaying&&this.fragPlaying.level===e||this.hls.trigger(p["default"].LEVEL_SWITCHED,{level:e}),this.fragPlaying=d}}}},{key:"immediateLevelSwitch",value:function(){if(x.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var a=this.media,b=void 0;a?(b=a.paused,a.pause()):b=!0,this.previouslyPaused=b}var c=this.fragCurrent;c&&c.loader&&c.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}},{key:"immediateLevelSwitchEnd",value:function(){var a=this.media;a&&a.buffered.length&&(this.immediateSwitch=!1,l["default"].isBuffered(a,a.currentTime)&&(a.currentTime-=1e-4),this.previouslyPaused||a.play())}},{key:"nextLevelSwitch",value:function(){var a=this.media;if(a&&a.readyState){var b=void 0,c=void 0,d=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,c=this.getBufferedFrag(a.currentTime),c&&c.startPTS>1&&this.flushMainBuffer(0,c.startPTS-1),a.paused)b=0;else{var e=this.hls.nextLoadLevel,f=this.levels[e],g=this.fragLastKbps;b=g&&this.fragCurrent?this.fragCurrent.duration*f.bitrate/(1e3*g)+1:0}if(d=this.getBufferedFrag(a.currentTime+b),d&&(d=this.followingBufferedFrag(d))){var h=this.fragCurrent;h&&h.loader&&h.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(d.maxStartPTS,Number.POSITIVE_INFINITY)}}}},{key:"flushMainBuffer",value:function(a,b){this.state=y.BUFFER_FLUSHING;var c={startOffset:a,endOffset:b};this.altAudio&&(c.type="video"),this.hls.trigger(p["default"].BUFFER_FLUSHING,c)}},{key:"onMediaAttached",value:function(a){var b=this.media=this.mediaBuffer=a.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),b.addEventListener("seeking",this.onvseeking),b.addEventListener("seeked",this.onvseeked),b.addEventListener("ended",this.onvended);var c=this.config;this.levels&&c.autoStartLoad&&this.hls.startLoad(c.startPosition)}},{key:"onMediaDetaching",value:function(){var a=this.media;a&&a.ended&&(x.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var b=this.levels;b&&b.forEach(function(a){a.details&&a.details.fragments.forEach(function(a){a.loadCounter=void 0,a.backtracked=void 0})}),a&&(a.removeEventListener("seeking",this.onvseeking),a.removeEventListener("seeked",this.onvseeked),a.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){var a=this.media,b=a?a.currentTime:void 0,c=this.config;isNaN(b)||x.logger.log("media seeking to "+b.toFixed(3));var d=this.mediaBuffer?this.mediaBuffer:a,e=l["default"].bufferInfo(d,b,this.config.maxBufferHole);if(this.state===y.FRAG_LOADING){var f=this.fragCurrent;if(0===e.len&&f){var g=c.maxFragLookUpTolerance,h=f.start-g,i=f.start+f.duration+g;b<h||b>i?(f.loader&&(x.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),f.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=y.IDLE):x.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===y.ENDED&&(0===e.len&&(this.fragPrevious=0),this.state=y.IDLE);a&&(this.lastCurrentTime=b),this.state!==y.FRAG_LOADING&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*c.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=b),this.tick()}},{key:"onMediaSeeked",value:function(){var a=this.media,b=a?a.currentTime:void 0;isNaN(b)||x.logger.log("media seeked to "+b.toFixed(3)),this.tick()}},{key:"onMediaEnded",value:function(){x.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){x.logger.log("trigger BUFFER_RESET"),this.hls.trigger(p["default"].BUFFER_RESET),this._bufferedFrags=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0}},{key:"onManifestParsed",value:function(a){var b,c=!1,d=!1;a.levels.forEach(function(a){b=a.audioCodec,b&&(b.indexOf("mp4a.40.2")!==-1&&(c=!0),b.indexOf("mp4a.40.5")!==-1&&(d=!0))}),this.audioCodecSwitch=c&&d,this.audioCodecSwitch&&x.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=a.levels,this.startLevelLoaded=!1,this.startFragRequested=!1;var e=this.config;(e.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(e.startPosition)}},{key:"onLevelLoaded",value:function(a){var b=a.details,c=a.level,d=this.levels[c],e=b.totalduration,f=0;if(x.logger.log("level "+c+" loaded ["+b.startSN+","+b.endSN+"],duration:"+e),this.levelLastLoaded=c,b.live){var g=d.details;g&&b.fragments.length>0?(t["default"].mergeDetails(g,b),f=b.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(f,g),b.PTSKnown?x.logger.log("live playlist sliding:"+f.toFixed(3)):x.logger.log("live playlist - outdated PTS, unknown sliding")):(b.PTSKnown=!1,x.logger.log("live playlist - first load, unknown sliding"))}else b.PTSKnown=!1;if(d.details=b,this.hls.trigger(p["default"].LEVEL_UPDATED,{details:b,level:c}),this.startFragRequested===!1){if(this.startPosition===-1||this.lastCurrentTime===-1){var h=b.startTimeOffset;isNaN(h)?b.live?(this.startPosition=this.computeLivePosition(f,b),x.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(h<0&&(x.logger.log("negative start time offset "+h+", count from end of last fragment"),h=f+e+h),x.logger.log("start time offset found in playlist, adjust startPosition to "+h),this.startPosition=h),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===y.WAITING_LEVEL&&(this.state=y.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===y.KEY_LOADING&&(this.state=y.IDLE,this.tick())}},{key:"onFragLoaded",value:function(a){var b=this.fragCurrent,c=a.frag;if(this.state===y.FRAG_LOADING&&b&&"main"===c.type&&c.level===b.level&&c.sn===b.sn){var d=a.stats,e=this.levels[b.level],f=e.details;if(x.logger.log("Loaded  "+b.sn+" of ["+f.startSN+" ,"+f.endSN+"],level "+b.level),this.bitrateTest=!1,this.stats=d,c.bitrateTest===!0&&this.hls.nextLoadLevel)this.state=y.IDLE,this.startFragRequested=!1,d.tparsed=d.tbuffered=performance.now(),this.hls.trigger(p["default"].FRAG_BUFFERED,{stats:d,frag:b,id:"main"}),this.tick();else if("initSegment"===c.sn)this.state=y.IDLE,d.tparsed=d.tbuffered=performance.now(),f.initSegment.data=a.payload,this.hls.trigger(p["default"].FRAG_BUFFERED,{stats:d,frag:b,id:"main"}),this.tick();else{this.state=y.PARSING;var g=f.totalduration,h=b.level,i=b.sn,j=this.config.defaultAudioCodec||e.audioCodec;this.audioCodecSwap&&(x.logger.log("swapping playlist audio codec"),void 0===j&&(j=this.lastAudioCodec),j&&(j=j.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,x.logger.log("Parsing "+i+" of ["+f.startSN+" ,"+f.endSN+"],level "+h+", cc "+b.cc);var k=this.demuxer;k||(k=this.demuxer=new n["default"](this.hls,"main"));var l=this.media,m=l&&l.seeking,o=!m&&(f.PTSKnown||!f.live),q=f.initSegment?f.initSegment.data:[];k.push(a.payload,q,j,e.videoCodec,b,g,o,void 0)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(a){var b=this.fragCurrent,c=a.frag;if(b&&"main"===a.id&&c.sn===b.sn&&c.level===b.level&&this.state===y.PARSING){var d,e,f=a.tracks;if(f.audio&&this.altAudio&&delete f.audio,e=f.audio){var g=this.levels[this.level].audioCodec,h=navigator.userAgent.toLowerCase();g&&this.audioCodecSwap&&(x.logger.log("swapping playlist audio codec"),g=g.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==e.metadata.channelCount&&h.indexOf("firefox")===-1&&(g="mp4a.40.5"),h.indexOf("android")!==-1&&"audio/mpeg"!==e.container&&(g="mp4a.40.2",x.logger.log("Android: force audio codec to "+g)),e.levelCodec=g,e.id=a.id}e=f.video,e&&(e.levelCodec=this.levels[this.level].videoCodec,e.id=a.id),this.hls.trigger(p["default"].BUFFER_CODECS,f);for(d in f){e=f[d],x.logger.log("main track:"+d+",container:"+e.container+",codecs[level/parsed]=["+e.levelCodec+"/"+e.codec+"]");var i=e.initSegment;i&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(p["default"].BUFFER_APPENDING,{type:d,data:i,parent:"main",content:"initSegment"}))}this.tick()}}},{key:"onFragParsingData",value:function(a){var b=this,c=this.fragCurrent,d=a.frag;if(c&&"main"===a.id&&d.sn===c.sn&&d.level===c.level&&("audio"!==a.type||!this.altAudio)&&this.state===y.PARSING){var e=this.levels[this.level],f=c;if(isNaN(a.endPTS)&&(a.endPTS=a.startPTS+c.duration,a.endDTS=a.startDTS+c.duration),x.logger.log("Parsed "+a.type+",PTS:["+a.startPTS.toFixed(3)+","+a.endPTS.toFixed(3)+"],DTS:["+a.startDTS.toFixed(3)+"/"+a.endDTS.toFixed(3)+"],nb:"+a.nb+",dropped:"+(a.dropped||0)),"video"===a.type)if(f.dropped=a.dropped,f.dropped){if(!f.backtracked)return x.logger.warn("missing video frame(s), backtracking fragment"),f.backtracked=!0,this.nextLoadPosition=a.startPTS,this.state=y.IDLE,this.fragPrevious=f,void this.tick();x.logger.warn("Already backtracked on this fragment, appending with the gap")}else f.backtracked=!1;var g=t["default"].updateFragPTSDTS(e.details,f,a.startPTS,a.endPTS,a.startDTS,a.endDTS),h=this.hls;h.trigger(p["default"].LEVEL_PTS_UPDATED,{details:e.details,level:this.level,drift:g,type:a.type,start:a.startPTS,end:a.endPTS}),[a.data1,a.data2].forEach(function(c){c&&c.length&&b.state===y.PARSING&&(b.appended=!0,b.pendingBuffering=!0,h.trigger(p["default"].BUFFER_APPENDING,{type:a.type,data:c,parent:"main",content:"data"}))}),this.tick()}}},{key:"onFragParsed",value:function(a){var b=this.fragCurrent,c=a.frag;b&&"main"===a.id&&c.sn===b.sn&&c.level===b.level&&this.state===y.PARSING&&(this.stats.tparsed=performance.now(),this.state=y.PARSED,this._checkAppendedParsed())}},{key:"onAudioTrackSwitching",value:function(a){var b=!!a.url,c=a.id;if(!b){if(this.mediaBuffer!==this.media){x.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var d=this.fragCurrent;d.loader&&(x.logger.log("switching to main audio track, cancel main fragment load"),d.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=y.IDLE}var e=this.hls;e.trigger(p["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),e.trigger(p["default"].AUDIO_TRACK_SWITCHED,{id:c}),this.altAudio=!1}}},{key:"onAudioTrackSwitched",value:function(a){var b=a.id,c=!!this.hls.audioTracks[b].url;if(c){var d=this.videoBuffer;d&&this.mediaBuffer!==d&&(x.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=d)}this.altAudio=c,this.tick()}},{key:"onBufferCreated",value:function(a){var b=a.tracks,c=void 0,d=void 0,e=!1;for(var f in b){var g=b[f];"main"===g.id?(d=f,c=g,"video"===f&&(this.videoBuffer=b[f].buffer)):e=!0}e&&c?(x.logger.log("alternate track found, use "+d+".buffered to schedule main fragment loading"),this.mediaBuffer=c.buffer):this.mediaBuffer=this.media}},{key:"onBufferAppended",value:function(a){if("main"===a.parent){var b=this.state;b!==y.PARSING&&b!==y.PARSED||(this.pendingBuffering=a.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==y.PARSED||this.appended&&this.pendingBuffering)){var a=this.fragCurrent;if(a){var b=this.mediaBuffer?this.mediaBuffer:this.media;x.logger.log("main buffered : "+v["default"].toString(b.buffered));var c=this._bufferedFrags.filter(function(a){return l["default"].isBuffered(b,(a.startPTS+a.endPTS)/2)});c.push(a),this._bufferedFrags=c.sort(function(a,b){return a.startPTS-b.startPTS}),this.fragPrevious=a;var d=this.stats;d.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*d.total/(d.tbuffered-d.tfirst)),this.hls.trigger(p["default"].FRAG_BUFFERED,{stats:d,frag:a,id:"main"}),this.state=y.IDLE}this.tick()}}},{key:"onError",value:function(a){var b=a.frag||this.fragCurrent;if(!b||"main"===b.type){var c=this.media,d=c&&l["default"].isBuffered(c,c.currentTime)&&l["default"].isBuffered(c,c.currentTime+.5);switch(a.details){case w.ErrorDetails.FRAG_LOAD_ERROR:case w.ErrorDetails.FRAG_LOAD_TIMEOUT:case w.ErrorDetails.KEY_LOAD_ERROR:case w.ErrorDetails.KEY_LOAD_TIMEOUT:if(!a.fatal){var e=this.fragLoadError;e?e++:e=1;var f=this.config;if(e<=f.fragLoadingMaxRetry||d||b.autoLevel&&b.level){this.fragLoadError=e,b.loadCounter=0;var g=Math.min(Math.pow(2,e-1)*f.fragLoadingRetryDelay,f.fragLoadingMaxRetryTimeout);x.logger.warn("mediaController: frag loading failed, retry in "+g+" ms"),this.retryDate=performance.now()+g,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.state=y.FRAG_LOADING_WAITING_RETRY}else x.logger.error("mediaController: "+a.details+" reaches max retry, redispatch as fatal ..."),a.fatal=!0,this.state=y.ERROR}break;case w.ErrorDetails.FRAG_LOOP_LOADING_ERROR:a.fatal||(d?(this._reduceMaxBufferLength(b.duration),this.state=y.IDLE):b.autoLevel&&0!==b.level||(a.fatal=!0,this.state=y.ERROR));break;case w.ErrorDetails.LEVEL_LOAD_ERROR:case w.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==y.ERROR&&(a.fatal?(this.state=y.ERROR,x.logger.warn("streamController: "+a.details+",switch to "+this.state+" state ...")):a.levelRetry||this.state!==y.WAITING_LEVEL||(this.state=y.IDLE));break;case w.ErrorDetails.BUFFER_FULL_ERROR:"main"!==a.parent||this.state!==y.PARSING&&this.state!==y.PARSED||(d?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=y.IDLE):(x.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}}},{key:"_reduceMaxBufferLength",value:function(a){var b=this.config;b.maxMaxBufferLength>=a&&(b.maxMaxBufferLength/=2,x.logger.warn("main:reduce max buffer length to "+b.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*b.fragLoadingLoopThreshold)}},{key:"_checkBuffer",value:function(){var a=this.media,b=this.config;if(a&&a.readyState){var c=a.currentTime,d=this.mediaBuffer?this.mediaBuffer:a,e=d.buffered;if(!this.loadedmetadata&&e.length){this.loadedmetadata=!0;var f=a.seeking?c:this.startPosition,g=l["default"].isBuffered(d,f),h=e.start(0);(c!==f||!g&&Math.abs(f-h)<b.maxSeekHole)&&(x.logger.log("target start position:"+f),g||x.logger.log("target start position not buffered, seek to buffered.start(0) "+f),x.logger.log("adjust currentTime from "+c+" to "+f),a.currentTime=f)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var i=l["default"].bufferInfo(a,c,0),j=!(a.paused||a.ended||0===a.buffered.length),k=.5,m=c!==this.lastCurrentTime;if(m)this.stallReported&&(x.logger.warn("playback not stuck anymore @"+c+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(j){var n=performance.now(),o=this.hls;if(this.stalled){var q=n-this.stalled,r=i.len,s=this.nudgeRetry||0;if(r<=k&&q>1e3*b.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,x.logger.warn("playback stalling in low buffer @"+c),o.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:r}));var t=i.nextStart,u=t-c;if(t&&u<b.maxSeekHole&&u>0){this.nudgeRetry=++s;var v=s*b.nudgeOffset;x.logger.log("adjust currentTime from "+a.currentTime+" to next buffered @ "+t+" + nudge "+v),a.currentTime=t+v,this.stalled=void 0,o.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:t+v-c})}}else if(r>k&&q>1e3*b.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,x.logger.warn("playback stalling in high buffer @"+c),o.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:r})),this.stalled=void 0,this.nudgeRetry=++s,s<b.nudgeMaxRetry){var y=a.currentTime,z=y+s*b.nudgeOffset;x.logger.log("adjust currentTime from "+y+" to "+z),a.currentTime=z,o.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else x.logger.error("still stuck in high buffer @"+c+" after "+b.nudgeMaxRetry+", raise fatal error"),o.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=n,this.stallReported=!1}}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=y.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()}},{key:"onBufferFlushed",value:function(){var a=this.mediaBuffer?this.mediaBuffer:this.media;this._bufferedFrags=this._bufferedFrags.filter(function(b){return l["default"].isBuffered(a,(b.startPTS+b.endPTS)/2)}),this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=y.IDLE,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"computeLivePosition",value:function(a,b){var c=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*b.targetduration;return a+Math.max(0,b.totalduration-c)}},{key:"state",set:function(a){if(this.state!==a){var b=this.state;this._state=a,x.logger.log("main stream:"+b+"->"+a),this.hls.trigger(p["default"].STREAM_STATE_TRANSITION,{previousState:b,nextState:a})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var a=this.media;if(a){var b=this.getBufferedFrag(a.currentTime);if(b)return b.level}return-1}},{key:"nextBufferedFrag",get:function(){var a=this.media;return a?this.followingBufferedFrag(this.getBufferedFrag(a.currentTime)):null}},{key:"nextLevel",get:function(){var a=this.nextBufferedFrag;return a?a.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(a){this._liveSyncPosition=a}}]),b}(r["default"]);c["default"]=z},{25:25,33:33,34:34,35:35,37:37,38:38,48:48,54:54,55:55}],14:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(54),n=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].ERROR,j["default"].SUBTITLE_TRACKS_UPDATED,j["default"].SUBTITLE_TRACK_SWITCH,j["default"].SUBTITLE_TRACK_LOADED,j["default"].SUBTITLE_FRAG_PROCESSED));
return c.config=a.config,c.vttFragSNsProcessed={},c.vttFragQueues=void 0,c.currentlyProcessing=null,c.currentTrackId=-1,c}return g(b,a),h(b,[{key:"destroy",value:function(){l["default"].prototype.destroy.call(this)}},{key:"clearVttFragQueues",value:function(){var a=this;this.vttFragQueues={},this.tracks.forEach(function(b){a.vttFragQueues[b.id]=[]})}},{key:"nextFrag",value:function(){if(null===this.currentlyProcessing&&this.currentTrackId>-1&&this.vttFragQueues[this.currentTrackId].length){var a=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.hls.trigger(j["default"].FRAG_LOADING,{frag:a})}}},{key:"onSubtitleFragProcessed",value:function(a){a.success&&this.vttFragSNsProcessed[a.frag.trackId].push(a.frag.sn),this.currentlyProcessing=null,this.nextFrag()}},{key:"onError",value:function(a){var b=a.frag;b&&"subtitle"!==b.type||this.currentlyProcessing&&(this.currentlyProcessing=null,this.nextFrag())}},{key:"onSubtitleTracksUpdated",value:function(a){var b=this;m.logger.log("subtitle tracks updated"),this.tracks=a.subtitleTracks,this.clearVttFragQueues(),this.vttFragSNsProcessed={},this.tracks.forEach(function(a){b.vttFragSNsProcessed[a.id]=[]})}},{key:"onSubtitleTrackSwitch",value:function(a){this.currentTrackId=a.id,this.clearVttFragQueues()}},{key:"onSubtitleTrackLoaded",value:function(a){var b=this.vttFragSNsProcessed[a.id],c=this.vttFragQueues[a.id],d=this.currentlyProcessing?this.currentlyProcessing.sn:-1,e=function(a){return b.indexOf(a.sn)>-1},f=function(a){return c.some(function(b){return b.sn===a.sn})};a.details.fragments.forEach(function(b){e(b)||b.sn===d||f(b)||(b.trackId=a.id,c.push(b))}),this.nextFrag()}}]),b}(l["default"]);c["default"]=n},{34:34,35:35,54:54}],15:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function h(a){for(var b=[],c=0;c<a.length;c++)"subtitles"===a[c].kind&&b.push(a[c]);return b}Object.defineProperty(c,"__esModule",{value:!0});var i=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=a(35),k=d(j),l=a(34),m=d(l),n=a(54),o=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,k["default"].MEDIA_ATTACHED,k["default"].MEDIA_DETACHING,k["default"].MANIFEST_LOADING,k["default"].MANIFEST_LOADED,k["default"].SUBTITLE_TRACK_LOADED));return c.tracks=[],c.trackId=-1,c.media=void 0,c}return g(b,a),i(b,[{key:"_onTextTracksChanged",value:function(){if(this.media){for(var a=-1,b=h(this.media.textTracks),c=0;c<b.length;c++)"showing"===b[c].mode&&(a=c);this.subtitleTrack=a}}},{key:"destroy",value:function(){m["default"].prototype.destroy.call(this)}},{key:"onMediaAttached",value:function(a){this.media=a.media,this.media&&(this.trackChangeListener=this._onTextTracksChanged.bind(this),this.media.textTracks.addEventListener("change",this.trackChangeListener))}},{key:"onMediaDetaching",value:function(){this.media&&(this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=void 0)}},{key:"onManifestLoading",value:function(){this.tracks=[],this.trackId=-1}},{key:"onManifestLoaded",value:function(a){var b=this,c=a.subtitles||[],d=!1;this.tracks=c,this.trackId=-1,this.hls.trigger(k["default"].SUBTITLE_TRACKS_UPDATED,{subtitleTracks:c}),c.forEach(function(a){a["default"]&&(b.subtitleTrack=a.id,d=!0)})}},{key:"onTick",value:function(){var a=this.trackId,b=this.tracks[a];if(b){var c=b.details;void 0!==c&&c.live!==!0||(n.logger.log("(re)loading playlist for subtitle track "+a),this.hls.trigger(k["default"].SUBTITLE_TRACK_LOADING,{url:b.url,id:a}))}}},{key:"onSubtitleTrackLoaded",value:function(a){var b=this;a.id<this.tracks.length&&(n.logger.log("subtitle track "+a.id+" loaded"),this.tracks[a.id].details=a.details,a.details.live&&!this.timer&&(this.timer=setInterval(function(){b.onTick()},1e3*a.details.targetduration,this)),!a.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))}},{key:"setSubtitleTrackInternal",value:function(a){if(a>=0&&a<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=a,n.logger.log("switching to subtitle track "+a);var b=this.tracks[a];this.hls.trigger(k["default"].SUBTITLE_TRACK_SWITCH,{id:a});var c=b.details;void 0!==c&&c.live!==!0||(n.logger.log("(re)loading playlist for subtitle track "+a),this.hls.trigger(k["default"].SUBTITLE_TRACK_LOADING,{url:b.url,id:a}))}}},{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(a){this.trackId!==a&&this.setSubtitleTrackInternal(a)}}]),b}(m["default"]);c["default"]=o},{34:34,35:35,54:54}],16:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function h(a){if(a&&a.cues)for(;a.cues.length>0;)a.removeCue(a.cues[0])}function i(a,b){return a&&a.label===b.name&&!(a.textTrack1||a.textTrack2)}function j(a,b,c,d){return Math.min(b,d)-Math.max(a,c)}Object.defineProperty(c,"__esModule",{value:!0});var k=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),l=a(35),m=d(l),n=a(34),o=d(n),p=a(49),q=d(p),r=a(58),s=d(r),t=a(54),u=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,m["default"].MEDIA_ATTACHING,m["default"].MEDIA_DETACHING,m["default"].FRAG_PARSING_USERDATA,m["default"].MANIFEST_LOADING,m["default"].MANIFEST_LOADED,m["default"].FRAG_LOADED,m["default"].LEVEL_SWITCHING,m["default"].INIT_PTS_FOUND));if(c.hls=a,c.config=a.config,c.enabled=!0,c.Cues=a.config.cueHandler,c.textTracks=[],c.tracks=[],c.unparsedVttFrags=[],c.initPTS=void 0,c.cueRanges=[],c.config.enableCEA708Captions){var d=c,g=function(a,b){var c=null;try{c=new window.Event("addtrack")}catch(d){c=document.createEvent("Event"),c.initEvent("addtrack",!1,!1)}c.track=a,b.dispatchEvent(c)},i={newCue:function(a,b,c){if(!d.textTrack1){var e=d.getExistingTrack("1");if(e)d.textTrack1=e,h(d.textTrack1),g(d.textTrack1,d.media);else{var f=d.createTextTrack("captions",d.config.captionsTextTrack1Label,d.config.captionsTextTrack1LanguageCode);f&&(f.textTrack1=!0,d.textTrack1=f)}}d.addCues("textTrack1",a,b,c)}},j={newCue:function(a,b,c){if(!d.textTrack2){var e=d.getExistingTrack("2");if(e)d.textTrack2=e,h(d.textTrack2),g(d.textTrack2,d.media);else{var f=d.createTextTrack("captions",d.config.captionsTextTrack2Label,d.config.captionsTextTrack1LanguageCode);f&&(f.textTrack2=!0,d.textTrack2=f)}}d.addCues("textTrack2",a,b,c)}};c.cea608Parser=new q["default"](0,i,j)}return c}return g(b,a),k(b,[{key:"addCues",value:function(a,b,c,d){for(var e=this.cueRanges,f=!1,g=e.length;g--;){var h=e[g],i=j(h[0],h[1],b,c);if(i>=0&&(h[0]=Math.min(h[0],b),h[1]=Math.max(h[1],c),f=!0,i/(c-b)>.5))return}f||e.push([b,c]),this.Cues.newCue(this[a],b,c,d)}},{key:"onInitPtsFound",value:function(a){var b=this;"undefined"==typeof this.initPTS&&(this.initPTS=a.initPTS),this.unparsedVttFrags.length&&(this.unparsedVttFrags.forEach(function(a){b.onFragLoaded(a)}),this.unparsedVttFrags=[])}},{key:"getExistingTrack",value:function(a){var b=this.media;if(b)for(var c=0;c<b.textTracks.length;c++){var d=b.textTracks[c],e="textTrack"+a;if(d[e]===!0)return d}return null}},{key:"createTextTrack",value:function(a,b,c){var d=this.media;if(d)return d.addTextTrack(a,b,c)}},{key:"destroy",value:function(){o["default"].prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(a){this.media=a.media}},{key:"onMediaDetaching",value:function(){h(this.textTrack1),h(this.textTrack2)}},{key:"onManifestLoading",value:function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0};var a=this.media;if(a){var b=a.textTracks;if(b)for(var c=0;c<b.length;c++)h(b[c])}}},{key:"onManifestLoaded",value:function(a){var b=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=void 0,this.cueRanges=[],this.config.enableWebVTT){this.tracks=a.subtitles||[];var c=this.media?this.media.textTracks:[];this.tracks.forEach(function(a,d){var e=void 0;if(d<c.length){var f=c[d];i(f,a)&&(e=f)}e||(e=b.createTextTrack("subtitles",a.name,a.lang)),e.mode=a["default"]?"showing":"hidden",b.textTracks.push(e)})}}},{key:"onLevelSwitching",value:function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions}},{key:"onFragLoaded",value:function(a){var b=a.frag,c=a.payload;if("main"===b.type){var d=b.sn;if(d!==this.lastSn+1){var e=this.cea608Parser;e&&e.reset()}this.lastSn=d}else if("subtitle"===b.type)if(c.byteLength){if("undefined"==typeof this.initPTS)return void this.unparsedVttFrags.push(a);var f=this.vttCCs;f[b.cc]||(f[b.cc]={start:b.start,prevCC:this.prevCC,"new":!0},this.prevCC=b.cc);var g=this.textTracks,h=this.hls;s["default"].parse(c,this.initPTS,f,b.cc,function(a){var c=g[b.trackId];a.forEach(function(a){c.cues.getCueById(a.id)||c.addCue(a)}),h.trigger(m["default"].SUBTITLE_FRAG_PROCESSED,{success:!0,frag:b})},function(a){t.logger.log("Failed to parse VTT cue: "+a),h.trigger(m["default"].SUBTITLE_FRAG_PROCESSED,{success:!1,frag:b})})}else this.hls.trigger(m["default"].SUBTITLE_FRAG_PROCESSED,{success:!1,frag:b})}},{key:"onFragParsingUserdata",value:function(a){if(this.enabled&&this.config.enableCEA708Captions)for(var b=0;b<a.samples.length;b++){var c=this.extractCea608Data(a.samples[b].bytes);this.cea608Parser.addData(a.samples[b].pts,c)}}},{key:"extractCea608Data",value:function(a){for(var b,c,d,e,f,g=31&a[0],h=2,i=[],j=0;j<g;j++)b=a[h++],c=127&a[h++],d=127&a[h++],e=0!==(4&b),f=3&b,0===c&&0===d||e&&0===f&&(i.push(c),i.push(d));return i}}]),b}(o["default"]);c["default"]=u},{34:34,35:35,49:49,54:54,58:58}],17:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b,c){d(this,a),this.subtle=b,this.aesIV=c}return e(a,[{key:"decrypt",value:function(a,b){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},b,a)}}]),a}();c["default"]=f},{}],18:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return e(a,[{key:"uint8ArrayToUint32Array_",value:function(a){for(var b=new DataView(a),c=new Uint32Array(4),d=0;d<4;d++)c[d]=b.getUint32(4*d);return c}},{key:"initTable",value:function(){var a=this.sBox,b=this.invSBox,c=this.subMix,d=c[0],e=c[1],f=c[2],g=c[3],h=this.invSubMix,i=h[0],j=h[1],k=h[2],l=h[3],m=new Uint32Array(256),n=0,o=0,p=0;for(p=0;p<256;p++)p<128?m[p]=p<<1:m[p]=p<<1^283;for(p=0;p<256;p++){var q=o^o<<1^o<<2^o<<3^o<<4;q=q>>>8^255&q^99,a[n]=q,b[q]=n;var r=m[n],s=m[r],t=m[s],u=257*m[q]^16843008*q;d[n]=u<<24|u>>>8,e[n]=u<<16|u>>>16,f[n]=u<<8|u>>>24,g[n]=u,u=16843009*t^65537*s^257*r^16843008*n,i[q]=u<<24|u>>>8,j[q]=u<<16|u>>>16,k[q]=u<<8|u>>>24,l[q]=u,n?(n=r^m[m[m[t^r]]],o^=m[m[o]]):n=o=1}}},{key:"expandKey",value:function(a){for(var b=this.uint8ArrayToUint32Array_(a),c=!0,d=0;d<b.length&&c;)c=b[d]===this.key[d],d++;if(!c){this.key=b;var e=this.keySize=b.length;if(4!==e&&6!==e&&8!==e)throw new Error("Invalid aes key size="+e);var f=this.ksRows=4*(e+6+1),g=void 0,h=void 0,i=this.keySchedule=new Uint32Array(f),j=this.invKeySchedule=new Uint32Array(f),k=this.sBox,l=this.rcon,m=this.invSubMix,n=m[0],o=m[1],p=m[2],q=m[3],r=void 0,s=void 0;for(g=0;g<f;g++)g<e?r=i[g]=b[g]:(s=r,g%e===0?(s=s<<8|s>>>24,s=k[s>>>24]<<24|k[s>>>16&255]<<16|k[s>>>8&255]<<8|k[255&s],s^=l[g/e|0]<<24):e>6&&g%e===4&&(s=k[s>>>24]<<24|k[s>>>16&255]<<16|k[s>>>8&255]<<8|k[255&s]),i[g]=r=(i[g-e]^s)>>>0);for(h=0;h<f;h++)g=f-h,s=3&h?i[g]:i[g-4],h<4||g<=4?j[h]=s:j[h]=n[k[s>>>24]]^o[k[s>>>16&255]]^p[k[s>>>8&255]]^q[k[255&s]],j[h]=j[h]>>>0}}},{key:"networkToHostOrderSwap",value:function(a){return a<<24|(65280&a)<<8|(16711680&a)>>8|a>>>24}},{key:"decrypt",value:function(a,b,c){for(var d,e,f=this.keySize+6,g=this.invKeySchedule,h=this.invSBox,i=this.invSubMix,j=i[0],k=i[1],l=i[2],m=i[3],n=this.uint8ArrayToUint32Array_(c),o=n[0],p=n[1],q=n[2],r=n[3],s=new Int32Array(a),t=new Int32Array(s.length),u=void 0,v=void 0,w=void 0,x=void 0,y=void 0,z=void 0,A=void 0,B=void 0,C=void 0,D=void 0,E=void 0,F=void 0,G=this.networkToHostOrderSwap;b<s.length;){for(C=G(s[b]),D=G(s[b+1]),E=G(s[b+2]),F=G(s[b+3]),y=C^g[0],z=F^g[1],A=E^g[2],B=D^g[3],d=4,e=1;e<f;e++)u=j[y>>>24]^k[z>>16&255]^l[A>>8&255]^m[255&B]^g[d],v=j[z>>>24]^k[A>>16&255]^l[B>>8&255]^m[255&y]^g[d+1],w=j[A>>>24]^k[B>>16&255]^l[y>>8&255]^m[255&z]^g[d+2],x=j[B>>>24]^k[y>>16&255]^l[z>>8&255]^m[255&A]^g[d+3],y=u,z=v,A=w,B=x,d+=4;u=h[y>>>24]<<24^h[z>>16&255]<<16^h[A>>8&255]<<8^h[255&B]^g[d],v=h[z>>>24]<<24^h[A>>16&255]<<16^h[B>>8&255]<<8^h[255&y]^g[d+1],w=h[A>>>24]<<24^h[B>>16&255]<<16^h[y>>8&255]<<8^h[255&z]^g[d+2],x=h[B>>>24]<<24^h[y>>16&255]<<16^h[z>>8&255]<<8^h[255&A]^g[d+3],d+=3,t[b]=G(u^o),t[b+1]=G(x^p),t[b+2]=G(w^q),t[b+3]=G(v^r),o=C,p=D,q=E,r=F,b+=4}return t.buffer}},{key:"destroy",value:function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0}}]),a}();c["default"]=f},{}],19:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(17),h=d(g),i=a(20),j=d(i),k=a(18),l=d(k),m=a(33),n=a(54),o=function(){function a(b,c){e(this,a),this.observer=b,this.config=c,this.logEnabled=!0;try{var d=crypto?crypto:self.crypto;this.subtle=d.subtle||d.webkitSubtle}catch(f){}this.disableWebCrypto=!this.subtle}return f(a,[{key:"isSync",value:function(){return this.disableWebCrypto&&this.config.enableSoftwareAES}},{key:"decrypt",value:function(a,b,c,d){var e=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(n.logger.log("JS AES decrypt"),this.logEnabled=!1);var f=this.decryptor;f||(this.decryptor=f=new l["default"]),f.expandKey(b),d(f.decrypt(a,0,c))}else{this.logEnabled&&(n.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var g=this.subtle;this.key!==b&&(this.key=b,this.fastAesKey=new j["default"](g,b)),this.fastAesKey.expandKey().then(function(f){var i=new h["default"](g,c);i.decrypt(a,f)["catch"](function(f){e.onWebCryptoError(f,a,b,c,d)}).then(function(a){d(a)})})["catch"](function(f){e.onWebCryptoError(f,a,b,c,d)})}}},{key:"onWebCryptoError",value:function(a,b,c,d,e){this.config.enableSoftwareAES?(n.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(b,c,d,e)):(n.logger.error("decrypting error : "+a.message),this.observer.trigger(Event.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:a.message}))}},{key:"destroy",value:function(){var a=this.decryptor;a&&(a.destroy(),this.decryptor=void 0)}}]),a}();c["default"]=o},{17:17,18:18,20:20,33:33,54:54}],20:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b,c){d(this,a),this.subtle=b,this.key=c}return e(a,[{key:"expandKey",value:function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}]),a}();c["default"]=f},{}],21:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(22),h=d(g),i=a(54),j=a(27),k=d(j),l=function(){function a(b,c,d){e(this,a),this.observer=b,this.config=d,this.remuxer=c}return f(a,[{key:"resetInitSegment",value:function(a,b,c,d){this._audioTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:b,duration:d,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(a,b,c,d){for(var e=this._audioTrack,f=k["default"].getID3Data(a,0),g=90*k["default"].getTimeStamp(f),j=0,l=g,m=a.length,n=f.length,o=[{pts:l,dts:l,data:f}];n<m-1;)if(h["default"].isHeader(a,n)&&n+5<m){h["default"].initTrackConfig(e,this.observer,a,n,e.manifestCodec);var p=h["default"].appendFrame(e,a,n,g,j);if(!p){i.logger.log("Unable to parse AAC frame");break}n+=p.length,l=p.sample.pts,j++}else k["default"].isHeader(a,n)?(f=k["default"].getID3Data(a,n),o.push({pts:l,dts:l,data:f}),n+=f.length):n++;this.remuxer.remux(e,{samples:[]},{samples:o,inputTimeScale:9e4},{samples:[]},b,c,d)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(a){var b,c,d=k["default"].getID3Data(a,0);if(d&&void 0!==k["default"].getTimeStamp(d))for(b=d.length,c=Math.min(a.length-1,b+100);b<c;b++)if(h["default"].probe(a,b))return i.logger.log("ADTS sync word found !"),!0;return!1}}]),a}();c["default"]=l},{22:22,27:27,54:54}],22:[function(a,b,c){"use strict";var d=a(54),e=a(33),f={getAudioConfig:function(a,b,c,f){var g,h,i,j,k,l=navigator.userAgent.toLowerCase(),m=f,n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return g=((192&b[c+2])>>>6)+1,h=(60&b[c+2])>>>2,h>n.length-1?void a.trigger(Event.ERROR,{type:e.ErrorTypes.MEDIA_ERROR,details:e.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+h}):(j=(1&b[c+2])<<2,j|=(192&b[c+3])>>>6,d.logger.log("manifest codec:"+f+",ADTS data:type:"+g+",sampleingIndex:"+h+"["+n[h]+"Hz],channelConfig:"+j),/firefox/i.test(l)?h>=6?(g=5,k=new Array(4),i=h-3):(g=2,k=new Array(2),i=h):l.indexOf("android")!==-1?(g=2,k=new Array(2),i=h):(g=5,k=new Array(4),f&&(f.indexOf("mp4a.40.29")!==-1||f.indexOf("mp4a.40.5")!==-1)||!f&&h>=6?i=h-3:((f&&f.indexOf("mp4a.40.2")!==-1&&h>=6&&1===j||!f&&1===j)&&(g=2,k=new Array(2)),i=h)),k[0]=g<<3,k[0]|=(14&h)>>1,k[1]|=(1&h)<<7,k[1]|=j<<3,5===g&&(k[1]|=(14&i)>>1,k[2]=(1&i)<<7,k[2]|=8,k[3]=0),{config:k,samplerate:n[h],channelCount:j,codec:"mp4a.40."+g,manifestCodec:m})},isHeaderPattern:function(a,b){return 255===a[b]&&240===(246&a[b+1])},getHeaderLength:function(a,b){return 1&a[b+1]?7:9},getFullFrameLength:function(a,b){return(3&a[b+3])<<11|a[b+4]<<3|(224&a[b+5])>>>5},isHeader:function(a,b){return!!(b+1<a.length&&this.isHeaderPattern(a,b))},probe:function(a,b){if(b+1<a.length&&this.isHeaderPattern(a,b)){var c=this.getHeaderLength(a,b),d=c;b+5<a.length&&(d=this.getFullFrameLength(a,b));var e=b+d;if(e===a.length||e+1<a.length&&this.isHeaderPattern(a,e))return!0}return!1},initTrackConfig:function(a,b,c,e,f){if(!a.samplerate){var g=this.getAudioConfig(b,c,e,f);a.config=g.config,a.samplerate=g.samplerate,a.channelCount=g.channelCount,a.codec=g.codec,a.manifestCodec=g.manifestCodec,d.logger.log("parsed codec:"+a.codec+",rate:"+g.samplerate+",nb channel:"+g.channelCount)}},getFrameDuration:function(a){return 9216e4/a},appendFrame:function(a,b,c,d,e){var f=this.getFrameDuration(a.samplerate),g=this.parseFrameHeader(b,c,d,e,f);if(g){var h=g.stamp,i=g.headerLength,j=g.frameLength,k={unit:b.subarray(c+i,c+i+j),pts:h,dts:h};return a.samples.push(k),a.len+=j,{sample:k,length:j+i}}},parseFrameHeader:function(a,b,c,d,e){var f,g,h,i=a.length;if(f=this.getHeaderLength(a,b),g=this.getFullFrameLength(a,b),g-=f,g>0&&b+f+g<=i)return h=c+d*e,{headerLength:f,frameLength:g,stamp:h}}};b.exports=f},{33:33,54:54}],23:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(35),h=d(g),i=a(33),j=a(19),k=d(j),l=a(21),m=d(l),n=a(29),o=d(n),p=a(32),q=d(p),r=a(28),s=d(r),t=a(45),u=d(t),v=a(46),w=d(v),x=function(){function a(b,c,d,f){e(this,a),this.observer=b,this.typeSupported=c,this.config=d,this.vendor=f}return f(a,[{key:"destroy",value:function(){var a=this.demuxer;a&&a.destroy()}},{key:"push",value:function(a,b,c,d,e,f,g,i,j,l,m,n){if(a.byteLength>0&&null!=b&&null!=b.key&&"AES-128"===b.method){var o=this.decrypter;null==o&&(o=this.decrypter=new k["default"](this.observer,this.config));var p,q=this;try{p=performance.now()}catch(r){p=Date.now()}o.decrypt(a,b.key.buffer,b.iv.buffer,function(a){var k;try{k=performance.now()}catch(o){k=Date.now()}q.observer.trigger(h["default"].FRAG_DECRYPTED,{stats:{tstart:p,tdecrypt:k}}),q.pushDecrypted(new Uint8Array(a),b,new Uint8Array(c),d,e,f,g,i,j,l,m,n)})}else this.pushDecrypted(new Uint8Array(a),b,new Uint8Array(c),d,e,f,g,i,j,l,m,n)}},{key:"pushDecrypted",value:function(a,b,c,d,e,f,g,j,k,l,n,p){var r=this.demuxer;if(!r||g&&!this.probe(a)){for(var t=this.observer,v=this.typeSupported,x=this.config,y=[{demux:m["default"],remux:u["default"]},{demux:s["default"],remux:u["default"]},{demux:q["default"],remux:u["default"]},{demux:o["default"],remux:w["default"]}],z=0,A=y.length;z<A;z++){var B=y[z],C=B.demux.probe;if(C(a)){var D=this.remuxer=new B.remux(t,x,v,this.vendor);r=new B.demux(t,D,x,v),this.probe=C;break}}if(!r)return void t.trigger(h["default"].ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=r}var E=this.remuxer;(g||j)&&(r.resetInitSegment(c,d,e,l),E.resetInitSegment()),g&&(r.resetTimeStamp(p),E.resetTimeStamp(p)),"function"==typeof r.setDecryptData&&r.setDecryptData(b),r.append(a,f,k,n)}}]),a}();c["default"]=x},{19:19,21:21,28:28,29:29,32:32,33:33,35:35,45:45,46:46}],24:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a(23),f=d(e),g=a(35),h=d(g),i=a(54),j=a(1),k=d(j),l=function(a){var b=new k["default"];b.trigger=function(a){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];b.emit.apply(b,[a,a].concat(d))},b.off=function(a){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];b.removeListener.apply(b,[a].concat(d))};var c=function(b,c){a.postMessage({event:b,data:c})};a.addEventListener("message",function(d){var e=d.data;switch(e.cmd){case"init":var g=JSON.parse(e.config);a.demuxer=new f["default"](b,e.typeSupported,g,e.vendor);try{(0,i.enableLogs)(g.debug===!0)}catch(h){}c("init",null);break;case"demux":a.demuxer.push(e.data,e.decryptdata,e.initSegment,e.audioCodec,e.videoCodec,e.timeOffset,e.discontinuity,e.trackSwitch,e.contiguous,e.duration,e.accurateTimeOffset,e.defaultInitPTS)}}),b.on(h["default"].FRAG_DECRYPTED,c),b.on(h["default"].FRAG_PARSING_INIT_SEGMENT,c),b.on(h["default"].FRAG_PARSED,c),b.on(h["default"].ERROR,c),b.on(h["default"].FRAG_PARSING_METADATA,c),b.on(h["default"].FRAG_PARSING_USERDATA,c),b.on(h["default"].INIT_PTS_FOUND,c),b.on(h["default"].FRAG_PARSING_DATA,function(b,c){var d=[],e={event:b,data:c};c.data1&&(e.data1=c.data1.buffer,d.push(c.data1.buffer),delete c.data1),c.data2&&(e.data2=c.data2.buffer,d.push(c.data2.buffer),delete c.data2),a.postMessage(e,d)})};c["default"]=l},{1:1,23:23,35:35,54:54}],25:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(35),h=d(g),i=a(23),j=d(i),k=a(24),l=d(k),m=a(54),n=a(33),o=a(1),p=d(o),q=function(){function b(c,d){e(this,b),this.hls=c,this.id=d;var f=this.observer=new p["default"],g=c.config;f.trigger=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];f.emit.apply(f,[a,a].concat(c))},f.off=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];f.removeListener.apply(f,[a].concat(c))};var i=function(a,b){b=b||{},b.frag=this.frag,b.id=this.id,c.trigger(a,b)}.bind(this);f.on(h["default"].FRAG_DECRYPTED,i),f.on(h["default"].FRAG_PARSING_INIT_SEGMENT,i),f.on(h["default"].FRAG_PARSING_DATA,i),f.on(h["default"].FRAG_PARSED,i),f.on(h["default"].ERROR,i),f.on(h["default"].FRAG_PARSING_METADATA,i),f.on(h["default"].FRAG_PARSING_USERDATA,i),f.on(h["default"].INIT_PTS_FOUND,i);var k={mp4:MediaSource.isTypeSupported("video/mp4"),mpeg:MediaSource.isTypeSupported("audio/mpeg"),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"')},o=navigator.vendor;if(g.enableWorker&&"undefined"!=typeof Worker){m.logger.log("demuxing in webworker");var q=void 0;try{var r=a(3);q=this.w=r(l["default"]),this.onwmsg=this.onWorkerMessage.bind(this),q.addEventListener("message",this.onwmsg),q.onerror=function(a){c.trigger(h["default"].ERROR,{type:n.ErrorTypes.OTHER_ERROR,details:n.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:a.message+" ("+a.filename+":"+a.lineno+")"}})},q.postMessage({cmd:"init",typeSupported:k,vendor:o,id:d,config:JSON.stringify(g)})}catch(s){m.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),q&&URL.revokeObjectURL(q.objectURL),this.demuxer=new j["default"](f,k,g,o),this.w=void 0}}else this.demuxer=new j["default"](f,k,g,o)}return f(b,[{key:"destroy",value:function(){var a=this.w;if(a)a.removeEventListener("message",this.onwmsg),a.terminate(),this.w=null;else{var b=this.demuxer;b&&(b.destroy(),this.demuxer=null)}var c=this.observer;c&&(c.removeAllListeners(),this.observer=null)}},{key:"push",value:function(a,b,c,d,e,f,g,h){var i=this.w,j=isNaN(e.startDTS)?e.start:e.startDTS,k=e.decryptdata,l=this.frag,n=!(l&&e.cc===l.cc),o=!(l&&e.level===l.level),p=l&&e.sn===l.sn+1,q=!o&&p;if(n&&m.logger.log(this.id+":discontinuity detected"),o&&m.logger.log(this.id+":switch detected"),this.frag=e,i)i.postMessage({cmd:"demux",data:a,decryptdata:k,initSegment:b,audioCodec:c,videoCodec:d,timeOffset:j,discontinuity:n,trackSwitch:o,contiguous:q,duration:f,accurateTimeOffset:g,defaultInitPTS:h},[a]);else{var r=this.demuxer;r&&r.push(a,k,b,c,d,j,n,o,q,f,g,h)}}},{key:"onWorkerMessage",value:function(a){var b=a.data,c=this.hls;switch(b.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case h["default"].FRAG_PARSING_DATA:b.data.data1=new Uint8Array(b.data1),b.data2&&(b.data.data2=new Uint8Array(b.data2));default:b.data=b.data||{},b.data.frag=this.frag,b.data.id=this.id,c.trigger(b.event,b.data)}}}]),b}();c["default"]=q},{1:1,23:23,24:24,3:3,33:33,35:35,54:54}],26:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a(54),g=function(){function a(b){d(this,a),this.data=b,this.bytesAvailable=b.byteLength,this.word=0,this.bitsAvailable=0}return e(a,[{key:"loadWord",value:function(){var a=this.data,b=this.bytesAvailable,c=a.byteLength-b,d=new Uint8Array(4),e=Math.min(4,b);if(0===e)throw new Error("no bytes available");d.set(a.subarray(c,c+e)),this.word=new DataView(d.buffer).getUint32(0),this.bitsAvailable=8*e,this.bytesAvailable-=e}},{key:"skipBits",value:function(a){var b;this.bitsAvailable>a?(this.word<<=a,this.bitsAvailable-=a):(a-=this.bitsAvailable,b=a>>3,a-=b>>3,this.bytesAvailable-=b,this.loadWord(),this.word<<=a,this.bitsAvailable-=a)}},{key:"readBits",value:function(a){var b=Math.min(this.bitsAvailable,a),c=this.word>>>32-b;return a>32&&f.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=b,this.bitsAvailable>0?this.word<<=b:this.bytesAvailable>0&&this.loadWord(),b=a-b,b>0&&this.bitsAvailable?c<<b|this.readBits(b):c}},{key:"skipLZ",value:function(){var a;for(a=0;a<this.bitsAvailable;++a)if(0!==(this.word&2147483648>>>a))return this.word<<=a,this.bitsAvailable-=a,a;return this.loadWord(),a+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var a=this.skipLZ();return this.readBits(a+1)-1}},{key:"readEG",value:function(){var a=this.readUEG();return 1&a?1+a>>>1:-1*(a>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(a){var b,c,d=8,e=8;for(b=0;b<a;b++)0!==e&&(c=this.readEG(),e=(d+c+256)%256),
d=0===e?d:e}},{key:"readSPS",value:function(){var a,b,c,d,e,f,g,h,i,j=0,k=0,l=0,m=0,n=this.readUByte.bind(this),o=this.readBits.bind(this),p=this.readUEG.bind(this),q=this.readBoolean.bind(this),r=this.skipBits.bind(this),s=this.skipEG.bind(this),t=this.skipUEG.bind(this),u=this.skipScalingList.bind(this);if(n(),a=n(),b=o(5),r(3),c=n(),t(),100===a||110===a||122===a||244===a||44===a||83===a||86===a||118===a||128===a){var v=p();if(3===v&&r(1),t(),t(),r(1),q())for(h=3!==v?8:12,i=0;i<h;i++)q()&&u(i<6?16:64)}t();var w=p();if(0===w)p();else if(1===w)for(r(1),s(),s(),d=p(),i=0;i<d;i++)s();t(),r(1),e=p(),f=p(),g=o(1),0===g&&r(1),r(1),q()&&(j=p(),k=p(),l=p(),m=p());var x=[1,1];if(q()&&q()){var y=n();switch(y){case 1:x=[1,1];break;case 2:x=[12,11];break;case 3:x=[10,11];break;case 4:x=[16,11];break;case 5:x=[40,33];break;case 6:x=[24,11];break;case 7:x=[20,11];break;case 8:x=[32,11];break;case 9:x=[80,33];break;case 10:x=[18,11];break;case 11:x=[15,11];break;case 12:x=[64,33];break;case 13:x=[160,99];break;case 14:x=[4,3];break;case 15:x=[3,2];break;case 16:x=[2,1];break;case 255:x=[n()<<8|n(),n()<<8|n()]}}return{width:Math.ceil(16*(e+1)-2*j-2*k),height:(2-g)*(f+1)*16-(g?2:4)*(l+m),pixelRatio:x}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),a}();c["default"]=g},{54:54}],27:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a)}return e(a,null,[{key:"isHeader",value:function(a,b){return b+10<=a.length&&73===a[b]&&68===a[b+1]&&51===a[b+2]&&a[b+3]<255&&a[b+4]<255&&a[b+6]<128&&a[b+7]<128&&a[b+8]<128&&a[b+9]<128}},{key:"isFooter",value:function(a,b){return b+10<=a.length&&51===a[b]&&68===a[b+1]&&73===a[b+2]&&a[b+3]<255&&a[b+4]<255&&a[b+6]<128&&a[b+7]<128&&a[b+8]<128&&a[b+9]<128}},{key:"getID3Data",value:function(b,c){for(var d=c,e=0;a.isHeader(b,c);){e+=10;var f=a._readSize(b,c+6);e+=f,a.isFooter(b,c+10)&&(e+=10),c+=e}if(e>0)return b.subarray(d,d+e)}},{key:"_readSize",value:function(a,b){var c=0;return c=(127&a[b])<<21,c|=(127&a[b+1])<<14,c|=(127&a[b+2])<<7,c|=127&a[b+3]}},{key:"getTimeStamp",value:function(b){for(var c=a.getID3Frames(b),d=0;d<c.length;d++){var e=c[d];if(a.isTimeStampFrame(e))return a._readTimeStamp(e)}}},{key:"isTimeStampFrame",value:function(a){return a&&"PRIV"===a.key&&"com.apple.streaming.transportStreamTimestamp"===a.info}},{key:"_getFrameData",value:function(b){var c=String.fromCharCode(b[0],b[1],b[2],b[3]),d=a._readSize(b,4),e=10;return{type:c,size:d,data:b.subarray(e,e+d)}}},{key:"getID3Frames",value:function(b){for(var c=0,d=[];a.isHeader(b,c);){var e=a._readSize(b,c+6);c+=10;for(var f=c+e;c+8<f;){var g=a._getFrameData(b.subarray(c)),h=a._decodeFrame(g);h&&d.push(h),c+=g.size+10}a.isFooter(b,c)&&(c+=10)}return d}},{key:"_decodeFrame",value:function(b){return"PRIV"===b.type?a._decodePrivFrame(b):"T"===b.type[0]?a._decodeTextFrame(b):"W"===b.type[0]?a._decodeURLFrame(b):void 0}},{key:"_readTimeStamp",value:function(a){if(8===a.data.byteLength){var b=new Uint8Array(a.data),c=1&b[3],d=(b[4]<<23)+(b[5]<<15)+(b[6]<<7)+b[7];return d/=45,c&&(d+=47721858.84),Math.round(d)}}},{key:"_decodePrivFrame",value:function(b){if(!(b.size<2)){var c=a._utf8ArrayToStr(b.data),d=new Uint8Array(b.data.subarray(c.length+1));return{key:b.type,info:c,data:d.buffer}}}},{key:"_decodeTextFrame",value:function(b){if(!(b.size<2)){if("TXXX"===b.type){var c=1,d=a._utf8ArrayToStr(b.data.subarray(c));c+=d.length+1;var e=a._utf8ArrayToStr(b.data.subarray(c));return{key:b.type,info:d,data:e}}var f=a._utf8ArrayToStr(b.data.subarray(1));return{key:b.type,data:f}}}},{key:"_decodeURLFrame",value:function(b){if("WXXX"===b.type){if(b.size<2)return;var c=1,d=a._utf8ArrayToStr(b.data.subarray(c));c+=d.length+1;var e=a._utf8ArrayToStr(b.data.subarray(c));return{key:b.type,info:d,data:e}}var f=a._utf8ArrayToStr(b.data);return{key:b.type,data:f}}},{key:"_utf8ArrayToStr",value:function(a){for(var b=void 0,c=void 0,d="",e=0,f=a.length;e<f;){var g=a[e++];switch(g>>4){case 0:return d;case 1:case 2:case 3:case 4:case 5:case 6:case 7:d+=String.fromCharCode(g);break;case 12:case 13:b=a[e++],d+=String.fromCharCode((31&g)<<6|63&b);break;case 14:b=a[e++],c=a[e++],d+=String.fromCharCode((15&g)<<12|(63&b)<<6|(63&c)<<0)}}return d}}]),a}();c["default"]=f},{}],28:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(27),h=d(g),i=a(54),j=a(30),k=d(j),l=function(){function a(b,c,d){e(this,a),this.observer=b,this.config=d,this.remuxer=c}return f(a,[{key:"resetInitSegment",value:function(a,b,c,d){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:b,duration:d,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(a,b,c,d){for(var e=h["default"].getID3Data(a,0),f=90*h["default"].getTimeStamp(e),g=e.length,i=a.length,j=0,l=0,m=this._audioTrack,n=[{pts:f,dts:f,data:e}];g<i;)if(k["default"].isHeader(a,g)){var o=k["default"].appendFrame(m,a,g,f,j);if(!o)break;g+=o.length,l=o.sample.pts,j++}else h["default"].isHeader(a,g)?(e=h["default"].getID3Data(a,g),n.push({pts:l,dts:l,data:e}),g+=e.length):g++;this.remuxer.remux(m,{samples:[]},{samples:n,inputTimeScale:9e4},{samples:[]},b,c,d)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(a){var b,c,d=h["default"].getID3Data(a,0);if(d&&void 0!==h["default"].getTimeStamp(d))for(b=d.length,c=Math.min(a.length-1,b+100);b<c;b++)if(k["default"].probe(a,b))return i.logger.log("MPEG Audio sync word found !"),!0;return!1}}]),a}();c["default"]=l},{27:27,30:30,54:54}],29:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(35),h=d(g),i=Math.pow(2,32)-1,j=function(){function a(b,c){e(this,a),this.observer=b,this.remuxer=c}return f(a,[{key:"resetTimeStamp",value:function(a){this.initPTS=a}},{key:"resetInitSegment",value:function(b,c,d,e){if(b&&b.byteLength){var f=this.initData=a.parseInitSegment(b),g={};f.audio&&(g.audio={container:"audio/mp4",codec:c,initSegment:e?b:null}),f.video&&(g.video={container:"video/mp4",codec:d,initSegment:e?b:null}),this.observer.trigger(h["default"].FRAG_PARSING_INIT_SEGMENT,{tracks:g})}else c&&(this.audioCodec=c),d&&(this.videoCodec=d)}},{key:"append",value:function(b,c,d,e){var f=this.initData;f||(this.resetInitSegment(b,this.audioCodec,this.videoCodec),f=this.initData);var g=void 0,i=this.initPTS;if(void 0===i){var j=a.getStartDTS(f,b);this.initPTS=i=j-c,this.observer.trigger(h["default"].INIT_PTS_FOUND,{initPTS:i})}a.offsetStartDTS(f,b,i),g=a.getStartDTS(f,b),this.remuxer.remux(f.audio,f.video,null,null,g,d,e,b)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(b){if(b.length>=8){var c=a.bin2str(b.subarray(4,8));return["moof","ftyp","styp"].indexOf(c)>=0}return!1}},{key:"bin2str",value:function(a){return String.fromCharCode.apply(null,a)}},{key:"readUint32",value:function(a,b){a.data&&(b+=a.start,a=a.data);var c=a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3];return c<0?4294967296+c:c}},{key:"writeUint32",value:function(a,b,c){a.data&&(b+=a.start,a=a.data),a[b]=c>>24,a[b+1]=c>>16&255,a[b+2]=c>>8&255,a[b+3]=255&c}},{key:"findBox",value:function(b,c){var d,e,f,g,h,i,j,k=[];if(b.data?(i=b.start,g=b.end,b=b.data):(i=0,g=b.byteLength),!c.length)return null;for(d=i;d<g;)e=a.readUint32(b,d),f=a.bin2str(b.subarray(d+4,d+8)),j=e>1?d+e:g,f===c[0]&&(1===c.length?k.push({data:b,start:d+8,end:j}):(h=a.findBox({data:b,start:d+8,end:j},c.slice(1)),h.length&&(k=k.concat(h)))),d=j;return k}},{key:"parseInitSegment",value:function(b){var c=[],d=a.findBox(b,["moov","trak"]);return d.forEach(function(b){var d=a.findBox(b,["tkhd"])[0];if(d){var e=d.data[d.start],f=0===e?12:20,g=a.readUint32(d,f),h=a.findBox(b,["mdia","mdhd"])[0];if(h){e=h.data[h.start],f=0===e?12:20;var i=a.readUint32(h,f),j=a.findBox(b,["mdia","hdlr"])[0];if(j){var k=a.bin2str(j.data.subarray(j.start+8,j.start+12)),l={soun:"audio",vide:"video"}[k];l&&(c[g]={timescale:i,type:l},c[l]={timescale:i,id:g})}}}}),c}},{key:"getStartDTS",value:function(b,c){var d,e,f;return d=a.findBox(c,["moof","traf"]),e=[].concat.apply([],d.map(function(c){return a.findBox(c,["tfhd"]).map(function(d){var e,f,g;return e=a.readUint32(d,4),f=b[e].timescale||9e4,g=a.findBox(c,["tfdt"]).map(function(b){var c,d;return c=b.data[b.start],d=a.readUint32(b,4),1===c&&(d*=Math.pow(2,32),d+=a.readUint32(b,8)),d})[0],g=g||1/0,g/f})})),f=Math.min.apply(null,e),isFinite(f)?f:0}},{key:"offsetStartDTS",value:function(b,c,d){a.findBox(c,["moof","traf"]).map(function(c){return a.findBox(c,["tfhd"]).map(function(e){var f=a.readUint32(e,4),g=b[f].timescale||9e4;a.findBox(c,["tfdt"]).map(function(b){var c=b.data[b.start],e=a.readUint32(b,4);if(0===c)a.writeUint32(b,4,e-d*g);else{e*=Math.pow(2,32),e+=a.readUint32(b,8),e-=d*g;var f=Math.floor(e/(i+1)),h=Math.floor(e%(i+1));a.writeUint32(b,4,f),a.writeUint32(b,8,h)}})})})}}]),a}();c["default"]=j},{35:35}],30:[function(a,b,c){"use strict";var d={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],appendFrame:function(a,b,c,d,e){if(!(c+24>b.length)){var f=this.parseHeader(b,c);if(f&&c+f.frameLength<=b.length){var g=10368e4/f.sampleRate,h=d+e*g,i={unit:b.subarray(c,c+f.frameLength),pts:h,dts:h};return a.config=[],a.channelCount=f.channelCount,a.samplerate=f.sampleRate,a.samples.push(i),a.len+=f.frameLength,{sample:i,length:f.frameLength}}}},parseHeader:function(a,b){var c=a[b+1]>>3&3,e=a[b+1]>>1&3,f=a[b+2]>>4&15,g=a[b+2]>>2&3,h=!!(2&a[b+2]);if(1!==c&&0!==f&&15!==f&&3!==g){var i=3===c?3-e:3===e?3:4,j=1e3*d.BitratesMap[14*i+f-1],k=3===c?0:2===c?1:2,l=d.SamplingRateMap[3*k+g],m=h?1:0,n=a[b+3]>>6===3?1:2,o=3===e?(3===c?12:6)*j/l+m<<2:(3===c?144:72)*j/l+m|0;return{sampleRate:l,channelCount:n,frameLength:o}}},isHeaderPattern:function(a,b){return 255===a[b]&&224===(224&a[b+1])&&0!==(6&a[b+1])},isHeader:function(a,b){return!!(b+1<a.length&&this.isHeaderPattern(a,b))},probe:function(a,b){if(b+1<a.length&&this.isHeaderPattern(a,b)){var c=4,d=this.parseHeader(a,b),e=c;d&&d.frameLength&&(e=d.frameLength);var f=b+e;if(f===a.length||f+1<a.length&&this.isHeaderPattern(a,f))return!0}return!1}};b.exports=d},{}],31:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(19),h=d(g),i=function(){function a(b,c,d,f){e(this,a),this.decryptdata=d,this.discardEPB=f,this.decrypter=new h["default"](b,c)}return f(a,[{key:"decryptBuffer",value:function(a,b){this.decrypter.decrypt(a,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,b)}},{key:"decryptAacSample",value:function(a,b,c,d){var e=a[b].unit,f=e.subarray(16,e.length-e.length%16),g=f.buffer.slice(f.byteOffset,f.byteOffset+f.length),h=this;this.decryptBuffer(g,function(f){f=new Uint8Array(f),e.set(f,16),d||h.decryptAacSamples(a,b+1,c)})}},{key:"decryptAacSamples",value:function(a,b,c){for(;;b++){if(b>=a.length)return void c();if(!(a[b].unit.length<32)){var d=this.decrypter.isSync();if(this.decryptAacSample(a,b,c,d),!d)return}}}},{key:"getAvcEncryptedData",value:function(a){for(var b=16*Math.floor((a.length-48)/160)+16,c=new Int8Array(b),d=0,e=32;e<=a.length-16;e+=160,d+=16)c.set(a.subarray(e,e+16),d);return c}},{key:"getAvcDecryptedUnit",value:function(a,b){b=new Uint8Array(b);for(var c=0,d=32;d<=a.length-16;d+=160,c+=16)a.set(b.subarray(c,c+16),d);return a}},{key:"decryptAvcSample",value:function(a,b,c,d,e,f){var g=this.discardEPB(e.data),h=this.getAvcEncryptedData(g),i=this;this.decryptBuffer(h.buffer,function(h){e.data=i.getAvcDecryptedUnit(g,h),f||i.decryptAvcSamples(a,b,c+1,d)})}},{key:"decryptAvcSamples",value:function(a,b,c,d){for(;;b++,c=0){if(b>=a.length)return void d();for(var e=a[b].units;!(c>=e.length);c++){var f=e[c];if(!(f.length<=48||1!==f.type&&5!==f.type)){var g=this.decrypter.isSync();if(this.decryptAvcSample(a,b,c,d,f,g),!g)return}}}}}]),a}();c["default"]=i},{19:19}],32:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(22),h=d(g),i=a(30),j=d(i),k=a(35),l=d(k),m=a(26),n=d(m),o=a(31),p=d(o),q=a(54),r=a(33),s=function(){function a(b,c,d,f){e(this,a),this.observer=b,this.config=d,this.typeSupported=f,this.remuxer=c,this.sampleAes=null}return f(a,[{key:"setDecryptData",value:function(a){null!=a&&null!=a.key&&"SAMPLE-AES"===a.method?this.sampleAes=new p["default"](this.observer,this.config,a,this.discardEPB):this.sampleAes=null}},{key:"resetInitSegment",value:function(a,b,c,d){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:0},this._audioTrack={container:"video/mp2t",type:"audio",id:-1,inputTimeScale:9e4,duration:d,sequenceNumber:0,samples:[],len:0,isAAC:!0},this._id3Track={type:"id3",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=b,this.videoCodec=c,this._duration=d}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(a,b,c,d){var e,f,g,h,i,j,k=a.length,m=!1;this.contiguous=c;var n=this.pmtParsed,o=this._avcTrack,p=this._audioTrack,s=this._id3Track,t=o.id,u=p.id,v=s.id,w=this._pmtId,x=o.pesData,y=p.pesData,z=s.pesData,A=this._parsePAT,B=this._parsePMT,C=this._parsePES,D=this._parseAVCPES.bind(this),E=this._parseAACPES.bind(this),F=this._parseMPEGPES.bind(this),G=this._parseID3PES.bind(this);for(k-=k%188,e=0;e<k;e+=188)if(71===a[e]){if(f=!!(64&a[e+1]),g=((31&a[e+1])<<8)+a[e+2],h=(48&a[e+3])>>4,h>1){if(i=e+5+a[e+4],i===e+188)continue}else i=e+4;switch(g){case t:f&&(x&&(j=C(x))&&D(j,!1),x={data:[],size:0}),x&&(x.data.push(a.subarray(i,e+188)),x.size+=e+188-i);break;case u:f&&(y&&(j=C(y))&&(p.isAAC?E(j):F(j)),y={data:[],size:0}),y&&(y.data.push(a.subarray(i,e+188)),y.size+=e+188-i);break;case v:f&&(z&&(j=C(z))&&G(j),z={data:[],size:0}),z&&(z.data.push(a.subarray(i,e+188)),z.size+=e+188-i);break;case 0:f&&(i+=a[i]+1),w=this._pmtId=A(a,i);break;case w:f&&(i+=a[i]+1);var H=B(a,i,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,null!=this.sampleAes);t=H.avc,t>0&&(o.id=t),u=H.audio,u>0&&(p.id=u,p.isAAC=H.isAAC),v=H.id3,v>0&&(s.id=v),m&&!n&&(q.logger.log("reparse from beginning"),m=!1,e=-188),n=this.pmtParsed=!0;break;case 17:case 8191:break;default:m=!0}}else this.observer.trigger(l["default"].ERROR,{type:r.ErrorTypes.MEDIA_ERROR,details:r.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});x&&(j=C(x))?(D(j,!0),o.pesData=null):o.pesData=x,y&&(j=C(y))?(p.isAAC?E(j):F(j),p.pesData=null):(y&&y.size&&q.logger.log("last AAC PES packet truncated,might overlap between fragments"),p.pesData=y),z&&(j=C(z))?(G(j),s.pesData=null):s.pesData=z,null==this.sampleAes?this.remuxer.remux(p,o,s,this._txtTrack,b,c,d):this.decryptAndRemux(p,o,s,this._txtTrack,b,c,d)}},{key:"decryptAndRemux",value:function(a,b,c,d,e,f,g){if(a.samples&&a.isAAC){var h=this;this.sampleAes.decryptAacSamples(a.samples,0,function(){h.decryptAndRemuxAvc(a,b,c,d,e,f,g)})}else this.decryptAndRemuxAvc(a,b,c,d,e,f,g)}},{key:"decryptAndRemuxAvc",value:function(a,b,c,d,e,f,g){if(b.samples){var h=this;this.sampleAes.decryptAvcSamples(b.samples,0,0,function(){h.remuxer.remux(a,b,c,d,e,f,g)})}else this.remuxer.remux(a,b,c,d,e,f,g)}},{key:"destroy",value:function(){this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(a,b){return(31&a[b+10])<<8|a[b+11]}},{key:"_parsePMT",value:function(a,b,c,d){var e,f,g,h,i={audio:-1,avc:-1,id3:-1,isAAC:!0};for(e=(15&a[b+1])<<8|a[b+2],f=b+3+e-4,g=(15&a[b+10])<<8|a[b+11],b+=12+g;b<f;){switch(h=(31&a[b+1])<<8|a[b+2],a[b]){case 207:if(!d){q.logger.log("unkown stream type:"+a[b]);break}case 15:i.audio===-1&&(i.audio=h);break;case 21:i.id3===-1&&(i.id3=h);break;case 219:if(!d){q.logger.log("unkown stream type:"+a[b]);break}case 27:i.avc===-1&&(i.avc=h);break;case 3:case 4:c?i.audio===-1&&(i.audio=h,i.isAAC=!1):q.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:q.logger.warn("HEVC stream type found, not supported for now");break;default:q.logger.log("unkown stream type:"+a[b])}b+=((15&a[b+3])<<8|a[b+4])+5}return i}},{key:"_parsePES",value:function(a){var b,c,d,e,f,g,h,i,j,k=0,l=a.data;if(!a||0===a.size)return null;for(;l[0].length<19&&l.length>1;){var m=new Uint8Array(l[0].length+l[1].length);m.set(l[0]),m.set(l[1],l[0].length),l[0]=m,l.splice(1,1)}if(b=l[0],d=(b[0]<<16)+(b[1]<<8)+b[2],1===d){if(e=(b[4]<<8)+b[5],e&&e>a.size-6)return null;c=b[7],192&c&&(h=536870912*(14&b[9])+4194304*(255&b[10])+16384*(254&b[11])+128*(255&b[12])+(254&b[13])/2,h>4294967295&&(h-=8589934592),64&c?(i=536870912*(14&b[14])+4194304*(255&b[15])+16384*(254&b[16])+128*(255&b[17])+(254&b[18])/2,i>4294967295&&(i-=8589934592),h-i>54e5&&(q.logger.warn(Math.round((h-i)/9e4)+"s delta between PTS and DTS, align them"),h=i)):i=h),f=b[8],j=f+9,a.size-=j,g=new Uint8Array(a.size);for(var n=0,o=l.length;n<o;n++){b=l[n];var p=b.byteLength;if(j){if(j>p){j-=p;continue}b=b.subarray(j),p-=j,j=0}g.set(b,k),k+=p}return e&&(e-=f+3),{data:g,pts:h,dts:i,len:e}}return null}},{key:"pushAccesUnit",value:function(a,b){if(a.units.length&&a.frame){var c=b.samples,d=c.length;!this.config.forceKeyFrameOnDiscontinuity||a.key===!0||b.sps&&(d||this.contiguous)?(a.id=d,c.push(a)):b.dropped++}a.debug.length&&q.logger.log(a.pts+"/"+a.dts+":"+a.debug)}},{key:"_parseAVCPES",value:function(a,b){var c,d,e,f=this,g=this._avcTrack,h=this._parseAVCNALu(a.data),i=!1,j=this.avcSample,k=!1;a.data=null,h.forEach(function(b){switch(b.type){case 1:d=!0,i&&j&&(j.debug+="NDR "),j.frame=!0;var h=b.data;if(k&&h.length>4){var l=new n["default"](h).readSliceType();2!==l&&4!==l&&7!==l&&9!==l||(j.key=!0)}break;case 5:d=!0,j||(j=f.avcSample=f._createAVCSample(!0,a.pts,a.dts,"")),i&&(j.debug+="IDR "),j.key=!0,j.frame=!0;break;case 6:d=!0,i&&j&&(j.debug+="SEI "),c=new n["default"](f.discardEPB(b.data)),c.readUByte();for(var m=0,o=0,p=!1,q=0;!p&&c.bytesAvailable>1;){m=0;do q=c.readUByte(),m+=q;while(255===q);o=0;do q=c.readUByte(),o+=q;while(255===q);if(4===m&&0!==c.bytesAvailable){p=!0;var r=c.readUByte();if(181===r){var s=c.readUShort();if(49===s){var t=c.readUInt();if(1195456820===t){var u=c.readUByte();if(3===u){var v=c.readUByte(),w=c.readUByte(),x=31&v,y=[v,w];for(e=0;e<x;e++)y.push(c.readUByte()),y.push(c.readUByte()),y.push(c.readUByte());f._insertSampleInOrder(f._txtTrack.samples,{type:3,pts:a.pts,bytes:y})}}}}}else if(o<c.bytesAvailable)for(e=0;e<o;e++)c.readUByte()}break;case 7:if(d=!0,k=!0,i&&j&&(j.debug+="SPS "),!g.sps){c=new n["default"](b.data);var z=c.readSPS();g.width=z.width,g.height=z.height,g.pixelRatio=z.pixelRatio,g.sps=[b.data],g.duration=f._duration;var A=b.data.subarray(1,4),B="avc1.";for(e=0;e<3;e++){var C=A[e].toString(16);C.length<2&&(C="0"+C),B+=C}g.codec=B}break;case 8:d=!0,i&&j&&(j.debug+="PPS "),g.pps||(g.pps=[b.data]);break;case 9:d=!1,j&&f.pushAccesUnit(j,g),j=f.avcSample=f._createAVCSample(!1,a.pts,a.dts,i?"AUD ":"");break;case 12:d=!1;break;default:d=!1,j&&(j.debug+="unknown NAL "+b.type+" ")}if(j&&d){var D=j.units;D.push(b)}}),b&&j&&(this.pushAccesUnit(j,g),this.avcSample=null)}},{key:"_createAVCSample",value:function(a,b,c,d){return{key:a,pts:b,dts:c,units:[],debug:d}}},{key:"_insertSampleInOrder",value:function(a,b){var c=a.length;if(c>0){if(b.pts>=a[c-1].pts)a.push(b);else for(var d=c-1;d>=0;d--)if(b.pts<a[d].pts){a.splice(d,0,b);break}}else a.push(b)}},{key:"_getLastNalUnit",value:function(){var a=this.avcSample,b=void 0;if(!a||0===a.units.length){var c=this._avcTrack,d=c.samples;a=d[d.length-1]}if(a){var e=a.units;b=e[e.length-1]}return b}},{key:"_parseAVCNALu",value:function(a){var b,c,d,e,f,g=0,h=a.byteLength,i=this._avcTrack,j=i.naluState||0,k=j,l=[],m=-1;for(j===-1&&(m=0,f=31&a[0],j=0,g=1);g<h;)if(b=a[g++],j)if(1!==j)if(b)if(1===b){if(m>=0)d={data:a.subarray(m,g-j-1),type:f},l.push(d);else{var n=this._getLastNalUnit();if(n&&(k&&g<=4-k&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-k)),c=g-j-1,c>0)){var o=new Uint8Array(n.data.byteLength+c);o.set(n.data,0),o.set(a.subarray(0,c),n.data.byteLength),n.data=o}}g<h?(e=31&a[g],m=g,f=e,j=0):j=-1}else j=0;else j=3;else j=b?0:2;else j=b?0:1;if(m>=0&&j>=0&&(d={data:a.subarray(m,h),type:f,state:j},l.push(d)),0===l.length){var p=this._getLastNalUnit();if(p){var q=new Uint8Array(p.data.byteLength+a.byteLength);q.set(p.data,0),q.set(a,p.data.byteLength),p.data=q}}return i.naluState=j,l}},{key:"discardEPB",value:function(a){for(var b,c,d=a.byteLength,e=[],f=1;f<d-2;)0===a[f]&&0===a[f+1]&&3===a[f+2]?(e.push(f+2),f+=2):f++;if(0===e.length)return a;b=d-e.length,c=new Uint8Array(b);var g=0;for(f=0;f<b;g++,f++)g===e[0]&&(g++,e.shift()),c[f]=a[g];return c}},{key:"_parseAACPES",value:function(a){var b,c,d,e,f,g=this._audioTrack,i=a.data,j=a.pts,k=0,m=this.aacOverFlow,n=this.aacLastPTS;if(m){var o=new Uint8Array(m.byteLength+i.byteLength);o.set(m,0),o.set(i,m.byteLength),i=o}for(d=k,f=i.length;d<f-1&&!h["default"].isHeader(i,d);d++);if(d){var p,s;if(d<f-1?(p="AAC PES did not start with ADTS header,offset:"+d,s=!1):(p="no ADTS header found in AAC PES",s=!0),q.logger.warn("parsing error:"+p),this.observer.trigger(l["default"].ERROR,{type:r.ErrorTypes.MEDIA_ERROR,details:r.ErrorDetails.FRAG_PARSING_ERROR,fatal:s,reason:p}),s)return}if(h["default"].initTrackConfig(g,this.observer,i,d,this.audioCodec),c=0,b=h["default"].getFrameDuration(g.samplerate),m&&n){var t=n+b;Math.abs(t-j)>1&&(q.logger.log("AAC: align PTS for overlapping frames by "+Math.round((t-j)/90)),j=t)}for(;d<f;)if(h["default"].isHeader(i,d)&&d+5<f){var u=h["default"].appendFrame(g,i,d,j,c);if(!u)break;d+=u.length,e=u.sample.pts,c++}else d++;m=d<f?i.subarray(d,f):null,this.aacOverFlow=m,this.aacLastPTS=e}},{key:"_parseMPEGPES",value:function(a){for(var b=a.data,c=b.length,d=0,e=0,f=a.pts;e<c;)if(j["default"].isHeader(b,e)){var g=j["default"].appendFrame(this._audioTrack,b,e,f,d);if(!g)break;e+=g.length,d++}else e++}},{key:"_parseID3PES",value:function(a){this._id3Track.samples.push(a)}}],[{key:"probe",value:function(a){return a.length>=564&&71===a[0]&&71===a[188]&&71===a[376]}}]),a}();c["default"]=s},{22:22,26:26,30:30,31:31,33:33,35:35,54:54}],33:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},c.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException",WEBVTT_EXCEPTION:"webVTTException"}},{}],34:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a(54),i=a(33),j=a(35),k=d(j),l=function(){function a(b){e(this,a),this.hls=b,this.onEvent=this.onEvent.bind(this);for(var c=arguments.length,d=Array(c>1?c-1:0),f=1;f<c;f++)d[f-1]=arguments[f];this.handledEvents=d,this.useGenericHandler=!0,this.registerListeners()}return g(a,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===f(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(a){if("hlsEventGeneric"===a)throw new Error("Forbidden event name: "+a);this.hls.on(a,this.onEvent)},this)}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(a){this.hls.off(a,this.onEvent)},this)}},{key:"onEvent",value:function(a,b){this.onEventGeneric(a,b)}},{key:"onEventGeneric",value:function(a,b){var c=function(a,b){var c="on"+a.replace("hls","");if("function"!=typeof this[c])throw new Error("Event "+a+" has no generic handler in this "+this.constructor.name+" class (tried "+c+")");return this[c].bind(this,b)};try{c.call(this,a,b).call()}catch(d){h.logger.error("internal error happened while processing "+a+":"+d.message),this.hls.trigger(k["default"].ERROR,{type:i.ErrorTypes.OTHER_ERROR,details:i.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:a,err:d})}}}]),a}();c["default"]=l},{33:33,35:35,54:54}],35:[function(a,b,c){"use strict";b.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCH:"hlsLevelSwitch",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},{}],36:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a)}return e(a,null,[{key:"getSilentFrame",value:function(a,b){switch(a){case"mp4a.40.2":if(1===b)return new Uint8Array([0,200,0,128,35,128]);if(2===b)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===b)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===b)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===b)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),a}();c["default"]=f},{}],37:[function(a,b,c){"use strict";var d={isBuffered:function(a,b){if(a)for(var c=a.buffered,d=0;d<c.length;d++)if(b>=c.start(d)&&b<=c.end(d))return!0;return!1},bufferInfo:function(a,b,c){if(!a)return{len:0,start:b,end:b,nextStart:void 0};try{var d,e=a.buffered,f=[];for(d=0;d<e.length;d++)f.push({start:e.start(d),end:e.end(d)});return this.bufferedInfo(f,b,c)}catch(g){}},bufferedInfo:function(a,b,c){var d,e,f,g,h,i=[];for(a.sort(function(a,b){var c=a.start-b.start;return c?c:b.end-a.end}),h=0;h<a.length;h++){
var j=i.length;if(j){var k=i[j-1].end;a[h].start-k<c?a[h].end>k&&(i[j-1].end=a[h].end):i.push(a[h])}else i.push(a[h])}for(h=0,d=0,e=f=b;h<i.length;h++){var l=i[h].start,m=i[h].end;if(b+c>=l&&b<m)e=l,f=m,d=f-b;else if(b+c<l){g=l;break}}return{len:d,start:e,end:f,nextStart:g}}};b.exports=d},{}],38:[function(a,b,c){"use strict";var d=a(54),e={mergeDetails:function(a,b){var c,f=Math.max(a.startSN,b.startSN)-b.startSN,g=Math.min(a.endSN,b.endSN)-b.startSN,h=b.startSN-a.startSN,i=a.fragments,j=b.fragments,k=0;if(g<f)return void(b.PTSKnown=!1);for(var l=f;l<=g;l++){var m=i[h+l],n=j[l];n&&m&&(k=m.cc-n.cc,isNaN(m.startPTS)||(n.start=n.startPTS=m.startPTS,n.endPTS=m.endPTS,n.duration=m.duration,n.backtracked=m.backtracked,n.dropped=m.dropped,c=n))}if(k)for(d.logger.log("discontinuity sliding from playlist, take drift into account"),l=0;l<j.length;l++)j[l].cc+=k;if(c)e.updateFragPTSDTS(b,c,c.startPTS,c.endPTS,c.startDTS,c.endDTS);else if(h>=0&&h<i.length){var o=i[h].start;for(l=0;l<j.length;l++)j[l].start+=o}b.PTSKnown=a.PTSKnown},updateFragPTSDTS:function(a,b,c,d,f,g){var h=c;if(!isNaN(b.startPTS)){var i=Math.abs(b.startPTS-c);isNaN(b.deltaPTS)?b.deltaPTS=i:b.deltaPTS=Math.max(i,b.deltaPTS),h=Math.max(c,b.startPTS),c=Math.min(c,b.startPTS),d=Math.max(d,b.endPTS),f=Math.min(f,b.startDTS),g=Math.max(g,b.endDTS)}var j=c-b.start;b.start=b.startPTS=c,b.maxStartPTS=h,b.endPTS=d,b.startDTS=f,b.endDTS=g,b.duration=d-c;var k=b.sn;if(!a||k<a.startSN||k>a.endSN)return 0;var l,m,n;for(l=k-a.startSN,m=a.fragments,b=m[l],n=l;n>0;n--)e.updatePTS(m,n,n-1);for(n=l;n<m.length-1;n++)e.updatePTS(m,n,n+1);return a.PTSKnown=!0,j},updatePTS:function(a,b,c){var e=a[b],f=a[c],g=f.startPTS;isNaN(g)?c>b?f.start=e.start+e.duration:f.start=Math.max(e.start-f.duration,0):c>b?(e.duration=g-e.start,e.duration<0&&d.logger.warn("negative duration computed for frag "+e.sn+",level "+e.level+", there should be some duration drift between playlist and fragment!")):(f.duration=e.start-g,f.duration<0&&d.logger.warn("negative duration computed for frag "+f.sn+",level "+f.level+", there should be some duration drift between playlist and fragment!"))}};b.exports=e},{54:54}],39:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(2),h=d(g),i=a(35),j=d(i),k=a(33),l=a(43),m=d(l),n=a(41),o=d(n),p=a(42),q=d(p),r=a(13),s=d(r),t=a(12),u=d(t),v=a(11),w=d(v),x=a(54),y=a(1),z=d(y),A=a(4),B=function(){function a(){var b=this,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,a);var d=a.DefaultConfig;if((c.liveSyncDurationCount||c.liveMaxLatencyDurationCount)&&(c.liveSyncDuration||c.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var f in d)f in c||(c[f]=d[f]);if(void 0!==c.liveMaxLatencyDurationCount&&c.liveMaxLatencyDurationCount<=c.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==c.liveMaxLatencyDuration&&(c.liveMaxLatencyDuration<=c.liveSyncDuration||void 0===c.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');(0,x.enableLogs)(c.debug),this.config=c,this._autoLevelCapping=-1;var g=this.observer=new z["default"];g.trigger=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];g.emit.apply(g,[a,a].concat(c))},g.off=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];g.removeListener.apply(g,[a].concat(c))},this.on=g.on.bind(g),this.off=g.off.bind(g),this.trigger=g.trigger.bind(g);var h=this.abrController=new c.abrController(this),i=new c.bufferController(this),j=new c.capLevelController(this),k=new c.fpsController(this),l=new m["default"](this),n=new o["default"](this),p=new q["default"](this),r=new w["default"](this),t=this.levelController=new u["default"](this),v=this.streamController=new s["default"](this),y=[t,v],A=c.audioStreamController;A&&y.push(new A(this)),this.networkControllers=y;var B=[l,n,p,h,i,j,k,r];if(A=c.audioTrackController){var C=new A(this);this.audioTrackController=C,B.push(C)}if(A=c.subtitleTrackController){var D=new A(this);this.subtitleTrackController=D,B.push(D)}[c.subtitleStreamController,c.timelineController].forEach(function(a){a&&B.push(new a(b))}),this.coreComponents=B}return f(a,null,[{key:"isSupported",value:function(){var a=window.MediaSource=window.MediaSource||window.WebKitMediaSource,b=window.SourceBuffer=window.SourceBuffer||window.WebKitSourceBuffer,c=a&&"function"==typeof a.isTypeSupported&&a.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),d=!b||b.prototype&&"function"==typeof b.prototype.appendBuffer&&"function"==typeof b.prototype.remove;return c&&d}},{key:"version",get:function(){return"0.7.10"}},{key:"Events",get:function(){return j["default"]}},{key:"ErrorTypes",get:function(){return k.ErrorTypes}},{key:"ErrorDetails",get:function(){return k.ErrorDetails}},{key:"DefaultConfig",get:function(){return a.defaultConfig?a.defaultConfig:A.hlsDefaultConfig},set:function(b){a.defaultConfig=b}}]),f(a,[{key:"destroy",value:function(){x.logger.log("destroy"),this.trigger(j["default"].DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(a){a.destroy()}),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1}},{key:"attachMedia",value:function(a){x.logger.log("attachMedia"),this.media=a,this.trigger(j["default"].MEDIA_ATTACHING,{media:a})}},{key:"detachMedia",value:function(){x.logger.log("detachMedia"),this.trigger(j["default"].MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(a){a.m3u8?(x.logger.log("loadSource:"+a.url),this.url=a.url,this.trigger(j["default"].MANIFEST_LOADING,{url:a.url,m3u8:a.m3u8})):(a=a.url,a=h["default"].buildAbsoluteURL(window.location.href,a,{alwaysNormalize:!0}),x.logger.log("loadSource:"+a),this.url=a,this.trigger(j["default"].MANIFEST_LOADING,{url:a}))}},{key:"startLoad",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;x.logger.log("startLoad("+a+")"),this.networkControllers.forEach(function(b){b.startLoad(a)})}},{key:"stopLoad",value:function(){x.logger.log("stopLoad"),this.networkControllers.forEach(function(a){a.stopLoad()})}},{key:"swapAudioCodec",value:function(){x.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){x.logger.log("recoverMediaError");var a=this.media;this.detachMedia(),this.attachMedia(a)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(a){x.logger.log("set currentLevel:"+a),this.loadLevel=a,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(a){x.logger.log("set nextLevel:"+a),this.levelController.manualLevel=a,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(a){x.logger.log("set loadLevel:"+a),this.levelController.manualLevel=a}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(a){this.levelController.nextLoadLevel=a}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(a){x.logger.log("set firstLevel:"+a),this.levelController.firstLevel=a}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(a){x.logger.log("set startLevel:"+a);var b=this;a!==-1&&(a=Math.max(a,b.minAutoLevel)),b.levelController.startLevel=a}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(a){x.logger.log("set autoLevelCapping:"+a),this._autoLevelCapping=a}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var a=this,b=a.levels,c=a.config.minAutoBitrate,d=b?b.length:0,e=0;e<d;e++){var f=b[e].realBitrate?Math.max(b[e].realBitrate,b[e].bitrate):b[e].bitrate;if(f>c)return e}return 0}},{key:"maxAutoLevel",get:function(){var a=this,b=a.levels,c=a.autoLevelCapping,d=void 0;return d=c===-1&&b&&b.length?b.length-1:c}},{key:"nextAutoLevel",get:function(){var a=this;return Math.min(Math.max(a.abrController.nextAutoLevel,a.minAutoLevel),a.maxAutoLevel)},set:function(a){var b=this;b.abrController.nextAutoLevel=Math.max(b.minAutoLevel,a)}},{key:"audioTracks",get:function(){var a=this.audioTrackController;return a?a.audioTracks:[]}},{key:"audioTrack",get:function(){var a=this.audioTrackController;return a?a.audioTrack:-1},set:function(a){var b=this.audioTrackController;b&&(b.audioTrack=a)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var a=this.subtitleTrackController;return a?a.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var a=this.subtitleTrackController;return a?a.subtitleTrack:-1},set:function(a){var b=this.subtitleTrackController;b&&(b.subtitleTrack=a)}}]),a}();c["default"]=B},{1:1,11:11,12:12,13:13,2:2,33:33,35:35,4:4,41:41,42:42,43:43,54:54}],40:[function(a,b,c){"use strict";b.exports=a(39)["default"]},{39:39}],41:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(33),n=a(54),o=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].FRAG_LOADING));return c.loaders={},c}return g(b,a),h(b,[{key:"destroy",value:function(){var a=this.loaders;for(var b in a){var c=a[b];c&&c.destroy()}this.loaders={},l["default"].prototype.destroy.call(this)}},{key:"onFragLoading",value:function(a){var b=a.frag,c=b.type,d=this.loaders[c],e=this.hls.config;b.loaded=0,d&&(n.logger.warn("abort previous fragment loader for type:"+c),d.abort()),d=this.loaders[c]=b.loader="undefined"!=typeof e.fLoader?new e.fLoader(e):new e.loader(e);var f=void 0,g=void 0,h=void 0;f={url:b.url,frag:b,responseType:"arraybuffer",progressData:!1};var i=b.byteRangeStartOffset,j=b.byteRangeEndOffset;isNaN(i)||isNaN(j)||(f.rangeStart=i,f.rangeEnd=j),g={timeout:e.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:e.fragLoadingMaxRetryTimeout},h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},d.load(f,g,h)}},{key:"loadsuccess",value:function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,e=a.data,f=c.frag;f.loader=void 0,this.loaders[f.type]=void 0,this.hls.trigger(j["default"].FRAG_LOADED,{payload:e,frag:f,stats:b,networkDetails:d})}},{key:"loaderror",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=b.loader;d&&d.abort(),this.loaders[b.type]=void 0,this.hls.trigger(j["default"].ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:b.frag,response:a,networkDetails:c})}},{key:"loadtimeout",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=b.loader;d&&d.abort(),this.loaders[b.type]=void 0,this.hls.trigger(j["default"].ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:b.frag,networkDetails:c})}},{key:"loadprogress",value:function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,e=b.frag;e.loaded=a.loaded,this.hls.trigger(j["default"].FRAG_LOAD_PROGRESS,{frag:e,stats:a,networkDetails:d})}}]),b}(l["default"]);c["default"]=o},{33:33,34:34,35:35,54:54}],42:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(33),n=a(54),o=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].KEY_LOADING));return c.loaders={},c.decryptkey=null,c.decrypturl=null,c}return g(b,a),h(b,[{key:"destroy",value:function(){for(var a in this.loaders){var b=this.loaders[a];b&&b.destroy()}this.loaders={},l["default"].prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(a){var b=a.frag,c=b.type,d=this.loaders[c],e=b.decryptdata,f=e.uri;if(f!==this.decrypturl||null===this.decryptkey){var g=this.hls.config;d&&(n.logger.warn("abort previous key loader for type:"+c),d.abort()),b.loader=this.loaders[c]=new g.loader(g),this.decrypturl=f,this.decryptkey=null;var h=void 0,i=void 0,k=void 0;h={url:f,frag:b,responseType:"arraybuffer"},i={timeout:g.fragLoadingTimeOut,maxRetry:g.fragLoadingMaxRetry,retryDelay:g.fragLoadingRetryDelay,maxRetryDelay:g.fragLoadingMaxRetryTimeout},k={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},b.loader.load(h,i,k)}else this.decryptkey&&(e.key=this.decryptkey,this.hls.trigger(j["default"].KEY_LOADED,{frag:b}))}},{key:"loadsuccess",value:function(a,b,c){var d=c.frag;this.decryptkey=d.decryptdata.key=new Uint8Array(a.data),d.loader=void 0,this.loaders[d.type]=void 0,this.hls.trigger(j["default"].KEY_LOADED,{frag:d})}},{key:"loaderror",value:function(a,b){var c=b.frag,d=c.loader;d&&d.abort(),this.loaders[b.type]=void 0,this.hls.trigger(j["default"].ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:c,response:a})}},{key:"loadtimeout",value:function(a,b){var c=b.frag,d=c.loader;d&&d.abort(),this.loaders[b.type]=void 0,this.hls.trigger(j["default"].ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:c})}}]),b}(l["default"]);c["default"]=o},{33:33,34:34,35:35,54:54}],43:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(2),j=d(i),k=a(35),l=d(k),m=a(34),n=d(m),o=a(33),p=a(47),q=d(p),r=a(54),s=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,t=/#EXT-X-MEDIA:(.*)/g,u=new RegExp([/#EXTINF:(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),v=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,w=function(){function a(){g(this,a),this.method=null,this.key=null,this.iv=null,this._uri=null}return h(a,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=j["default"].buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),a}(),x=function(){function a(){g(this,a),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}return h(a,[{key:"createInitializationVector",value:function(a){for(var b=new Uint8Array(16),c=12;c<16;c++)b[c]=a>>8*(15-c)&255;return b}},{key:"fragmentDecryptdataFromLevelkey",value:function(a,b){var c=a;return a&&a.method&&a.uri&&!a.iv&&(c=new w,c.method=a.method,c.baseuri=a.baseuri,c.reluri=a.reluri,c.iv=this.createInitializationVector(b)),c}},{key:"cloneObj",value:function(a){return JSON.parse(JSON.stringify(a))}},{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=j["default"].buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(a){this._url=a}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange){var a=this._byteRange=[];if(this.rawByteRange){var b=this.rawByteRange.split("@",2);if(1===b.length){var c=this.lastByteRangeEndOffset;a[0]=c?c:0}else a[0]=parseInt(b[1]);a[1]=parseInt(b[0])+a[0]}}return this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),a}(),y=function(a){function b(a){g(this,b);var c=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,l["default"].MANIFEST_LOADING,l["default"].LEVEL_LOADING,l["default"].AUDIO_TRACK_LOADING,l["default"].SUBTITLE_TRACK_LOADING));return c.loaders={},c}return f(b,a),h(b,[{key:"destroy",value:function(){for(var a in this.loaders){var b=this.loaders[a];b&&b.destroy()}this.loaders={},n["default"].prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(a){a.m3u8?this.loadsuccess({data:a.m3u8,url:a.url},{loaded:1,retry:1,tfirst:1,tload:1,total:1,trequest:1},{type:"manifest",url:a.url}):this.load(a.url,{type:"manifest"})}},{key:"onLevelLoading",value:function(a){this.load(a.url,{type:"level",level:a.level,id:a.id})}},{key:"onAudioTrackLoading",value:function(a){this.load(a.url,{type:"audioTrack",id:a.id})}},{key:"onSubtitleTrackLoading",value:function(a){this.load(a.url,{type:"subtitleTrack",id:a.id})}},{key:"load",value:function(a,b){var c=this.loaders[b.type];if(c){var d=c.context;if(d&&d.url===a)return void r.logger.trace("playlist request ongoing");r.logger.warn("abort previous loader for type:"+b.type),c.abort()}var e=this.hls.config,f=void 0,g=void 0,h=void 0,i=void 0;"manifest"===b.type?(f=e.manifestLoadingMaxRetry,g=e.manifestLoadingTimeOut,h=e.manifestLoadingRetryDelay,i=e.manifestLoadingMaxRetryTimeout):(f=e.levelLoadingMaxRetry,g=e.levelLoadingTimeOut,h=e.levelLoadingRetryDelay,i=e.levelLoadingMaxRetryTimeout,r.logger.log("loading playlist for "+b.type+" "+(b.level||b.id))),c=this.loaders[b.type]=b.loader="undefined"!=typeof e.pLoader?new e.pLoader(e):new e.loader(e),b.url=a,b.responseType="";var j=void 0,k=void 0;j={timeout:g,maxRetry:f,retryDelay:h,maxRetryDelay:i},k={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},c.load(b,j,k)}},{key:"resolve",value:function(a,b){return j["default"].buildAbsoluteURL(b,a,{alwaysNormalize:!0})}},{key:"parseMasterPlaylist",value:function(a,b){var c=[],d=void 0;for(s.lastIndex=0;null!=(d=s.exec(a));){var e={},f=e.attrs=new q["default"](d[1]);e.url=this.resolve(d[2],b);var g=f.decimalResolution("RESOLUTION");g&&(e.width=g.width,e.height=g.height),e.bitrate=f.decimalInteger("AVERAGE-BANDWIDTH")||f.decimalInteger("BANDWIDTH"),e.name=f.NAME;var h=f.CODECS;if(h){h=h.split(/[ ,]+/);for(var i=0;i<h.length;i++){var j=h[i];j.indexOf("avc1")!==-1?e.videoCodec=this.avc1toavcoti(j):j.indexOf("hvc1")!==-1?e.videoCodec=j:e.audioCodec=j}}c.push(e)}return c}},{key:"parseMasterPlaylistMedia",value:function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,e=void 0,f=[],g=0;for(t.lastIndex=0;null!=(e=t.exec(a));){var h={},i=new q["default"](e[1]);i.TYPE===c&&(h.groupId=i["GROUP-ID"],h.name=i.NAME,h.type=c,h["default"]="YES"===i.DEFAULT,h.autoselect="YES"===i.AUTOSELECT,h.forced="YES"===i.FORCED,i.URI&&(h.url=this.resolve(i.URI,b)),h.lang=i.LANGUAGE,h.name||(h.name=h.lang),d&&(h.audioCodec=d),h.id=g++,f.push(h))}return f}},{key:"avc1toavcoti",value:function(a){var b,c=a.split(".");return c.length>2?(b=c.shift()+".",b+=parseInt(c.shift()).toString(16),b+=("000"+parseInt(c.shift()).toString(16)).substr(-4)):b=a,b}},{key:"parseLevelPlaylist",value:function(a,b,c,d){var e,f,g=0,h=0,i={type:null,version:null,url:b,fragments:[],live:!0,startSN:0},j=new w,k=0,l=null,m=new x;for(u.lastIndex=0;null!==(e=u.exec(a));){var n=e[1];if(n){m.duration=parseFloat(n);var o=(" "+e[2]).slice(1);m.title=o?o:null,m.tagList.push(o?["INF",n,o]:["INF",n])}else if(e[3]){if(!isNaN(m.duration)){var p=g++;m.type=d,m.start=h,m.levelkey=j,m.sn=p,m.level=c,m.cc=k,m.baseurl=b,m.relurl=(" "+e[3]).slice(1),i.fragments.push(m),l=m,h+=m.duration,m=new x}}else if(e[4]){if(m.rawByteRange=(" "+e[4]).slice(1),l){var s=l.byteRangeEndOffset;s&&(m.lastByteRangeEndOffset=s)}}else if(e[5])m.rawProgramDateTime=(" "+e[5]).slice(1),m.tagList.push(["PROGRAM-DATE-TIME",m.rawProgramDateTime]);else{for(e=e[0].match(v),f=1;f<e.length&&void 0===e[f];f++);var t=(" "+e[f+1]).slice(1),y=(" "+e[f+2]).slice(1);switch(e[f]){case"#":m.tagList.push(y?[t,y]:[t]);break;case"PLAYLIST-TYPE":i.type=t.toUpperCase();break;case"MEDIA-SEQUENCE":g=i.startSN=parseInt(t);break;case"TARGETDURATION":i.targetduration=parseFloat(t);break;case"VERSION":i.version=parseInt(t);break;case"EXTM3U":break;case"ENDLIST":i.live=!1;break;case"DIS":k++,m.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":k=parseInt(t);break;case"KEY":var z=t,A=new q["default"](z),B=A.enumeratedString("METHOD"),C=A.URI,D=A.hexadecimalInteger("IV");B&&(j=new w,C&&["AES-128","SAMPLE-AES"].indexOf(B)>=0&&(j.method=B,j.baseuri=b,j.reluri=C,j.key=null,j.iv=D));break;case"START":var E=t,F=new q["default"](E),G=F.decimalFloatingPoint("TIME-OFFSET");isNaN(G)||(i.startTimeOffset=G);break;case"MAP":var H=new q["default"](t);m.relurl=H.URI,m.rawByteRange=H.BYTERANGE,m.baseurl=b,m.level=c,m.type=d,m.sn="initSegment",i.initSegment=m,m=new x;break;default:r.logger.warn("line parsed but not handled: "+e)}}}return m=l,m&&!m.relurl&&(i.fragments.pop(),h-=m.duration),i.totalduration=h,i.averagetargetduration=h/i.fragments.length,i.endSN=g-1,i}},{key:"loadsuccess",value:function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,e=a.data,f=a.url,g=c.type,h=c.id,i=c.level,j=this.hls;if(this.loaders[g]=void 0,void 0!==f&&0!==f.indexOf("data:")||(f=c.url),b.tload=performance.now(),0===e.indexOf("#EXTM3U"))if(e.indexOf("#EXTINF:")>0){var k="audioTrack"!==g&&"subtitleTrack"!==g,m=isNaN(i)?isNaN(h)?0:h:i,n=this.parseLevelPlaylist(e,f,m,"audioTrack"===g?"audio":"subtitleTrack"===g?"subtitle":"main");n.tload=b.tload,"manifest"===g&&j.trigger(l["default"].MANIFEST_LOADED,{levels:[{url:f,details:n}],audioTracks:[],url:f,stats:b,networkDetails:d}),b.tparsed=performance.now(),n.targetduration?k?j.trigger(l["default"].LEVEL_LOADED,{details:n,level:i||0,id:h||0,stats:b,networkDetails:d}):"audioTrack"===g?j.trigger(l["default"].AUDIO_TRACK_LOADED,{details:n,id:h,stats:b,networkDetails:d}):"subtitleTrack"===g&&j.trigger(l["default"].SUBTITLE_TRACK_LOADED,{details:n,id:h,stats:b,networkDetails:d}):j.trigger(l["default"].ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:f,reason:"invalid targetduration",networkDetails:d})}else{var p=this.parseMasterPlaylist(e,f);if(p.length){var q=this.parseMasterPlaylistMedia(e,f,"AUDIO",p[0].audioCodec),s=this.parseMasterPlaylistMedia(e,f,"SUBTITLES");if(q.length){var t=!1;q.forEach(function(a){a.url||(t=!0)}),t===!1&&p[0].audioCodec&&!p[0].attrs.AUDIO&&(r.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),q.unshift({type:"main",name:"main"}))}j.trigger(l["default"].MANIFEST_LOADED,{levels:p,audioTracks:q,subtitles:s,url:f,stats:b,networkDetails:d})}else j.trigger(l["default"].ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:f,reason:"no level found in manifest",networkDetails:d})}else j.trigger(l["default"].ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:f,reason:"no EXTM3U delimiter",networkDetails:d})}},{key:"loaderror",value:function(a,b){var c,d,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,f=b.loader;switch(b.type){case"manifest":c=o.ErrorDetails.MANIFEST_LOAD_ERROR,d=!0;break;case"level":c=o.ErrorDetails.LEVEL_LOAD_ERROR,d=!1;break;case"audioTrack":c=o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,d=!1}f&&(f.abort(),this.loaders[b.type]=void 0),this.hls.trigger(l["default"].ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:c,fatal:d,url:f.url,loader:f,response:a,context:b,networkDetails:e})}},{key:"loadtimeout",value:function(a,b){var c,d,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,f=b.loader;switch(b.type){case"manifest":c=o.ErrorDetails.MANIFEST_LOAD_TIMEOUT,d=!0;break;case"level":c=o.ErrorDetails.LEVEL_LOAD_TIMEOUT,d=!1;break;case"audioTrack":c=o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT,d=!1}f&&(f.abort(),this.loaders[b.type]=void 0),this.hls.trigger(l["default"].ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:c,fatal:d,url:f.url,loader:f,context:b,networkDetails:e})}}]),b}(n["default"]);c["default"]=y},{2:2,33:33,34:34,35:35,47:47,54:54}],44:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=Math.pow(2,32)-1,g=function(){function a(){d(this,a)}return e(a,null,[{key:"init",value:function(){a.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var b;for(b in a.types)a.types.hasOwnProperty(b)&&(a.types[b]=[b.charCodeAt(0),b.charCodeAt(1),b.charCodeAt(2),b.charCodeAt(3)]);var c=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),d=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);a.HDLR_TYPES={video:c,audio:d};var e=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),f=new Uint8Array([0,0,0,0,0,0,0,0]);a.STTS=a.STSC=a.STCO=f,a.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),a.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),a.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),a.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var g=new Uint8Array([105,115,111,109]),h=new Uint8Array([97,118,99,49]),i=new Uint8Array([0,0,0,1]);a.FTYP=a.box(a.types.ftyp,g,i,g,h),a.DINF=a.box(a.types.dinf,a.box(a.types.dref,e))}},{key:"box",value:function(a){for(var b,c=Array.prototype.slice.call(arguments,1),d=8,e=c.length,f=e;e--;)d+=c[e].byteLength;for(b=new Uint8Array(d),b[0]=d>>24&255,b[1]=d>>16&255,b[2]=d>>8&255,b[3]=255&d,b.set(a,4),e=0,d=8;e<f;e++)b.set(c[e],d),d+=c[e].byteLength;return b}},{key:"hdlr",value:function(b){return a.box(a.types.hdlr,a.HDLR_TYPES[b])}},{key:"mdat",value:function(b){return a.box(a.types.mdat,b)}},{key:"mdhd",value:function(b,c){c*=b;var d=Math.floor(c/(f+1)),e=Math.floor(c%(f+1));return a.box(a.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,b>>24&255,b>>16&255,b>>8&255,255&b,d>>24,d>>16&255,d>>8&255,255&d,e>>24,e>>16&255,e>>8&255,255&e,85,196,0,0]))}},{key:"mdia",value:function(b){return a.box(a.types.mdia,a.mdhd(b.timescale,b.duration),a.hdlr(b.type),a.minf(b))}},{key:"mfhd",value:function(b){return a.box(a.types.mfhd,new Uint8Array([0,0,0,0,b>>24,b>>16&255,b>>8&255,255&b]))}},{key:"minf",value:function(b){return"audio"===b.type?a.box(a.types.minf,a.box(a.types.smhd,a.SMHD),a.DINF,a.stbl(b)):a.box(a.types.minf,a.box(a.types.vmhd,a.VMHD),a.DINF,a.stbl(b))}},{key:"moof",value:function(b,c,d){return a.box(a.types.moof,a.mfhd(b),a.traf(d,c))}},{key:"moov",value:function(b){for(var c=b.length,d=[];c--;)d[c]=a.trak(b[c]);return a.box.apply(null,[a.types.moov,a.mvhd(b[0].timescale,b[0].duration)].concat(d).concat(a.mvex(b)))}},{key:"mvex",value:function(b){for(var c=b.length,d=[];c--;)d[c]=a.trex(b[c]);return a.box.apply(null,[a.types.mvex].concat(d))}},{key:"mvhd",value:function(b,c){c*=b;var d=Math.floor(c/(f+1)),e=Math.floor(c%(f+1)),g=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,b>>24&255,b>>16&255,b>>8&255,255&b,d>>24,d>>16&255,d>>8&255,255&d,e>>24,e>>16&255,e>>8&255,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return a.box(a.types.mvhd,g)}},{key:"sdtp",value:function(b){var c,d,e=b.samples||[],f=new Uint8Array(4+e.length);for(d=0;d<e.length;d++)c=e[d].flags,f[d+4]=c.dependsOn<<4|c.isDependedOn<<2|c.hasRedundancy;return a.box(a.types.sdtp,f)}},{key:"stbl",value:function(b){return a.box(a.types.stbl,a.stsd(b),a.box(a.types.stts,a.STTS),a.box(a.types.stsc,a.STSC),a.box(a.types.stsz,a.STSZ),a.box(a.types.stco,a.STCO))}},{key:"avc1",value:function(b){var c,d,e,f=[],g=[];for(c=0;c<b.sps.length;c++)d=b.sps[c],e=d.byteLength,f.push(e>>>8&255),f.push(255&e),f=f.concat(Array.prototype.slice.call(d));for(c=0;c<b.pps.length;c++)d=b.pps[c],e=d.byteLength,g.push(e>>>8&255),g.push(255&e),g=g.concat(Array.prototype.slice.call(d));var h=a.box(a.types.avcC,new Uint8Array([1,f[3],f[4],f[5],255,224|b.sps.length].concat(f).concat([b.pps.length]).concat(g))),i=b.width,j=b.height,k=b.pixelRatio[0],l=b.pixelRatio[1];
return a.box(a.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i>>8&255,255&i,j>>8&255,255&j,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),h,a.box(a.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),a.box(a.types.pasp,new Uint8Array([k>>24,k>>16&255,k>>8&255,255&k,l>>24,l>>16&255,l>>8&255,255&l])))}},{key:"esds",value:function(a){var b=a.config.length;return new Uint8Array([0,0,0,0,3,23+b,0,1,0,4,15+b,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([b]).concat(a.config).concat([6,1,2]))}},{key:"mp4a",value:function(b){var c=b.samplerate;return a.box(a.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,b.channelCount,0,16,0,0,0,0,c>>8&255,255&c,0,0]),a.box(a.types.esds,a.esds(b)))}},{key:"mp3",value:function(b){var c=b.samplerate;return a.box(a.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,b.channelCount,0,16,0,0,0,0,c>>8&255,255&c,0,0]))}},{key:"stsd",value:function(b){return"audio"===b.type?b.isAAC||"mp3"!==b.codec?a.box(a.types.stsd,a.STSD,a.mp4a(b)):a.box(a.types.stsd,a.STSD,a.mp3(b)):a.box(a.types.stsd,a.STSD,a.avc1(b))}},{key:"tkhd",value:function(b){var c=b.id,d=b.duration*b.timescale,e=b.width,g=b.height,h=Math.floor(d/(f+1)),i=Math.floor(d%(f+1));return a.box(a.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,c>>24&255,c>>16&255,c>>8&255,255&c,0,0,0,0,h>>24,h>>16&255,h>>8&255,255&h,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,e>>8&255,255&e,0,0,g>>8&255,255&g,0,0]))}},{key:"traf",value:function(b,c){var d=a.sdtp(b),e=b.id,g=Math.floor(c/(f+1)),h=Math.floor(c%(f+1));return a.box(a.types.traf,a.box(a.types.tfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e])),a.box(a.types.tfdt,new Uint8Array([1,0,0,0,g>>24,g>>16&255,g>>8&255,255&g,h>>24,h>>16&255,h>>8&255,255&h])),a.trun(b,d.length+16+20+8+16+8+8),d)}},{key:"trak",value:function(b){return b.duration=b.duration||4294967295,a.box(a.types.trak,a.tkhd(b),a.mdia(b))}},{key:"trex",value:function(b){var c=b.id;return a.box(a.types.trex,new Uint8Array([0,0,0,0,c>>24,c>>16&255,c>>8&255,255&c,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(b,c){var d,e,f,g,h,i,j=b.samples||[],k=j.length,l=12+16*k,m=new Uint8Array(l);for(c+=8+l,m.set([0,0,15,1,k>>>24&255,k>>>16&255,k>>>8&255,255&k,c>>>24&255,c>>>16&255,c>>>8&255,255&c],0),d=0;d<k;d++)e=j[d],f=e.duration,g=e.size,h=e.flags,i=e.cts,m.set([f>>>24&255,f>>>16&255,f>>>8&255,255&f,g>>>24&255,g>>>16&255,g>>>8&255,255&g,h.isLeading<<2|h.dependsOn,h.isDependedOn<<6|h.hasRedundancy<<4|h.paddingValue<<1|h.isNonSync,61440&h.degradPrio,15&h.degradPrio,i>>>24&255,i>>>16&255,i>>>8&255,255&i],12+16*d);return a.box(a.types.trun,m)}},{key:"initSegment",value:function(b){a.types||a.init();var c,d=a.moov(b);return c=new Uint8Array(a.FTYP.byteLength+d.byteLength),c.set(a.FTYP),c.set(d,a.FTYP.byteLength),c}}]),a}();c["default"]=g},{}],45:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(36),h=d(g),i=a(35),j=d(i),k=a(54),l=a(44),m=d(l),n=a(33),o=1e4,p=function(){function a(b,c,d,f){e(this,a),this.observer=b,this.config=c,this.typeSupported=d;var g=navigator.userAgent;this.isSafari=f&&f.indexOf("Apple")>-1&&g&&!g.match("CriOS"),this.ISGenerated=!1}return f(a,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(a){this._initPTS=this._initDTS=a}},{key:"resetInitSegment",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(a,b,c,d,e,f,g){if(this.ISGenerated){if(g){var h=this._initPTS,i=this._PTSNormalize,l=a.inputTimeScale||b.inputTimeScale,m=1/0,n=1/0,o=a.samples;if(o.length&&(m=n=i(o[0].pts-l*e,h)),o=b.samples,o.length){var p=o[0];m=Math.min(m,i(p.pts-l*e,h)),n=Math.min(n,i(p.dts-l*e,h))}if(m!==1/0){var q=h-m;Math.abs(q)>10*l&&(k.logger.warn("timestamp inconsistency, "+(q/l).toFixed(3)+"s delta against expected value: missing discontinuity ? reset initPTS/initDTS"),this._initPTS=m,this._initDTS=n,this.observer.trigger(j["default"].INIT_PTS_FOUND,{initPTS:m}))}}}else this.generateIS(a,b,e);if(this.ISGenerated)if(a.samples.length){a.timescale||(k.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(a,b,e));var r=this.remuxAudio(a,e,f,g);if(b.samples.length){var s=void 0;r&&(s=r.endPTS-r.startPTS),b.timescale||(k.logger.warn("regenerate InitSegment as video detected"),this.generateIS(a,b,e)),this.remuxVideo(b,e,f,s,g)}}else{var t=void 0;b.samples.length&&(t=this.remuxVideo(b,e,f,g)),t&&a.codec&&this.remuxEmptyAudio(a,e,f,t)}c.samples.length&&this.remuxID3(c,e),d.samples.length&&this.remuxText(d,e),this.observer.trigger(j["default"].FRAG_PARSED)}},{key:"generateIS",value:function(a,b,c){var d,e,f=this.observer,g=a.samples,h=b.samples,i=this.typeSupported,l="audio/mp4",o={},p={tracks:o},q=void 0===this._initPTS;if(q&&(d=e=1/0),a.config&&g.length&&(a.timescale=a.samplerate,k.logger.log("audio sampling rate : "+a.samplerate),a.isAAC||(i.mpeg?(l="audio/mpeg",a.codec=""):i.mp3&&(a.codec="mp3")),o.audio={container:l,codec:a.codec,initSegment:!a.isAAC&&i.mpeg?new Uint8Array:m["default"].initSegment([a]),metadata:{channelCount:a.channelCount}},q&&(d=e=g[0].pts-a.inputTimeScale*c)),b.sps&&b.pps&&h.length){var r=b.inputTimeScale;b.timescale=r,o.video={container:"video/mp4",codec:b.codec,initSegment:m["default"].initSegment([b]),metadata:{width:b.width,height:b.height}},q&&(d=Math.min(d,h[0].pts-r*c),e=Math.min(e,h[0].dts-r*c),this.observer.trigger(j["default"].INIT_PTS_FOUND,{initPTS:d}))}Object.keys(o).length?(f.trigger(j["default"].FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,q&&(this._initPTS=d,this._initDTS=e)):f.trigger(j["default"].ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(a,b,c,d,e){var f,g,h,i,l,o,p,q,r=8,s=a.timescale,t=a.samples,u=[],v=t.length,w=this._PTSNormalize,x=this._initDTS,y=this.nextAvcDts,z=this.isSafari;z&&(c|=t.length&&y&&(e&&Math.abs(b-y/s)<.1||Math.abs(t[0].pts-y-x)<s/5)),c||(y=b*s),t.forEach(function(a){a.pts=w(a.pts-x,y),a.dts=w(a.dts-x,y)}),t.sort(function(a,b){var c=a.dts-b.dts,d=a.pts-b.pts;return c?c:d?d:a.id-b.id});var A=t.reduce(function(a,b){return Math.max(Math.min(a,b.pts-b.dts),-18e3)},0);if(A<0){k.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(A/90)+" ms to overcome this issue");for(var B=0;B<t.length;B++)t[B].dts+=A}var C=t[0];l=Math.max(C.dts,0),i=Math.max(C.pts,0);var D=Math.round((l-y)/90);c&&D&&(D>1?k.logger.log("AVC:"+D+" ms hole between fragments detected,filling it"):D<-1&&k.logger.log("AVC:"+-D+" ms overlapping between fragments detected"),l=y,t[0].dts=l,i=Math.max(i-D,y),t[0].pts=i,k.logger.log("Video/PTS/DTS adjusted: "+Math.round(i/90)+"/"+Math.round(l/90)+",delta:"+D+" ms")),o=l,C=t[t.length-1],q=Math.max(C.dts,0),p=Math.max(C.pts,0,q),z&&(f=Math.round((q-l)/(t.length-1)));for(var E=0,F=0,G=0;G<v;G++){for(var H=t[G],I=H.units,J=I.length,K=0,L=0;L<J;L++)K+=I[L].data.length;F+=K,E+=J,H.length=K,z?H.dts=l+G*f:H.dts=Math.max(H.dts,l),H.pts=Math.max(H.pts,H.dts)}var M=F+4*E+8;try{g=new Uint8Array(M)}catch(N){return void this.observer.trigger(j["default"].ERROR,{type:n.ErrorTypes.MUX_ERROR,details:n.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:M,reason:"fail allocating video mdat "+M})}var O=new DataView(g.buffer);O.setUint32(0,M),g.set(m["default"].types.mdat,4);for(var P=0;P<v;P++){for(var Q=t[P],R=Q.units,S=0,T=void 0,U=0,V=R.length;U<V;U++){var W=R[U],X=W.data,Y=W.data.byteLength;O.setUint32(r,Y),r+=4,g.set(X,r),r+=Y,S+=4+Y}if(z)T=Math.max(0,f*Math.round((Q.pts-Q.dts)/f));else{if(P<v-1)f=t[P+1].dts-Q.dts;else{var Z=this.config,$=Q.dts-t[P>0?P-1:P].dts;if(Z.stretchShortVideoTrack){var _=Z.maxBufferHole,aa=Z.maxSeekHole,ba=Math.floor(Math.min(_,aa)*s),ca=(d?i+d*s:this.nextAudioPts)-Q.pts;ca>ba?(f=ca-$,f<0&&(f=$),k.logger.log("It is approximately "+ca/90+" ms to the next segment; using duration "+f/90+" ms for the last video frame.")):f=$}else f=$}T=Math.round(Q.pts-Q.dts)}u.push({size:S,duration:f,cts:T,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:Q.key?2:1,isNonSync:Q.key?0:1}})}this.nextAvcDts=q+f;var da=a.dropped;if(a.len=0,a.nbNalu=0,a.dropped=0,u.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var ea=u[0].flags;ea.dependsOn=2,ea.isNonSync=0}a.samples=u,h=m["default"].moof(a.sequenceNumber++,l,a),a.samples=[];var fa={data1:h,data2:g,startPTS:i/s,endPTS:(p+f)/s,startDTS:l/s,endDTS:this.nextAvcDts/s,type:"video",nb:u.length,dropped:da};return this.observer.trigger(j["default"].FRAG_PARSING_DATA,fa),fa}},{key:"remuxAudio",value:function(a,b,c,d){var e,f,g,h,i,l,p,q=a.inputTimeScale,r=a.timescale,s=q/r,t=a.isAAC?1024:1152,u=t*s,v=this._PTSNormalize,w=this._initDTS,x=!a.isAAC&&this.typeSupported.mpeg,y=a.samples,z=[],A=this.nextAudioPts;if(c|=y.length&&A&&(d&&Math.abs(b-A/q)<.1||Math.abs(y[0].pts-A-w)<20*u),c||(A=b*q),y.forEach(function(a){a.pts=a.dts=v(a.pts-w,A)}),y.sort(function(a,b){return a.pts-b.pts}),d&&a.isAAC)for(var B=0,C=A;B<y.length;){var D,E=y[B],F=E.pts;D=F-C;var G=Math.abs(1e3*D/q);if(D<=-u)k.logger.warn("Dropping 1 audio frame @ "+(C/q).toFixed(3)+"s due to "+G+" ms overlap."),y.splice(B,1),a.len-=E.unit.length;else if(D>=u&&G<o&&C){var H=Math.round(D/u);k.logger.warn("Injecting "+H+" audio frame @ "+(C/q).toFixed(3)+"s due to "+Math.round(1e3*D/q)+" ms gap.");for(var I=0;I<H;I++){var J=Math.max(C,0);g||(k.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),g=E.unit.subarray()),y.splice(B,0,{unit:g,pts:J,dts:J}),a.len+=g.length,C+=u,B++}E.pts=E.dts=C,C+=u,B++}else Math.abs(D)>.1*u,E.pts=E.dts=C,C+=u,B++}for(var K=0,L=y.length;K<L;K++){var M=y[K],N=M.unit,O=M.pts;if(void 0!==p)f.duration=Math.round((O-p)/s);else{var P=Math.round(1e3*(O-A)/q),Q=0;if(c&&a.isAAC&&P){if(P>0&&P<o)Q=Math.round((O-A)/u),k.logger.log(P+" ms hole between AAC samples detected,filling it"),Q>0&&(g||(g=N.subarray()),a.len+=Q*g.length);else if(P<-12){k.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(A/q).toFixed(3)+"s/"+(O/q).toFixed(3)+"s/"+-P+"ms"),a.len-=N.byteLength;continue}O=A}if(l=Math.max(0,O),!(a.len>0))return;var R=x?a.len:a.len+8;e=x?0:8;try{h=new Uint8Array(R)}catch(S){return void this.observer.trigger(j["default"].ERROR,{type:n.ErrorTypes.MUX_ERROR,details:n.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:R,reason:"fail allocating audio mdat "+R})}if(!x){var T=new DataView(h.buffer);T.setUint32(0,R),h.set(m["default"].types.mdat,4)}for(var U=0;U<Q;U++)g||(k.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),g=N.subarray()),h.set(g,e),e+=g.byteLength,f={size:g.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},z.push(f)}h.set(N,e);var V=N.byteLength;e+=V,f={size:V,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},z.push(f),p=O}var W=0,X=z.length;if(X>=2&&(W=z[X-2].duration,f.duration=W),X){this.nextAudioPts=A=p+s*W,a.len=0,a.samples=z,i=x?new Uint8Array:m["default"].moof(a.sequenceNumber++,l/s,a),a.samples=[];var Y=l/q,Z=A/q,$={data1:i,data2:h,startPTS:Y,endPTS:Z,startDTS:Y,endDTS:Z,type:"audio",nb:X};return this.observer.trigger(j["default"].FRAG_PARSING_DATA,$),$}return null}},{key:"remuxEmptyAudio",value:function(a,b,c,d){var e=a.inputTimeScale,f=a.samplerate?a.samplerate:e,g=e/f,i=this.nextAudioPts,j=(void 0!==i?i:d.startDTS*e)+this._initDTS,l=d.endDTS*e+this._initDTS,m=1024,n=g*m,o=Math.ceil((l-j)/n),p=h["default"].getSilentFrame(a.manifestCodec||a.codec,a.channelCount);if(k.logger.warn("remux empty Audio"),!p)return void k.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");for(var q=[],r=0;r<o;r++){var s=j+r*n;q.push({unit:p,pts:s,dts:s}),a.len+=p.length}a.samples=q,this.remuxAudio(a,b,c)}},{key:"remuxID3",value:function(a,b){var c,d=a.samples.length,e=a.inputTimeScale,f=this._initPTS,g=this._initDTS;if(d){for(var h=0;h<d;h++)c=a.samples[h],c.pts=(c.pts-f)/e,c.dts=(c.dts-g)/e;this.observer.trigger(j["default"].FRAG_PARSING_METADATA,{samples:a.samples})}a.samples=[],b=b}},{key:"remuxText",value:function(a,b){a.samples.sort(function(a,b){return a.pts-b.pts});var c,d=a.samples.length,e=a.inputTimeScale,f=this._initPTS;if(d){for(var g=0;g<d;g++)c=a.samples[g],c.pts=(c.pts-f)/e;this.observer.trigger(j["default"].FRAG_PARSING_USERDATA,{samples:a.samples})}a.samples=[],b=b}},{key:"_PTSNormalize",value:function(a,b){var c;if(void 0===b)return a;for(c=b<a?-8589934592:8589934592;Math.abs(a-b)>4294967296;)a+=c;return a}}]),a}();c["default"]=p},{33:33,35:35,36:36,44:44,54:54}],46:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(35),h=d(g),i=function(){function a(b){e(this,a),this.observer=b}return f(a,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(){}},{key:"resetInitSegment",value:function(){}},{key:"remux",value:function(a,b,c,d,e,f,g,i){var j=this.observer,k="";a&&(k+="audio"),b&&(k+="video"),j.trigger(h["default"].FRAG_PARSING_DATA,{data1:i,startPTS:e,startDTS:e,type:k,nb:1,dropped:0}),j.trigger(h["default"].FRAG_PARSED)}}]),a}();c["default"]=i},{35:35}],47:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=/^(\d+)x(\d+)$/,g=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,h=function(){function a(b){d(this,a),"string"==typeof b&&(b=a.parseAttrList(b));for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c])}return e(a,[{key:"decimalInteger",value:function(a){var b=parseInt(this[a],10);return b>Number.MAX_SAFE_INTEGER?1/0:b}},{key:"hexadecimalInteger",value:function(a){if(this[a]){var b=(this[a]||"0x").slice(2);b=(1&b.length?"0":"")+b;for(var c=new Uint8Array(b.length/2),d=0;d<b.length/2;d++)c[d]=parseInt(b.slice(2*d,2*d+2),16);return c}return null}},{key:"hexadecimalIntegerAsNumber",value:function(a){var b=parseInt(this[a],16);return b>Number.MAX_SAFE_INTEGER?1/0:b}},{key:"decimalFloatingPoint",value:function(a){return parseFloat(this[a])}},{key:"enumeratedString",value:function(a){return this[a]}},{key:"decimalResolution",value:function(a){var b=f.exec(this[a]);if(null!==b)return{width:parseInt(b[1],10),height:parseInt(b[2],10)}}}],[{key:"parseAttrList",value:function(a){var b,c={};for(g.lastIndex=0;null!==(b=g.exec(a));){var d=b[2],e='"';0===d.indexOf(e)&&d.lastIndexOf(e)===d.length-1&&(d=d.slice(1,-1)),c[b[1]]=d}return c}}]),a}();c["default"]=h},{}],48:[function(a,b,c){"use strict";var d={search:function(a,b){for(var c=0,d=a.length-1,e=null,f=null;c<=d;){e=(c+d)/2|0,f=a[e];var g=b(f);if(g>0)c=e+1;else{if(!(g<0))return f;d=e-1}}return null}};b.exports=d},{}],49:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},g=function(a){var b=a;return f.hasOwnProperty(a)&&(b=f[a]),String.fromCharCode(b)},h=15,i=100,j={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},k={17:2,18:4,21:6,22:8,23:10,19:13,20:15},l={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},m={25:2,26:4,29:6,30:8,31:10,27:13,28:15},n=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],o={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(a){this.time=a},log:function(a,b){var c=this.verboseFilter[a];this.verboseLevel>=c}},p=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].toString(16));return b},q=function(){function a(b,c,e,f,g){d(this,a),this.foreground=b||"white",this.underline=c||!1,this.italics=e||!1,this.background=f||"black",this.flash=g||!1}return e(a,[{key:"reset",value:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}},{key:"setStyles",value:function(a){for(var b=["foreground","underline","italics","background","flash"],c=0;c<b.length;c++){var d=b[c];a.hasOwnProperty(d)&&(this[d]=a[d])}}},{key:"isDefault",value:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}},{key:"equals",value:function(a){return this.foreground===a.foreground&&this.underline===a.underline&&this.italics===a.italics&&this.background===a.background&&this.flash===a.flash}},{key:"copy",value:function(a){this.foreground=a.foreground,this.underline=a.underline,this.italics=a.italics,this.background=a.background,this.flash=a.flash}},{key:"toString",value:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}]),a}(),r=function(){function a(b,c,e,f,g,h){d(this,a),this.uchar=b||" ",this.penState=new q(c,e,f,g,h)}return e(a,[{key:"reset",value:function(){this.uchar=" ",this.penState.reset()}},{key:"setChar",value:function(a,b){this.uchar=a,this.penState.copy(b)}},{key:"setPenState",value:function(a){this.penState.copy(a)}},{key:"equals",value:function(a){return this.uchar===a.uchar&&this.penState.equals(a.penState)}},{key:"copy",value:function(a){this.uchar=a.uchar,this.penState.copy(a.penState)}},{key:"isEmpty",value:function(){return" "===this.uchar&&this.penState.isDefault()}}]),a}(),s=function(){function a(){d(this,a),this.chars=[];for(var b=0;b<i;b++)this.chars.push(new r);this.pos=0,this.currPenState=new q}return e(a,[{key:"equals",value:function(a){for(var b=!0,c=0;c<i;c++)if(!this.chars[c].equals(a.chars[c])){b=!1;break}return b}},{key:"copy",value:function(a){for(var b=0;b<i;b++)this.chars[b].copy(a.chars[b])}},{key:"isEmpty",value:function(){for(var a=!0,b=0;b<i;b++)if(!this.chars[b].isEmpty()){a=!1;break}return a}},{key:"setCursor",value:function(a){this.pos!==a&&(this.pos=a),this.pos<0?(o.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>i&&(o.log("ERROR","Too large cursor position "+this.pos),this.pos=i)}},{key:"moveCursor",value:function(a){var b=this.pos+a;if(a>1)for(var c=this.pos+1;c<b+1;c++)this.chars[c].setPenState(this.currPenState);this.setCursor(b)}},{key:"backSpace",value:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}},{key:"insertChar",value:function(a){a>=144&&this.backSpace();var b=g(a);return this.pos>=i?void o.log("ERROR","Cannot insert "+a.toString(16)+" ("+b+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(b,this.currPenState),void this.moveCursor(1))}},{key:"clearFromPos",value:function(a){var b;for(b=a;b<i;b++)this.chars[b].reset()}},{key:"clear",value:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}},{key:"clearToEndOfRow",value:function(){this.clearFromPos(this.pos)}},{key:"getTextString",value:function(){for(var a=[],b=!0,c=0;c<i;c++){var d=this.chars[c].uchar;" "!==d&&(b=!1),a.push(d)}return b?"":a.join("")}},{key:"setPenStyles",value:function(a){this.currPenState.setStyles(a);var b=this.chars[this.pos];b.setPenState(this.currPenState)}}]),a}(),t=function(){function a(){d(this,a),this.rows=[];for(var b=0;b<h;b++)this.rows.push(new s);this.currRow=h-1,this.nrRollUpRows=null,this.reset()}return e(a,[{key:"reset",value:function(){for(var a=0;a<h;a++)this.rows[a].clear();this.currRow=h-1}},{key:"equals",value:function(a){for(var b=!0,c=0;c<h;c++)if(!this.rows[c].equals(a.rows[c])){b=!1;break}return b}},{key:"copy",value:function(a){for(var b=0;b<h;b++)this.rows[b].copy(a.rows[b])}},{key:"isEmpty",value:function(){for(var a=!0,b=0;b<h;b++)if(!this.rows[b].isEmpty()){a=!1;break}return a}},{key:"backSpace",value:function(){var a=this.rows[this.currRow];a.backSpace()}},{key:"clearToEndOfRow",value:function(){var a=this.rows[this.currRow];a.clearToEndOfRow()}},{key:"insertChar",value:function(a){var b=this.rows[this.currRow];b.insertChar(a)}},{key:"setPen",value:function(a){var b=this.rows[this.currRow];b.setPenStyles(a)}},{key:"moveCursor",value:function(a){var b=this.rows[this.currRow];b.moveCursor(a)}},{key:"setCursor",value:function(a){o.log("INFO","setCursor: "+a);var b=this.rows[this.currRow];b.setCursor(a)}},{key:"setPAC",value:function(a){o.log("INFO","pacData = "+JSON.stringify(a));var b=a.row-1;if(this.nrRollUpRows&&b<this.nrRollUpRows-1&&(b=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==b){for(var c=0;c<h;c++)this.rows[c].clear();var d=this.currRow+1-this.nrRollUpRows,e=this.lastOutputScreen;if(e){var f=e.rows[d].cueStartTime;if(f&&f<o.time)for(var g=0;g<this.nrRollUpRows;g++)this.rows[b-this.nrRollUpRows+g+1].copy(e.rows[d+g])}}this.currRow=b;var i=this.rows[this.currRow];if(null!==a.indent){var j=a.indent,k=Math.max(j-1,0);i.setCursor(a.indent),a.color=i.chars[k].penState.foreground}var l={foreground:a.color,underline:a.underline,italics:a.italics,background:"black",flash:!1};this.setPen(l)}},{key:"setBkgData",value:function(a){o.log("INFO","bkgData = "+JSON.stringify(a)),this.backSpace(),this.setPen(a),this.insertChar(32)}},{key:"setRollUpRows",value:function(a){this.nrRollUpRows=a}},{key:"rollUp",value:function(){if(null===this.nrRollUpRows)return void o.log("DEBUG","roll_up but nrRollUpRows not set yet");o.log("TEXT",this.getDisplayText());var a=this.currRow+1-this.nrRollUpRows,b=this.rows.splice(a,1)[0];b.clear(),this.rows.splice(this.currRow,0,b),o.log("INFO","Rolling up")}},{key:"getDisplayText",value:function(a){a=a||!1;for(var b=[],c="",d=-1,e=0;e<h;e++){var f=this.rows[e].getTextString();f&&(d=e+1,a?b.push("Row "+d+": '"+f+"'"):b.push(f.trim()))}return b.length>0&&(c=a?"["+b.join(" | ")+"]":b.join("\n")),c}},{key:"getTextAndFormat",value:function(){return this.rows}}]),a}(),u=function(){function a(b,c){d(this,a),this.chNr=b,this.outputFilter=c,this.mode=null,this.verbose=0,this.displayedMemory=new t,this.nonDisplayedMemory=new t,this.lastOutputScreen=new t,this.currRollUpRow=this.displayedMemory.rows[h-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return e(a,[{key:"reset",value:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[h-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null}},{key:"getHandler",value:function(){return this.outputFilter}},{key:"setHandler",value:function(a){this.outputFilter=a}},{key:"setPAC",value:function(a){this.writeScreen.setPAC(a)}},{key:"setBkgData",value:function(a){this.writeScreen.setBkgData(a)}},{key:"setMode",value:function(a){a!==this.mode&&(this.mode=a,o.log("INFO","MODE="+a),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=a)}},{key:"insertChars",value:function(a){for(var b=0;b<a.length;b++)this.writeScreen.insertChar(a[b]);var c=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";o.log("INFO",c+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(o.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}},{key:"ccRCL",value:function(){o.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}},{key:"ccBS",value:function(){o.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}},{key:"ccAOF",value:function(){}},{key:"ccAON",value:function(){}},{key:"ccDER",value:function(){o.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}},{key:"ccRU",value:function(a){o.log("INFO","RU("+a+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(a)}},{key:"ccFON",value:function(){o.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})}},{key:"ccRDC",value:function(){o.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}},{key:"ccTR",value:function(){o.log("INFO","TR"),this.setMode("MODE_TEXT")}},{key:"ccRTD",value:function(){o.log("INFO","RTD"),this.setMode("MODE_TEXT")}},{key:"ccEDM",value:function(){o.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()}},{key:"ccCR",value:function(){o.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()}},{key:"ccENM",value:function(){o.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}},{key:"ccEOC",value:function(){if(o.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var a=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=a,this.writeScreen=this.nonDisplayedMemory,o.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()}},{key:"ccTO",value:function(a){o.log("INFO","TO("+a+") - Tab Offset"),this.writeScreen.moveCursor(a)}},{key:"ccMIDROW",value:function(a){var b={flash:!1};if(b.underline=a%2===1,b.italics=a>=46,b.italics)b.foreground="white";else{var c=Math.floor(a/2)-16,d=["white","green","blue","cyan","red","yellow","magenta"];b.foreground=d[c]}o.log("INFO","MIDROW: "+JSON.stringify(b)),this.writeScreen.setPen(b)}},{key:"outputDataUpdate",value:function(){var a=o.time;null!==a&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(a,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,a,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:a):this.cueStartTime=a,this.lastOutputScreen.copy(this.displayedMemory))}},{key:"cueSplitAtTime",value:function(a){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,a,this.displayedMemory),this.cueStartTime=a))}}]),a}(),v=function(){function a(b,c,e){d(this,a),this.field=b||1,this.outputs=[c,e],this.channels=[new u(1,c),new u(2,e)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,"char":0,cmd:0,other:0}}return e(a,[{key:"getHandler",value:function(a){return this.channels[a].getHandler()}},{key:"setHandler",value:function(a,b){this.channels[a].setHandler(b)}},{key:"addData",value:function(a,b){var c,d,e,f=!1;this.lastTime=a,o.setTime(a);for(var g=0;g<b.length;g+=2)if(d=127&b[g],e=127&b[g+1],0!==d||0!==e){if(o.log("DATA","["+p([b[g],b[g+1]])+"] -> ("+p([d,e])+")"),c=this.parseCmd(d,e),c||(c=this.parseMidrow(d,e)),c||(c=this.parsePAC(d,e)),c||(c=this.parseBackgroundAttributes(d,e)),!c&&(f=this.parseChars(d,e)))if(this.currChNr&&this.currChNr>=0){var h=this.channels[this.currChNr-1];h.insertChars(f)}else o.log("WARNING","No channel found yet. TEXT-MODE?");c?this.dataCounters.cmd+=2:f?this.dataCounters["char"]+=2:(this.dataCounters.other+=2,o.log("WARNING","Couldn't parse cleaned data "+p([d,e])+" orig: "+p([b[g],b[g+1]])))}else this.dataCounters.padding+=2}},{key:"parseCmd",value:function(a,b){var c=null,d=(20===a||28===a)&&32<=b&&b<=47,e=(23===a||31===a)&&33<=b&&b<=35;if(!d&&!e)return!1;if(a===this.lastCmdA&&b===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,o.log("DEBUG","Repeated command ("+p([a,b])+") is dropped"),!0;c=20===a||23===a?1:2;var f=this.channels[c-1];return 20===a||28===a?32===b?f.ccRCL():33===b?f.ccBS():34===b?f.ccAOF():35===b?f.ccAON():36===b?f.ccDER():37===b?f.ccRU(2):38===b?f.ccRU(3):39===b?f.ccRU(4):40===b?f.ccFON():41===b?f.ccRDC():42===b?f.ccTR():43===b?f.ccRTD():44===b?f.ccEDM():45===b?f.ccCR():46===b?f.ccENM():47===b&&f.ccEOC():f.ccTO(b-32),this.lastCmdA=a,this.lastCmdB=b,this.currChNr=c,!0}},{key:"parseMidrow",value:function(a,b){var c=null;if((17===a||25===a)&&32<=b&&b<=47){if(c=17===a?1:2,c!==this.currChNr)return o.log("ERROR","Mismatch channel in midrow parsing"),!1;var d=this.channels[c-1];return d.ccMIDROW(b),o.log("DEBUG","MIDROW ("+p([a,b])+")"),!0}return!1}},{key:"parsePAC",value:function(a,b){var c=null,d=null,e=(17<=a&&a<=23||25<=a&&a<=31)&&64<=b&&b<=127,f=(16===a||24===a)&&64<=b&&b<=95;if(!e&&!f)return!1;if(a===this.lastCmdA&&b===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;c=a<=23?1:2,d=64<=b&&b<=95?1===c?j[a]:l[a]:1===c?k[a]:m[a];var g=this.interpretPAC(d,b),h=this.channels[c-1];return h.setPAC(g),this.lastCmdA=a,this.lastCmdB=b,this.currChNr=c,!0}},{key:"interpretPAC",value:function(a,b){var c=b,d={color:null,italics:!1,indent:null,underline:!1,row:a};return c=b>95?b-96:b-64,d.underline=1===(1&c),c<=13?d.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(c/2)]:c<=15?(d.italics=!0,d.color="white"):d.indent=4*Math.floor((c-16)/2),d}},{key:"parseChars",value:function(a,b){var c=null,d=null,e=null;if(a>=25?(c=2,e=a-8):(c=1,e=a),17<=e&&e<=19){var f=b;f=17===e?b+80:18===e?b+112:b+144,o.log("INFO","Special char '"+g(f)+"' in channel "+c),d=[f]}else 32<=a&&a<=127&&(d=0===b?[a]:[a,b]);if(d){var h=p(d);o.log("DEBUG","Char codes =  "+h.join(",")),this.lastCmdA=null,this.lastCmdB=null}return d}},{key:"parseBackgroundAttributes",value:function(a,b){var c,d,e,f,g=(16===a||24===a)&&32<=b&&b<=47,h=(23===a||31===a)&&45<=b&&b<=47;return!(!g&&!h)&&(c={},16===a||24===a?(d=Math.floor((b-32)/2),c.background=n[d],b%2===1&&(c.background=c.background+"_semi")):45===b?c.background="transparent":(c.foreground="black",47===b&&(c.underline=!0)),e=a<24?1:2,f=this.channels[e-1],f.setBkgData(c),this.lastCmdA=null,this.lastCmdB=null,!0)}},{key:"reset",value:function(){for(var a=0;a<this.channels.length;a++)this.channels[a]&&this.channels[a].reset();this.lastCmdA=null,this.lastCmdB=null}},{key:"cueSplitAtTime",
value:function(a){for(var b=0;b<this.channels.length;b++)this.channels[b]&&this.channels[b].cueSplitAtTime(a)}}]),a}();c["default"]=v},{}],50:[function(a,b,c){"use strict";var d=a(57),e={newCue:function(a,b,c,e){for(var f,g,h,i,j,k=window.VTTCue||window.TextTrackCue,l=0;l<e.rows.length;l++)if(f=e.rows[l],h=!0,i=0,j="",!f.isEmpty()){for(var m=0;m<f.chars.length;m++)f.chars[m].uchar.match(/\s/)&&h?i++:(j+=f.chars[m].uchar,h=!1);f.cueStartTime=b,b===c&&(c+=1e-4),g=new k(b,c,(0,d.fixLineBreaks)(j.trim())),i>=16?i--:i++,navigator.userAgent.match(/Firefox\//)?g.line=l+1:g.line=l>7?l-2:l+1,g.align="left",g.position=Math.max(0,Math.min(100,100*(i/32)+(navigator.userAgent.match(/Firefox\//)?50:0))),a.addCue(g)}}};b.exports=e},{57:57}],51:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){return g["default"].search(a,function(a){return a.cc<b?1:a.cc>b?-1:0})}Object.defineProperty(c,"__esModule",{value:!0}),c.findFragWithCC=e;var f=a(48),g=d(f)},{48:48}],52:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(53),h=d(g),i=function(){function a(b,c,d,f){e(this,a),this.hls=b,this.defaultEstimate_=f,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new h["default"](c),this.fast_=new h["default"](d)}return f(a,[{key:"sample",value:function(a,b){a=Math.max(a,this.minDelayMs_);var c=8e3*b/a,d=a/1e3;this.fast_.sample(d,c),this.slow_.sample(d,c)}},{key:"canEstimate",value:function(){var a=this.fast_;return a&&a.getTotalWeight()>=this.minWeight_}},{key:"getEstimate",value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:"destroy",value:function(){}}]),a}();c["default"]=i},{53:53}],53:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this.alpha_=b?Math.exp(Math.log(.5)/b):0,this.estimate_=0,this.totalWeight_=0}return e(a,[{key:"sample",value:function(a,b){var c=Math.pow(this.alpha_,a);this.estimate_=b*(1-c)+c*this.estimate_,this.totalWeight_+=a}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var a=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/a}return this.estimate_}}]),a}();c["default"]=f},{}],54:[function(a,b,c){"use strict";function d(){}function e(a,b){return b="["+a+"] > "+b}function f(a){var b=self.console[a];return b?function(){for(var c=arguments.length,d=Array(c),f=0;f<c;f++)d[f]=arguments[f];d[0]&&(d[0]=e(a,d[0])),b.apply(self.console,d)}:d}function g(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];c.forEach(function(b){j[b]=a[b]?a[b].bind(a):f(b)})}Object.defineProperty(c,"__esModule",{value:!0});var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},i={trace:d,debug:d,log:d,warn:d,info:d,error:d},j=i;c.enableLogs=function(a){if(a===!0||"object"===("undefined"==typeof a?"undefined":h(a))){g(a,"debug","log","info","warn","error");try{j.log()}catch(b){j=i}}else j=i},c.logger=j},{}],55:[function(a,b,c){"use strict";var d={toString:function(a){for(var b="",c=a.length,d=0;d<c;d++)b+="["+a.start(d).toFixed(3)+","+a.end(d).toFixed(3)+"]";return b}};b.exports=d},{}],56:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c["default"]=function(){function a(a){if("string"!=typeof a)return!1;var b=f[a.toLowerCase()];return!!b&&a.toLowerCase()}function b(a){if("string"!=typeof a)return!1;var b=g[a.toLowerCase()];return!!b&&a.toLowerCase()}function c(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)a[d]=c[d]}return a}function d(d,f,g){var h=this,i=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),j={};i?h=document.createElement("custom"):j.enumerable=!0,h.hasBeenReset=!1;var k="",l=!1,m=d,n=f,o=g,p=null,q="",r=!0,s="auto",t="start",u=50,v="middle",w=50,x="middle";if(Object.defineProperty(h,"id",c({},j,{get:function(){return k},set:function(a){k=""+a}})),Object.defineProperty(h,"pauseOnExit",c({},j,{get:function(){return l},set:function(a){l=!!a}})),Object.defineProperty(h,"startTime",c({},j,{get:function(){return m},set:function(a){if("number"!=typeof a)throw new TypeError("Start time must be set to a number.");m=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",c({},j,{get:function(){return n},set:function(a){if("number"!=typeof a)throw new TypeError("End time must be set to a number.");n=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",c({},j,{get:function(){return o},set:function(a){o=""+a,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",c({},j,{get:function(){return p},set:function(a){p=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",c({},j,{get:function(){return q},set:function(b){var c=a(b);if(c===!1)throw new SyntaxError("An invalid or illegal string was specified.");q=c,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",c({},j,{get:function(){return r},set:function(a){r=!!a,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",c({},j,{get:function(){return s},set:function(a){if("number"!=typeof a&&a!==e)throw new SyntaxError("An invalid number or illegal string was specified.");s=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",c({},j,{get:function(){return t},set:function(a){var c=b(a);if(!c)throw new SyntaxError("An invalid or illegal string was specified.");t=c,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",c({},j,{get:function(){return u},set:function(a){if(a<0||a>100)throw new Error("Position must be between 0 and 100.");u=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",c({},j,{get:function(){return v},set:function(a){var c=b(a);if(!c)throw new SyntaxError("An invalid or illegal string was specified.");v=c,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",c({},j,{get:function(){return w},set:function(a){if(a<0||a>100)throw new Error("Size must be between 0 and 100.");w=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",c({},j,{get:function(){return x},set:function(a){var c=b(a);if(!c)throw new SyntaxError("An invalid or illegal string was specified.");x=c,this.hasBeenReset=!0}})),h.displayState=void 0,i)return h}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e="auto",f={"":!0,lr:!0,rl:!0},g={start:!0,middle:!0,end:!0,left:!0,right:!0};return d.prototype.getCueAsHTML=function(){var a=window.WebVTT;return a.convertCueToDOMTree(window,this.text)},d}()},{}],57:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new m,this.regionList=[]}function f(a){function b(a,b,c,d){return 3600*(0|a)+60*(0|b)+(0|c)+(0|d)/1e3}var c=a.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return c?c[3]?b(c[1],c[2],c[3].replace(":",""),c[4]):c[1]>59?b(c[1],c[2],0,c[4]):b(0,c[1],c[2],c[4]):null}function g(){this.values=Object.create(null)}function h(a,b,c,d){var e=d?a.split(d):[a];for(var f in e)if("string"==typeof e[f]){var g=e[f].split(c);if(2===g.length){var h=g[0],i=g[1];b(h,i)}}}function i(a,b,c){function d(){var b=f(a);if(null===b)throw new Error("Malformed timestamp: "+j);return a=a.replace(/^[^\sa-zA-Z-]+/,""),b}function e(a,b){var d=new g;h(a,function(a,b){switch(a){case"region":for(var e=c.length-1;e>=0;e--)if(c[e].id===b){d.set(a,c[e].region);break}break;case"vertical":d.alt(a,b,["rl","lr"]);break;case"line":var f=b.split(","),g=f[0];d.integer(a,g),d.percent(a,g)&&d.set("snapToLines",!1),d.alt(a,g,["auto"]),2===f.length&&d.alt("lineAlign",f[1],["start",o,"end"]);break;case"position":f=b.split(","),d.percent(a,f[0]),2===f.length&&d.alt("positionAlign",f[1],["start",o,"end","line-left","line-right","auto"]);break;case"size":d.percent(a,b);break;case"align":d.alt(a,b,["start",o,"end","left","right"])}},/:/,/\s/),b.region=d.get("region",null),b.vertical=d.get("vertical","");var e=d.get("line","auto");"auto"===e&&n.line===-1&&(e=-1),b.line=e,b.lineAlign=d.get("lineAlign","start"),b.snapToLines=d.get("snapToLines",!0),b.size=d.get("size",100),b.align=d.get("align",o);var f=d.get("position","auto");"auto"===f&&50===n.position&&(f="start"===b.align||"left"===b.align?0:"end"===b.align||"right"===b.align?100:50),b.position=f}function i(){a=a.replace(/^\s+/,"")}var j=a;if(i(),b.startTime=d(),i(),"-->"!==a.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+j);a=a.substr(3),i(),b.endTime=d(),i(),e(a,b)}function j(a){return a.replace(/<br(?: \/)?>/gi,"\n")}Object.defineProperty(c,"__esModule",{value:!0}),c.fixLineBreaks=void 0;var k=a(56),l=d(k),m=function(){return{decode:function(a){if(!a)return"";if("string"!=typeof a)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(a))}}};g.prototype={set:function(a,b){this.get(a)||""===b||(this.values[a]=b)},get:function(a,b,c){return c?this.has(a)?this.values[a]:b[c]:this.has(a)?this.values[a]:b},has:function(a){return a in this.values},alt:function(a,b,c){for(var d=0;d<c.length;++d)if(b===c[d]){this.set(a,b);break}},integer:function(a,b){/^-?\d+$/.test(b)&&this.set(a,parseInt(b,10))},percent:function(a,b){var c;return!!((c=b.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(b=parseFloat(b),b>=0&&b<=100))&&(this.set(a,b),!0)}};var n=new l["default"](0,0,0),o="middle"===n.align?"middle":"center";e.prototype={parse:function(a){function b(){var a=d.buffer,b=0;for(a=j(a);b<a.length&&"\r"!==a[b]&&"\n"!==a[b];)++b;var c=a.substr(0,b);return"\r"===a[b]&&++b,"\n"===a[b]&&++b,d.buffer=a.substr(b),c}function c(a){h(a,function(a,b){switch(a){case"Region":}},/:/)}var d=this;a&&(d.buffer+=d.decoder.decode(a,{stream:!0}));try{var e;if("INITIAL"===d.state){if(!/\r\n|\n/.test(d.buffer))return this;e=b();var f=e.match(/^WEBVTT([ \t].*)?$/);if(!f||!f[0])throw new Error("Malformed WebVTT signature.");d.state="HEADER"}for(var g=!1;d.buffer;){if(!/\r\n|\n/.test(d.buffer))return this;switch(g?g=!1:e=b(),d.state){case"HEADER":/:/.test(e)?c(e):e||(d.state="ID");continue;case"NOTE":e||(d.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){d.state="NOTE";break}if(!e)continue;if(d.cue=new l["default"](0,0,""),d.state="CUE",e.indexOf("-->")===-1){d.cue.id=e;continue}case"CUE":try{i(e,d.cue,d.regionList)}catch(k){d.cue=null,d.state="BADCUE";continue}d.state="CUETEXT";continue;case"CUETEXT":var m=e.indexOf("-->")!==-1;if(!e||m&&(g=!0)){d.oncue&&d.oncue(d.cue),d.cue=null,d.state="ID";continue}d.cue.text&&(d.cue.text+="\n"),d.cue.text+=e;continue;case"BADCUE":e||(d.state="ID");continue}}}catch(k){"CUETEXT"===d.state&&d.cue&&d.oncue&&d.oncue(d.cue),d.cue=null,d.state="INITIAL"===d.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var a=this;try{if(a.buffer+=a.decoder.decode(),(a.cue||"HEADER"===a.state)&&(a.buffer+="\n\n",a.parse()),"INITIAL"===a.state)throw new Error("Malformed WebVTT signature.")}catch(b){throw b}return a.onflush&&a.onflush(),this}},c.fixLineBreaks=j,c["default"]=e},{56:56}],58:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}var e=a(57),f=d(e),g=function(a,b,c){return a.substr(c||0,b.length)===b},h=function(a){var b=parseInt(a.substr(-3)),c=parseInt(a.substr(-6,2)),d=parseInt(a.substr(-9,2)),e=a.length>9?parseInt(a.substr(0,a.indexOf(":"))):0;return isNaN(b)||isNaN(c)||isNaN(d)||isNaN(e)?-1:(b+=1e3*c,b+=6e4*d,b+=36e5*e)},i=function l(a){for(var l=5381,b=a.length;b;)l=33*l^a.charCodeAt(--b);return(l>>>0).toString()},j=function(a,b,c){var d=a[b],e=a[d.prevCC];if(!e||!e["new"]&&d["new"])return a.ccOffset=a.presentationOffset=d.start,void(d["new"]=!1);for(;e&&e["new"];)a.ccOffset+=d.start-e.start,d["new"]=!1,d=e,e=a[d.prevCC];a.presentationOffset=c},k={parse:function(a,b,c,d,e,k){var l=/\r\n|\n\r|\n|\r/g,m=String.fromCharCode.apply(null,new Uint8Array(a)).trim().replace(l,"\n").split("\n"),n="00:00.000",o=0,p=0,q=0,r=[],s=void 0,t=!0,u=new f["default"];u.oncue=function(a){var b=c[d],e=c.ccOffset;b&&b["new"]&&(void 0!==p?e=c.ccOffset=b.start:j(c,d,q)),q&&(e=q+c.ccOffset-c.presentationOffset),a.startTime+=e-p,a.endTime+=e-p,a.id=i(a.startTime)+i(a.endTime)+i(a.text),a.text=decodeURIComponent(escape(a.text)),a.endTime>0&&r.push(a)},u.onparsingerror=function(a){s=a},u.onflush=function(){return s&&k?void k(s):void e(r)},m.forEach(function(a){if(t){if(g(a,"X-TIMESTAMP-MAP=")){t=!1,a.substr(16).split(",").forEach(function(a){g(a,"LOCAL:")?n=a.substr(6):g(a,"MPEGTS:")&&(o=parseInt(a.substr(7)))});try{b=b<0?b+8589934592:b,o-=b,p=h(n)/1e3,q=o/9e4,p===-1&&(s=new Error("Malformed X-TIMESTAMP-MAP: "+a))}catch(c){s=new Error("Malformed X-TIMESTAMP-MAP: "+a)}return}""===a&&(t=!1)}u.parse(a+"\n")}),u.flush()}};b.exports=k},{57:57}],59:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a(54),g=function(){function a(b){d(this,a),b&&b.xhrSetup&&(this.xhrSetup=b.xhrSetup)}return e(a,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var a=this.loader;a&&4!==a.readyState&&(this.stats.aborted=!0,a.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"load",value:function(a,b,c){this.context=a,this.config=b,this.callbacks=c,this.stats={trequest:performance.now(),retry:0},this.retryDelay=b.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var a,b=this.context;a="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest;var c=this.stats;c.tfirst=0,c.loaded=0;var d=this.xhrSetup;try{if(d)try{d(a,b.url)}catch(e){a.open("GET",b.url,!0),d(a,b.url)}a.readyState||a.open("GET",b.url,!0)}catch(e){return void this.callbacks.onError({code:a.status,text:e.message},b,a)}b.rangeEnd&&a.setRequestHeader("Range","bytes="+b.rangeStart+"-"+(b.rangeEnd-1)),a.onreadystatechange=this.readystatechange.bind(this),a.onprogress=this.loadprogress.bind(this),a.responseType=b.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),a.send()}},{key:"readystatechange",value:function(a){var b=a.currentTarget,c=b.readyState,d=this.stats,e=this.context,g=this.config;if(!d.aborted&&c>=2)if(window.clearTimeout(this.requestTimeout),0===d.tfirst&&(d.tfirst=Math.max(performance.now(),d.trequest)),4===c){var h=b.status;if(h>=200&&h<300){d.tload=Math.max(d.tfirst,performance.now());var i=void 0,j=void 0;"arraybuffer"===e.responseType?(i=b.response,j=i.byteLength):(i=b.responseText,j=i.length),d.loaded=d.total=j;var k={url:b.responseURL,data:i};this.callbacks.onSuccess(k,d,e,b)}else d.retry>=g.maxRetry||h>=400&&h<499?(f.logger.error(h+" while loading "+e.url),this.callbacks.onError({code:h,text:b.statusText},e,b)):(f.logger.warn(h+" while loading "+e.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,g.maxRetryDelay),d.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),g.timeout)}},{key:"loadtimeout",value:function(){f.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)}},{key:"loadprogress",value:function(a){var b=a.currentTarget,c=this.stats;c.loaded=a.loaded,a.lengthComputable&&(c.total=a.total);var d=this.callbacks.onProgress;d&&d(c,this.context,null,b)}}]),a}();c["default"]=g},{54:54}]},{},[40])(40)})}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(280)},49:function(a,b){!function(a){function b(){}function c(a){g=[a]}function d(a,b,c){return a&&a.apply(b.context||b,c)}function e(a){return/\?/.test(a)?"&":"?"}function f(f){function n(a){X++||(Y(),S&&(A[U]={s:[a]}),O&&(a=O.apply(f,[a])),d(L,f,[a,v,f]),d(N,f,[f,v]))}function F(a){X++||(Y(),S&&a!=w&&(A[U]=a),d(M,f,[f,a]),d(N,f,[f,a]))}f=a.extend({},C,f);var G,H,I,J,K,L=f.success,M=f.error,N=f.complete,O=f.dataFilter,P=f.callbackParameter,Q=f.callback,R=f.cache,S=f.pageCache,T=f.charset,U=f.url,V=f.data,W=f.timeout,X=0,Y=b;return y&&y(function(a){a.done(L).fail(M),L=a.resolve,M=a.reject}).promise(f),f.abort=function(){!X++&&Y()},d(f.beforeSend,f,[f])===!1||X?f:(U=U||j,V=V?"string"==typeof V?V:a.param(V,f.traditional):j,U+=V?e(U)+V:j,P&&(U+=e(U)+encodeURIComponent(P)+"=?"),!R&&!S&&(U+=e(U)+"_"+(new Date).getTime()+"="),U=U.replace(/=\?(&|$)/,"="+Q+"$1"),S&&(G=A[U])?G.s?n(G.s[0]):F(G):(x[Q]=c,I=a(u)[0],I.id=m+B++,T&&(I[i]=T),D&&D.version()<11.6?(J=a(u)[0]).text="document.getElementById('"+I.id+"')."+p+"()":I[h]=h,E&&(I.htmlFor=I.id,I.event=o),I[q]=I[p]=I[r]=function(a){if(!I[s]||!/i/.test(I[s])){try{I[o]&&I[o]()}catch(b){}a=g,g=0,a?n(a[0]):F(k)}},I.src=U,Y=function(a){K&&clearTimeout(K),I[r]=I[q]=I[p]=null,z[t](I),J&&z[t](J)},z[l](I,H=z.firstChild),J&&z[l](J,H),K=W>0&&setTimeout(function(){F(w)},W)),f)}var g,h="async",i="charset",j="",k="error",l="insertBefore",m="_jqjsp",n="on",o=n+"click",p=n+k,q=n+"load",r=n+"readystatechange",s="readyState",t="removeChild",u="<script>",v="success",w="timeout",x=window,y=a.Deferred,z=a("head")[0]||document.documentElement,A={},B=0,C={callback:m,url:location.href},D=x.opera,E=!!a("<div>").html("<!--[if IE]><i><![endif]-->").find("i").length;f.setup=function(b){a.extend(C,b)},a.jsonp=f}(Txplayer.$)},66:function(a,b){var c={unstarted:-1,ended:0,playing:1,paused:2,buffering:3,cued:4,stop:5},d={msd:"\u6d41\u7545180P",sd:"\u6807\u6e05270P",hd:"\u9ad8\u6e05480P",shd:"\u8d85\u6e05720P",fhd:"\u84dd\u51491080P",uhd:"4K"};a.exports={playerstate:c,definitionMap:d}},67:function(a,b){function c(a){var b={getinfo:["http://h5vv.video.qq.com/getinfo?callback=?","https://h5vv.video.qq.com/getinfo?callback=?"],edugetvinfo:["http://sv.video.qq.com/edugetvinfo?callback=?","https://sv.video.qq.com/edugetvinfo?callback=?"],mvgetinfo:["http://sv.video.qq.com/mvgetinfo?callback=?","https://sv.video.qq.com/mvgetinfo?callback=?"],getinfoInews:["http://h5wx.video.qq.com/getinfo?callback=?","https://h5wx.video.qq.com/getinfo?callback=?"],getvinfo:["http://h5vv.video.qq.com/getvinfo?callback=?","https://h5vv.video.qq.com/getvinfo?callback=?"],getkey:["http://h5vv.video.qq.com/getkey?callback=?","https://h5vv.video.qq.com/getkey?callback=?"],mvgetkey:["http://sv.video.qq.com/mvgetkey?callback=?","https://sv.video.qq.com/mvgetkey?callback=?"],getkeyInews:["http://h5wx.video.qq.com/getkey?callback=?","https://h5wx.video.qq.com/getkey?callback=?"],zb:["http://info.zb.video.qq.com/?callback=?","https://info.zb.video.qq.com/?callback=?"],rmd_mobile:["http://like.video.qq.com/fcgi-bin/rmd_mobile?callback=?","https://like.video.qq.com/fcgi-bin/rmd_mobile?callback=?"],like:["http://like.video.qq.com/fcgi-bin/like?","https://like.video.qq.com/fcgi-bin/like?"],dataout_ex:["http://sns.video.qq.com/fcgi-bin/dlib/dataout_ex?","https://sns.video.qq.com/fcgi-bin/dlib/dataout_ex?"],get_dtype:["http://h5vv.video.qq.com/getdtype?","https://h5vv.video.qq.com/getdtype?"]};return"https:"===window.location.protocol?b[a][1]:b[a][0]}function d(a){return e=Txplayer.$,this.context=a.context,this.init()}var e=Txplayer.$,f=Txplayer.util,g=f.AppHelper,h=[{reg:function(){return!!this.cfg.noAuth},request:function(a){var b=this;a.resolve({param:{vids:b.cfg.vid,defaultfmt:b.cfg.fmt}})}},{reg:function(){var a;return a=f.isInIframe()?f.getHostname(document.referrer):window.location.hostname,!!(a&&a.indexOf("weishi.qq.com")>-1)},request:function(a){a.resolve({param:{platform:"110701",sdtfrom:"v7015"}})}},{reg:function(){return!(!this.cfg.eduext&&!this.cfg.authext||location.href.indexOf("campus.qq.com")!==-1)},request:function(a){var b=this;a.resolve({cgi:c("edugetvinfo"),param:{eduext:b.cfg.eduext,platform:f.mobile?"261001":"260201",vid:b.cfg.vid,defn:b.cfg.fmt}})}},{reg:function(){return"kuaibao.qq.com"===location.hostname},request:function(a){var b=this;a.resolve({cgi:c("getinfo"),param:{platform:"570701",vid:b.cfg.vid,sdtfrom:"v7152"}})}},{reg:function(){return 1===this.cfg.classType},request:function(a){var b=this;a.resolve({cgi:c("edugetvinfo"),param:{platform:221001,vid:b.cfg.vid,defn:b.cfg.fmt}})}},{reg:function(){if(window!==top&&"v.qq.com"===location.hostname&&"/iframe/player.html"===location.pathname){var a=f.getParams(location.href);if(a&&a.cKey&&a.encryptVer&&a.platform)return this.params=a,!0}return!1},request:function(a){var b,d=this,e={cgi:c("getinfo"),param:{encryptVer:d.params.encryptVer,platform:d.params.platform,cKey:d.params.cKey,vids:d.cfg.vid,defaultfmt:d.cfg.fmt}};try{b=window.parent.location.href}catch(f){}b&&(e.param.wxrefer=b),a.resolve(e)}},{reg:function(){return!(!f.browser.mqq||"xiaoqu.qq.com"!==window.location.hostname&&"buluo.qq.com"!==window.location.hostname)},request:function(a){if(!window.getBrowserSignature)return void a.reject();var b=this;window.getBrowserSignature(b.cfg.vid,function(c){var d;if(c&&c.data)try{var e=JSON.parse(c.data);e&&e.result&&e.result.token&&(d=e.result.token)}catch(g){}d?a.resolve({param:{cKey:d,encryptVer:"6.4",platform:f.os.ios?"170408":"170308",vids:b.cfg.vid,defaultfmt:b.cfg.fmt}}):a.reject()})}},{reg:function(){return"qzs.qq.com"==window.location.hostname&&(window.location.href.indexOf("//qzs.qq.com/open/mobile")>-1||window.location.href.indexOf("//qzs.qq.com/open/yyb/")>-1)},request:function(a){a.resolve({param:{platform:"2730701",sdtfrom:"v7002"}})}},{reg:function(){return"viewlite.inews.qq.com"==window.location.hostname||"rl.inews.qq.com"==window.location.hostname||"album.sparta.html5.qq.com"==window.location.hostname},request:function(a){a.resolve({param:{platform:"5750701",sdtfrom:"v7003"}})}},{reg:function(){return!!(window.location.hostname&&window.location.hostname.indexOf("lexiangla.com")>-1)},request:function(a){a.resolve({param:{platform:"3570701",sdtfrom:"v7005"}})}},{reg:function(){return!(!f.browser.mqqbrowser||f.browser.mqq||f.browser.wechat||f.browser.qqdownloader||window!==top)},request:function(a){var b,d,h=this,i="undefined"!=typeof h.cfg.svr_time?h.cfg.svr_time+"":parseInt(+new Date/1e3)+"",j=function(){var b,d,e={vid:h.cfg.vid};e.timestamp=i,f.os.ios?(b=window.x5.ios.getBrowserSignature,d=f.os.ipad?e:"vid:"+e.vid+"["+e.timestamp+"]"):(b=window.x5.android.getBrowserSignature,d="vid:"+e.vid+"["+e.timestamp+"]"),b(d,function(b){var d;"object"==typeof b&&b.key&&b.ver&&b.platform?(d={cgi:c("getvinfo"),param:{cKey:b.key,encryptVer:b.ver,platform:b.platform,vid:h.cfg.vid,defn:h.cfg.fmt,cgiType:"getvinfo"}},a.resolve(d)):"object"==typeof b&&b.data?(d={cgi:c("getvinfo"),param:{cKey:b.data,encryptVer:"4.0",platform:"161001",vid:h.cfg.vid,defn:h.cfg.fmt,cgiType:"getvinfo"}},a.resolve(d)):"string"==typeof b?(d={cgi:c("getvinfo"),param:{cKey:b,encryptVer:"4.0",platform:"161001",vid:h.cfg.vid,defn:h.cfg.fmt,cgiType:"getvinfo"}},a.resolve(d)):a.reject()},function(){a.reject()})};b=window.x5&&window.x5.ios&&"function"===e.type(window.x5.ios.getBrowserSignature),d=window.x5&&"function"===e.type(window.x5.getBrowserSignature),b||d?j():g.loadMqqBrowserAPI().done(function(){b=window.x5&&window.x5.ios&&"function"===e.type(window.x5.ios.getBrowserSignature),d=window.x5&&"function"===e.type(window.x5.getBrowserSignature),b||d?j():a.reject()}).fail(function(){a.reject()})}},{reg:function(){return!!f.browser.kuaibao},request:function(a){var b,c,d,e=this,g=e.cfg.vid,h="undefined"!=typeof e.cfg.svr_time?e.cfg.svr_time+"":parseInt(+new Date/1e3)+"",i="TVP_KUAIBAO_CB_"+h.substr(-4,4);if(window.top!==window){try{var j=window.top.location.href;j&&(b=window.top,c=b.document)}catch(k){d=!0}if(d)return void a.reject()}else b=window,c=b.document;b[i]=function(b){var c;try{c=JSON.parse(b)}catch(d){}if(c&&c.key&&c.ver&&c.platform&&c.sdtfrom){var f={param:{cKey:c.key,encryptVer:c.ver,platform:c.platform,sdtfrom:c.sdtfrom,vid:e.cfg.vid,defaultfmt:"mp4",clip:4}};a.resolve(f)}else a.reject()};var l=function(){var a={method:"getCKey",types:["string","string","string"],args:[g,h,i],instanceName:"TencentNewsScriptControllerJsInterface"},b="jsbridge://get_with_json_data?json="+encodeURIComponent(JSON.stringify(a))+"&_t="+h,c=new Image;c.src=b},m=function(){var a=function(){b.getBrowserSignature(g,h,i)};"function"==typeof b.getBrowserSignature?(a(),c.addEventListener("TencentNewsJSInjectionComplete",function(){a()})):c.addEventListener("TencentNewsJSInjectionComplete",function(){a()})};f.os.ios?m():f.os.android?l():a.reject()}},{reg:function(){return!(!f.browser.qqnews||f.browser.qqnewsAd)},request:function(a){var b,c,d,g=this,h=g.cfg.vid,i="undefined"!=typeof g.cfg.svr_time?g.cfg.svr_time+"":parseInt(+new Date/1e3)+"",j="TVP_KUAIBAO_CB_"+i.substr(-4,4);if(window.top!==window){try{var k=window.top.location.href;k&&(b=window.top,c=b.document)}catch(l){d=!0}if(d)return void a.reject()}else b=window,c=b.document;b[j]=function(b){var c;try{c=JSON.parse(b)}catch(d){}if(c&&c.key&&c.ver&&c.platform&&c.sdtfrom){var e={param:{cKey:c.key,encryptVer:c.ver,platform:c.platform,sdtfrom:c.sdtfrom,vid:g.cfg.vid,defaultfmt:"mp4",clip:4}};a.resolve(e)}else a.reject()};var m=function(){var a=function(){window.TencentNews.invoke("getCKey",h,i,j)};window.TencentNews&&window.TencentNews.invoke?a():e.getScript("//mat1.gtimg.com/www/js/newsapp/jsapi/news.js?_tsid=1",function(){window.TencentNews&&window.TencentNews.invoke&&a()})},n=function(){var a=function(){b.getBrowserSignature(h,i,j)};"function"==typeof b.getBrowserSignature?(a(),c.addEventListener("TencentNewsJSInjectionComplete",function(){a()})):c.addEventListener("TencentNewsJSInjectionComplete",function(){a()})};f.os.ios?n():f.os.android?m():a.reject()}},{reg:function(){return!(!f.browser.douban&&!f.browser.liebao)},request:function(a){var b,c=this,d="undefined"!=typeof c.cfg.svr_time?c.cfg.svr_time+"":parseInt(+new Date/1e3)+"",e=function(){if(!window.getBrowserSignature)return void a.reject();try{b=window.getBrowserSignature(c.cfg.vid,d)}catch(e){}if(b&&b.key&&b.ver&&b.platform){var f={param:{cKey:b.key,encryptVer:b.ver,platform:b.platform,vid:c.cfg.vid,defaultfmt:c.cfg.fmt}};a.resolve(f)}else a.reject()};e()}},{reg:function(){return!(!f.browser.mqq||"mqqcartoon"!==f.getUrlParam("openS"))},request:function(a){var b=this,d="undefined"!=typeof b.cfg.svr_time?b.cfg.svr_time+"":parseInt(+new Date/1e3)+"";e.getScript("http://imgcache.qq.com/club/client/comic/release/js/util/qqComicVideoAuth.js?t="+d,function(){"function"===e.type(window.getBrowserSignature)?window.getBrowserSignature(b.cfg.vid,function(d){if(d&&d!==-1){var e={cgi:c("getvinfo"),param:{cKey:d,encryptVer:"6.4",platform:"170101",vid:b.cfg.vid,defn:b.cfg.fmt}};a.resolve(e)}}):a.reject()})}},{reg:function(){return f.isNews()},request:function(a){a.resolve({param:{platform:"20701"}})}},{reg:function(){return f.isNewsPlugin()},request:function(a){a.resolve({param:{platform:"5430701",sdtfrom:"v7013"}})}},{reg:function(){return"yoo.qq.com"===window.location.hostname},request:function(a){a.resolve({param:{platform:"4450701",sdtfrom:"v7158"}})}},{reg:function(){function a(a,b){var c=a.replace(/\?/g,".").replace(/#/g,"\\d").replace(/\*+/g,".*");return new RegExp("^"+c+"$","i").test(b)}var b=["lol.qq.com","lolm.qq.com","lole.qq.com","lpl.qq.com"],c=["*.lol.qq.com","*.lolm.qq.com","*.lole.qq.com","*.lpl.qq.com"];if(b.indexOf(window.location.hostname)>-1)return!0;for(var d=0,e=c.length;d<e;d++)if(a(c[d],window.location.hostname))return!0;return!1},request:function(a){a.resolve({param:{platform:"5290701",sdtfrom:"v7012"}})}},{reg:function(){return"qc.vip.qq.com"==window.location.hostname||"cdn.vip.qq.com"==window.location.hostname},request:function(a){a.resolve({param:{platform:"4860701",sdtfrom:"v7159"}})}},{reg:function(){return"h5.maobing.qq.com"==window.location.hostname||"h5test.maobing.qq.com"==window.location.hostname},request:function(a){a.resolve({param:{platform:"5020701",sdtfrom:"v7161"}})}},{reg:function(){return"m.v.qq.com"!=window.location.hostname&&"v.qq.com"!=window.location.hostname},request:function(a){a.resolve({param:{platform:"4810701",sdtfrom:"v7157"}})}}];d.prototype={init:function(){return this.exportsModuleApis(),this.reg_request},reg_request:function(a,b){var c=this;c.cfg=a,c.cfg2=b;var d=e.Deferred(),f=!1;return e(h).each(function(a,b){return"function"!==e.type(b.reg)||("function"!==e.type(b.request)||(!b.reg.call(c)||(f=!0,b.request.call(c,d),!1)))}),f||d.reject(),setTimeout(function(){d.reject()},6e3),d},exportsModuleApis:function(){var a=this;this.context.msg.setData("isInAuthRuleList",function(b,c){var d=!1;a.cfg={},a.cfg2={},e(h).each(function(b,c){return"function"!==e.type(c.reg)||(!c.reg.call(a)||(d=!0,!1))}),c.data=d})}},a.exports=d},105:function(a,b){a.exports={RFID:"TxpCreativePlayer-rfid",AD_EVENT:{AD_ORDER_DATA_READY:"onAdOrderDataReady",AD_ORDER_PPB_DATA_READY:"ppbAdDataReady",AD_ORDER_PDF_DATA_READY:"pdfAdDataReady",VIDEO_AD_LAYER_SHOW:"adVideoShow",VIDEO_AD_LAYER_HIDE:"adVideoHide"},PLAYER_STATE:{NOT_START:-1,END:0,PLAYING:1,PAUSE:2,LOADING:3},AD_TYPE:{LD:"LD",HT:"HT",ZC:"ZC",ZT:"ZT",KB:"KB",PSJ:"PSJ",PPB:"PPB",PVL:"PVL",ZI:"ZI",BS:"BS",PDF:"PDF",VIDEO_MARK:"PSJ|BS|ZI|ZC|CZC|VIN",CZC:"CZC"},LD_AD_REG:/LD|KB/,VIDEO_AD_REG:/LD|KB|ZC|HT/}},114:function(a,b,c){function d(a){e=Txplayer.util,f=Txplayer.$,this.context=a,this.dataset={hasRequest:!1,retryTime:0},this.dataset.url="//mark.l.qq.com/fcgi-bin/get_video_mark_all",1==e.getUrlParam("debugvideomark")&&(this.dataset.url="//testmark.l.qq.com/fcgi-bin/get_video_mark_all"),this.context.config.usePreviewDomain&&(this.dataset.url="//mark.cm.com/fcgi-bin/get_video_mark_all"),this.init(),f.jsonp||c(49)}var e,f,g=c(105).AD_TYPE,h=d.prototype,i=1;h.init=function(){this.addEventListeners()},h.addEventListeners=function(){var a=this;this.dataset.eventList={},this.dataset.eventList[e.getUniqueMsgKey("vidChange")]=function(b,c){a.dataset.request&&"function"===f.type(a.dataset.request.abort)&&a.dataset.request.abort(),a.dataset.hasRequest=!1,a.dataset.retryTime=0},this.dataset.eventList[e.getUniqueMsgKey("beforeVideoRePlay")]=function(){a.dataset.request&&"function"===f.type(a.dataset.request.abort)&&a.dataset.request.abort(),a.dataset.hasRequest=!1,a.dataset.retryTime=0},f.each(this.dataset.eventList,function(b,c){a.context.msg.on(b,c)})},h.requestVideoMark=function(){var a=this,b=this.context.dataset.vid;if((this.context.config.usePreviewDomain||"v.qq.com"===location.hostname&&this.context.config.official)&&!this.dataset.hasRequest){this.dataset.hasRequest=!0;var c="txplayer_get_video_mark_all",d=this.context.adApi.getAdRequestParam("VIDEO_MARK");d.url=encodeURIComponent(d.url),d.refer=encodeURIComponent(d.refer),d.vptag=encodeURIComponent(d.vptag),d.anchor=1,this.context.dataset.adExtras.adsid&&(d.session_id=this.context.dataset.adExtras.adsid);var h={idlist:b,pr:1,otype:"json",strAdParam:e.param(d),callback:c};this.context.dataset.cid&&(h.cid=this.context.dataset.cid),this.context.dataset.columnId&&(h.lid=this.context.dataset.columnId);var j=(new Date).getTime(),k={},l=+new Date;this.dataset.request=f.jsonp({url:this.dataset.url,data:h,callback:c,timeout:6e3}).done(function(b){k.adcost=+new Date-l,k.requestOk=!0;var c=b&&b.errorno;if(b&&0==b.errorno){var d=b.results[0],e=d.admark||{};e.requestOk=!0;var f=d.fields||[];if(0===Object.keys(e).length)a.dataset.retryTime<i?(a.dataset.retryTime++,a.dataset.hasRequest=!1,a.requestVideoMark()):(k.errorCode=2102,a.reportVideoMarkError(k));else{var h=a.filterVideoBuyPoint(f);a._handleData(h),e.fields=f,e.adtype=g.VIDEO_MARK,e.adcost=(new Date).getTime()-j,a.context.msg.broadcast("onAdOrderDataReady",e)}}else{if(20005==c)return;a.dataset.retryTime<i?(a.dataset.retryTime++,a.dataset.hasRequest=!1,a.requestVideoMark()):(k.errorCode=2102,a.reportVideoMarkError(k))}}).fail(function(b){k.adcost=+new Date-l,k.requestOk=!1,a.dataset.retryTime<i?(a.dataset.retryTime++,a.dataset.hasRequest=!1,a.requestVideoMark()):(k.adcost>=6e3?k.errorCode=2101:k.errorCode=2102,a.reportVideoMarkError(k))})}},h.filterVideoBuyPoint=function(a){var b=[];try{b=a[0].videotag[0].ts.t[0]}catch(c){}if(0===b.length)return this._setVideoMarkForPage([]),a;var d=b.filter(function(a){return 768!=a.cate});return this._setVideoMarkForPage(d),a[0].videotag[0].ts.t[0]=d,a},h.reportVideoMarkError=function(a){this.context.msg.broadcast("adPluginMsg",{name:"reportAd",adtype:g.VIDEO_MARK,reportData:{info:!0,data:{adcost:a.adcost,errorCode:a.errorCode,adtype:g.VIDEO_MARK}}}),Txplayer.util.localLog("GET_VIDEO_MARK_DATA_ERROR",a)},h._handleData=function(a){var b=[],c={},d=this;try{b=a[0].videotag[0].ts.t[0]}catch(g){Txplayer.util.localLog("PARSE_VIDEO_MARK_DATA_ERROR",g)}f.each(b,function(a,b){b=b||{};var d=b.cate;"undefined"!==f.type(b.cate)&&(c[d]||(c[d]=[]),c[d].push(b))}),f.each(c,function(a,b){try{d.context.msg.broadcast("getVideoMarkDataReady."+a,b)}catch(c){e.showError("getVideoMark.handleData.Error."+a,c)}})},h._setVideoMarkForPage=function(a){var b=a&&a.length?a:[];if("function"==typeof window.__tenvideo_setPlayerAction){var c={cmd:10,action:"list",data:b};window.__tenvideo_setPlayerAction(c)}},a.exports=d},135:function(a,b){function c(){throw new Error("setTimeout has not been defined")}function d(){throw new Error("clearTimeout has not been defined")}function e(a){if(k===setTimeout)return setTimeout(a,0);if((k===c||!k)&&setTimeout)return k=setTimeout,setTimeout(a,0);try{return k(a,0)}catch(b){try{return k.call(null,a,0)}catch(b){return k.call(this,a,0)}}}function f(a){if(l===clearTimeout)return clearTimeout(a);if((l===d||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(a);try{return l(a)}catch(b){try{return l.call(null,a)}catch(b){return l.call(this,a)}}}function g(){p&&n&&(p=!1,n.length?o=n.concat(o):q=-1,o.length&&h())}function h(){if(!p){var a=e(g);p=!0;for(var b=o.length;b;){for(n=o,o=[];++q<b;)n&&n[q].run();q=-1,b=o.length}n=null,p=!1,f(a)}}function i(a,b){this.fun=a,this.array=b}function j(){}var k,l,m=a.exports={};!function(){try{k="function"==typeof setTimeout?setTimeout:c}catch(a){k=c}try{l="function"==typeof clearTimeout?clearTimeout:d}catch(a){l=d}}();var n,o=[],p=!1,q=-1;m.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];o.push(new i(a,b)),1!==o.length||p||e(h)},i.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={},m.on=j,m.addListener=j,m.once=j,m.off=j,m.removeListener=j,m.removeAllListeners=j,m.emit=j,m.prependListener=j,m.prependOnceListener=j,m.listeners=function(a){return[]},m.binding=function(a){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(a){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},143:function(a,b){var c={};c[445]=c[444]="\u7f51\u7edc\u8fde\u63a5\u4f3c\u4e4e\u51fa\u73b0\u95ee\u9898\uff0c",c[10001]=c[1]=c[2]=c[3]=c[4]=c[5]=c[30]=c[40]=c[41]=c[42]=c[50]=c[68]="\u89c6\u9891\u83b7\u53d6\u9014\u4e2d\u51fa\u73b0\u95ee\u9898\uff0c",c.defaultMsg=c[51]=c[52]=c[61]=c[62]=c[63]=c[65]=c[66]=c[69]=c[71]=c[73]=c[74]=c[76]=c[77]=c[81]=c[82]=c[86]=c["80.10"]=c[94]="\u8fd9\u4e2a\u89c6\u9891\u88ab\u5916\u661f\u4eba\u52ab\u8d70\uff0c\u6682\u65f6\u770b\u4e0d\u4e86\u4e86~",c[64]=c[100]="\u5f88\u9057\u61be\uff0c\u5bf9\u6b64\u89c6\u9891\u7684\u8bbf\u95ee\u6682\u65f6\u53d7\u9650",c[80.3]=c["80.10"]=c[80.11]=c[84]="\u6b64\u89c6\u9891\u5305\u542b\u654f\u611f\u4fe1\u606f\uff0c\u5df2\u88ab\u7ba1\u7406\u5458\u6349\u62ff~",c[80]=c[83]="\u6682\u65f6\u6ca1\u6709\u83b7\u5f97\u8be5\u89c6\u9891\u7248\u6743\uff0c\u52aa\u529b\u4e3a\u60a8\u4e89\u53d6\u4e2d~",c[80.1]="\u5f88\u62b1\u6b49\uff0c\u7531\u4e8e\u7248\u6743\u9650\u5236\uff0c\u60a8\u6240\u5728\u7684\u5730\u533a\u6682\u65f6\u65e0\u6cd5\u64ad\u653e\u8be5\u89c6\u9891",c[80.2]=c[80.7]=c[80.9]="\u6682\u65f6\u6ca1\u6709\u83b7\u5f97\u8be5\u89c6\u9891\u7248\u6743\uff0c\u52aa\u529b\u4e3a\u60a8\u4e89\u53d6\u4e2d~",c[69.4]=c[80.14]=c[-11111]="\u5e94\u7248\u6743\u65b9\u8981\u6c42\u672c\u7247\u91c7\u7528\u52a0\u5bc6\u683c\u5f0f\uff0c\u6b64\u6d4f\u89c8\u5668\u6682\u4e0d\u652f\u6301\u64ad\u653e",c.adblock="\u64ad\u653e\u5185\u5bb9\u88abadblock\u8bef\u62e6\u622a\u4e86\uff0c\u8bf7\u60a8\u5173\u95ed\u63d2\u4ef6\uff0c\u6216\u4f7f\u7528\u4e0b\u5217\u65b9\u5f0f\u89c2\u770b\uff1a",c.getPlatformErrorCode=function(a,b,c){var d="-",e="-",f="-";return c=c||"00",d=Txplayer.util.os.mac?"62":Txplayer.util.os.windows?"61":"66","getinfo"===a?e="101":"getkey"===a?e="102":"ad"===a?e="215":"player"===a&&(e="200"),"neterror"===b?f="140":"cgiInnerError"===b?(f="13",c&&(c=""+c),2===c.length&&(c="0"+c)):"h5video"===b?f="111":"aderror"===b&&(f="150"),Txplayer.util.localLog&&Txplayer.util.localLog("VIDEO_ERROR",{platform:d,type:e,module:f,code:c}),d+e+"."+f+c},a.exports=c},244:function(a,b){function c(a){this.options=e(a),this.resizeListened=!1,this.initDom()}function d(a){return d.dialog?(d.dialog.initDom(a),d.dialog):(d.dialog=new c(a),d.dialog)}function e(a){"[object Object]"!=Object.prototype.toString.call(a)&&(a={});var b={};for(var c in h)h.hasOwnProperty(c)&&(b[c]=h[c]);for(var d in a)a.hasOwnProperty(d)&&(b[d]=a[d]);return b}var f=Txplayer.util,g=Txplayer.$,h={type:"trial_watch",context:null,showClose:!0,content:"",open:function(){},close:function(){}},i='<txp class="${overlayClass}" display-id="14"><txp class="txp_overlay_content"><txp class="txp_close ${closeClass}"><svg class="txp_icon txp_icon_close" version="1.1" viewBox="0 0 16 16" width="16" height="16"><use class="txp_svg_symbol txp_svg_close" xlink:href="#txp_svg_close"></use></svg></txp>${content}</txp></txp>';c.prototype.initDom=function(a){a&&(this.options=e(a));var b=this.options;this.$dom&&(this.delEvent(),this.$dom.remove()),this.$target=b.target;var c=this.overlayClass="txp_overlay_"+b.type,d=this.soverlayClass=c+"_s",h={overlayClass:c,content:b.content||"",closeClass:b.showClose?" ":"txp_none"};this.domStr=f.tpl(i,h),this.$dom=g(this.domStr),this.$dom.attr("id","txp-"+b.type+"-dialog");var j=this.$target.width();j<700?(this.$dom.addClass(d),this.$dom.find(".brspace").html("<br>")):(this.$dom.removeClass(d),this.$dom.find(".brspace").text("\uff0c")),this.$target.append(this.$dom),this.$closeBtn=this.$dom.find(".txp_close"),this.initEvent()},c.prototype.initEvent=function(){var a=this;this.options.showClose&&this.$closeBtn.on("click",function(){a.close()}),this.options.context&&!this.resizeListened&&this.options.context.msg.on("resize",function(b){a.resizeListened=!0;var c=b.width;b.height;c<700?(a.$dom.addClass(a.soverlayClass),a.$dom.find(".brspace").html("<br>")):(a.$dom.removeClass(a.soverlayClass),a.$dom.find(".brspace").text("\uff0c"))})},c.prototype.delEvent=function(){this.options.showClose&&this.$closeBtn.off("click")},c.prototype.open=function(){this.$dom.removeClass("txp_none"),this.status=1,this.options.open()},c.prototype.close=function(a){this.status=0,this.$dom.addClass("txp_none"),a||this.options.close()},c.prototype.destroy=function(){this.delEvent(),this.status&&this.close();var a=this,b=setTimeout(function(){a.$dom.remove(),clearTimeout(b),b=null},1e3)},d.dialog=null,a.exports=d},280:function(a,b,c){function d(a){f=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=c(281),f=Txplayer.$,g=Txplayer.util,h=(c(143),c(67)),i=c(114);d.prototype={init:function(){var a=this;return this.auth=new h({context:this.context}),this.getVideoMark=new i(this.context),this.dataset.hasVideoPlayed=!1,this.context.dataset.urlIndex=0,["vid","cid","columnId","title","nextVid","tpid","authext","eduext","authfrom","isNeedPay","autoplay","skipPrelude","connectionPlayTime","playStartTime"].forEach(function(b){a.context.dataset[b]=a.context.config[b]}),"string"===f.type(this.context.config.volume)&&/^\d+$/.test(this.context.config.volume)&&(this.context.config.volume=parseInt(this.context.config.volume)),"number"!==f.type(this.context.config.volume)||this.context.config.volume>100||this.context.config.volume<0?void g.showError("context.config.volume\u5fc5\u987b\u4e3a 0~100 "):(this.context.dataset.volume=this.context.config.volume,this.context.config.duration&&this.context.config.playEndTime&&(this.context.dataset.playEndTime=parseInt(this.context.config.duration)-this.context.config.playEndTime,this.context.dataset.playEndTime<0&&(this.context.dataset.playEndTime=null)),this.context.msg.broadcast("setVolume",{volume:this.context.dataset.volume,showTips:!1}),g.isSupportSafariHls(this.context.dataset.platform)&&(this.context.dataset.useHls=!0),a.context.dataset.hasChromeHlsPlugin&&(this.context.dataset.useChromeHls=!0,this.context.dataset.useHls=!0),this.context.getinfo=new e(this.context),this.addEventListener(),this.exportsModuleApis(),g.v4log("v4HdPlayerControl-init"),void(this.context.dataset.autoplay&&this.playControl({nextVid:this.context.dataset.nextVid,vid:this.context.dataset.vid,connectionPlayTime:this.context.dataset.connectionPlayTime,playStartTime:this.context.dataset.playStartTime})))},addEventListener:function(){this.dealAdMsgMoudle(),this.dealFilmMsgMoudle()},exportsModuleApis:function(){this.initUserApis(),this.initPrivateMsg(),this.initDataApis()}},g.extend(d.prototype,c(286)),g.extend(d.prototype,c(288)),g.extend(d.prototype,c(289)),g.extend(d.prototype,c(290)),g.extend(d.prototype,c(291)),g.extend(d.prototype,c(292)),g.extend(d.prototype,c(293)),g.extend(d.prototype,c(294)),Txplayer.register("v4HdPlayerControl",d)},281:function(a,b,c){function d(a){var b=function(){};return b.prototype=a,new b}function e(a){f=Txplayer.$,h.call(this,a)}var f=Txplayer.$,g=Txplayer.util,h=c(282),i="POST";e.prototype=d(h.prototype),e.prototype.constructor=e,e.prototype.requestGetinfo=function(a){return this.context.dataset.requestNewGetinfoError||1==g.getUrlParam("debuggetinfo")?this.requestOldGetinfo(a):this.requestNewGetinfo(a)},e.prototype.requestGetkey=function(a){return this.context.dataset.requestNewGetinfoError?this.requestOldGetVkey(a):this.requestNewGetVkey(a)},e.prototype.requestInsertAd=function(a){return a&&(a.method=i),this.requestPostCgi("insertAd",a).defer},e.prototype.requestPauseAd=function(a){return a&&(a.method=i),this.requestPostCgi("pauseAd",a).defer},e.prototype.requestEndingAd=function(a){return a&&(a.method=i),this.requestPostCgi("endingAd",a).defer},e.prototype.requestPpbAd=function(a){return a&&(a.method=i),this.requestPostCgi("ppbAd",a).defer},e.prototype.requestPdfAd=function(a){return a&&(a.method=i),this.requestPostCgi("pdfAd",a).defer},e.prototype.requestIvbAd=function(a){return a&&(a.method=i),this.requestPostCgi("ivbAd",a).defer},e.prototype.requestYaliuAd=function(a){return a&&(a.method=i),this.requestPostCgi("yaliuAd",a).defer},e.prototype.requestPostCgi=function(a,b){var c={};c="vinfoad"==a?this.dataset.svDomain?{buid:"vinfoad_sv",adparam:f.param(b.adparam),vinfoparam_sv:f.param(b.vinfoparam)}:{buid:"vinfoad",adparam:f.param(b.adparam),vinfoparam:f.param(b.vinfoparam)}:"vinfo"==a?this.dataset.svDomain?{buid:"onlyvinfo_sv",vinfoparam_sv:f.param(b.vinfoparam)}:{buid:"onlyvinfo",vinfoparam:f.param(b.vinfoparam)}:"getkey"==a?this.dataset.svDomain?{buid:"onlyvkey_sv",vkeyparam_sv:f.param(b.vkeyparam)}:{buid:"onlyvkey",vkeyparam:f.param(b.vkeyparam)}:{buid:"onlyad",adparam:f.param(b)};var d=b.domain?b.domain:"vd.l.qq.com";1==g.getUrlParam("debugvideomark")&&(d="testvd.l.qq.com");var e=f.Deferred(),h=+new Date,j=b.method||"POST";"GET"===j&&(i=j),Txplayer.util.v4log("6072 beforeRequest",h);var k=f.ajax({method:j,type:j,url:"//"+d+"/proxyhttp",crossDomain:!0,xhrFields:{withCredentials:!0},timeout:8e3,dataType:"POST"===j?"json":"jsonp",contentType:"POST"===j?"text/plain":"application/javascript",data:"POST"===j?JSON.stringify(c):c}).done(function(a){var b=+new Date;if(Txplayer.util.v4log("6072 afterRequest",b),0==a.errCode)try{if("onlyad"==c.buid){var d=JSON.parse(a.ad);d.requestOk=!0,d.adcost=b-h,e.resolve(d)}else"vinfoad"==c.buid?("{}"==a.vinfo&&e.reject(a,"dataerr"),e.resolve(JSON.parse(a.vinfo),a.ad)):"vinfoad_sv"==c.buid?("{}"==a.vinfo&&e.reject(a,"dataerr"),e.resolve(JSON.parse(a.vinfo),a.ad)):"onlyvinfo"==c.buid?("{}"==a.vinfo&&e.reject(a,"dataerr"),e.resolve(JSON.parse(a.vinfo))):"onlyvinfo_sv"==c.buid?("{}"==a.vinfo&&e.reject(a,"dataerr"),e.resolve(JSON.parse(a.vinfo))):"onlyvkey"==c.buid?("{}"==a.vkey&&e.reject(a,"dataerr"),e.resolve(JSON.parse(a.vkey))):"onlyvkey_sv"==c.buid&&("{}"==a.vkey&&e.reject(a,"dataerr"),e.resolve(JSON.parse(a.vkey)))}catch(f){e.reject(a,"dataerr")}else e.reject(a)}).fail(function(a,b){a=a||{};var c=new Date;a.adcost=c-h,a.requestOk=!1,e.reject(a,b)});return{request:k,defer:e}},e.prototype.requestRollVideoInfo=function(a){var b=this;return this.requestRollInfo(a).done(function(a){if(a.hasnlink){if(b.context.dataset.hasnlink=!0,["LD","ZC","HT"].indexOf(b.context.dataset.currentAdType)>-1)return;if(b.context.dataset.hasShowEndAdditionTip)return void(b.context.dataset.fvpint=0);b.context.msg.broadcast("showAdditionTip",{duration:a.vlinktd,type:"normal"})}a.nextpint?b.context.dataset.fvpint=1e3*a.nextpint:b.context.dataset.fvpint=0}).fail(function(a){b.context.dataset.fvpint=6e5})},a.exports=e},282:function(a,b,c){function d(a){j=Txplayer.$;this.context=a,this.dataset={},this.context&&this.context.dataset&&this.context.dataset.businessId&&(this.context.dataset.authext||this.context.dataset.authfrom)&&("11"==this.context.dataset.businessId||this.context.dataset.businessId>=200)&&(this.dataset.svDomain=!0);var b="object"==typeof window.WebAssembly;if(l.browser.chrome&&l.compareVersion(l.browser.chrome.version,"62.0")<=0&&(b=!1),b&&!h&&(h=j.Deferred(),Txplayer.ckeyModule={locateFile:function(a){return"//vm.gtimg.cn/tencentvideo/txp/js/"+a+"?v="+Txplayer.dataset.ts},print:Txplayer.util.v4log.bind(Txplayer.util,"ckey9"),printErr:Txplayer.util.v4log.bind(Txplayer.util,"ckey9"),monitorRunDependencies:function(a){a<=0&&setTimeout(function(){f=g.cwrap("getckey","string",["number","string","string","string","string","number"]),h.resolve()},0)},onAbort:function(a){Txplayer.util.v4log("init ckey9xModule: ",a),h.reject()}},!g))try{g=c(285)}catch(d){Txplayer.util.v4log("import ckey9xModule: ",d?d.message:"error"),h.reject()}}function e(a){var b;f?(a.encryptVer="9.1",b=f(a.platform,a.appVer,a.vids||a.vid,"",a.guid,a.tm)):(a.encryptVer="8.1",b=i(a.vids||a.vid,a.tm,a.appVer,a.guid,a.platform)),a.cKey=b||""}var f,g,h,i=c(283),j=Txplayer.$,k=c(284),l=Txplayer.util,m=["30","40","41","42","50","64","85","445"],n=["vd.l.qq.com","vi.l.qq.com"],o="pxy.video.qq.com",p=["l.cm.com","l.cm.com"],q="testvd.l.qq.com",r=!1;d.prototype={checkGetInfoData:function(a){return a&&"o"==a.s?1:0},checkGetinfoRetCode:function(a){var b,c,d=0;return a&&a.s?"o"!==a.s?(d=a.em||50,c=a.exem):a.vl&&a.vl.vi&&j.isArray(a.vl.vi)&&0!==a.vl.cnt?b=a.vl.vi[0]:d=68:d=50,0!==d||5===b.fst&&j.isPlainObject(b.ul)&&j.isArray(b.ul.ui)&&0!==b.ul.ui.length?0===d&&2!==b.st&&(8!=b.st?d=62:(d=83,c=b.ch)):d=62,{exVal:c,iRetCode:d,vi:b}},getRequestUrl:function(a){a=a||{};var b,c={},d=["vv.video.qq.com","av.video.qq.com","bkvv.video.qq.com","h5vv.video.qq.com"];return c.domain=d[a.retryTimes],"vv.video.qq.com"==c.domain&&this.dataset.svDomain&&(c.domain="sv.video.qq.com"),"http:"===location.protocol?c.protocol="http:":c.protocol="https:","geth5info"===a.type?c.path="/geth5info?":"getkey"===a.type?c.path="/geth5key?":"pollvinfo"===a.type&&(c.path="/pollvinfo?"),b=c.protocol+"//"+c.domain+c.path,a.disableCallback||(b+="callback=?&"),b},getInfoConfig:function(a,b){var c="";
try{c=location.href.replace(location.search,""),l.isInIframe()&&(c=l.removeUrlParams(top.location.href||""))}catch(d){}var f=window!=top?l.removeUrlParams(document.referrer||""):document.location.host;c=l.getUrlParam("debugehost")||c;var g={charge:0,defaultfmt:"auto",otype:"vinfoad"==a?"ojson":"json",guid:this.context.dataset.guid,flowid:this.context.dataset.flowid,platform:this.context.dataset.platform,sdtfrom:this.context.dataset.sdtfrom,defnpayver:1,appVer:Txplayer.dataset.ver,host:location.host,ehost:c,refer:f,sphttps:"https:"===location.protocol?1:0,tm:b.tm?b.tm:l.getTimeStampStr(),spwm:4};g.logintoken=this.context.dataset.txplayerAuth.getInfo(!0),"nintendo"===this.context.config.playerType&&(g.clip=4),this.context.dataset.unid&&(g.unid=this.context.dataset.unid),this.context.dataset.authfrom&&(g.auth_from=this.context.dataset.authfrom),this.context.dataset.authext&&(g.auth_ext=this.context.dataset.authext);var h=j.extend(g,b);if(this.context.config&&"function"===j.type(this.context.config.getUserType))try{var i=this.context.config.getUserType();2!=i&&10!=i&&+l.getData("gp-cacdc")>=4&&(h.defn="sd")}catch(d){}return b.show1080p||(h.defnpayver=0),"auto"!=h.defn&&h.defn?h.defsrc=2:h.defsrc=1,e(h),this.context.dataset.useP2P&&(h.fp2p=1),this.context.dataset.IsSupportVideoIn&&(h.spadseg=1),this.context.dataset.adExtras&&(h.adsid=this.context.dataset.adExtras.adsid||"",h.adpinfo=this.context.dataset.adExtras.adpinfo||""),h},getinfoOnError:function(a,b){a=a||{},"444"==a.code?a.timeout?a.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","03"):a.dataerr?a.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","04"):a.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","01"):a.code?a.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","cgiInnerError",a.code):(a.code="444",a.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","04")),a.errCode&&a.exem&&(a.errCode+="."+a.exem),b.reject(a)},getinfoReport:function(a,b,c,d){var e=+new Date,f={endTime:e,startTime:c,getinfoURL:b,costTime:e-c};a&&"object"===j.type(a)?(f.err="error",f=j.extend(f,a)):a&&"string"===j.type(a)&&(f.err=a,"timeout"==a&&(f.code=600)),"string"===j.type(a)?"timeout"==a?f.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","03"):f.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","01"):a&&a.code&&(f.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","cgiInnerError",a.code)),d&&(f.isLastRetry=1),f.errCode&&f.exem&&(f.errCode+="."+f.exem),this.context.msg.broadcast("getinfoFinish",f)},dealGetinfoData:function(a,b,c){var d,e,f,g=this,h=g.checkGetInfoData(a);if(1===h){if(d=g.checkGetinfoRetCode(a),83!=d.iRetCode&&0!==d.iRetCode)return Txplayer.util.v4log("getinfo\u8fd4\u56de\u9519\u8bef\u7801\u9519\u8bef ",{iRetCode:d.iRetCode}),void g.getinfoOnError(a,b);a.iRetCode=d.iRetCode,g.dataset.getinfoData=a;try{g.context.dataset.reportClip=d.vi.fc||d.vi.cl.fc,g.context.dataset.reportStatus=d.vi.vst,g.context.dataset.reportType=d.vi.type,g.context.dataset.reportTestId=a.tstid,g.context.dataset.reportUsrIP=a.ip,g.context.dataset.cdnID=d.vi.ul.ui[0].vt,g.context.dataset.originalHwRate=(d.vi.vh/d.vi.vw).toFixed(3)}catch(i){}return e=k.getPcVideoMp4Url(a,g.context),"array"===j.type(e)&&e.length&&(f=1==a.dltype?e[0].urlArray[0].url+"&vkey="+d.vi.fvkey:e[0].urlArray&&e[0].urlArray[0]&&e[0].urlArray[0].url),g.context.dataset.dltype=a.dltype,8===g.context.dataset.dltype&&e&&e[0]&&!e[0].m3u8&&(g.context.dataset.dltype=3),b.resolve(f,e,k.getDefinitionListFromData(a),a,c?c:{}),g.context.msg.broadcast("reportGetinfo",{filename:d.vi.fn,cdnIp:Txplayer.util.getHostNameByUrl(d.vi.ul.ui[0].url),cdnId:d.vi.ul.ui[0].vt,vkey:1==a.dltype?d.vi.fvkey:""}),null}return{exem:a.exem,code:a.em,curTime:a.curTime}},requestBefore:function(a){var b=j.Deferred(),c=this,d=[b].concat(Array.prototype.slice.call(arguments,1));return h?h.done(function(){a.apply(c,d)}).fail(function(){f=null,a.apply(c,d)}):a.apply(c,d),b},requestNewGetinfo:function(a){return this.requestBefore(this.requestNewGetinfoImpl,a)},requestNewGetinfoImpl:function(a,b){function c(p){p&&p.tm&&(b.tm=p.tm,g=f.getInfoConfig("vinfoad",b),3==s&&(s+=1)),p&&p.ckeyRetry&&(delete b.tm,g=f.getInfoConfig("vinfoad",b)),p&&p.domainRetry&&h++;var v=p&&p.domain||n[h%2];1==l.getUrlParam("debugvideomark")&&(v=q);var w=p&&p.method||"POST";r&&(w="GET");var x=+new Date,y="//"+v+"/proxyhttp/"+d+"&"+j.param(g),z=k>=s;(k>0||b.onlyGetinfo&&!b.fhdswitch)&&(g.sphls=1,g.spgzip="",g.dlver=""),k++,f.context.msg.broadcast("getinfoStart",{getinfoURL:y,time:+new Date}),v===o&&(e.finaltry=1);var A=+new Date;Txplayer.util.v4log("6072 before.defer: ",A),Txplayer.util.v4log("requestGetinfo",g),Txplayer.util.v4log("requestAd",e);var B=f.requestPostCgi(d,{vinfoparam:g,adparam:e,domain:v,method:w});i=B.request;var C=B.defer;C.done(function(b,d){var e=+new Date;Txplayer.util.v4log("6072 _defer.done: ",e,b,d);var g={};try{g=JSON.parse(d)}catch(h){}g.orginStr=d,g.adcost=e-A,g.retryTimes=k,g.domain=v,Txplayer.util.v4log("6072 adcost: ",g.adcost),g.requestOk=!0;var i=f.dealGetinfoData(b,a,g);f.getinfoReport(i,y,x,z),i&&(i.code?z||j.inArray(i.code+"",m)==-1?f.getinfoOnError(i,a):85==i.code?c(i.exem==-3&&i.curTime?{tm:i.curTime}:{ckeyRetry:!0}):c():z?f.getinfoOnError({},a):c({domainRetry:!0}))}).fail(function(b,d){var e=+new Date;b.adcost=e-A,b.requestOk=!1,u.push(e-A),d&&"abort"===d||(f.getinfoReport(d,y,x,z),z?!t&&k>=s&&u.every(function(a){return a<=500})?(c({domain:o}),t=!0):r?f.getinfoOnError({code:444,timeout:"timeout"===d,dataerr:"dataerr"===d,costTime:+new Date-x},a):(c({domain:n[0],method:"GET"}),r=!0):c({domainRetry:!0}))})}var d,e,f=this,g=this.getInfoConfig("vinfoad",b),h=0;b.onlyGetinfo?(d="vinfo",e=""):(d="vinfoad",e=f.context.adApi&&f.context.adApi.getAdRequestParam()||{});var i,k=0,s=3,t=!1,u=[];return f.context.config.usePreviewDomain&&(n=p),c(),this.context.msg.off("vidChange.requestGetinfo").on("vidChange.requestGetinfo",function(){i&&i.abort&&i.abort()}),this.context.msg.off("seekStart.requestGetinfo").on("seekStart.requestGetinfo",function(){i&&i.abort&&i.abort()}),this.context.msg.off("userStopVideo.requestGetinfo").on("userStopVideo.requestGetinfo",function(){i&&i.abort&&i.abort()}),a},requestOldGetinfo:function(a){return this.requestBefore(this.requestOldGetinfoImpl,a)},requestOldGetinfoImpl:function(a,b){function c(h){var i=h&&h.cgi?h.cgi:f.getRequestUrl({type:"geth5info",retryTimes:g}),k=+new Date;h&&h.tm&&(b.tm=h.tm,e=f.getInfoConfig("getinfo",b));var l=i+"&"+j.param(e),n=g>=3;g++,f.context.msg.broadcast("getinfoStart",{getinfoURL:l,time:k}),d=j.jsonp({url:i,data:e,timeout:6e3,callback:Txplayer.util.getJsonpCallbackName("getinfo")}).done(function(b){var d=f.dealGetinfoData(b,a);f.getinfoReport(d,l,k,n),d&&(d.code?n||j.inArray(d.code+"",m)==-1?f.getinfoOnError(d,a):c(85==d.code&&d.exem==-3&&d.curTime?{tm:d.curTime,cgi:i}:{cgi:i}):n?f.getinfoOnError({},a):c())}).fail(function(b,d){d&&"abort"===d||(f.getinfoReport(d,l,k,n),n?f.getinfoOnError({code:444,timeout:"timeout"===d,costTime:+new Date-k},a):c())})}var d,e=this.getInfoConfig("getinfo",b),f=this,g=0;return c(),this.context.msg.off("vidChange.requestGetinfo").on("vidChange.requestGetinfo",function(){d&&d.abort&&d.abort()}),this.context.msg.off("seekStart.requestGetinfo").on("seekStart.requestGetinfo",function(){d&&d.abort&&d.abort()}),this.context.msg.off("userStopVideo.requestGetinfo").on("userStopVideo.requestGetinfo",function(){d&&d.abort&&d.abort()}),a},getKeyConfig:function(a,b,c){function d(a){for(var b=0,c=a.length;b<c;b++)if(1==a[b].sl)return a[b].id;return-1}var f="";try{f=location.href.replace(location.search,""),l.isInIframe()&&(f=top.location.href.replace(top.location.search,""))}catch(g){}var h=l.getUrlParam("debugehost")||l.removeUrlParams(f),i={otype:b?"ojson":"json",vid:a.vid,format:d(this.dataset.getinfoData.fl.fi),filename:a.newFileName,platform:this.context.dataset.platform,appVer:Txplayer.dataset.ver,vt:a.vt,sdtfrom:this.context.dataset.sdtfrom,guid:this.context.dataset.guid,flowid:this.context.dataset.flowid,charge:a.isNeedPay?1:0,linkver:2,lnk:this.context.dataset.getinfoJSON.vl.vi[0].lnk,tm:c?c:l.getTimeStampStr(),refer:f,ehost:h};return i.logintoken=this.context.dataset.txplayerAuth.getInfo(!0),this.context.dataset.unid&&(i.unid=this.context.dataset.unid),this.context.dataset.authfrom&&(i.auth_from=this.context.dataset.authfrom),this.context.dataset.authext&&(i.auth_ext=this.context.dataset.authext),e(i),i},getKeyErrorCode:function(a){a=a||{},!a.err&&a.em&&(a.err="error"),!a.code&&a.em&&(a.code=a.em);var b="";return"error"===a?b=Txplayer.v4errcode.getPlatformErrorCode("getkey","neterror","01"):"timeout"===a?b=Txplayer.v4errcode.getPlatformErrorCode("getkey","neterror","03"):"dataerr"===a?b=Txplayer.v4errcode.getPlatformErrorCode("getkey","neterror","04"):a.errCode?b=a.errCode:"timeout"===a.err?b=Txplayer.v4errcode.getPlatformErrorCode("getkey","neterror","03"):"no key"!==a.err||a.hasOwnProperty("code")?a.err&&!a.hasOwnProperty("code")?b=Txplayer.v4errcode.getPlatformErrorCode("getkey","neterror","01"):a.err&&a.hasOwnProperty("code")&&(b=Txplayer.v4errcode.getPlatformErrorCode("getkey","cgiInnerError",a.code+"")):b=Txplayer.v4errcode.getPlatformErrorCode("getkey","neterror","04"),b&&a.exem&&(b+="."+a.exem),b},getkeyReport:function(a,b,c,d){var e=this,f=+new Date,g={endTime:f,startTime:b,getkeyURL:c,costTime:f-b,isLastRetry:d};a&&"object"===j.type(a)?(g.err="error",g=j.extend(g,a),a.em&&(g.code=a.em)):a&&"string"===j.type(a)&&(g.err=a,"timeout"==a&&(g.code=600)),g.errCode=e.getKeyErrorCode(a),e.context.msg.broadcast("getkeyFinish",g)},requestOldGetVkey:function(a){return this.requestBefore(this.requestOldGetVkeyImpl,a)},requestOldGetVkeyImpl:function(a,b){var c,d=this,e=0,f=this.getRequestUrl({type:"getkey",retryTimes:e}),g=this.getKeyConfig(b,!1),h=function(b){if(b=b||{},b.code&&j.inArray(b.code+"",m)==-1)return void a.reject(b);var i=e>d.context.config.keyRetryTimes;if(i)return b.code||(b.code=445),void a.reject(b);e++;var k=+new Date;d.context.msg.broadcast("getkeyStart"),c=j.jsonp({url:b.url||f,data:g,timeout:6e3,callback:Txplayer.util.getJsonpCallbackName("getkey")}).done(function(c){c&&c.key?(a.resolve(c.key),d.getkeyReport(null,k,f+"&"+j.param(g),i)):(!c.code&&b.em&&(c.code=b.em),c.key||(c.err="no key"),d.getkeyReport(c,k,f+"&"+j.param(g),i),c.errCode=d.getKeyErrorCode(c),h(c))}).fail(function(a,b){b&&"abort"===b||(d.getkeyReport(b,k,f+"&"+j.param(g),i),h({code:445,errCode:d.getKeyErrorCode(b),url:d.getRequestUrl({type:"getkey",retryTimes:e}),timeout:"timeout"===b}))})};return h(),this.context.msg.off("vidChange.requestOldGetVkey").on("vidChange.requestOldGetVkey",function(){c&&c.abort&&c.abort()}),this.context.msg.off("userStopVideo.requestOldGetVkey").on("userStopVideo.requestOldGetVkey",function(){c&&c.abort&&c.abort()}),a},requestNewGetVkey:function(a){return this.requestBefore(this.requestNewGetVkeyImpl,a)},requestNewGetVkeyImpl:function(a,b){var c,d=this,e=0,f=this.getKeyConfig(b,!0),g=0,h=d.context.config.keyRetryTimes,i=!1,k=[],l=function(p){if(p=p||{},p.code&&j.inArray(p.code+"",m)==-1)return void a.reject(p);var q=e>h;if(q&&!p.lastDomain)return p.code||(p.code=445),void a.reject(p);p&&p.domainRetry&&g++,p.ckeyRetry&&(f=d.getKeyConfig(b,!0,p.curTime));var s=p&&p.domain||n[g%2],t=p&&p.method||"POST";r&&(t="GET"),e++;var u=+new Date,v="//"+s+"/proxyhttp/getkey&"+j.param(f);d.context.msg.broadcast("getkeyStart");var w=+new Date,x=d.requestPostCgi("getkey",{vkeyparam:f,domain:s,method:t});c=x.request;var y=x.defer;y.done(function(b){b&&b.key?(a.resolve(b.key),d.getkeyReport(null,u,v,q)):(!b.code&&b.em&&(b.code=b.em),85==b.code&&(b.hasOwnProperty("exem")&&(b.exem=b.exem),b.exem==-3&&(h=3==h?4:h),b.curTime&&(b.curTime=b.curTime),b.ckeyRetry=!0),b.err||(b.err="no key"),d.getkeyReport(b,u,v,q),b.errCode=d.getKeyErrorCode(b),b.code||"no key"!=b.err||(b.domainRetry=!0),Txplayer.util.v4log("\u91cd\u8bd5getkey\uff0c\u540e\u53f0\u6709\u8fd4\u56de\u6570\u636e\uff1a"+JSON.stringify(b)),l(b))}).fail(function(a,b){return k.push(+new Date-w),b&&"abort"===b?void Txplayer.util.v4log("\u91cd\u8bd5getkey\uff0c\u6240\u6709\u8bf7\u6c42\u90fd\u5931\u8d25\u4e86\uff0cabort\uff0cerr: "+b):void(!i&&e>h&&k.every(function(a){return a<=500})?(Txplayer.util.v4log("\u91cd\u8bd5getkey\uff0c\u6240\u6709\u7684\u8bf7\u6c42\u90fd\u5931\u8d25\u4e86,500ms\u4ee5\u5185, err: "+b),l({domain:o}),i=!0):r?(Txplayer.util.v4log("\u91cd\u8bd5getkey\uff0c\u5176\u4ed6\u573a\u666f, err: "+b),d.getkeyReport(b,u,v,q),l({code:445,errCode:d.getKeyErrorCode(b||"error"),timeout:"timeout"===b,domainRetry:!0})):(Txplayer.util.v4log("\u91cd\u8bd5getkey\uff0c\u6ca1\u6709\u7528\u8fc7GET\u8bf7\u6c42\uff0c\u5207\u6362\u5230GET\u8bf7\u6c42, err: "+b),l({domain:n[0],lastDomain:!0,method:"GET"}),r=!0))})};return l(),this.context.msg.off("vidChange.requestOldGetVkey").on("vidChange.requestOldGetVkey",function(){c&&c.abort&&c.abort()}),this.context.msg.off("userStopVideo.requestOldGetVkey").on("userStopVideo.requestOldGetVkey",function(){c&&c.abort&&c.abort()}),a},requestRollInfo:function(a){return this.requestBefore(this.requestRollInfoImpl,a)},requestRollInfoImpl:function(a,b){function c(c){var g=c&&c.cgi?c.cgi:f.getRequestUrl({type:"pollvinfo",retryTimes:0});c&&c.tm&&(b.tm=c.tm,e=f.getInfoConfig("getinfo",b)),e.jsonp=1,e.vid=f.context.dataset.vid,d=j.jsonp({url:g,data:e,timeout:6e3,callback:Txplayer.util.getJsonpCallbackName("pollvinfo")}).done(function(b){a.resolve(b)}).fail(function(b,c){a.reject(c)})}var d,e=this.getInfoConfig("getinfo",b),f=this;return c(),this.context.msg.off("vidChange.requestRollInfo").on("vidChange.requestRollInfo",function(){d&&d.abort&&d.abort()}),this.context.msg.off("seekStart.requestRollInfo").on("seekStart.requestRollInfo",function(){d&&d.abort&&d.abort()}),this.context.msg.off("userStopVideo.requestRollInfo").on("userStopVideo.requestRollInfo",function(){d&&d.abort&&d.abort()}),a}},a.exports=d},283:function(a,b){var c=function(){function a(a){return b.call(this,ia+2097+8214-15822,a)}function b(c){for(var d="",e=-8432+ka+12979;e<"\u090a".length;e++)d+=String.fromCharCode(la+ma+na-50^"\u090a".charCodeAt(e));for(var f="",g=0;g<"\u07ad".length;g++)f+=String.fromCharCode(I+3326+4681^"\u07ad".charCodeAt(g));for(var k="",l=0;l<"\u04a0".length;l++)k+=String.fromCharCode(oa+Q+m+8449^"\u04a0".charCodeAt(l));for(var n="",p=0;p<"\u0d07".length;p++)n+=String.fromCharCode(G+-5316+8904^"\u0d07".charCodeAt(p));for(var r="",A=pa+3628+qa-16465;A<"\u05ff".length;A++)r+=String.fromCharCode(146+na+-1434-5788^"\u05ff".charCodeAt(A));for(var C="",D=-1434+ra+11308;D<"\u08a8".length;D++)C+=String.fromCharCode(2260^"\u08a8".charCodeAt(D));for(var N="",O=0;O<"\u0b36".length;O++)N+=String.fromCharCode(2890^"\u0b36".charCodeAt(O));for(var P="",T=sa+6246;T<"\u01a8\u01a2\u01f6\u01a6\u01f6\u01a7\u01f5\u01f1\u01a7\u01a4".length;T++)P+=String.fromCharCode(-5316+da+ta+358^"\u01a8\u01a2\u01f6\u01a6\u01f6\u01a7\u01f5\u01f1\u01a7\u01a4".charCodeAt(T));for(var U="",V=ua+146+4448-6833;V<"\u0a78".length;V++)U+=String.fromCharCode(2564^"\u0a78".charCodeAt(V));for(var W="",ia=va+4448+4019;ia<"\u084c".length;ia++)W+=String.fromCharCode(2096^"\u084c".charCodeAt(ia));for(var gb="",hb=wa+-3155+-9555+13665;hb<"\u0676".length;hb++)gb+=String.fromCharCode(E+-3155+6442^"\u0676".charCodeAt(hb));for(var ib="",jb=xa+2579;jb<"\u0a88".length;jb++)ib+=String.fromCharCode(K+9851-9876^"\u0a88".charCodeAt(jb));for(var kb="",lb=0;lb<"\u0227".length;lb++)kb+=String.fromCharCode(da+4223^"\u0227".charCodeAt(lb));for(var mb="",nb=0;nb<"\u043e".length;nb++)mb+=String.fromCharCode(ya+E+9851-4347^"\u043e".charCodeAt(nb));for(var ob="",pb=0;pb<"\u07e1".length;pb++)ob+=String.fromCharCode(za+S+fa-4523^"\u07e1".charCodeAt(pb));for(var qb="",rb=-215+L+F+6127;rb<"\u0305".length;rb++)qb+=String.fromCharCode(889^"\u0305".charCodeAt(rb));for(var sb="",tb=Aa+-6842+7201;tb<"".length;tb++)sb+=String.fromCharCode(z+Ba+3363^"".charCodeAt(tb));for(var ub="",vb=ba+Ca+Da-4446;vb<"".length;vb++)ub+=String.fromCharCode(aa+y+4989^"".charCodeAt(vb));for(var wb="",xb=-7878+$+y+16828;xb<"".length;xb++)wb+=String.fromCharCode(3628+Ea+2321^"".charCodeAt(xb));for(var yb="",zb=Fa+Ga+Ha-10082;zb<"\xb4\xb9\xb2\xaf".length;zb++)yb+=String.fromCharCode(Ia+5817-5364^"\xb4\xb9\xb2\xaf".charCodeAt(zb));for(var Ab="",Bb=Z+u+-1665-4436;Bb<"\u06d8\u06d5\u06de\u06c3".length;Bb++)Ab+=String.fromCharCode(Ja+146+-4109+529^"\u06d8\u06d5\u06de\u06c3".charCodeAt(Bb));for(var Cb="",Db=Ka+9456-19159;Db<"\u0668\u0669\u0668\u0663".length;Db++)Cb+=String.fromCharCode(1542^"\u0668\u0669\u0668\u0663".charCodeAt(Db));for(var Eb="",Fb=ea+ha+X+3846;Fb<"\xc1\xcc".length;Fb++)Eb+=String.fromCharCode(168^"\xc1\xcc".charCodeAt(Fb));for(var Gb="",Hb=ga+7940;Hb<"\u06c6\u06cb\u06d4".length;Hb++)Gb+=String.fromCharCode(1698^"\u06c6\u06cb\u06d4".charCodeAt(Hb));for(var Ib="",Jb=0,Kb="\u0b36\u0b0b\u0b51\u0b5e\u0b08\u0b0d\u0b0d\u0b51\u0b59\u0b36";Jb<Kb.length;Jb++)Ib+=String.fromCharCode(9964+La+-1265-7812^Kb.charCodeAt(Jb));for(var Lb="",Mb=0;Mb<"\u05d9\u05c7\u05c0\u05ca\u05c1\u05d9".length;Mb++)Lb+=String.fromCharCode(1454^"\u05d9\u05c7\u05c0\u05ca\u05c1\u05d9".charCodeAt(Mb));switch(c){case 0:var Nb=[];window[Lb]===window?Nb.push(o+M+Ma-12906):Nb.push(Na+5538);try{var Ob=Ib+Math.floor(1e7*Math.random()),Pb=document.createElement(Gb);Pb.setAttribute(Eb,Ob),Pb.style.La=Cb,(document.body||document.getElementsByTagName(Ab)[0]).appendChild(Pb),document.getElementById(Ob)?Nb.push(0):Nb.push(1),(document.body||document.getElementsByTagName(yb)[Oa+h+Pa-8151]).removeChild(Pb)}catch(Qb){Nb.push(-1361+Qa+1879)}return Nb.join(wb);case 1:var Rb=arguments[x+5347],Sb=new fb.a.f.init([1332468387,-1641050960,Ra+R+2136881301,-1629555948],ya+2689),Tb=new fb.a.f.init([Sa+w+22041281,Y+Ta+1457907509,776125350,-(-7878+_+-5975+1942018983)],Ua+4647);return fb.Ga.$(Rb,Sb,{ra:Tb,ba:fb.ba.la,qa:fb.na.ma}).xa.toString().toUpperCase();case Va+Wa-5967:return(_b=arguments[Xa+-1708+Ya+5932])?_b.length>8011+H-16329?_b.substr(6968+Za-7677,48):_b:ub;case 3:var Ub=window.document.URL,Vb=window.navigator.userAgent.toLowerCase(),Wb=sb;window.document.referrer.length>-11220+$a+18473&&(Wb=window.document.referrer);try{Wb.length==_a-8815&&opener.location.href.length>0&&(Wb=opener.location.href)}catch(Xb){}var Yb=window.navigator.appCodeName,Zb=window.navigator.appName,$b=window.navigator.platform;return Ub=a(Ub),Wb=a(Wb),Ub+qb+(Vb=a(Vb))+ob+Wb+mb+Yb+kb+Zb+ib+$b;case ab+J+ca-11490:var _b=arguments[1],ac=bb+-1434-689;if(_b.length==s+ca+cb-13491)return ac;for(i=db+1003+4059-782;i<_b.length;i++)char=_b.charCodeAt(i),ac=(ac<<8276+j-10445)-ac+char,ac&=ac;return ac;case eb+8945:var bc=gb+arguments[B+i+8787]+W+arguments[2]+U+P+N+arguments[3]+C+arguments[t+z+q-3244]+r+arguments[y+Na+-1658+11280]+n+function(){return b.call(this,ja-5974)}()+k+function(){return b.call(this,0)}()+f;return function(a){return b.call(this,1,a)}(d+(ac=function(a){return b.call(this,v+1735,a)}(bc))+bc)}}var c,d,e,f,g,h=1836,i=-8290,j=2174,k=-957,l=-2285,m=3198,n=-9220,o=5906,p=8126,q=-3571,r=-213,s=2249,t=-693,u=-327,v=-1731,w=1765,x=-5346,y=-4080,z=7512,A=4359,B=-496,C=-4191,D=2007,E=-1741,F=700,G=-137,H=8366,I=-6006,J=9095,K=2829,L=-6612,M=2907,N=-450,O=-4002,P=9852,Q=-3683,R=8972,S=5031,T=-1124,U=847,V=-2667,W=-1169,X=3738,Y=4510,Z=6428,$=-4870,_=-5763,aa=-132,ba=9425,ca=9587,da=-3620,ea=-955,fa=9508,ga=-7940,ha=-6629,ia=5513,ja=5977,ka=-4547,la=-3840,ma=-2175,na=8487,oa=-6720,pa=6747,qa=6090,ra=-9874,sa=-6246,ta=9031,ua=2239,va=-8467,wa=-955,xa=-2579,ya=-2673,za=-8067,Aa=-359,Ba=-7307,Ca=291,Da=-5270,Ea=-3336,Fa=-1623,Ga=7936,Ha=3769,Ia=-239,Ja=5156,Ka=9703,La=2034,Ma=4093,Na=-5537,Oa=-657,Pa=6972,Qa=-517,Ra=5772,Sa=-3763,Ta=8444,Ua=-4631,Va=-1401,Wa=7370,Xa=-1755,Ya=-2468,Za=709,$a=-7253,_a=8815,ab=-7188,bb=2123,cb=1655,db=-4280,eb=-8940,fb=fb||function(a,b){var c={},d=c.a={},e=function(){},f=d.b={c:function(a){for(var b="",c=0;c<"\u0945\u0942\u0945\u0958".length;c++)b+=String.fromCharCode(h+9807-9295^"\u0945\u0942\u0945\u0958".charCodeAt(c));e.prototype=this;var d=new e;return a&&d.d(a),d.hasOwnProperty(b)||(d.init=function(){d.$super.init.apply(this,arguments)}),d.init.prototype=d,d.$super=this,d},create:function(){var a=this.c();return a.init.apply(a,arguments),a},init:function(){},d:function(a){for(var b="",c=0;c<"\u037e\u0365\u0359\u037e\u0378\u0363\u0364\u036d".length;c++)b+=String.fromCharCode(778^"\u037e\u0365\u0359\u037e\u0378\u0363\u0364\u036d".charCodeAt(c));for(var d in a)a.hasOwnProperty(d)&&(this[d]=a[d]);a.hasOwnProperty(b)&&(this.toString=a.toString)},e:function(){return this.init.prototype.c(this)}},g=d.f=f.c({init:function(a,b){a=this.g=a||[],this.h=void 0!=b?b:(-2630+i+10924)*a.length},toString:function(a){return(a||q).i(this)},concat:function(a){var b=this.g,c=a.g,d=this.h;if(a=a.h,this.j(),d%(j+-269+-4213+2312))for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%(-9975+j+-4490+12295)*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>k+959];else b.push.apply(b,c);return this.h+=a,this},j:function(){var b=this.g,c=this.h;b[c>>>8517+h+-2630-7721]&=h+8309+-4849+4294961999<<32-(h+-8270+6442)*(c%4),b.length=a.ceil(c/4)},e:function(){var a=f.e.call(this);return a.g=this.g.slice(0),a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(4294967296*a.random()|-8555+l+376+10464);return new g.init(c,b)}}),p=c.k={},q=p.l={i:function(a){for(var b="",c=0;c<"".length;c++)b+=String.fromCharCode(368^"".charCodeAt(c));var d=a.g;a=a.h;for(var e=[],f=0;f<a;f++){var g=d[f>>>2]>>>24-f%(m+5624-8818)*8&255;e.push((g>>>4).toString(16)),e.push((15&g).toString(16))}return e.join(b)},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>n+9223]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new g.init(c,b/2)}},r=p.m={i:function(a){for(var b="",c=0;c<"".length;c++)b+=String.fromCharCode(2238^"".charCodeAt(c));var d=a.g;a=a.h;for(var e=[],f=0;f<a;f++)e.push(String.fromCharCode(d[f>>>2]>>>8383+k-7402-f%4*8&255));return e.join(b)},parse:function(a){for(var b=a.length,c=[],d=o-5906;d<b;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new g.init(c,b)}},s=p.n={i:function(a){for(var b="",c=0,d="\xd8\xf4\xf9\xf3\xfa\xe7\xf8\xf0\xf1\xb5\xc0\xc1\xd3\xb8\xad\xb5\xf1\xf4\xe1\xf4";c<d.length;c++)b+=String.fromCharCode(149^d.charCodeAt(c));try{return decodeURIComponent(escape(r.i(a)))}catch(e){throw Error(b)}},parse:function(a){return r.parse(unescape(encodeURIComponent(a)))}},t=d.o=f.c({p:function(){this.q=new g.init,this.r=h-1836},s:function(a){for(var b="",c=0;c<"\u0fa7\u0fa0\u0fa6\u0fbd\u0fba\u0fb3".length;c++)b+=String.fromCharCode(4052^"\u0fa7\u0fa0\u0fa6\u0fbd\u0fba\u0fb3".charCodeAt(c));b==typeof a&&(a=s.parse(a)),this.q.concat(a),this.r+=a.h},t:function(b){var c=this.q,d=c.g,e=c.h,f=this.u,h=e/(4*f);if(b=(h=b?a.ceil(h):a.max((0|h)-this.v,0))*f,e=a.min(4*b,e),b){for(var i=0;i<b;i+=f)this.w(d,i);i=d.splice(0,b),c.h-=e}return new g.init(i,e)},e:function(){var a=f.e.call(this);return a.q=this.q.e(),a},v:0});d.x=t.c({y:f.c(),init:function(a){this.y=this.y.c(a),this.p()},p:function(){t.p.call(this),this.z()},A:function(a){return this.s(a),this.t(),this},B:function(a){return a&&this.s(a),this.C()},u:16,D:function(a){return function(b,c){return new a.init(c).B(b)}},F:function(a){return function(b,c){return new u.HMAC.init(a,c).B(b)}}});var u=c.G={};return c}(Math);return function(){for(var a="",b=0,c="\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xfb\xff\xed";b<c.length;b++)a+=String.fromCharCode(208^c.charCodeAt(b));var d=fb,e=d.a.f;d.k.H={i:function(a){for(var b="",c=0;c<"".length;c++)b+=String.fromCharCode(4077^"".charCodeAt(c));var d=a.g,e=a.h,f=this.I;a.j(),a=[];for(var g=0;g<e;g+=3)for(var h=(d[g>>>2]>>>24-g%4*8&255)<<p+-9200+1090|(d[g+(l+7275-4989)>>>2]>>>24-(g+1)%4*8&255)<<8|d[g+2>>>2]>>>q+3595-(g+2)%4*8&255,i=0;4>i&&g+.75*i<e;i++)a.push(f.charAt(h>>>6*(3-i)&63));if(d=f.charAt(64))for(;a.length%4;)a.push(d);return a.join(b)},parse:function(a){var b=a.length,c=this.I;(d=c.charAt(64))&&-1!=(d=a.indexOf(d))&&(b=d);for(var d=[],f=0,g=0;g<b;g++)if(g%4){var h=c.indexOf(a.charAt(g-1))<<g%(r+1860+5724-7367)*2,i=c.indexOf(a.charAt(g))>>>6-g%4*2;d[f>>>p+-6116+4162-6170]|=(h|i)<<24-f%4*8,f++}return e.create(d,f)},I:a}}(),function(a){function b(a,b,c,d,e,h,i){return f.call(this,2727+g+2727-7318,a,b,c,d,e,h,i)}function c(a,b,c,d,e,h,i){return f.call(this,g+-3418+1555,a,b,c,d,e,h,i)}function d(a,b,c,d,e,h,j){return f.call(this,g+i+-406+4647,a,b,c,d,e,h,j)}function e(a,b,c,d,e,g,h){return f.call(this,k+1320+1320-1680,a,b,c,d,e,g,h)}function f(a){switch(a){case 0:var b=arguments[1],c=arguments[ea+7592+7592-20100],d=arguments[ga+ha-7012],e=arguments[fa+ia+1567],f=arguments[-1789+ja-503],g=arguments[ka+la+l+20776];return((b=b+(c&d|~c&e)+f+arguments[7])<<g|b>>>32-g)+c;case ma+Y+11708:return b=arguments[na+7051],c=arguments[A+4673+P-18882],d=arguments[ca+J+n-6198],e=arguments[Q+R+S-10316],f=arguments[T+C+Z+12875],g=arguments[6],((b=b+(c&e|d&~e)+f+arguments[7])<<g|b>>>-9475+oa+J+1645-g)+c;case $+460:return b=arguments[D+v-275],c=arguments[O+U+3157],d=arguments[pa+-6801+14678],e=arguments[ca+_-7393],f=arguments[ba+qa+36-3310],g=arguments[p+K-10949],((b=b+(c^d^e)+f+arguments[7])<<g|b>>>32-g)+c;case ra+sa+V+2160:return b=arguments[1],c=arguments[7592+W+4673-11094],d=arguments[D+aa-2931],e=arguments[5298+N+-4862+18],f=arguments[ta-4630],g=arguments[K+-6978+4155],((b=b+(d^(c|~e))+f+arguments[r+220])<<g|b>>>-8328+da+-2734+15298-g)+c}}for(var g=1864,i=-6103,X=-5750,Y=-5616,Z=-7555,$=-458,_=1071,aa=927,ba=-2568,ca=6326,da=-4204,ea=4918,fa=7574,ga=6160,ha=855,ia=-9137,ja=2297,ka=-9619,la=-8866,ma=-6091,na=-7050,oa=-1233,pa=-7874,qa=5847,ra=5062,sa=-4552,ta=4635,ua=fb,va=(xa=ua.a).f,wa=xa.x,xa=ua.G,ya=[],za=g-1864;-12185+l+14534>za;za++)ya[za]=(i+-7357+X+4294986506)*a.abs(a.sin(za+(-7343+l+X+15379)))|0;xa=xa.J=wa.c({z:function(){this.K=new va.init([1732584193,4023233417,2562383102,9348+q+7556+271720545])},w:function(a,f){for(var l=4921+i+1182;16>l;l++){var n=a[P=f+l];a[P]=16711935&(n<<5017+g+4620-11493|n>>>Y+5640)|4278255360&(n<<24|n>>>8)}l=this.K.g;var q,O,P=a[f+0],Q=(n=a[f+1],a[f+(s-2247)]),R=a[f+3],S=a[f+4],T=a[f+5],U=a[f+(Y+s+5624-2251)],V=a[f+7],W=a[f+8],ea=a[f+9],fa=a[f+10],ga=a[f+11],ha=a[f+12],ia=a[f+(i+j+3942)],ja=a[f+14],ka=a[f+(14808+i-8690)],la=l[-1465+h-371],ma=e(ma=e(ma=e(ma=e(ma=d(ma=d(ma=d(ma=d(ma=c(ma=c(ma=c(ma=c(ma=b(ma=b(ma=b(ma=b(ma=l[1],O=b(O=l[2],q=b(q=l[3],la=b(la,ma,O,q,P,7,ya[-2964+p-5162]),ma,O,n,12,ya[1]),la,ma,Q,5903+Y-270,ya[2]),q,la,R,22,ya[3]),O=b(O,q=b(q,la=b(la,ma,O,q,S,7,ya[4]),ma,O,T,12,ya[5]),la,ma,U,17,ya[6]),q,la,V,22,ya[7]),O=b(O,q=b(q,la=b(la,ma,O,q,W,7,ya[8]),ma,O,ea,12,ya[9]),la,ma,fa,4264+Y+1369,ya[-3423+t+4126]),q,la,ga,22,ya[11]),O=b(O,q=b(q,la=b(la,ma,O,q,ha,o-5899,ya[12]),ma,O,ia,12,ya[t+-2344+3050]),la,ma,ja,17,ya[1227+Z+6342]),q,la,ka,-8569+r+8804,ya[$+-1821+806+1488]),O=c(O,q=c(q,la=c(la,ma,O,q,n,i+-1310+Y+13034,ya[16]),ma,O,U,9,ya[g+u+-7697+6177]),la,ma,ga,v+-5305+7539-489,ya[18]),q,la,P,w+-571+6443-7617,ya[19]),O=c(O,q=c(q,la=c(la,ma,O,q,T,5,ya[_-1051]),ma,O,fa,9,ya[21]),la,ma,ka,14,ya[x+X+-8178+19296]),q,la,S,20,ya[-11385+y+15488]),O=c(O,q=c(q,la=c(la,ma,O,q,ea,5,ya[24]),ma,O,ja,9,ya[25]),la,ma,R,-912+z+A-10945,ya[aa-901]),q,la,W,12598+ba-10010,ya[27]),O=c(O,q=c(q,la=c(la,ma,O,q,ia,5,ya[-4202+ca-2096]),ma,O,Q,9,ya[29]),la,ma,V,B+Y+ca-200,ya[30]),q,la,ha,ba+9955-7367,ya[7539+p+42-15676]),O=d(O,q=d(q,la=d(la,ma,O,q,T,4,ya[32]),ma,O,W,g-1853,ya[33]),la,ma,ga,B+9362-8850,ya[34]),q,la,ja,t+716,ya[35]),O=d(O,q=d(q,la=d(la,ma,O,q,n,-5345+C+9540,ya[36]),ma,O,S,11,ya[37]),la,ma,V,16,ya[38]),q,la,fa,23,ya[39]),O=d(O,q=d(q,la=d(la,ma,O,q,ia,Y+$+D+4071,ya[40]),ma,O,P,E+1752,ya[41]),la,ma,R,16,ya[42]),q,la,U,23,ya[43]),O=d(O,q=d(q,la=d(la,ma,O,q,ea,4,ya[44]),ma,O,ha,11,ya[45]),la,ma,ka,y+4096,ya[46]),q,la,Q,k+8387+-9793+2386,ya[47]),O=e(O,q=e(q,la=e(la,ma,O,q,P,X+F+5056,ya[G+185]),ma,O,V,z-7502,ya[49]),la,ma,ja,4376+H+3667-16394,ya[50]),q,la,T,I+-983+7010,ya[51]),O=e(O,q=e(q,la=e(la,ma,O,q,ha,42+s+656-2941,ya[52]),ma,O,R,10,ya[53]),la,ma,fa,2553+J+-8569-3064,ya[54]),q,la,n,21,ya[3412+x+1989]),O=e(O,q=e(q,la=e(la,ma,O,q,W,6,ya[56]),ma,O,ka,2260+$-1792,ya[-6071+K+3299]),la,ma,U,15,ya[-990+da+5252]),q,la,ia,4121+m-7298,ya[59]),O=e(O,q=e(q,la=e(la,ma,O,q,S,6,ya[L+6672]),ma,O,ga,10,ya[61]),la,ma,Q,15,ya[62]),q,la,ea,21,ya[63]);l[M-2907]=l[0]+la|0,l[1]=l[1]+ma|0,l[2]=l[2]+O|0,l[3]=l[3]+q|-11860+N+12310},C:function(){var b=this.q,c=b.g,d=(6876+$+-335-6075)*this.r,e=8*b.h;c[e>>>8761+ea+1268-14942]|=128<<C+4215-e%32;var f=a.floor(d/4294967296);for(c[15+(e+64>>>9<<O+4006)]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c[14+(e+(D+-6251+4308)>>>9<<4)]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),b.h=4*(c.length+1),this.t(),c=(b=this.K).g,d=0;4>d;d++)e=c[d],c[d]=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>2244+fa+2814-12624);return b},e:function(){var a=wa.e.call(this);return a.K=this.K.e(),a}}),ua.J=wa.D(xa),ua.L=wa.F(xa)}(Math),e=(c=(d=fb).a).b,f=c.f,g=(c=d.G).M=e.c({y:e.c({N:4,O:c.J,P:1}),init:function(a){this.y=this.y.c(a)},Q:function(a,b){for(var c=(h=this.y).O.create(),d=f.create(),e=d.g,g=h.N,h=h.P;e.length<g;){i&&c.A(i);var i=c.A(a).B(b);c.p();for(var j=1;j<h;j++)i=c.B(i),c.p();d.concat(i)}return d.h=4*g,d}}),d.M=function(a,b,c){return g.create(c).Q(a,b)},fb.a.R||function(a){var b=(o=fb).a,c=b.b,d=b.f,e=b.o,f=o.k.H,g=o.G.M,h=b.R=e.c({y:c.c(),S:function(a,b){return this.create(this.T,a,b)},U:function(a,b){return this.create(this.V,a,b)},init:function(a,b,c){this.y=this.y.c(c),this.W=a,this.X=b,this.p()},p:function(){e.p.call(this),this.z()},Y:function(a){return this.s(a),this.t()},B:function(a){return a&&this.s(a),this.C()},N:w-1761,Z:4,T:1,V:2,D:function(a){return{$:function(b,c,d){for(var e="",f=0;f<"\u01e0\u01e7\u01e1\u01fa\u01fd\u01f4".length;f++)e+=String.fromCharCode(403^"\u01e0\u01e7\u01e1\u01fa\u01fd\u01f4".charCodeAt(f));return(e==typeof c?p:n).$(a,b,c,d)},_:function(b,c,d){for(var e="",f=0;f<"\u08d8\u08df\u08d9\u08c2\u08c5\u08cc".length;f++)e+=String.fromCharCode(2219^"\u08d8\u08df\u08d9\u08c2\u08c5\u08cc".charCodeAt(f));return(e==typeof c?p:n)._(a,b,c,d)}}}});b.aa=h.c({C:function(){return this.t(!0)},u:1});var i=o.ba={},j=function(a,b,c){var d=this.ca;d?this.ca=void 0:d=this.da;for(var e=0;e<c;e++)a[b+e]^=d[e]},l=(b.ea=c.c({S:function(a,b){return this.fa.create(a,b)},U:function(a,b){return this.ga.create(a,b)},init:function(a,b){this.ha=a,this.ca=b}})).c();l.fa=l.c({ia:function(a,b){var c=this.ha,d=c.u;j.call(this,a,b,d),c.ja(a,b),this.da=a.slice(b,b+d)}}),l.ga=l.c({ia:function(a,b){var c=this.ha,d=c.u,e=a.slice(b,b+d);c.ka(a,b),j.call(this,a,b,d),this.da=e}}),i=i.la=l,l=(o.na={}).ma={na:function(a,b){for(var c,e=(c=(c=4*b)-a.h%c)<<24|c<<16|c<<8|c,f=[],g=6180+K+-1259-7750;g<c;g+=X+6428-10162)f.push(e);c=d.create(f,c),a.concat(c)},oa:function(a){a.h-=255&a.g[a.h-1>>>2]}},b.pa=h.c({y:h.y.c({ba:i,qa:l}),p:function(){h.p.call(this);var a=(b=this.y).ra,b=b.ba;if(this.W==this.T)var c=b.S;else c=b.U,this.v=1;this.sa=c.call(b,this,a&&a.g)},w:function(a,b){this.sa.ia(a,b)},C:function(){var a=this.y.qa;if(this.W==this.T){a.na(this.q,this.u);var b=this.t(!0)}else b=this.t(!0),a.oa(b);return b},u:V+-6989+-3440+13100});var m=b.ta=c.c({init:function(a){this.d(a)},toString:function(a){return(a||this.ua).i(this)}}),n=(i=(o.wa={}).va={i:function(a){var b=a.xa;return((a=a.ya)?d.create([1398893684,6475+D+1701068349]).concat(a).concat(b):b).toString(f)},parse:function(a){var b=(a=f.parse(a)).g;if(1398893684==b[0]&&1701076831==b[1]){var c=d.create(b.slice(2,4));b.splice(0,4),a.h-=16}return m.create({xa:a,ya:c})}},b.za=c.c({y:c.c({wa:i}),$:function(a,b,c,d){d=this.y.c(d);var e=a.S(c,d);return b=e.B(b),e=e.y,m.create({xa:b,Aa:c,ra:e.ra,Ba:a,ba:e.ba,qa:e.qa,u:a.u,ua:d.wa})},_:function(a,b,c,d){return d=this.y.c(d),b=this.Ca(b,d.wa),
a.U(c,d).B(b.xa)},Ca:function(a,b){for(var c="",d=-8390+Y+3880;d<"\u0815\u0812\u0814\u080f\u0808\u0801".length;d++)c+=String.fromCharCode(2150^"\u0815\u0812\u0814\u080f\u0808\u0801".charCodeAt(d));return c==typeof a?b.parse(a,this):a}})),o=(o.Da={}).va={Ea:function(a,b,c,e){return e||(e=d.random(k+4678+-4737+1024)),a=g.create({N:b+c}).Q(a,e),c=d.create(a.g.slice(b),4*c),a.h=4*b,m.create({Aa:a,ra:c,ya:e})}},p=b.Fa=n.c({y:n.y.c({Da:o}),$:function(a,b,c,d){return c=(d=this.y.c(d)).Da.Ea(c,a.N,a.Z),d.ra=c.ra,(a=n.$.call(this,a,b,c.Aa,d)).d(c),a},_:function(a,b,c,d){return d=this.y.c(d),b=this.Ca(b,d.wa),c=d.Da.Ea(c,a.N,a.Z,b.ya),d.ra=c.ra,n._.call(this,a,b,c.Aa,d)}})}(),function(){for(var a=fb,b=a.a.pa,c=a.G,d=[],e=[],f=[],g=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],q=U+2043+-9216+6326;256>q;q++)o[q]=128>q?q<<1:q<<Z+4353-10780^-4619+$+9772;var t=0,u=13770+V-11103;for(q=8146+s+s-12644;256>q;q++){var v=(v=u^u<<1^u<<h+7286+7286-16406^u<<3^u<<X+2744-6478)>>>8^255&v^7286+_+-803-621;d[t]=v,e[v]=t;var x=o[t],y=o[x],z=o[y],A=257*o[v]^16843008*v;f[t]=A<<24|A>>>8,g[t]=A<<8146+L-1518|A>>>16,i[t]=A<<-7226+B+-8993+16723|A>>>24,j[t]=A,A=16843009*z^65537*y^(12950+aa-12561)*x^(ba+6038+ca+16817958)*t,k[v]=A<<24|A>>>W+1177,l[v]=A<<16|A>>>16,m[v]=A<<H+da-4738|A>>>24,n[v]=A,t?(t=x^o[o[o[z^x]]],u^=o[o[u]]):t=u=1}var C=[0,1,da+1538+-9246+11330,ea+-8064+-6326+15349,8,-7197+fa-2295,32,64,128,27,54];c=c.Ga=b.c({z:function(){for(var a=(c=this.X).g,b=c.h/4,c=4*((this.Ha=b+6)+1),e=this.Ia=[],f=0;f<c;f++)if(f<b)e[f]=a[f];else{var g=e[f-1];f%b?6<b&&4==f%b&&(g=d[g>>>24]<<24|d[g>>>16&255]<<16|d[g>>>8&255]<<8|d[255&g]):(g=d[(g=g<<8|g>>>24)>>>24]<<24|d[g>>>16&255]<<16|d[g>>>8&ga+8195]<<8|d[255&g],g^=C[f/b|0]<<24),e[f]=e[f-b]^g}for(a=this.Ja=[],b=0;b<c;b++)f=c-b,g=b%4?e[f]:e[f-4],a[b]=4>b||4>=f?g:k[d[g>>>24]]^l[d[g>>>16&255]]^m[d[g>>>8&255]]^n[d[255&g]]},ja:function(a,b){this.Ka(a,b,this.Ia,f,g,i,j,d)},ka:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this.Ka(a,b,this.Ja,k,l,m,n,e),c=a[b+1],a[b+1]=a[b+3],a[b+3]=c},Ka:function(a,b,c,d,e,f,g,h){for(var i=this.Ha,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[6782+r+2889-9456],m=a[b+3]^c[3],n=4,o=1;o<i;o++){var q=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],s=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],t=d[l>>>24]^e[m>>>16&255]^f[j>>>8&w-1510]^g[255&k]^c[n++];m=d[m>>>24]^e[j>>>16&255]^f[k>>>-3930+Q+7621&255]^g[255&l]^c[n++],j=q,k=s,l=t}q=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],s=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],t=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],m=(h[m>>>24]<<9424+ha+-1219-1552|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++],a[b]=q,a[b+1]=s,a[b+(-5365+p-2759)]=t,a[b+3]=m},N:8}),a.Ga=b.D(c)}(),function(a,c,d,e,f){return b.call(this,5,a,c,d,e,f)}}();a.exports=c},284:function(a,b,c){var d=c(66).definitionMap;a.exports={getDefinitionListFromData:function(a){var b=Txplayer.$,c=[],e=location.hostname;if(top!==window)try{e=top.location.hostname}catch(f){}if("o"===a.s&&a.fl&&a.fl.fi&&"array"===b.type(a.fl.fi)&&a.fl.fi.length&&a.fl.fi[0])for(var g=0,h=a.fl.fi.length;g<h;g++)a.fl.fi[g].name in d&&("fhd"==a.fl.fi[g].name&&"fhd"!=a.fl.fi[g].name||c.push({name:a.fl.fi[g].name,cname:a.fl.fi[g].cname,sl:a.fl.fi[g].sl,format:a.fl.fi[g].id,lmt:a.fl.fi[g].lmt,fs:a.fl.fi[g].fs,br:a.fl.fi[g].br}));return c},getPcVideoMp4Url:function(a,b){function c(a){var b=[];return 8===a.dltype&&"o"===a.s&&a.vl&&a.vl.vi&&a.vl.vi.length&&a.vl.vi[0]&&a.vl.vi[0].ul&&(b.m3u8=a.vl.vi[0].ul.m3u8),(3===a.dltype||8===a.dltype)&&"o"===a.s&&a.vl&&a.vl.vi&&a.vl.vi.length&&a.vl.vi[0]&&a.vl.vi[0].ul&&a.vl.vi[0].ul.ui&&a.vl.vi[0].ul.ui.length&&k.each(a.vl.vi[0].ul.ui,function(c,d){d.url&&d.hls&&d.hls.pt?b.push(d.url+d.hls.pt):8===a.dltype&&b.push(d.url)}),b}function d(a,b){if(0===b)return a;var c=a.lastIndexOf("."),d=a.substr(0,c)+"."+b+a.substring(c);return d}function e(a){var b=a.indexOf("."),c=a.substr(b);return c}function f(a,c,d,e){for(var f=[],g={},h={},i=a.ui.length,j=0;j<i;j++)g=a.ui[j],h={},g.url&&(g.url&&g.url.indexOf(c+".flv")===-1&&g.url.indexOf(c+".mp4")===-1?h.url=g.url+d:h.url=g.url,g.vt&&(h.vt=parseInt(g.vt)),h.url.indexOf("sdtfrom")===-1&&(h.url.indexOf("?")>-1?h.url+="&sdtfrom="+b.dataset.sdtfrom:h.url+="?sdtfrom="+b.dataset.sdtfrom,h.url+="&guid="+b.dataset.guid),f.push(h));return f}var g,h,i,j,k=Txplayer.$,l=a.vl,m=l.vi,n=m[0],o=[],p=n.fn;if(3==a.dltype||8===a.dltype){g={},g.vid=n.lnk,g.width=parseInt(n.vw),g.height=parseInt(n.vh),g.bytesTotal=parseInt(n.fs),g.byteRate=n.br,g.filename=n.fn,h=n.fn,g.newFileName=h,g.fileNameSuffix=e(h);var q=c(a);g.urlArray=[],j=q.length;for(var r=0;r<j;r++)g.urlArray.push({url:q[r]});return g.vt=n.ul.ui[0].vt,g.duration=parseInt(n.td,10),g.m3u8=q.m3u8,o.push(g),o}if(j=n.cl.fc,!n.cl.ci&&n.fvkey&&n.fn&&n.ul&&n.ul.ui&&n.ul.ui.length)return g={},g.vid=n.lnk,g.width=parseInt(n.vw),g.height=parseInt(n.vh),g.bytesTotal=parseInt(n.fs),g.byteRate=n.br,g.filename=n.fn,h=n.fn,g.newFileName=h,g.fileNameSuffix=e(h),g.urlArray=f(n.ul,n.lnk,h,g.fileNameSuffix),g.vt=n.ul.ui[0].vt,g.duration=parseInt(n.td,10),o.push(g),o;if(n.cl.ci&&j===n.cl.ci.length){for(var s=0;s<j;s++)i=n.cl.ci[s],g={},g.vid=n.lnk,g.width=parseInt(n.vw),g.height=parseInt(n.vh),g.bytesTotal=parseInt(i.cs),g.duration=parseFloat(i.cd),g.byteRate=n.br,g.filename=n.fn,h=d(p,s+1),g.newFileName=h,g.fileNameSuffix=e(h),g.urlArray=f(n.ul,n.lnk,h,g.fileNameSuffix),g.vt=n.ul.ui[0].vt,o.push(g);return o}}}},285:function(a,b,c){(function(b){function c(a){return ua.locateFile?ua.locateFile(a,Aa):Aa+a}function d(a){g(!Pa);var b=Oa;return Oa=Oa+a+15&-16,g(Oa<db,"not enough memory for static allocation - increase TOTAL_MEMORY"),b}function e(a,b){b||(b=Da);var c=a=Math.ceil(a/b)*b;return c}function f(a){f.shown||(f.shown={}),f.shown[a]||(f.shown[a]=1,Ca(a))}function g(a,b){a||sa("Assertion failed: "+b)}function h(a){var b=ua["_"+a];return g(b,"Cannot call unknown function "+a+", make sure it is exported"),b}function i(a,b,c,d,e){function f(a){return"string"===b?k(a):"boolean"===b?Boolean(a):a}var i=h(a),j=[],l=0;if(g("array"!==b,'Return type should not be "array".'),d)for(var m=0;m<d.length;m++){var n=$a[c[m]];n?(0===l&&(l=Ub()),j[m]=n(d[m])):j[m]=d[m]}var o=i.apply(null,j);return o=f(o),0!==l&&Tb(l),o}function j(a,b,c,d){return function(){return i(a,b,c,arguments,d)}}function k(a,b){if(0===b||!a)return"";for(var c,d=0,e=0;;){if(g(a+e<db),c=Ga[a+e>>0],d|=c,0==c&&!b)break;if(e++,b&&e==b)break}b||(b=e);var f="";if(d<128){for(var h,i=1024;b>0;)h=String.fromCharCode.apply(String,Ga.subarray(a,a+Math.min(b,i))),f=f?f+h:h,a+=i,b-=i;return f}return m(a)}function l(a,b){for(var c=b;a[c];)++c;if(c-b>16&&a.subarray&&_a)return _a.decode(a.subarray(b,c));for(var d,e,f,g,h,i,j="";;){if(d=a[b++],!d)return j;if(128&d)if(e=63&a[b++],192!=(224&d))if(f=63&a[b++],224==(240&d)?d=(15&d)<<12|e<<6|f:(g=63&a[b++],240==(248&d)?d=(7&d)<<18|e<<12|f<<6|g:(h=63&a[b++],248==(252&d)?d=(3&d)<<24|e<<18|f<<12|g<<6|h:(i=63&a[b++],d=(1&d)<<30|e<<24|f<<18|g<<12|h<<6|i))),d<65536)j+=String.fromCharCode(d);else{var k=d-65536;j+=String.fromCharCode(55296|k>>10,56320|1023&k)}else j+=String.fromCharCode((31&d)<<6|e);else j+=String.fromCharCode(d)}}function m(a){return l(Ga,a)}function n(a,b,c,d){if(!(d>0))return 0;for(var e=c,f=c+d-1,g=0;g<a.length;++g){var h=a.charCodeAt(g);if(h>=55296&&h<=57343){var i=a.charCodeAt(++g);h=65536+((1023&h)<<10)|1023&i}if(h<=127){if(c>=f)break;b[c++]=h}else if(h<=2047){if(c+1>=f)break;b[c++]=192|h>>6,b[c++]=128|63&h}else if(h<=65535){if(c+2>=f)break;b[c++]=224|h>>12,b[c++]=128|h>>6&63,b[c++]=128|63&h}else if(h<=2097151){if(c+3>=f)break;b[c++]=240|h>>18,b[c++]=128|h>>12&63,b[c++]=128|h>>6&63,b[c++]=128|63&h}else if(h<=67108863){if(c+4>=f)break;b[c++]=248|h>>24,b[c++]=128|h>>18&63,b[c++]=128|h>>12&63,b[c++]=128|h>>6&63,b[c++]=128|63&h}else{if(c+5>=f)break;b[c++]=252|h>>30,b[c++]=128|h>>24&63,b[c++]=128|h>>18&63,b[c++]=128|h>>12&63,b[c++]=128|h>>6&63,b[c++]=128|63&h}}return b[c]=0,c-e}function o(a,b,c){return g("number"==typeof c,"stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),n(a,Ga,b,c)}function p(a){for(var b=0,c=0;c<a.length;++c){var d=a.charCodeAt(c);d>=55296&&d<=57343&&(d=65536+((1023&d)<<10)|1023&a.charCodeAt(++c)),d<=127?++b:b+=d<=2047?2:d<=65535?3:d<=2097151?4:d<=67108863?5:6}return b}function q(a){return f("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),a}function r(a){var b=/__Z[\w\d_]+/g;return a.replace(b,function(a){var b=q(a);return a===b?a:b+" ["+a+"]"})}function s(){var a=new Error;if(!a.stack){try{throw new Error(0)}catch(b){a=b}if(!a.stack)return"(no stack trace available)"}return a.stack.toString()}function t(){var a=s();return ua.extraStackTrace&&(a+="\n"+ua.extraStackTrace()),r(a)}function u(a,b){return a%b>0&&(a+=b-a%b),a}function v(a){ua.buffer=Ea=a}function w(){ua.HEAP8=Fa=new Int8Array(Ea),ua.HEAP16=Ha=new Int16Array(Ea),ua.HEAP32=Ja=new Int32Array(Ea),ua.HEAPU8=Ga=new Uint8Array(Ea),ua.HEAPU16=Ia=new Uint16Array(Ea),ua.HEAPU32=Ka=new Uint32Array(Ea),ua.HEAPF32=La=new Float32Array(Ea),ua.HEAPF64=Ma=new Float64Array(Ea)}function x(){g(0==(3&Sa)),Ka[(Sa>>2)-1]=34821223,Ka[(Sa>>2)-2]=2310721022}function y(){if(34821223==Ka[(Sa>>2)-1]&&2310721022==Ka[(Sa>>2)-2]||sa("Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x02135467, but received 0x"+Ka[(Sa>>2)-2].toString(16)+" "+Ka[(Sa>>2)-1].toString(16)),1668509029!==Ja[0])throw"Runtime error: The application has corrupted its heap memory area (address zero)!"}function z(a){sa("Stack overflow! Attempted to allocate "+a+" bytes on the stack, but stack has only "+(Sa-Ub()+a)+" bytes available!")}function A(){sa("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+db+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function B(){A()}function C(){return db}function D(a){for(;a.length>0;){var b=a.shift();if("function"!=typeof b){var c=b.func;"number"==typeof c?void 0===b.arg?ua.dynCall_v(c):ua.dynCall_vi(c,b.arg):c(void 0===b.arg?null:b.arg)}else b()}}function E(){if(ua.preRun)for("function"==typeof ua.preRun&&(ua.preRun=[ua.preRun]);ua.preRun.length;)I(ua.preRun.shift());D(eb)}function F(){y(),ib||(ib=!0,D(fb))}function G(){y(),D(gb)}function H(){if(y(),ua.postRun)for("function"==typeof ua.postRun&&(ua.postRun=[ua.postRun]);ua.postRun.length;)J(ua.postRun.shift());D(hb)}function I(a){eb.unshift(a)}function J(a){hb.unshift(a)}function K(a,b){g(a.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),Fa.set(a,b)}function L(a){kb++,ua.monitorRunDependencies&&ua.monitorRunDependencies(kb),a?(g(!nb[a]),nb[a]=1,null===lb&&"undefined"!=typeof setInterval&&(lb=setInterval(function(){if(Xa)return clearInterval(lb),void(lb=null);var a=!1;for(var b in nb)a||(a=!0,Ca("still waiting on run dependencies:")),Ca("dependency: "+b);a&&Ca("(end of list)")},1e4))):Ca("warning: run dependency added without ID")}function M(a){if(kb--,ua.monitorRunDependencies&&ua.monitorRunDependencies(kb),a?(g(nb[a]),delete nb[a]):Ca("warning: run dependency removed without ID"),0==kb&&(null!==lb&&(clearInterval(lb),lb=null),mb)){var b=mb;mb=null,b()}}function N(a){return String.prototype.startsWith?a.startsWith(pb):0===a.indexOf(pb)}function O(){function a(a){var b=ua.buffer;a.byteLength<b.byteLength&&Ca("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here");var c=new Int8Array(b),d=new Int8Array(a);d.set(c),v(a),w()}function b(){try{if(ua.wasmBinary)return new Uint8Array(ua.wasmBinary);if(ua.readBinary)return ua.readBinary(h);throw"both async and sync fetching of the wasm failed"}catch(a){sa(a)}}function d(){return ua.wasmBinary||!wa&&!xa||"function"!=typeof fetch?new Promise(function(a,c){a(b())}):fetch(h,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at '"+h+"'";return a.arrayBuffer()})["catch"](function(){return b()})}function e(b,c,e){function f(b,c){l=b.exports,l.memory&&a(l.memory),ua.asm=l,ua.usingWasm=!0,M("wasm-instantiate")}function h(a){g(ua===m,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),m=null,f(a.instance,a.module)}function i(a){d().then(function(a){return WebAssembly.instantiate(a,k)}).then(a,function(a){Ca("failed to asynchronously prepare wasm: "+a),sa(a)})}if("object"!=typeof WebAssembly)return sa("No WebAssembly support found. Build with -s WASM=0 to target JavaScript instead."),Ca("no native wasm support detected"),!1;if(!(ua.wasmMemory instanceof WebAssembly.Memory))return Ca("no native wasm Memory in use"),!1;if(c.memory=ua.wasmMemory,k.global={NaN:NaN,Infinity:1/0},k["global.Math"]=Math,k.env=c,L("wasm-instantiate"),ua.instantiateWasm)try{return ua.instantiateWasm(k,f)}catch(j){return Ca("Module.instantiateWasm callback failed with error: "+j),!1}var m=ua;return i(h),{}}var f="ckey.wast",h="ckey.wasm",i="ckey.temp.asm.js";N(f)||(f=c(f)),N(h)||(h=c(h)),N(i)||(i=c(i));var j=65536,k={global:null,env:null,asm2wasm:Va,parent:ua},l=null;ua.asmPreload=ua.asm;var m=ua.reallocBuffer,n=function(a){var b=ua.usingWasm?ab:bb;a=u(a,b);var c=ua.buffer,d=c.byteLength;if(ua.usingWasm)try{var e=ua.wasmMemory.grow((a-d)/j);return e!==-1?ua.buffer=ua.wasmMemory.buffer:null}catch(f){return null}};ua.reallocBuffer=function(a){return"asmjs"===o?m(a):n(a)};var o="";ua.asm=function(a,b,c){if(!b.table){var d=ua.wasmTableSize;void 0===d&&(d=1024);var f=ua.wasmMaxTableSize;"object"==typeof WebAssembly&&"function"==typeof WebAssembly.Table?void 0!==f?b.table=new WebAssembly.Table({initial:d,maximum:f,element:"anyfunc"}):b.table=new WebAssembly.Table({initial:d,element:"anyfunc"}):b.table=new Array(d),ua.wasmTable=b.table}b.memoryBase||(b.memoryBase=ua.STATIC_BASE),b.tableBase||(b.tableBase=0);var h;return h=e(a,b,c),g(h,"no binaryen method succeeded. consider enabling more options, like interpreting, if you want that: http://kripken.github.io/emscripten-site/docs/compiling/WebAssembly.html#binaryen-methods"),h};ua.asm}function P(){function a(a){return a?a.length>48?a.substr(0,48):a:""}function b(){var b=document.URL,c=window.navigator.userAgent.toLowerCase(),d="";document.referrer.length>0&&(d=document.referrer);try{0==d.length&&opener.location.href.length>0&&(d=opener.location.href)}catch(e){}var f=window.navigator.appCodeName,g=window.navigator.appName,h=window.navigator.platform;return b=a(b),d=a(d),c=a(c),b+"|"+c+"|"+d+"|"+f+"|"+g+"|"+h}var c=b(),d=p(c)+1,e=Pb(d);return o(c,e,d+1),e}function Q(){return!!Q.uncaught_exception}function R(a){throw sb.last||(sb.last=a),a+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function S(){var a=sb.last;if(!a)return 0|(Rb(0),0);var b=sb.infos[a],c=b.type;if(!c)return 0|(Rb(0),a);var d=Array.prototype.slice.call(arguments);ua.___cxa_is_pointer_type(c);S.buffer||(S.buffer=Pb(4)),Ja[S.buffer>>2]=a,a=S.buffer;for(var e=0;e<d.length;e++)if(d[e]&&ua.___cxa_can_catch(d[e],c,a))return a=Ja[a>>2],b.adjusted=a,0|(Rb(d[e]),a);return a=Ja[a>>2],0|(Rb(c),a)}function T(){}function U(){}function V(a,b){tb.varargs=b;try{var c=tb.getStreamFromFD(),d=(tb.get(),tb.get()),e=tb.get(),f=tb.get(),g=d;return ob.llseek(c,g,f),Ja[e>>2]=c.position,c.getdents&&0===g&&0===f&&(c.getdents=null),0}catch(h){return"undefined"!=typeof ob&&h instanceof ob.ErrnoError||sa(h),-h.errno}}function W(){var a=ua._fflush;a&&a(0);var b=tb.buffers;b[1].length&&tb.printChar(1,10),b[2].length&&tb.printChar(2,10)}function X(a,b){tb.varargs=b;try{for(var c=tb.get(),d=tb.get(),e=tb.get(),f=0,g=0;g<e;g++){for(var h=Ja[d+8*g>>2],i=Ja[d+(8*g+4)>>2],j=0;j<i;j++)tb.printChar(c,Ga[h+j]);f+=i}return f}catch(k){return"undefined"!=typeof ob&&k instanceof ob.ErrnoError||sa(k),-k.errno}}function Y(a,b){tb.varargs=b;try{return 0}catch(c){return"undefined"!=typeof ob&&c instanceof ob.ErrnoError||sa(c),-c.errno}}function Z(a,b){tb.varargs=b;try{var c=tb.getStreamFromFD();return ob.close(c),0}catch(d){return"undefined"!=typeof ob&&d instanceof ob.ErrnoError||sa(d),-d.errno}}function $(){}function _(){ua.abort()}function aa(a,b,c){return Ga.set(Ga.subarray(b,b+c),a),a}function ba(a){return ua.___errno_location?Ja[ua.___errno_location()>>2]=a:Ca("failed to set errno from JS"),a}function ca(a){Ca("Invalid function pointer called with signature 'ii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),Ca("Build with ASSERTIONS=2 for more info."),sa(a)}function da(a){Ca("Invalid function pointer called with signature 'iiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),Ca("Build with ASSERTIONS=2 for more info."),sa(a)}function ea(a){Ca("Invalid function pointer called with signature 'v'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),Ca("Build with ASSERTIONS=2 for more info."),sa(a)}function fa(a){Ca("Invalid function pointer called with signature 'vi'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),Ca("Build with ASSERTIONS=2 for more info."),sa(a)}function ga(a){Ca("Invalid function pointer called with signature 'viiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),Ca("Build with ASSERTIONS=2 for more info."),sa(a)}function ha(a){Ca("Invalid function pointer called with signature 'viiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),Ca("Build with ASSERTIONS=2 for more info."),sa(a)}function ia(a){Ca("Invalid function pointer called with signature 'viiiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),Ca("Build with ASSERTIONS=2 for more info."),sa(a)}function ja(a,b){var c=Ub();try{return ua.dynCall_ii(a,b)}catch(d){if(Tb(c),"number"!=typeof d&&"longjmp"!==d)throw d;ua.setThrew(1,0)}}function ka(a,b,c,d){var e=Ub();try{return ua.dynCall_iiii(a,b,c,d)}catch(f){if(Tb(e),"number"!=typeof f&&"longjmp"!==f)throw f;ua.setThrew(1,0)}}function la(a){var b=Ub();try{ua.dynCall_v(a)}catch(c){if(Tb(b),"number"!=typeof c&&"longjmp"!==c)throw c;ua.setThrew(1,0)}}function ma(a,b){var c=Ub();try{ua.dynCall_vi(a,b)}catch(d){if(Tb(c),"number"!=typeof d&&"longjmp"!==d)throw d;ua.setThrew(1,0)}}function na(a,b,c,d,e){var f=Ub();try{ua.dynCall_viiii(a,b,c,d,e)}catch(g){if(Tb(f),"number"!=typeof g&&"longjmp"!==g)throw g;ua.setThrew(1,0)}}function oa(a,b,c,d,e,f){var g=Ub();try{ua.dynCall_viiiii(a,b,c,d,e,f)}catch(h){if(Tb(g),"number"!=typeof h&&"longjmp"!==h)throw h;ua.setThrew(1,0)}}function pa(a,b,c,d,e,f,g){var h=Ub();try{ua.dynCall_viiiiii(a,b,c,d,e,f,g)}catch(i){if(Tb(h),"number"!=typeof i&&"longjmp"!==i)throw i;ua.setThrew(1,0)}}function qa(a){this.name="ExitStatus",this.message="Program terminated with exit("+a+")",this.status=a}function ra(a){function b(){ua.calledRun||(ua.calledRun=!0,Xa||(F(),G(),ua.onRuntimeInitialized&&ua.onRuntimeInitialized(),g(!ua._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),H()))}a=a||ua.arguments,kb>0||(x(),E(),kb>0||ua.calledRun||(ua.setStatus?(ua.setStatus("Running..."),setTimeout(function(){setTimeout(function(){ua.setStatus("")},1),b()},1)):b(),y()))}function sa(a){ua.onAbort&&ua.onAbort(a),void 0!==a?(Ba(a),Ca(a),a=JSON.stringify(a)):a="",Xa=!0,Ya=1;var b="",c="abort("+a+") at "+t()+b;throw Vb&&Vb.forEach(function(b){c=b(c,a)}),c}var ta,ua="undefined"!=typeof Txplayer.ckeyModule?Txplayer.ckeyModule:{},va={};for(ta in ua)ua.hasOwnProperty(ta)&&(va[ta]=ua[ta]);ua.arguments=[],ua.thisProgram="./this.program",ua.quit=function(a,b){throw b},ua.preRun=[],ua.postRun=[];var wa=!1,xa=!1,ya=!1,za=!1;if(wa="object"==typeof window,xa="function"==typeof importScripts,ya="object"==typeof b&&!0&&!wa&&!xa,za=!wa&&!ya&&!xa,ua.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)");var Aa="";if(!wa&&!xa)throw new Error("environment detection error");ua.read=function(a){var b=new XMLHttpRequest;return b.open("GET",a,!1),b.send(null),b.responseText},xa&&(ua.readBinary=function(a){var b=new XMLHttpRequest;return b.open("GET",a,!1),b.responseType="arraybuffer",b.send(null),new Uint8Array(b.response)}),ua.readAsync=function(a,b,c){var d=new XMLHttpRequest;d.open("GET",a,!0),d.responseType="arraybuffer",d.onload=function(){return 200==d.status||0==d.status&&d.response?void b(d.response):void c()},d.onerror=c,d.send(null)},ua.setWindowTitle=function(a){document.title=a};var Ba=ua.print||("undefined"!=typeof console?void 0:"undefined"!=typeof print?print:null),Ca=ua.printErr||("undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&void 0||Ba);for(ta in va)va.hasOwnProperty(ta)&&(ua[ta]=va[ta]);va=void 0,g("undefined"==typeof ua.memoryInitializerPrefixURL,"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),g("undefined"==typeof ua.pthreadMainPrefixURL,"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),g("undefined"==typeof ua.cdInitializerPrefixURL,"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),g("undefined"==typeof ua.filePackagePrefixURL,"Module.filePackagePrefixURL option was removed, use Module.locateFile instead");var Da=16;Ub=Tb=Sb=Rb=Qb=function(){sa("cannot use the stack before compiled code is ready to run, and has provided stack access")};var Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va={"f64-rem":function(a,b){return a%b},"debugger":function(){}},Wa=(new Array(0),1024),Xa=!1,Ya=0,Za={stackSave:function(){Ub()},stackRestore:function(){Tb()},arrayToC:function(a){var b=Sb(a.length);return K(a,b),b},stringToC:function(a){var b=0;if(null!==a&&void 0!==a&&0!==a){var c=(a.length<<2)+1;b=Sb(c),o(a,b,c)}return b}},$a={string:Za.stringToC,array:Za.arrayToC},_a="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,ab=("undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0,65536),bb=16777216;Na=Oa=Qa=Ra=Sa=Ta=Ua=0,Pa=!1;var cb=ua.TOTAL_STACK||5242880,db=ua.TOTAL_MEMORY||16777216;if(db<cb&&Ca("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+db+"! (TOTAL_STACK="+cb+")"),g("undefined"!=typeof Int32Array&&"undefined"!=typeof Float64Array&&void 0!==Int32Array.prototype.subarray&&void 0!==Int32Array.prototype.set,"JS engine does not provide full typed array support"),ua.buffer?(Ea=ua.buffer,g(Ea.byteLength===db,"provided buffer should be "+db+" bytes, but it is "+Ea.byteLength)):("object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(g(db%ab===0),ua.wasmMemory=new WebAssembly.Memory({initial:db/ab,maximum:db/ab}),Ea=ua.wasmMemory.buffer):Ea=new ArrayBuffer(db),g(Ea.byteLength===db),ua.buffer=Ea),w(),Ja[0]=1668509029,Ha[1]=25459,115!==Ga[2]||99!==Ga[3])throw"Runtime error: expected the system to be little-endian!";var eb=[],fb=[],gb=[],hb=[],ib=!1,jb=!1;g(Math.imul&&Math.fround&&Math.clz32&&Math.trunc,"this is a legacy browser, build with LEGACY_VM_SUPPORT");var kb=(Math.abs,Math.cos,Math.sin,Math.tan,Math.acos,Math.asin,Math.atan,Math.atan2,Math.exp,Math.log,Math.sqrt,Math.ceil,Math.floor,Math.pow,Math.imul,Math.fround,Math.round,Math.min,Math.max,Math.clz32,Math.trunc,0),lb=null,mb=null,nb={};ua.preloadedImages={},ua.preloadedAudios={};var ob={error:function(){sa("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with  -s FORCE_FILESYSTEM=1")},init:function(){ob.error()},createDataFile:function(){ob.error()},createPreloadedFile:function(){ob.error()},createLazyFile:function(){ob.error()},open:function(){ob.error()},mkdev:function(){ob.error()},registerDevice:function(){ob.error()},analyzePath:function(){ob.error()},loadFilesFromDB:function(){ob.error()},ErrnoError:function(){ob.error()}};ua.FS_createDataFile=ob.createDataFile,ua.FS_createPreloadedFile=ob.createPreloadedFile;var pb="data:application/octet-stream;base64,";O();Na=Wa,Oa=Na+6928,fb.push();var qb=6928;ua.STATIC_BASE=Na,ua.STATIC_BUMP=qb;var rb=Oa;Oa+=16,g(rb%8==0);var sb={last:0,caught:[],infos:{},deAdjust:function(a){if(!a||sb.infos[a])return a;for(var b in sb.infos){var c=+b,d=sb.infos[c];if(d.adjusted===a)return c}return a},addRef:function(a){if(a){var b=sb.infos[a];b.refcount++}},decRef:function(a){if(a){var b=sb.infos[a];g(b.refcount>0),b.refcount--,0!==b.refcount||b.rethrown||(b.destructor&&ua.dynCall_vi(b.destructor,a),delete sb.infos[a],___cxa_free_exception(a))}},clearRef:function(a){if(a){var b=sb.infos[a];b.refcount=0}}},tb={buffers:[null,[],[]],printChar:function(a,b){var c=tb.buffers[a];g(c),0===b||10===b?((1===a?Ba:Ca)(l(c,0)),c.length=0):c.push(b)},varargs:0,get:function(a){tb.varargs+=4;var b=Ja[tb.varargs-4>>2];return b},getStr:function(){var a=k(tb.get());return a},get64:function(){var a=tb.get(),b=tb.get();return g(a>=0?0===b:b===-1),a},getZero:function(){g(0===tb.get())}};Ua=d(4),Qa=Ra=e(Oa),Sa=Qa+cb,Ta=e(Sa),Ja[Ua>>2]=Ta,Pa=!0,g(Ta<db,"TOTAL_MEMORY not big enough for stack");ua.wasmTableSize=99,ua.wasmMaxTableSize=99,ua.asmGlobalArg={},ua.asmLibraryArg={abort:sa,assert:g,enlargeMemory:B,getTotalMemory:C,abortOnCannotGrowMemory:A,abortStackOverflow:z,nullFunc_ii:ca,nullFunc_iiii:da,nullFunc_v:ea,nullFunc_vi:fa,nullFunc_viiii:ga,nullFunc_viiiii:ha,nullFunc_viiiiii:ia,invoke_ii:ja,invoke_iiii:ka,invoke_v:la,invoke_vi:ma,invoke_viiii:na,invoke_viiiii:oa,invoke_viiiiii:pa,__ZSt18uncaught_exceptionv:Q,___cxa_find_matching_catch:S,___gxx_personality_v0:T,___lock:U,___resumeException:R,___setErrNo:ba,___syscall140:V,___syscall146:X,___syscall54:Y,___syscall6:Z,___unlock:$,_abort:_,_emscripten_memcpy_big:aa,_get_unicode_str:P,flush_NO_FILESYSTEM:W,DYNAMICTOP_PTR:Ua,tempDoublePtr:rb,STACKTOP:Ra,STACK_MAX:Sa};var ub=ua.asm(ua.asmGlobalArg,ua.asmLibraryArg,Ea),vb=ub.___cxa_can_catch;ub.___cxa_can_catch=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),vb.apply(null,arguments)};var wb=ub.___cxa_is_pointer_type;ub.___cxa_is_pointer_type=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),wb.apply(null,arguments)};var xb=ub.___em_js__get_unicode_str;ub.___em_js__get_unicode_str=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),xb.apply(null,arguments)};var yb=ub.___errno_location;ub.___errno_location=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),yb.apply(null,arguments)};var zb=ub._ckeytest;ub._ckeytest=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),zb.apply(null,arguments)};var Ab=ub._fflush;ub._fflush=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Ab.apply(null,arguments)};var Bb=ub._free;ub._free=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Bb.apply(null,arguments)};var Cb=ub._getckey;ub._getckey=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Cb.apply(null,arguments)};var Db=ub._llvm_bswap_i16;ub._llvm_bswap_i16=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Db.apply(null,arguments)};var Eb=ub._llvm_bswap_i32;ub._llvm_bswap_i32=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Eb.apply(null,arguments)};var Fb=ub._malloc;ub._malloc=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Fb.apply(null,arguments)};var Gb=ub._memmove;ub._memmove=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Gb.apply(null,arguments)};var Hb=ub._sbrk;ub._sbrk=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Hb.apply(null,arguments)};var Ib=ub.establishStackSpace;ub.establishStackSpace=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Ib.apply(null,arguments)};var Jb=ub.getTempRet0;ub.getTempRet0=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Jb.apply(null,arguments)};var Kb=ub.setTempRet0;ub.setTempRet0=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Kb.apply(null,arguments);
};var Lb=ub.setThrew;ub.setThrew=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Lb.apply(null,arguments)};var Mb=ub.stackAlloc;ub.stackAlloc=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Mb.apply(null,arguments)};var Nb=ub.stackRestore;ub.stackRestore=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Nb.apply(null,arguments)};var Ob=ub.stackSave;ub.stackSave=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Ob.apply(null,arguments)},ua.asm=ub;var Pb=(ua.___cxa_can_catch=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.___cxa_can_catch.apply(null,arguments)},ua.___cxa_is_pointer_type=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.___cxa_is_pointer_type.apply(null,arguments)},ua.___em_js__get_unicode_str=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.___em_js__get_unicode_str.apply(null,arguments)},ua.___errno_location=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.___errno_location.apply(null,arguments)},ua._ckeytest=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm._ckeytest.apply(null,arguments)},ua._fflush=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm._fflush.apply(null,arguments)},ua._free=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm._free.apply(null,arguments)},ua._getckey=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm._getckey.apply(null,arguments)},ua._llvm_bswap_i16=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm._llvm_bswap_i16.apply(null,arguments)},ua._llvm_bswap_i32=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm._llvm_bswap_i32.apply(null,arguments)},ua._malloc=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm._malloc.apply(null,arguments)}),Qb=(ua._memcpy=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm._memcpy.apply(null,arguments)},ua._memmove=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm._memmove.apply(null,arguments)},ua._memset=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm._memset.apply(null,arguments)},ua._sbrk=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm._sbrk.apply(null,arguments)},ua.establishStackSpace=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.establishStackSpace.apply(null,arguments)},ua.getTempRet0=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.getTempRet0.apply(null,arguments)}),Rb=(ua.runPostSets=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.runPostSets.apply(null,arguments)},ua.setTempRet0=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.setTempRet0.apply(null,arguments)}),Sb=(ua.setThrew=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.setThrew.apply(null,arguments)},ua.stackAlloc=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.stackAlloc.apply(null,arguments)}),Tb=ua.stackRestore=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.stackRestore.apply(null,arguments)},Ub=ua.stackSave=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.stackSave.apply(null,arguments)};ua.dynCall_ii=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.dynCall_ii.apply(null,arguments)},ua.dynCall_iiii=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.dynCall_iiii.apply(null,arguments)},ua.dynCall_v=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.dynCall_v.apply(null,arguments)},ua.dynCall_vi=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.dynCall_vi.apply(null,arguments)},ua.dynCall_viiii=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.dynCall_viiii.apply(null,arguments)},ua.dynCall_viiiii=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.dynCall_viiiii.apply(null,arguments)},ua.dynCall_viiiiii=function(){return g(ib,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!jb,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ua.asm.dynCall_viiiiii.apply(null,arguments)};ua.asm=ub,ua.intArrayFromString||(ua.intArrayFromString=function(){sa("'intArrayFromString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.intArrayToString||(ua.intArrayToString=function(){sa("'intArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.ccall=i,ua.cwrap=j,ua.setValue||(ua.setValue=function(){sa("'setValue' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.getValue||(ua.getValue=function(){sa("'getValue' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.allocate||(ua.allocate=function(){sa("'allocate' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.getMemory||(ua.getMemory=function(){sa("'getMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),ua.Pointer_stringify||(ua.Pointer_stringify=function(){sa("'Pointer_stringify' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.AsciiToString||(ua.AsciiToString=function(){sa("'AsciiToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.stringToAscii||(ua.stringToAscii=function(){sa("'stringToAscii' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.UTF8ArrayToString||(ua.UTF8ArrayToString=function(){sa("'UTF8ArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.UTF8ToString||(ua.UTF8ToString=function(){sa("'UTF8ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.stringToUTF8Array||(ua.stringToUTF8Array=function(){sa("'stringToUTF8Array' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.stringToUTF8||(ua.stringToUTF8=function(){sa("'stringToUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.lengthBytesUTF8||(ua.lengthBytesUTF8=function(){sa("'lengthBytesUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.UTF16ToString||(ua.UTF16ToString=function(){sa("'UTF16ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.stringToUTF16||(ua.stringToUTF16=function(){sa("'stringToUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.lengthBytesUTF16||(ua.lengthBytesUTF16=function(){sa("'lengthBytesUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.UTF32ToString||(ua.UTF32ToString=function(){sa("'UTF32ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.stringToUTF32||(ua.stringToUTF32=function(){sa("'stringToUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.lengthBytesUTF32||(ua.lengthBytesUTF32=function(){sa("'lengthBytesUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.allocateUTF8||(ua.allocateUTF8=function(){sa("'allocateUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.stackTrace||(ua.stackTrace=function(){sa("'stackTrace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.addOnPreRun||(ua.addOnPreRun=function(){sa("'addOnPreRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.addOnInit||(ua.addOnInit=function(){sa("'addOnInit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.addOnPreMain||(ua.addOnPreMain=function(){sa("'addOnPreMain' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.addOnExit||(ua.addOnExit=function(){sa("'addOnExit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.addOnPostRun||(ua.addOnPostRun=function(){sa("'addOnPostRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.writeStringToMemory||(ua.writeStringToMemory=function(){sa("'writeStringToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.writeArrayToMemory||(ua.writeArrayToMemory=function(){sa("'writeArrayToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.writeAsciiToMemory||(ua.writeAsciiToMemory=function(){sa("'writeAsciiToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.addRunDependency||(ua.addRunDependency=function(){sa("'addRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),ua.removeRunDependency||(ua.removeRunDependency=function(){sa("'removeRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),ua.ENV||(ua.ENV=function(){sa("'ENV' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.FS||(ua.FS=function(){sa("'FS' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.FS_createFolder||(ua.FS_createFolder=function(){sa("'FS_createFolder' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),ua.FS_createPath||(ua.FS_createPath=function(){sa("'FS_createPath' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),ua.FS_createDataFile||(ua.FS_createDataFile=function(){sa("'FS_createDataFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),ua.FS_createPreloadedFile||(ua.FS_createPreloadedFile=function(){sa("'FS_createPreloadedFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),ua.FS_createLazyFile||(ua.FS_createLazyFile=function(){sa("'FS_createLazyFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),ua.FS_createLink||(ua.FS_createLink=function(){sa("'FS_createLink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),ua.FS_createDevice||(ua.FS_createDevice=function(){sa("'FS_createDevice' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),ua.FS_unlink||(ua.FS_unlink=function(){sa("'FS_unlink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),ua.GL||(ua.GL=function(){sa("'GL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.staticAlloc||(ua.staticAlloc=function(){sa("'staticAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.dynamicAlloc||(ua.dynamicAlloc=function(){sa("'dynamicAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.warnOnce||(ua.warnOnce=function(){sa("'warnOnce' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.loadDynamicLibrary||(ua.loadDynamicLibrary=function(){sa("'loadDynamicLibrary' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.loadWebAssemblyModule||(ua.loadWebAssemblyModule=function(){sa("'loadWebAssemblyModule' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.getLEB||(ua.getLEB=function(){sa("'getLEB' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.getFunctionTables||(ua.getFunctionTables=function(){sa("'getFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.alignFunctionTables||(ua.alignFunctionTables=function(){sa("'alignFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.registerFunctions||(ua.registerFunctions=function(){sa("'registerFunctions' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.addFunction||(ua.addFunction=function(){sa("'addFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.removeFunction||(ua.removeFunction=function(){sa("'removeFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.getFuncWrapper||(ua.getFuncWrapper=function(){sa("'getFuncWrapper' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.prettyPrint||(ua.prettyPrint=function(){sa("'prettyPrint' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.makeBigInt||(ua.makeBigInt=function(){sa("'makeBigInt' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.dynCall||(ua.dynCall=function(){sa("'dynCall' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.getCompilerSetting||(ua.getCompilerSetting=function(){sa("'getCompilerSetting' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.stackSave||(ua.stackSave=function(){sa("'stackSave' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.stackRestore||(ua.stackRestore=function(){sa("'stackRestore' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.stackAlloc||(ua.stackAlloc=function(){sa("'stackAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.establishStackSpace||(ua.establishStackSpace=function(){sa("'establishStackSpace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.print||(ua.print=function(){sa("'print' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.printErr||(ua.printErr=function(){sa("'printErr' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),ua.ALLOC_NORMAL||Object.defineProperty(ua,"ALLOC_NORMAL",{get:function(){sa("'ALLOC_NORMAL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),ua.ALLOC_STACK||Object.defineProperty(ua,"ALLOC_STACK",{get:function(){sa("'ALLOC_STACK' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),ua.ALLOC_STATIC||Object.defineProperty(ua,"ALLOC_STATIC",{get:function(){sa("'ALLOC_STATIC' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),ua.ALLOC_DYNAMIC||Object.defineProperty(ua,"ALLOC_DYNAMIC",{get:function(){sa("'ALLOC_DYNAMIC' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),ua.ALLOC_NONE||Object.defineProperty(ua,"ALLOC_NONE",{get:function(){sa("'ALLOC_NONE' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),qa.prototype=new Error,qa.prototype.constructor=qa;mb=function Wb(){ua.calledRun||ra(),ua.calledRun||(mb=Wb)},ua.run=ra;var Vb=[];if(ua.abort=sa,ua.preInit)for("function"==typeof ua.preInit&&(ua.preInit=[ua.preInit]);ua.preInit.length>0;)ua.preInit.pop()();ua.noExitRuntime=!0,ra(),a.exports=ua}).call(b,c(135))},286:function(a,b,c){var d=Txplayer.util,e=c(287);a.exports={playControl:function(a){var b=Txplayer.$,c=this;if(c.context.dataset.playerWidth=c.context.dataset.$playermod.width(),c.context.dataset.playerHeight=c.context.dataset.$playermod.height(),"string"===b.type(a)?a={vid:a}:"undefined"===b.type(a)&&(a={}),a.vid||(a.vid=this.context.dataset.vid),!a.vid||11!==a.vid.length)throw new Error("vid is illegal");if(this.context.dataset.canPlayTime&&this.context.dataset.currentTime>=this.context.dataset.canPlayTime&&a.vid===this.context.dataset.vid)return void(this.context.dataset.getinfoJSON&&4==this.context.dataset.getinfoJSON.exem?this.showDujiaDialog():this.showUIVipGuide("trial"));if(1!==this.context.dataset.playState&&!this.context.dataset.isPlayingAd||a.vid!==this.context.dataset.vid){if(a.vid==this.context.dataset.vid){if(this.dataset.hasVideoPlayed)return void this.context.msg.broadcast("play");if(this.context.dataset.playList&&this.context.dataset.playList.length)return void this.context.msg.broadcast("setFocusVideoUrl",b.extend({},this.context.dataset.playList[0],{autoplay:!0}))}a.autoplay=!0,this.checkLanguageSwitch(a),a.hasOwnProperty("cid")&&(this.context.dataset.cid=a.cid),a.hasOwnProperty("triggerplay")&&(this.context.config.triggerplay=a.triggerplay),a.hasOwnProperty("columnId")&&(this.context.dataset.columnId=a.columnId),a.hasOwnProperty("autoplay")&&(this.context.dataset.autoplay=a.autoplay),a.hasOwnProperty("isNeedPay")&&(this.context.dataset.isNeedPay=a.isNeedPay),a.hasOwnProperty("nextVid")&&(this.context.dataset.nextVid=a.nextVid),a.hasOwnProperty("showBullet")&&(this.context.config.showBullet=a.showBullet||this.context.config.showBullet||!1),a.hasOwnProperty("playEndTime")&&a.playEndTime&&a.hasOwnProperty("duration")?(this.context.config.playEndTime=parseInt(a.playEndTime),this.context.dataset.playEndTime=parseInt(a.duration)-parseInt(a.playEndTime),this.context.dataset.playEndTime<0&&(this.context.dataset.playEndTime=null)):a.hasOwnProperty("vid")&&a.vid!==this.context.dataset.vid&&(this.context.dataset.playEndTime=null,this.context.config.playEndTime=0),a.hasOwnProperty("trailerMode")&&a.trailerMode?this.context.dataset.trailerMode=!0:this.context.dataset.trailerMode=!1,this.context.dataset.connectionPlayTime=a.connectionPlayTime?a.connectionPlayTime:0,a.connectionPlayTime&&this.context.config.duration&&Math.abs(+a.connectionPlayTime-+this.context.config.duration)<1&&(this.context.dataset.connectionPlayTime=a.connectionPlayTime=0),this.context.dataset.playStartTime=a.playStartTime?a.playStartTime:0,this.context.dataset.connectionPlayType=a.hasOwnProperty("connectionPlayType")?a.connectionPlayType:0,a.hasOwnProperty("connectionPlayType")||a.vid===this.context.dataset.vid||(this.context.dataset.connectionPlayType=3),a.hasOwnProperty("title")&&(this.context.dataset.title=d.xss(a.title)),a.authext&&(this.context.dataset.authext=a.authext),a.eduext&&(this.context.dataset.eduext=a.eduext),this.context.dataset.isAnNewPlayAction=!!a.isAnNewPlayAction,this.dataset.hasVideoPlayed=!1,this.dataset.hasLoadVideoUrl=!1;var f=this.context.dataset.vid;a.hasOwnProperty("vid")&&this.setVid(a.vid),this.context.msg.broadcast("beforeVideoPlay",this.context.dataset.vid,f),this.initNextVid();var g={};g.playStartTime=c.getSkipPreludeTime(),g.connectionPlayTime=c.context.dataset.connectionPlayTime,d.v4log("main-playcontrol:loadVideoUrls",g),"nintendo"===c.context.config.playerType?(c.context.config.browserDisableAutoPlay=!1,c.loadVideoUrls(g)):e.video().then(function(a){if(a.result===!0)c.context.config.browserDisableAutoPlay=!1,c.loadVideoUrls(g);else{var b=a.error&&a.error.name;if(/NotAllow/i.test(b)&&d.browser.safari)return;c.context.config.autoPlayInMute&&(c.context.config.browserDisableAutoPlay=!0,c.context.userApi.setVolume(0),c.context.userApi.mute(),c.loadVideoUrls(g))}})}},initNextVid:function(){var a=this;"array"==Txplayer.$.type(Txplayer.dataset.isReadyPlugins)&&Txplayer.dataset.isReadyPlugins.indexOf("UiPlayNext")!=-1?this.context.msg.broadcast("setNextVid",{nextVid:this.context.dataset.nextVid}):this.context.msg.on("pluginReady",function(b){"UiPlayNext"==b.name&&a.context.msg.broadcast("setNextVid",{nextVid:a.context.dataset.nextVid})})},setVid:function(a){if(a&&a!==this.context.dataset.vid){d.showInfo("HdPlayerControl.onVidChange",{currentVid:this.context.dataset.vid,nextVid:a});var b=this.context.dataset.vid;this.context.dataset.vid=a,this.context.msg.broadcast("vidChange",a,b),this.context.dataset.hasCallSetVid=!0;try{this.context.userMsg.broadcast("vidChange",a,b)}catch(c){}this.updatePlayerId()}},updatePlayerId:function(){this.context.dataset.playerId=d.createGUID(),this.context.dataset.flowid=this.context.dataset.playerId+"_"+this.context.dataset.platform},pauseControl:function(){this.context.dataset.disableHotKey||this.context.dataset.isPlayingAd||this.context.msg.broadcast("pause")}}},287:function(a,b){function c(a){return Object.assign({muted:!1,timeout:2e3,inline:!1},a)}function d(a,b){var c=a.muted,d=a.timeout,e=a.inline,f=b(),g=f.element,h=f.source,i=void 0,j=void 0,k=void 0;if(g.muted=c,c===!0&&g.setAttribute("muted","muted"),e===!0&&g.setAttribute("playsinline","playsinline"),g.src=h,"undefined"!=typeof window.Promise)return new window.Promise(function(a){i=g.play(),j=setTimeout(function(){k(!1,new Error("Timeout "+d+" ms has been reached"))},d),k=function(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;clearTimeout(j),a({result:b,error:c})},void 0!==i?i.then(function(){return k(!0)})["catch"](function(a){return k(!1,a)}):k(!0)});var l=Txplayer.$.Deferred();return i=g.play(),j=setTimeout(function(){k(!1,new Error("Timeout "+d+" ms has been reached"))},d),k=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;clearTimeout(j),l.resolve({result:a,error:b})},void 0!==i?i.then(function(){return k(!0)})["catch"](function(a){return k(!1,a)}):setTimeout(function(){k(!0)}),l}function e(a){return a=c(a),d(a,function(){return{element:document.createElement("video"),source:URL.createObjectURL(h)}})}function f(a){return a=c(a),d(a,function(){return{element:document.createElement("audio"),source:URL.createObjectURL(g)}})}"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(a,b){"use strict";if(null==a)throw new TypeError("Cannot convert undefined or null to object");for(var c=Object(a),d=1;d<arguments.length;d++){var e=arguments[d];if(null!=e)for(var f in e)Object.prototype.hasOwnProperty.call(e,f)&&(c[f]=e[f])}return c},writable:!0,configurable:!0});var g=new Blob([new Uint8Array([255,227,24,196,0,0,0,3,72,1,64,0,0,4,132,16,31,227,192,225,76,255,67,12,255,221,27,255,228,97,73,63,255,195,131,69,192,232,223,255,255,207,102,239,255,255,255,101,158,206,70,20,59,255,254,95,70,149,66,4,16,128,0,2,2,32,240,138,255,36,106,183,255,227,24,196,59,11,34,62,80,49,135,40,0,253,29,191,209,200,141,71,7,255,252,152,74,15,130,33,185,6,63,255,252,195,70,203,86,53,15,255,255,247,103,76,121,64,32,47,255,34,227,194,209,138,76,65,77,69,51,46,57,55,170,170,170,170,170,170,170,170,170,170,255,227,24,196,73,13,153,210,100,81,135,56,0,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170])],{type:"audio/mpeg"}),h=new Blob([new Uint8Array([0,0,0,28,102,116,121,112,105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,109,112,52,49,0,0,0,8,102,114,101,101,0,0,2,239,109,100,97,116,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,2,194,109,111,111,118,0,0,0,108,109,118,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,232,0,0,0,47,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,1,236,116,114,97,107,0,0,0,92,116,107,104,100,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,101,100,116,115,0,0,0,28,101,108,115,116,0,0,0,0,0,0,0,1,0,0,0,47,0,0,0,0,0,1,0,0,0,0,1,100,109,100,105,97,0,0,0,32,109,100,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,68,0,0,8,0,85,196,0,0,0,0,0,45,104,100,108,114,0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0,0,0,1,15,109,105,110,102,0,0,0,16,115,109,104,100,0,0,0,0,0,0,0,0,0,0,0,36,100,105,110,102,0,0,0,28,100,114,101,102,0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1,0,0,0,211,115,116,98,108,0,0,0,103,115,116,115,100,0,0,0,0,0,0,0,1,0,0,0,87,109,112,52,97,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,0,16,0,0,0,0,172,68,0,0,0,0,0,51,101,115,100,115,0,0,0,0,3,128,128,128,34,0,2,0,4,128,128,128,20,64,21,0,0,0,0,1,244,0,0,1,243,249,5,128,128,128,2,18,16,6,128,128,128,1,2,0,0,0,24,115,116,116,115,0,0,0,0,0,0,0,1,0,0,0,2,0,0,4,0,0,0,0,28,115,116,115,99,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,28,115,116,115,122,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,115,0,0,1,116,0,0,0,20,115,116,99,111,0,0,0,0,0,0,0,1,0,0,0,44,0,0,0,98,117,100,116,97,0,0,0,90,109,101,116,97,0,0,0,0,0,0,0,33,104,100,108,114,0,0,0,0,0,0,0,0,109,100,105,114,97,112,112,108,0,0,0,0,0,0,0,0,0,0,0,0,45,105,108,115,116,0,0,0,37,169,116,111,111,0,0,0,29,100,97,116,97,0,0,0,1,0,0,0,0,76,97,118,102,53,54,46,52,48,46,49,48,49])],{type:"video/mp4"}),i={audio:f,video:e};a.exports=i},288:function(a,b){var c=Txplayer.util;a.exports={seekTo:function(a){function b(){i===j.index?e.context.msg.broadcast("setFocusVideoCurrentTime",{time:f-j.prevDurtion,autoplay:!0}):e.context.dataset.playList[j.index]&&(g=e.context.dataset.playList[j.index],g.autoplay=!0,g.currentTime=f-j.prevDurtion,g.updateIndex=j.index,e.context.msg.broadcast("setFocusVideoUrl",g))}var d=Txplayer.$,e=this;if("object"===d.type(a)&&a.showTips&&(this.dataset.seekToSyncFlag=!0),!this.context.dataset.isPlayingAd){if(0===this.context.dataset.playState)return void c.showError("\u64ad\u653e\u5df2\u7ed3\u675f\uff0c\u4e0d\u80fdseek");if(this.context.dataset.playState===-1)return void c.showError("\u64ad\u653e\u72b6\u6001\u672a\u521d\u59cb\u5316\uff0c\u4e0d\u80fdseek","seekTo");if(!this.context.dataset.disableHotKey){var f,g,h,i,j,k,l,m,n=this.context.dataset.currentTime,o="object"!==d.type(a)||!a.hasOwnProperty("connectionPlayTime")&&!a.hasOwnProperty("playStartTime")&&!a.hasOwnProperty("historyTime")&&!a.hasOwnProperty("showTips")&&!a.hasOwnProperty("doNotReport");
if(a&&"object"===d.type(a)&&(a.time&&"string"==typeof a.time&&/^\d+$/.test(a.time)&&(a.time=Number(a.time)),a.connectionPlayTime&&"string"==typeof a.connectionPlayTime&&/^\d+$/.test(a.connectionPlayTime)&&(a.connectionPlayTime=Number(a.connectionPlayTime)),a.playStartTime&&"string"==typeof a.playStartTime&&/^\d+$/.test(a.playStartTime)&&(a.playStartTime=Number(a.playStartTime))),"object"===d.type(a)?f="number"===d.type(a.time)?a.time:"number"===d.type(a.connectionPlayTime)?a.connectionPlayTime:"number"===d.type(a.playStartTime)?a.playStartTime:null:"number"===d.type(a)&&(f=a,a={}),"number"!==d.type(f))return void c.error("seekTo\u53c2\u6570\u9519: \u53c2\u6570\u5fc5\u987b\u4e3anumber("+f+")");if(f<0&&(f=0),"number"===d.type(f)&&f<=this.context.dataset.duration&&("number"!==d.type(this.context.dataset.canPlayTime)||f<=this.context.dataset.canPlayTime)&&this.updateCurrentTime(f,"seekTo"),h=this.context.dataset.duration,f>h)return void c.showError("seekTo\u53c2\u6570\u9519\u8bef: seekTime["+f+"]\u4e0d\u80fd\u8d85\u8fc7\u89c6\u9891\u7684\u65f6\u957f["+h+"]","");"number"==d.type(this.context.dataset.canPlayTime)&&f>this.context.dataset.canPlayTime&&(f=this.context.dataset.canPlayTime-1),j=this.getVideoSeekToInfo(f),i=this.context.dataset.playListIndex,k=+new Date,this.context.dataset.isVideoSeeking=!0,c.v4log("seekStart ",{isVideoSeeking:this.context.dataset.isVideoSeeking}),this.context.msg.broadcast("seekStart",{type:"film",seekTime:f,seekIndex:j.index,seekStartTime:k,currentTimeWhenSeekStart:n,isUserAction:o});try{this.context.userMsg.broadcast("seekStart",{type:"film",seekTime:f,seekIndex:j.index,seekStartTime:k,currentTimeWhenSeekStart:n,isUserAction:o})}catch(p){}this.context.msg.off("videoSeeked.seekTo"),this.context.msg.once("videoSeeked.seekTo",function(){l=+new Date,m=e.context.dataset.currentTime,e.context.msg.broadcast("seekEnd",{seekStartTime:k,seekEndTime:l,seekTime:f,currentTimeWhenSeekStart:n,currentTimeWhenSeekEnd:m,isUserAction:o});try{e.context.userMsg.broadcast("seekEnd",{type:"film",seekStartTime:k,seekEndTime:l,seekTime:f,currentTimeWhenSeekStart:n,currentTimeWhenSeekEnd:m,isUserAction:o})}catch(a){}Math.abs(f-m)>5&&(e.context.dataset.retrySeekTo=!0,b())}),e.context.msg.broadcast("pause"),b(),a.seekTime=f,e.context.msg.broadcast("showUiSeekTip",a),a.bulletid&&e.context.msg.broadcast("barrageSeekTime",{bulletid:a.bulletid,time:f})}}}}},289:function(a,b){function c(){var a=this,b=Txplayer.util;this.context.msg.on("onAdOrderDataReady",function(a){}),this.context.msg.on("loadingAdStart",function(c){if(b.v4log("loadingAdStart \u524d\u5e16\u5f00\u59cb\u64ad\u653e"),!a.context.dataset.hasLoadingAdStart){a.context.dataset.hasLoadingAdStart=!0,a.context.msg.broadcast("adVideoShow"),a.context.msg.broadcast("filmVideoHide","loadingad");try{a.context.userMsg.broadcast("adStart",{type:"loadingad"}),a.context.msg.broadcast("adStart",{type:"loadingad"})}catch(d){}}}),this.context.msg.on("loadingAdLoadComplete",function(c){b.v4log("loadingAdLoadComplete \u524d\u5e16\u5168\u90e8\u4e0b\u8f7d\u5b8c\u6210 "),a.context.msg.broadcast("play",{isPreloadFirstFilm:!0,autoplay:!1}),a.context.dataset.isPreloadFilm=!0}),this.context.msg.on("loadingAdEnd",function(c){b.v4log("loadingAdEnd \u524d\u5e16\u64ad\u653e\u7ed3\u675f"),a.context.msg.broadcast("adVideoHide"),a.context.msg.broadcast("filmVideoShow","loadingad");try{a.context.userMsg.broadcast("adEnd",{type:"loadingad"}),a.context.msg.broadcast("adEnd",{type:"loadingad"})}catch(d){}}),this.context.msg.on("insertAdStart",function(c){b.v4log("insertAdStart"),a.context.msg.broadcast("adVideoShow"),a.context.msg.broadcast("filmVideoHide","insertad");try{a.context.userMsg.broadcast("adStart",{type:"insertad"}),a.context.msg.broadcast("adStart",{type:"insertad"})}catch(d){}}),this.context.msg.on("insertAdEnd",function(c){b.v4log("insertAdEnd"),a.context.msg.broadcast("adVideoHide"),a.context.msg.broadcast("filmVideoShow","insertad");try{a.context.userMsg.broadcast("adEnd",{type:"insertad"}),a.context.msg.broadcast("adEnd",{type:"insertad"})}catch(d){}}),this.context.msg.on("endingAdStart",function(c){b.v4log("endingAdStart"),a.context.msg.broadcast("adVideoShow"),a.context.msg.broadcast("filmVideoHide","endingad");try{a.context.userMsg.broadcast("adStart",{type:"endingad"}),a.context.msg.broadcast("adStart",{type:"endingad"})}catch(d){}}),this.context.msg.on("endingAdEnd",function(c){if(!a.context.dataset.isFilmEnded)return b.v4log("isEndingAdEnded"),void(a.context.dataset.isEndingAdEnded=!0);b.v4log("endingAdEnd"),a.context.msg.broadcast("adVideoHide"),a.context.msg.broadcast("filmVideoShow","endingad"),setTimeout(function(){a.context.msg.broadcast("videoEnd",{index:a.context.dataset.playListIndex,playListType:"endingad",isTheLastFilm:!0,isAllEnd:!0,from:"endingAdEnd"});try{a.context.userMsg.broadcast("videoEnd",{isTheLastFilm:!0,isAllEnd:!0})}catch(b){}},0);try{a.context.userMsg.broadcast("adEnd",{type:"endingad"}),a.context.msg.broadcast("adEnd",{type:"endingad"})}catch(d){}}),this.context.msg.on("pauseAdStart",function(b){a.context.msg.broadcast("adVideoShow")}),this.context.msg.on("pauseAdEnd",function(b){a.context.msg.broadcast("adVideoHide")}),this.context.msg.on("pvlAdStart",function(b){a.context.msg.broadcast("loadingImageAdUrlReady",{url:b})})}a.exports={dealAdMsgMoudle:c}},290:function(a,b){function c(){var a=this;a.context.msg.on(d.getUniqueMsgKey("beforeVideoPlay"),function(b,c){a.context.dataset.urlIndex=0,a.context.dataset.getinfoJSON=null,a.context.dataset.requestNewGetinfoError=!1,a.context.dataset.filmVideoData=[],a.context.dataset.duration=null,a.context.dataset.disableHotKey=!1,a.context.dataset.hasLoadingAdStart=!1,a.updateCurrentTime(0,"beforeVideoPlay"),a.dataset.seekToSyncFlag=!1,a.context.msg.off("videoPlaying.loadAndSeekSync"),a.context.msg.off("getVideoUrlSuccess.loadVideoUrls"),a.context.msg.off("videoPlaying.showUiSeekTip")}),a.context.msg.on(d.getUniqueMsgKey("beforeVideoRePlay"),function(b,c){a.dataset.hasVideoPlayed=!1,a.context.dataset.hasLoadingAdStart=!1,a.updateCurrentTime(0,"beforeVideoRePlay")}),this.context.msg.on(d.getUniqueMsgKey("videoPlaying"),function(b){"film"===a.context.dataset.currentPlayListType&&(a.dataset.hasVideoPlayed=!0)}),this.context.msg.on(d.getUniqueMsgKey("videoEnd"),function(b){b.isTheLastFilm&&"film"===b.playListType&&(a.context.msg.off("videoSeeked.seekTo"),a.dataset.hasVideoPlayed=!1,a.context.dataset.getinfoJSON=null)}),this.context.msg.on("userStopVideo",function(b){a.dataset.hasVideoPlayed=!1}),a.context.msg.on(d.getUniqueMsgKey("videoTimeUpdate"),function(b){if(b&&"film"===b.playListType){var c=a.calcCurrentTime();if(c&&b&&b.videoTag&&b.videoTag.currentTime&&a.updateCurrentTime(c,"onSectionTimeupdate"),a.context.dataset.canPlayTime){if(c&&c>=a.context.dataset.canPlayTime&&(a.context.dataset.getinfoJSON&&4==a.context.dataset.getinfoJSON.exem?a.showDujiaDialog():a.showUIVipGuide("trial")),b&&b.videoTag&&Math.floor(b.videoTag.duration)!==a.context.dataset.canPlayTime){var d=a.context.dataset.canPlayTime-b.videoTag.duration;d>0&&d<=3&&(a.context.dataset.canPlayTime=Math.floor(b.videoTag.duration))}a.showUnOfficialLimitTips()}}}),a.context.msg.on(d.getUniqueMsgKey("videoPlaying"),function(b){if(b&&"film"===b.playListType&&a.context.dataset.canPlayTime){var c=a.calcCurrentTime();c&&a.updateCurrentTime(c,"onSectionPlaying"),c&&c>=a.context.dataset.canPlayTime&&(a.context.dataset.getinfoJSON&&4==a.context.dataset.getinfoJSON.exem?a.showDujiaDialog():a.showUIVipGuide("trial"))}}),a.context.msg.on(d.getUniqueMsgKey("seekStart"),function(b){b&&"film"===b.type&&a.context.dataset.canPlayTime&&b&&b.seekTime&&b.seekTime>=a.dataset.canPlayTime&&(a.context.dataset.getinfoJSON&&4==a.context.dataset.getinfoJSON.exem?a.showDujiaDialog():a.showUIVipGuide("trial"))}),a.context.msg.on(d.getUniqueMsgKey("videoEnd"),function(b){b&&"film"===b.playListType&&a.context.dataset.canPlayTime&&a.context.dataset.currentTime>a.context.dataset.canPlayTime&&(a.updateCurrentTime(a.context.dataset.canPlayTime,"videoEnd"),a.context.dataset.getinfoJSON&&4==a.context.dataset.getinfoJSON.exem?a.showDujiaDialog():a.showUIVipGuide("trial"))}),a.context.msg.on(d.getUniqueMsgKey("beforeVideoPlay"),function(b,c){if(a.context.dataset.hasChromeHlsPlugin){a.context.dataset.useChromeHls=!0,a.context.dataset.useHls=!0;var e=["html5hd","safarihls","chromehls"],f=a.context.config.playerType;e.indexOf(f)>-1&&(a.context.config.playerType="chromehls")}d.isSupportSafariHls(a.context.dataset.platform)&&(a.context.dataset.useHls=!0),a.context.dataset.hasCallShowUIVipGuide=!1}),this.context.msg.on(d.getUniqueMsgKey("videoInterruptByError"),function(){a.dataset.getVkeyErrorData&&83===a.dataset.getVkeyErrorData.code?a.context.dataset.getinfoJSON&&4==a.context.dataset.getinfoJSON.exem?a.showDujiaDialog():a.showUIVipGuide("trial"):a.dataset.getVideoInfoErrorData&&91===a.dataset.getVideoInfoErrorData.code&&(a.showUIVipGuide("switchDef"),a.context.dataset.isDefinitionSwitching=!1)}),a.context.msg.on(d.getUniqueMsgKey("chromehlsErrorSwitchToHtml5hd"),function(b,c){a.context.msg.broadcast("reportChromeHlsError",b.code),a.context.dataset.useHls=!1,a.context.dataset.useChromeHls=!1,delete a.context.dataset.hlsLoadStartTime;var d=["html5hd","safarihls","chromehls"],e=a.context.config.playerType;d.indexOf(e)>-1&&(a.context.config.playerType="html5hd");var f={autoplay:!0};f.playStartTime=a.getSkipPreludeTime(),f.connectionPlayTime=a.context.dataset.connectionPlayTime,f.onlyGetinfo=!0,a.context.dataset.isDefinitionSwitching&&a.context.dataset.definition&&(f.defn=a.context.dataset.definition),a.context.dataset.isPlayingAd?a.context.msg.once("loadingAdEnd",function(){a.loadVideoUrls(f)}):a.loadVideoUrls(f)}),a.context.msg.on(d.getUniqueMsgKey("chromehlsErrorSwitchToChromehls"),function(b,c){a.context.msg.broadcast("reportChromeHlsError",b.code);var d={autoplay:!0};d.playStartTime=a.getSkipPreludeTime(),d.connectionPlayTime=a.context.dataset.connectionPlayTime,d.onlyGetinfo=!0,a.context.dataset.isDefinitionSwitching&&a.context.dataset.definition&&(d.defn=a.context.dataset.definition),a.loadVideoUrls(d)}),a.context.msg.on(d.getUniqueMsgKey("chromehlsCkeyTimeout"),function(){if("undefined"==typeof a.context.dataset.ckeytimeoutRetryCount&&(a.context.dataset.ckeytimeoutRetryCount=0),a.context.dataset.ckeytimeoutRetryCount<20){a.context.dataset.ckeytimeoutRetryCount++;var b={onlyGetinfo:!0};a.updateVideoUrls(b)}}),a.context.msg.on(d.getUniqueMsgKey("getVideoUrlSuccess"),function(){var b={width:a.context.dataset.videoWidth,height:a.context.dataset.videoHeight};if(b.width&&b.height){var c=a.context.dataset.$playermod.width(),d=a.context.dataset.$playermod.height(),e=b.width*(d/b.height),f=b.height*(c/b.width);e<c&&e>=c-20?a.context.dataset.$videomod.addClass("txp_video_fit_cover"):f<d&&f>=d-20?a.context.dataset.$videomod.addClass("txp_video_fit_cover"):a.context.dataset.$videomod.removeClass("txp_video_fit_cover")}});var b=function(){var b={otype:"json",market_id:1,platform:2,unix_time:+new Date,ip:a.context.dataset.reportUsrIP,user_agent:navigator.userAgent,qq:d.getQQFromCookie(),wx_openid:d.cookie.get("vuserid"),refer:document.referrer,url:location.href};Txplayer.$.jsonp({url:"//ncgi.video.qq.com/fcgi-bin/get_guid_http_to_jce?callback=?",data:b,callback:Txplayer.util.getJsonpCallbackName("get_guid")}).done(function(b){b&&0==b.err_code&&b.guid?(a.context.dataset.unid=b.guid,d.setData(Txplayer.dataset.localStorageKey.unid,b.guid)):a.dataset.hasRequestUnid=!1}).fail(function(){a.dataset.hasRequestUnid=!1})};a.context.msg.on(d.getUniqueMsgKey("videoPlaying"),function(c){if(c&&"film"===c.playListType){if(a.context.dataset.unid)return;var e=d.getData(Txplayer.dataset.localStorageKey.unid);if(e)return void(a.context.dataset.unid||(a.context.dataset.unid=e));if(a.dataset.hasRequestUnid)return;a.dataset.hasRequestUnid=!0,b()}}),a.context.msg.on(d.getUniqueMsgKey("videoPlaying"),function(b){b&&"film"===b.playListType&&a.getVideoMark&&a.getVideoMark.requestVideoMark()}),a.context.msg.on(d.getUniqueMsgKey("showLoginGuide"),function(b){a.context.dataset.disableHotKey=!0,a.context.msg.broadcast("pause"),a.context.msg.broadcast("hideUiTips"),Txplayer.util.v4log("showLoginGuide",{connectionPlayTime:a.context.dataset.currentTime});try{a.context.userMsg.broadcast("showLoginGuide",{connectionPlayTime:a.context.dataset.currentTime})}catch(c){}a.context.dataset.isBrowserFullscreen&&a.context.msg.broadcast("exitBrowserFullscreen"),a.context.dataset.isWindowFullscreen&&a.context.msg.broadcast("exitWindowFullscreen")}),a.context.msg.on(d.getUniqueMsgKey("startRollVideoInfo"),function(b){a.context.dataset.rollVideoInfoTimer&&clearTimeout(a.context.dataset.rollVideoInfoTimer);var c=a.context.dataset.fvpint;b&&c&&(a.context.dataset.rollVideoInfoTimer=setTimeout(function(){a.context.getinfo.requestRollVideoInfo(b).always(function(){a.context.msg.broadcast("startRollVideoInfo",b)})},c))}),a.context.msg.on(d.getUniqueMsgKey("vidChange"),function(){a.context.dataset.rollVideoInfoTimer&&clearTimeout(a.context.dataset.rollVideoInfoTimer),a.context.dataset.hasShowEndAdditionTip=!1,a.context.dataset.hasnlink=!1}),a.context.msg.on(d.getUniqueMsgKey("videoEnd"),function(){a.context.dataset.rollVideoInfoTimer&&clearTimeout(a.context.dataset.rollVideoInfoTimer),a.context.dataset.hasShowEndAdditionTip=!1,a.context.dataset.hasnlink=!1}),a.context.msg.on(d.getUniqueMsgKey("smallWindowModeChange"),function(b){b.isSmallWindow&&a.context.msg.broadcast("hideUiTips")}),a.context.msg.on(d.getUniqueMsgKey("videoTimeUpdate"),function(b){var c=a.calcCurrentTime(),d=c/a.context.dataset.duration;if(d>=.98&&a.context.dataset.hasnlink){if(a.context.dataset.hasShowEndAdditionTip)return;if(["LD","ZC","HT"].indexOf(a.context.dataset.currentAdType)>-1)return;a.context.dataset.hasShowEndAdditionTip=!0,a.context.msg.broadcast("showAdditionTip",{duration:b.vlinktd,type:"end"})}})}var d=Txplayer.util;a.exports={dealFilmMsgMoudle:c}},291:function(a,b){a.exports={initUserApis:function(){this.dataset.moduleApis={},this.dataset.moduleApis.seekTo=this.seekTo.bind(this),this.dataset.moduleApis.play=this.playControl.bind(this),this.dataset.moduleApis.pause=this.pauseControl.bind(this),this.dataset.moduleApis.getVid=this.getVid.bind(this),this.dataset.moduleApis.getCid=this.getCid.bind(this),this.dataset.moduleApis.getColumnId=this.getColumnId.bind(this),this.dataset.moduleApis.isSmallWindowMode=this.isSmallWindowMode.bind(this),this.dataset.moduleApis.setPlayerVipStatus=this.setPlayerVipStatus.bind(this),this.dataset.moduleApis.getDuration=this.getDuration.bind(this),this.dataset.moduleApis.getFileSize=this.getFileSize.bind(this),this.dataset.moduleApis.getVideoSize=this.getVideoSize.bind(this),this.dataset.moduleApis.getCurrentTime=this.getCurrentTime.bind(this),this.dataset.moduleApis.seekRight=this.seekRight.bind(this),this.dataset.moduleApis.seekLeft=this.seekLeft.bind(this),this.dataset.moduleApis.togglePlayPause=this.togglePlayPause.bind(this),this.dataset.moduleApis.getUserPayStatus=this.getUserPayStatus.bind(this),this.dataset.moduleApis.getVideoType=this.getVideoType.bind(this),this.dataset.moduleApis.getPlayerType=this.getPlayerType.bind(this),this.dataset.moduleApis.setSmallWindowMode=this.setSmallWindowMode.bind(this),this.dataset.moduleApis.getDefinitionList=this.getDefinitionList.bind(this),this.dataset.moduleApis.callPlayerExtendMethod=this.callPlayerExtendMethod.bind(this),this.dataset.moduleApis.closeLoginGuide=this.closeLoginGuide.bind(this),Txplayer.$.extend(this.context.userApi,this.dataset.moduleApis)},initPrivateMsg:function(){var a=this;this.dataset.privateApis={},this.dataset.privateApis.playControl=this.playControl.bind(this),this.dataset.privateApis.pauseControl=this.pauseControl.bind(this),this.dataset.privateApis.seekTo=this.seekTo.bind(this),this.dataset.privateApis.retryUrlsWhenErr=this.retryUrlsWhenErr.bind(this),this.dataset.privateApis.loadVideoUrls=this.loadVideoUrls.bind(this),Txplayer.$.each(this.dataset.privateApis,function(b,c){a.context.msg.on(b,c)})},initDataApis:function(){var a=this;this.dataset.dataApis={},this.dataset.dataApis.getVideoSeekToInfo=function(b,c){c.data=a.getVideoSeekToInfo(b)},Txplayer.$.each(this.dataset.dataApis,function(b,c){a.context.msg.setData(b,c)})}}},292:function(a,b,c){var d=Txplayer.util,e=c(143);Txplayer.$;a.exports={requestVideoUrlsByVid:function(a){a=a||{};var b={vid:this.context.dataset.vid,defn:this.context.dataset.historyDefinition||"",charge:this.context.dataset.isNeedPay?1:0,fhdswitch:a.fhdswitch?1:0,show1080p:this.context.config.show1080p?1:0,isHLS:0},c=this,f={};if(Txplayer.$.extend(b,a),this.context.dataset.useHls===!0&&"false"!=d.getUrlParam("ishls")){var g={isHLS:1,dtype:3,sphls:1,spgzip:"",dlver:""},h=!d.inNewIframe()&&("v.qq.com"===location.hostname||"film.qq.com"===location.hostname),i=h&&"0"===d.getUrlParam("useNewHls");h&&!i&&(g.sphls=2,g.spgzip=1,g.dlver=2),Txplayer.$.extend(b,g)}var j=new Date;d.isSupportEme&&(b.drm=32),b.hdcp=d.isSupportHDCP?1:0,b.spau=1,b.spaudio=15,b.defn=b.defn.replace("auto-",""),this.context.getinfo.requestGetinfo(b).done(function(e,g,h,i,j){d.v4log("requestGetinfo-done",e),d.log("requestGetinfo-done",i),g&&(c.context.dataset.filmVideoData=g,c.context.dataset.definitionList=h,Txplayer.$(c.context.dataset.definitionList).each(function(a,b){1===b.sl&&(c.context.dataset.currentDefinitionRate=b.br,c.context.dataset.definition=b.name,c.context.dataset.currentDefinitionFormat=b.format)})),c.context.dataset.getinfoJSON=i,c.context.dataset.duration=c.getDuration(),c.dataset.getVideoInfoErrorData=null,c.context.dataset.userPayStatus=c.getUserPayStatus(),c.context.dataset.filesize=c.getFileSize(),c.context.dataset.canPlayTime=null,i&&i.preview&&(1==i.exem||2==i.exem||4==i.exem||83==i.iRetCode)&&(c.context.dataset.canPlayTime=i.preview,f={code:83,trailTime:i.preview}),i&&i.vl&&i.vl.vi&&"object"===Txplayer.$.type(i.vl.vi[0])&&(c.context.dataset.videoWidth=i.vl.vi[0].vw,c.context.dataset.videoHeight=i.vl.vi[0].vh,c.context.dataset.tpid=i.vl.vi[0].videotype,c.context.dataset.ckey=i.vl.vi[0].fvkey,c.context.dataset.fvideo=i.vl.vi[0].fvideo,c.context.dataset.fvpint=i.vl.vi[0].fvpint?1e3*i.vl.vi[0].fvpint:6e5,c.context.dataset.adExtras=i.vl.vi[0].ad||{}),"1"==c.context.dataset.fvideo&&c.context.msg.broadcast("startRollVideoInfo",{config:b,fvpint:c.context.dataset.fvpint});var k,l=i&&i.fl&&i.fl.fi&&i.fl.fi||[],m=i&&i.al&&i.al.ai&&i.al.ai[0],n=m&&m.keyid||"";if(n=n.split("."),n=n.length>1?n[1]:"",l.forEach(function(a){1==a.sl&&(k=a.id,c.context.dataset.drm=a.drm||0)}),5==c.context.dataset.drm&&i&&i.vl&&i.vl.vi&&"object"===Txplayer.$.type(i.vl.vi[0])&&i.vl.vi[0].ckc){if(!d.isSupportEme||!c.context.dataset.useChromeHls)return void(c.context.dataset.isDefinitionSwitching&&c.context.dataset.vid===i.vl.vi[0].vid?c.context.msg.broadcast("switchDrmDefinitionError",{type:"hls",code:-11111,errCode:"-11111.1",exem:-1}):c.context.msg.broadcast("error",{type:"hls",errCode:"-11111.1",code:-11111,exem:-1}));var o=i.vl.vi[0].ckc;c.context.dataset.emeEnabled=!0;var p=["vid="+c.context.dataset.vid,"fmt="+k,"afmt="+n,"ip="+i.ip,"platform="+c.context.dataset.platform,"uin="+d.getUin(),"openid="+d.cookie.get("openid"),"version=1"];o=o.replace(/\|$/,""),c.context.dataset.ckc=o.indexOf("?")>-1?o+"&"+p.join("&"):o+"?"+p.join("&")}else c.context.dataset.emeEnabled=!1,c.context.dataset.ckc="";if(i.preview||1!==i.exem&&83!==i.iRetCode){if(1==i.dltype){c.context.msg.broadcast("destroyHlsPlayer",{msg:"backend does not suppoert hls, dltype=1"}),c.context.dataset.useHls=!1,c.context.dataset.useChromeHls=!1;var q=["html5hd","safarihls","chromehls"],r=c.context.config.playerType;q.indexOf(r)>-1&&(c.context.config.playerType="html5hd")}d.v4log("broadcast-getVideoUrlSuccess",a),c.context.msg.broadcast("getVideoUrlSuccess",e,g[0]),b.onlyGetinfo&&!a.requestNewGetinfoError||(d.v4log("broadcast-onAdOrderDataReady",""),j.adtype="LD",c.context.msg.broadcast("onAdOrderDataReady",j))}else f={code:83,trailTime:0};f&&f.hasOwnProperty("trailTime")&&!f.trailTime?c.showUIVipGuide("trial"):(f&&f.hasOwnProperty("code")&&83===f.code||c.context.dataset.trailerMode)&&(d.v4log("\u8be5\u7247\u652f\u6301\u8bd5\u770b",f),4==i.exem?c.context.msg.broadcast("showUIDujiaTip",f):c.context.msg.broadcast("showUIVipTip",f))}).fail(function(f){d.v4log("requestGetinfo-Fail",f);var g=new Date,h=g-j;if(h>32e3&&(h=32e3),f&&1001==f.code){d.v4log("\u5408\u5e76\u63a5\u53e3\u5931\u8d25 \u5355\u72ec\u8bf7\u6c42\u63a5\u53e3",f),a.onlyGetinfo=!0,a.requestNewGetinfoError=!0,c.context.dataset.requestNewGetinfoError=!0,c.requestVideoUrlsByVid(a);var i=window.performance&&window.performance.now()||0;return void c.context.msg.broadcast("reportAdInfo",{version:Txplayer.appVersion,adtype:"LD",step:1,step_duration:h,step_code:f.code,step_index:1,firstview_duration:parseInt(i,10)})}if(b.onlyGetinfo&&!a.requestNewGetinfoError||(d.v4log("broadcast-onAdOrderDataReady",""),c.context.msg.broadcast("onAdOrderDataReady",{videoErrorCode:f.code,adtype:"LD",requestOk:!1,adcost:g-j})),f&&91===f.code)c.dataset.getVideoInfoErrorData=f,c.context.msg.broadcast("videoInterruptByError");else if(f&&96==f.code)c.context.msg.broadcast("showLoginGuide");else if(f&&"76"===f.code&&"hls"===f.type)c.context.dataset.useHls=!1,c.requestVideoUrlsByVid(a);else{var k=e[f.code]||e.defaultMsg;"80"==f.code&&d.inArray(["1","2","3","7","9","10","11","14"],""+f.exem)>-1&&(k=e["80."+f.exem]),c.context.msg.broadcast("error",{errCode:f.errCode,code:f.code,msg:k,type:"cgi",exem:f.exem});try{c.context.userMsg.broadcast("error",{flowId:c.context.dataset.flowid,errCode:f.errCode,code:f.code,msg:k,type:"cgi",exem:f.exem})}catch(l){}}})},requestVideoNextPartKey:function(a,b,c){if(b=b||0,!this.context.dataset.filmVideoData)return!1;var d=this;return c=c?c:Txplayer.$.Deferred(),a.isNeedPay=this.context.dataset.isNeedPay,this.context.getinfo.requestGetkey(a).done(function(e){return d.dataset.getVkeyErrorData=null,e?void c.resolve(a.urlArray[b].url+"&vkey="+e):void c.reject()}).fail(function(f){if(f&&"1001"==f.code)return d.context.dataset.requestNewGetinfoError=!0,void d.requestVideoNextPartKey(a,b,c);if(!d.context.dataset.canPlayTime||83!==f.code){d.dataset.getVkeyErrorData=f,d.context.msg.broadcast("error",{code:f.code,errCode:f.errCode,msg:e[f.code]||e.defaultMsg,type:"cgi"});try{d.context.userMsg.broadcast("error",{flowId:d.context.dataset.flowid,code:f.code,errCode:f.errCode,msg:e[f.code]||e.defaultMsg,type:"cgi"})}catch(g){}c.reject(f)}}),c},updateVideoUrls:function(a){a=a||{};var b=this;this.context.msg.once("getVideoUrlSuccess.updateVideoUrls",function(a,c){c=c||{};var d=[];c.urlArray&&c.urlArray.length>0&&(d=c.urlArray.map(function(a){return a.url})),b.context.msg.broadcast("setChromeHlsData",{k:"keytimeout",v:{keyid:"hls."+b.context.dataset.getinfoJSON.vl.vi[0].lnk+"."+b.context.dataset.currentDefinitionFormat,m3u8url:d}})});var c=Txplayer.$.extend({},{vid:a.vid,charge:a.charge,defn:a.defn,fhdswitch:a.fhdswitch,onlyGetinfo:a.onlyGetinfo});this.requestVideoUrlsByVid(c)},loadVideoUrls:function(a){a=a||{},this.dataset.hasLoadVideoUrl=!0;var b,c=this;d.v4log("loadVideoUrls",a);var e=function(a){if(d.v4log("seekToSync",{playState:c.context.dataset.playState,seekToSyncFlag:c.dataset.seekToSyncFlag}),c.context.dataset.playState===-1)c.context.msg.on("videoPlaying.loadAndSeekSync",function(b){"film"==b.playListType&&(c.dataset.seekToSyncFlag||(a(),c.context.msg.off("videoPlaying.loadAndSeekSync")))});else{if(c.dataset.seekToSyncFlag)return;a()}};this.context.msg.once("getVideoUrlSuccess.loadVideoUrls",function(b,f){if(f=f||{},!c.context.dataset.filmVideoData)return void d.showError("onGetVideoUrlSuccess\u5931\u8d25","\u627e\u4e0d\u5230\u64ad\u653eurl\u5217\u8868");var g=[];c.context.dataset.useHls===!0?g.push({url:b,filesize:c.context.dataset.filmVideoData[0].bytesTotal,byteRate:c.context.dataset.filmVideoData[0].byteRate,vid:c.context.dataset.vid,m3u8:f&&f.m3u8}):Txplayer.$(c.context.dataset.filmVideoData).each(function(a,e){return 0===a&&b?void g.push({url:b,filesize:e.bytesTotal,vid:c.context.dataset.vid,data:e}):void g.push({_url:e.urlArray,data:e,filesize:e.bytesTotal,vid:c.context.dataset.vid,getUrlSync:function(){var a=Txplayer.$.Deferred();return c.requestVideoNextPartKey(this.data,c.context.dataset.urlIndex).done(function(b){d.showInfo("getUrlSync.done",b),a.resolve(b)}).fail(function(b){d.showError("getUrlSync.fail",b),a.reject(b)}),a}})});var h={data:g};return a.repalcePlayList&&(h.repalcePlayList=!0),a.clear&&(h.clear=!0),d.v4log("addUrls2Player",""),c.context.msg.broadcast("addUrls2Player",h),d.v4log("videoListChange",""),c.context.msg.broadcast("videoListChange",b,g),c.context.dataset.useChromeHls&&(c.context.dataset.hlsLoadStartTime=a.connectionPlayTime?a.connectionPlayTime:a.playStartTime,c.context.dataset.hlsLoadStartTime=+c.context.dataset.hlsLoadStartTime),d.v4log("options.autoplay",{autoplay:a.autoplay||"",noHdAdPlugin:c.context.dataset.noHdAdPlugin||""}),a.autoplay?(c.context.dataset.autoplay=!0,c.context.msg.broadcast("play")):c.context.dataset.noHdAdPlugin&&!a.fhdswitch&&(d.v4log("noHdAdPlugin-play",a),c.context.dataset.autoplay=!0,c.context.msg.broadcast("play")),c.context.dataset.autoplay&&c.context.dataset.requestNewGetinfoError&&!a.fhdswitch&&(d.v4log("requestNewGetinfoError",{}),c.context.msg.broadcast("play")),c.context.dataset.useChromeHls?(c.context.msg.off("videoPlaying.showUiSeekTip"),void c.context.msg.on("videoPlaying.showUiSeekTip",function(b){b&&"film"==b.playListType&&(delete c.context.dataset.hlsLoadStartTime,c.context.msg.off("videoPlaying.showUiSeekTip"),a.type="chromehls",c.context.msg.broadcast("showUiSeekTip",a))})):void(a.connectionPlayTime?e(function(){c.context.dataset.isSkippingTime=!0,c.seekTo({connectionPlayTime:a.connectionPlayTime})}):a.playStartTime&&e(function(){c.context.dataset.isSkippingTime=!0,c.seekTo({playStartTime:a.playStartTime})}))}),b=Txplayer.$.extend({},{vid:a.vid,charge:a.charge,defn:a.defn,fhdswitch:a.fhdswitch,onlyGetinfo:a.onlyGetinfo}),c.requestVideoUrlsByVid(b)}}},293:function(a,b,c){var d=Txplayer.util;Txplayer.$,c(244);a.exports={calcCurrentTime:function(){if("film"!=this.context.dataset.currentPlayListType)return 0;var a=this.context.dataset.playListIndex;this.context.dataset.filmVideoData&&a>=this.context.dataset.filmVideoData.length&&(a=0);var b=0;return Txplayer.$(this.context.dataset.filmVideoData).each(function(c,d){return!(c>=a)&&void(b+=d.duration)}),b+=parseInt(this.context.dataset.videoCurrentTime),parseInt(b)},updateCurrentTime:function(a,b){"number"===Txplayer.$.type(a)&&(this.context.dataset.currentTime=a)},getVideoSeekToInfo:function(a){var b=0,c=0;this.context.dataset.useHls||Txplayer.$(this.context.dataset.filmVideoData).each(function(d,e){if(c=d,b+=e.duration,b>a)return b-=e.duration,!1});var d={index:c,prevDurtion:b};return d},showUIVipGuide:function(a){if(!this.context.dataset.hasCallShowUIVipGuide){this.context.dataset.hasCallShowUIVipGuide=!0;var b=this;setTimeout(function(){b.context.dataset.hasCallShowUIVipGuide=!1},3e3);var c={trial:{trialFinish:!0},switchDef:{switchDefinitionFail:!0,defn:this.context.dataset.targetDefn}};this.pauseControl(),d.v4log("showUIVipGuide",c[a]),this.context.msg.broadcast("showUIVipGuide",c[a]);try{this.context.userMsg.broadcast("showUIVipGuide",c[a])}catch(e){}this.context.dataset.isBrowserFullscreen&&this.context.msg.broadcast("exitBrowserFullscreen"),this.context.dataset.isWindowFullscreen&&this.context.msg.broadcast("exitWindowFullscreen")}},showDujiaDialog:function(){},showUnOfficialLimitTips:function(){if((!this.context.config.official||"nintendo"===this.context.config.playerType)&&this.context.dataset.canPlayTime&&4!=this.context.dataset.getinfoJSON.exem){var a=Txplayer.util.getTxVideoPageURLByVid(this.context.dataset.vid,0),b=this.context.dataset.canPlayTime||0,c=Math.floor(b/60),d=b-60*c;this.context.msg.broadcast("showUnOfficialLimitTips",{min:c,sec:d,href:a})}},getSkipPreludeTime:function(){var a;return a=this.context.dataset.skipPrelude?parseInt(this.context.dataset.playStartTime):0},checkLanguageSwitch:function(a){var b=d.getSessionData(Txplayer.dataset.sessionStorageKey.languageSwitch),c="";try{if(b&&(b=b.split("|")||[],b.length>0)){var e=b[0],f=(b[1],b[2]),g=(new Date).getTime();g-f<3e4?e===a.vid&&(c="page_langSwitch"):d.delSessionData(Txplayer.dataset.sessionStorageKey.languageSwitch)}var h=this.context.dataset.adext||"";c?0===h.length?h=c:h.indexOf("page_langSwitch")===-1&&(h=h+"|"+c):h=h.replace(/\|?page\_langSwitch/g,""),this.context.dataset.adext=h}catch(i){}},getDuration:function(){var a=0;return this.context.dataset.getinfoJSON&&this.context.dataset.getinfoJSON.vl&&this.context.dataset.getinfoJSON.vl.vi&&this.context.dataset.getinfoJSON.vl.vi[0]&&this.context.dataset.getinfoJSON.vl.vi[0].td&&(a=parseFloat(this.context.dataset.getinfoJSON.vl.vi[0].td)),parseFloat(a)},getFileSize:function(){if(!this.context.dataset.filmVideoData||"array"!==Txplayer.$.type(this.context.dataset.filmVideoData))return 0;var a=0;return Txplayer.$(this.context.dataset.filmVideoData).each(function(b,c){a+=parseInt(c.bytesTotal)}),parseInt(a/1024)},getVideoSize:function(){return{width:this.context.dataset.videoWidth,height:this.context.dataset.videoHeight}},getVideoType:function(){return this.context.config.videoType},getPlayerType:function(){return this.context.config.playerType},getCurrentTime:function(){return this.context.dataset.currentTime||0},getVid:function(){return this.context.dataset.vid},getCid:function(){return this.context.dataset.cid},getColumnId:function(){return this.context.dataset.columnId},isSmallWindowMode:function(){return!!this.context.dataset.isSmallWindowMode},callPlayerExtendMethod:function(){var a=Array.prototype.slice.call(arguments,0),b=a.shift();if(b)switch(a.length){case 1:try{this.context.msg.broadcast(b,a[0])}catch(c){}break;case 2:try{this.context.msg.broadcast(b,a[0],a[1])}catch(c){}break;default:try{this.context.msg.broadcast(b,a)}catch(c){}}},setPlayerVipStatus:function(a){this.context.config.show1080p=!!a},getDefinitionList:function(){return[]},seekRight:function(a){var b=5;"number"===Txplayer.$.type(a)&&(b=a);var c=this.context.dataset.duration;if(c){var d=this.getCurrentTime();d+=b,d>c||this.seekTo(d)}},seekLeft:function(a){var b=5;"number"===Txplayer.$.type(a)&&(b=a);var c=this.context.dataset.duration;if(c){var d=this.getCurrentTime();d-=b,d<0||this.seekTo(d)}},togglePlayPause:function(){this.context.dataset.disableHotKey||(1===this.context.dataset.playState?(this.pauseControl(),this.context.msg.broadcast("userPausePlayer")):(this.playControl(),this.context.msg.broadcast("userPlayPlayer")))},getUserPayStatus:function(){var a=null;return this.context.dataset.getinfoJSON&&this.context.dataset.getinfoJSON.vl&&this.context.dataset.getinfoJSON.vl.vi&&this.context.dataset.getinfoJSON.vl.vi.length&&this.context.dataset.getinfoJSON.vl.vi[0]&&(a=this.context.dataset.getinfoJSON.vl.vi[0].ch),a},setSmallWindowMode:function(a){this.context.dataset.isSmallWindowMode=!!a,this.context.msg.broadcast("smallWindowModeChange",{isSmallWindow:!!a})},closeLoginGuide:function(a){if(Txplayer.util.v4log("closeLoginGuide",a),this.context.dataset.disableHotKey=!1,a)if(a.success)if(a.isVip){this.context.msg.broadcast("definitionChange","shd");try{this.context.userMsg.broadcast("definitionChange",{definition:"shd"})}catch(b){}}else this.context.msg.broadcast("definitionChange","shd"),this.context.msg.broadcast("set720pWhenLogin");else this.context.msg.broadcast("closeLoginGuide"),this.context.msg.broadcast("play")}}},294:function(a,b){var c=Txplayer.util;a.exports={retryUrlsWhenErr:function(a){c.v4log("retryUrlsWhenErr",a);var b=this,d=a.currentTime,e=a.index;if(b.context.dataset.urlIndex++,b.context.dataset.filmVideoData&&!(e>=b.context.dataset.filmVideoData.length))if(b.context.dataset.urlIndex>=b.context.dataset.filmVideoData[e].urlArray.length&&(b.context.dataset.urlIndex=0),b.context.dataset.useHls===!0)a.isFocus?b.context.msg.broadcast("setFocusVideoUrl",{
url:b.context.dataset.filmVideoData[e].urlArray[b.context.dataset.urlIndex].url,currentTime:d,autoplay:!0}):b.context.msg.broadcast("setPreloadVideoUrl",{url:b.context.dataset.filmVideoData[e].urlArray[b.context.dataset.urlIndex].url,currentTime:d,autoplay:!1});else{if(c.browser.ie&&0==b.context.dataset.playState)return;a.isFocus&&b.requestVideoNextPartKey(b.context.dataset.filmVideoData[e],b.context.dataset.urlIndex).done(function(a){b.context.msg.broadcast("setFocusVideoUrl",{url:a,currentTime:d,autoplay:!0})})}}}}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(19)},19:function(a,b){function c(a){d=Txplayer.$,this.dataset={},this.context=a,this.init()}var d=Txplayer.$;Txplayer.util;c.prototype={init:function(){this.addEventListeners()},reset:function(){delete this.dataset.fileData,delete this.dataset.fileSize,delete this.dataset.prevBuffer,delete this.dataset.buffer},updateSpeed:function(a){this.dataset.hasOwnProperty("speeds")||(this.dataset.speeds=[]),"number"==typeof a&&(a>12288&&(a=12e3),this.context.dataset.videoDownloadSpeed=a,this.dataset.speeds.push(a));var b=10;this.dataset.speeds.length>b&&this.dataset.speeds.splice(0,this.dataset.speeds.length-b);var c={speed:this.dataset.speed,average:this.getAverSpeed()};this.context.msg.broadcast("downloadSpeedUpdate",c)},getAverSpeed:function(){if(!this.dataset.hasOwnProperty("speeds"))return 0;var a=0,b=0;return this.dataset.speeds&&this.dataset.speeds.length&&(d.each(this.dataset.speeds,function(b,c){a+=parseInt(c)}),b=parseInt(a/this.dataset.speeds.length)),b},calcMp4:function(){if(!this.context.dataset.disableCalcDownloadSpeed&&!this.dataset.isStop&&this.dataset.video&&this.dataset.fileData&&this.dataset.fileData.filesize){this.dataset.fileData.filesize=parseInt(this.dataset.fileData.filesize);var a=this;if(a.dataset.video.buffered.length&&(a.dataset.buffer=a.dataset.video.buffered.end(a.dataset.video.buffered.length-1),a.dataset.fileSize=a.dataset.fileData.filesize/1024,a.dataset.duration=a.dataset.fileData.data&&a.dataset.fileData.data.duration||a.dataset.video.duration,a.dataset.duration=parseFloat(a.dataset.duration),a.dataset.duration)){if(parseInt(a.dataset.buffer)>=parseInt(a.dataset.duration))return a.dataset.speed=0,void a.stop();if(a.dataset.hasOwnProperty("prevBuffer")||(a.dataset.prevBuffer=0),a.dataset.bufferUpdateTime=+new Date,a.dataset.bufferIncrease=a.dataset.buffer-a.dataset.prevBuffer,a.dataset.bufferIncrease<=0)return a.dataset.speed=0,void a.updateSpeed(a.dataset.speed);a.dataset.bufferUpdateCostTime=a.dataset.bufferUpdateTime-a.dataset.prevBufferUpdateTime,a.dataset.updateFileSize=a.dataset.fileSize*(a.dataset.bufferIncrease/a.dataset.duration),a.dataset.speed=a.dataset.updateFileSize/(a.dataset.bufferUpdateCostTime/1e3),a.dataset.speed=parseInt(a.dataset.speed),isNaN(a.dataset.speed)||a.updateSpeed(a.dataset.speed),a.dataset.prevBufferUpdateTime=a.dataset.bufferUpdateTime,a.dataset.prevBuffer=a.dataset.buffer}}},calcHLS:function(a){if(!this.context.dataset.disableCalcDownloadSpeed&&!this.dataset.isStop&&a&&a.loaded){if(this.dataset.prevBuffer||(this.dataset.prevBuffer=0),this.dataset.bufferIncrease=a.loaded-this.dataset.prevBuffer,this.dataset.bufferUpdateTime=+new Date,this.dataset.bufferIncrease<=0)return this.dataset.prevBufferUpdateTime=this.dataset.bufferUpdateTime,this.dataset.prevBuffer=a.loaded,void(this.context.dataset.videoDownloadSpeed=0);this.dataset.bufferUpdateCostTime=this.dataset.bufferUpdateTime-this.dataset.prevBufferUpdateTime,this.dataset.bufferUpdateCostTime<0||(this.dataset.speed=this.dataset.bufferIncrease/1024/(this.dataset.bufferUpdateCostTime/1e3),this.dataset.speed=parseInt(this.dataset.speed),isNaN(this.dataset.speed)||this.updateSpeed(this.dataset.speed),this.dataset.prevBufferUpdateTime=this.dataset.bufferUpdateTime,this.dataset.prevBuffer=a.loaded)}},getRealDownloadSpeedWhenNetFree:function(){var a={},b=this;setInterval(function(){var c=b.context.dataset.videoDownloadSpeed;a.hasOwnProperty(c)?"number"!=typeof a[c]?a[c]=1:(a[c]++,4===a[c]&&(b.context.dataset.videoDownloadSpeed=0,a={})):(a={},a[c]=1)},500)},addEventListeners:function(){var a=this;this.context.msg.on("adLoadProgress",function(b){b&&b.speed&&(a.context.dataset.videoDownloadSpeed=+b.speed)}),this.context.msg.on("videoPlay",function(b){b&&b.videoTag&&(0==b.videoTag.buffered.length&&(a.reset(),a.dataset.prevBufferUpdateTime=+new Date),a.dataset.video=b.videoTag,a.dataset.fileData=a.context.dataset.playList[a.context.dataset.playListIndex])}),this.context.msg.on("error.download-monitor",function(b){b&&b.type&&a.stop()}),"chromehls"===this.context.config.playerType&&this.context.msg.on("hlsProgress",function(b){a.dataset.isStop||a.calcHLS(b)}),this.context.msg.on("videoPlay.download-monitor",function(){"chromehls"!=a.context.config.playerType&&a.startTimer()}),a.getRealDownloadSpeedWhenNetFree()},startTimer:function(){if(!this.dataset.calcTimer){var a=this;this.dataset.calcTimer=setInterval(function(){a.calcMp4()},100)}},stop:function(){this.dataset.isStop=!0,this.dataset.startTimer&&clearInterval(this.dataset.startTimer)}},Txplayer.register("DownloadMonitor",c)}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(299)},206:function(a,b,c){function d(a){var b="qqlivechannel=channel1."+a;if(Txplayer.util.browser.ie){var c=new Date;c.setTime(c.getTime()+864e5),document.cookie=b+";path=/;expires="+c.toGMTString()}else{var d=Txplayer.$("<input>");Txplayer.$("body").append(d),d.css({position:"absolute",left:"-9999px"}),d.val(b),d.css({top:Txplayer.$(window).scrollTop()+"px"}),d.get(0).focus(),d.get(0).setSelectionRange(0,b.length),document.queryCommandSupported&&document.queryCommandSupported("copy")&&document.execCommand("copy",!0),d.remove()}}var e=c(207);a.exports=function(a){if(a.support&&a.sso){try{d(a.atag)}catch(b){}e(function(b){b&&b.exist().done(function(){b.open(a.sso),a.success&&a.success()}).fail(function(){a.error&&a.error()})})}}},207:function(a,b){var c=[],d=!1,e=0;a.exports=function(a){if(e)return void a(e);if(c.push(a),!d){if(d=!0,"qq.com"!=document.domain)throw new Error("document.domain is not qq.com");var b=document.createElement("iframe");b.src="javascript:'<script>window.onload=function(){document.write(\\'<script>document.domain=\\\"qq.com\\\";<\\\\/script>\\');document.close();};</script>'",b.style.cssText="display:none;",document.body.appendChild(b),b.getClient=function(a){e=a;for(var b=c.shift();b;)b&&b(a),b=c.shift()},b.src="//v.qq.com/iframe/client.html"}}},299:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=(Txplayer.apiList,c(300)),h=c(206),i=c(207),j=c(301);d.prototype={init:function(){this.write(),this.addEventListerner(),this.exportsModuleApis()},write:function(){var a={error:"txp-ui-error",errorMsg:"txp-ui-error-msg",errorRefresh:"txp-ui-error-refresh",changePlayer:"txp-ui-error-changeplayer",openNewPage:"txp-ui-error-newpage",errorCode:"txp-ui-error-code",errorTip:"txp-ui-error-tip",clientTitle:"txp-ui-error-client-title",clientSpan:"txp-ui-error-client-span",clientBtn:"txp-ui-error-client-btn",whenCoolOpen:"txp-ui-error-when-coolopen",qqbrowserBtn:"txp-ui-error-qqbrowser-btn",playBtn:"txp-ui-error-play-btn"},b=e.tmpl(g,a);this.context.dataset.$playermod.append(b),this.dataset.$error=this.context.dataset.$playermod.find('[data-role="'+a.error+'"]'),this.dataset.$errorMsg=this.context.dataset.$playermod.find('[data-role="'+a.errorMsg+'"]'),this.dataset.$errorRefresh=this.context.dataset.$playermod.find('[data-role="'+a.errorRefresh+'"]'),this.dataset.$changePlayer=this.context.dataset.$playermod.find('[data-role="'+a.changePlayer+'"]'),this.dataset.$openNewPage=this.context.dataset.$playermod.find('[data-role="'+a.openNewPage+'"]'),this.dataset.$errorCode=this.context.dataset.$playermod.find('[data-role="'+a.errorCode+'"]'),this.dataset.$errorTip=this.context.dataset.$playermod.find('[data-role="'+a.errorTip+'"]'),this.dataset.$clientTitle=this.context.dataset.$playermod.find('[data-role="'+a.clientTitle+'"]'),this.dataset.$clientSpan=this.context.dataset.$playermod.find('[data-role="'+a.clientSpan+'"]'),this.dataset.$clientBtn=this.context.dataset.$playermod.find('[data-role="'+a.clientBtn+'"]'),this.dataset.$coolOpenSpan=this.context.dataset.$playermod.find('[data-role="'+a.whenCoolOpen+'"]'),this.dataset.$qqbrowserBtn=this.context.dataset.$playermod.find('[data-role="'+a.qqbrowserBtn+'"]'),this.dataset.$playBtn=this.context.dataset.$playermod.find('[data-role="'+a.playBtn+'"]'),this.dataset.errorTipSrc={offline:{src:"//i.gtimg.cn/qqlive/images/20170712/error_tip2.png",srcset:"//i.gtimg.cn/qqlive/images/20170712/error_tip2@2x.png 2x"},ufo:{src:"//i.gtimg.cn/qqlive/images/20170712/error_tip1.png",srcset:"//i.gtimg.cn/qqlive/images/20170712/error_tip1@2x.png 2x"}},this.dataset.isCoolOpen="coolOpen"===this.context.config.playerType},remove:function(){this.dataset.$error.remove()},hide:function(){this.dataset.$error.addClass(Txplayer.dataset.hideClass)},getData:function(){var a=f.getData(Txplayer.dataset.localStorageKey.userSetting);try{a=JSON.parse(a)}catch(b){a={}}return a},setData:function(a,b){var c=this.getData(Txplayer.dataset.localStorageKey.userSetting);c[a]=b,f.setData(Txplayer.dataset.localStorageKey.userSetting,JSON.stringify(c))},report:function(a,b){this.context.msg.broadcast("reportUsrAction",{usr_action:a,usr_action_detail:b||""})},showErrorUiTips:function(a){var b=this;f.v4log("showErrorUiTips",a),a&&"object"===e.type(a.msg)&&(a.msg=a.msg.defaultMsg);var c=a.code+"",d=this.context.dataset.flowid;if(c&&c.indexOf("_")>-1&&(c=c.split("_")[0]),a&&e.inArray(c,["83"])>-1&&"function"===e.type(this.context.config.showOpenVIPGuide))return this.context.config.showOpenVIPGuide(),void(this.context.dataset.isBrowserFullscreen&&this.context.msg.broadcast("exitBrowserFullscreen"));if(this.dataset.$error.removeClass(Txplayer.dataset.hideClass),this.context.dataset.$playermod.width()<560?this.dataset.$errorCode.text("[ \u9519\u8bef\u7801:"+(a.errCode||"")+" ]"):this.dataset.$errorCode.text("[ \u9519\u8bef\u7801:"+(a.errCode||"")+", "+d+" ]"),e.inArray(a.code+"",["1","2","3","4","5","444","445","10001","30","40","41","42","50","68"])>-1){var g=a.msg;4!=a.code||f.isSupportMP4()||(g="\u5f53\u524d\u6d4f\u89c8\u5668\u4e0d\u652f\u6301H5\u64ad\u653e\u5668"),this.dataset.$errorMsg.html(g);var h;h=e.inArray(a.code+"",["444","445"])>-1?this.dataset.errorTipSrc.offline:this.dataset.errorTipSrc.ufo;var k=!1;try{k=parent.window._TxpIframeInQzoneIfrme}catch(l){}f.inNewIframe()&&k?this.dataset.$changePlayer.addClass(Txplayer.dataset.hideClass):this.dataset.$changePlayer.removeClass(Txplayer.dataset.hideClass)}else this.dataset.$changePlayer.addClass(Txplayer.dataset.hideClass),this.dataset.$errorRefresh.addClass(Txplayer.dataset.hideClass),this.dataset.$errorMsg.html(a.msg||Txplayer.v4errcode.defaultMsg),h=this.dataset.errorTipSrc.ufo;var m=this.context.dataset.$playermod||Txplayer.$&&Txplayer.$("#"+this.context.config.containerId),n=m.find(".txp_player");(this.dataset.isCoolOpen||this.context.config.useMiniSkin||n.hasClass("txp_player_mini")||!this.context.config.showHTML5Switch)&&(this.dataset.$changePlayer.addClass(Txplayer.dataset.hideClass),this.dataset.$coolOpenSpan.removeClass(Txplayer.dataset.hideClass));var o=["ke.qq.com","fudao.qq.com"];(f.os.mac||o.indexOf(location.host)>-1)&&this.dataset.$clientTitle.addClass(Txplayer.dataset.hideClass),this.dataset.$errorTip.attr({src:h.src,srcset:h.srcset});var p=this.dataset.errorcodeStr=a.code+"."+a.exem;"80.14"!==p&&"69.4"!==p&&a.code!=-11111||(f.os.mac?(this.dataset.$clientTitle.removeClass(Txplayer.dataset.hideClass),this.dataset.$clientSpan.text("\u8bf7\u4f7f\u7528Mac\u5ba2\u6237\u7aef\u89c2\u770b ")):this.dataset.$clientSpan.text("\u8bf7\u4f7f\u7528PC\u5ba2\u6237\u7aef\u89c2\u770b "));var q="";if(a.code==-11111||"80.14"===p||"69.4"===p){a.code==-11111&&window.TxpCreativePlayer&&window.TxpCreativePlayer.adBlockEnabled&&this.context.dataset.emeEnabled?(b.report("playererror-drm-error","blocked"),this.dataset.$errorMsg.html(Txplayer.v4errcode.adblock)):(b.report("playererror-drm-error","not_support"),"80.14"===p||"69.4"===p?this.dataset.$errorMsg.html(Txplayer.v4errcode[p]):this.dataset.$errorMsg.html(Txplayer.v4errcode[a.code])),q=f.os.mac?"Mac\u5ba2\u6237\u7aef\u89c2\u770b":"PC\u5ba2\u6237\u7aef\u89c2\u770b",this.dataset.$clientSpan.addClass(Txplayer.dataset.hideClass),a.showPlayBtn&&this.dataset.$playBtn.removeClass(Txplayer.dataset.hideClass);var r=this.dataset.$qqbrowserBtn,s=function(a){r.removeClass(Txplayer.dataset.hideClass);var b="\u6216${opName}\u6700\u65b0${showqq}Chrome\u6d4f\u89c8\u5668\u89c2\u770b";b=b.replace("${opName}",a?"\u4f7f\u7528":"\u4e0b\u8f7d"),b=b.replace("${showqq}",f.os.mac?"":' <a style="display:inline; margin: 16px 0 0 0;text-decoration: underline!important;">QQ\u6d4f\u89c8\u5668</a>/ '),r.html(b)};s(!0),j.detect().then(function(a){s(a.exist)},function(){})}else this.dataset.$playBtn.addClass(Txplayer.dataset.hideClass),this.dataset.$clientSpan.removeClass(Txplayer.dataset.hideClass),this.dataset.$qqbrowserBtn.addClass(Txplayer.dataset.hideClass);if(!this.dataset.$clientTitle.hasClass(Txplayer.dataset.hideClass))try{i(function(a){a&&a.exist().done(function(){var a="\u7acb\u5373\u6253\u5f00";"80.14"!==p&&"69.4"!==p||(a="\u7ee7\u7eed\u89c2\u770b"),q?b.dataset.$clientBtn.text("\u6253\u5f00"+q):b.dataset.$clientBtn.text(a)}).fail(function(){var a="\u7acb\u5373\u4e0b\u8f7d";q?b.dataset.$clientBtn.text("\u4e0b\u8f7d"+q):b.dataset.$clientBtn.text(a)})})}catch(l){var t="\u7acb\u5373\u4e0b\u8f7d";q?b.dataset.$clientBtn.text("\u4e0b\u8f7d"+q):b.dataset.$clientBtn.text(t)}61!=a.code&&62!=a.code||b.dataset.$clientSpan.addClass(Txplayer.dataset.hideClass),f.os.linux&&b.dataset.$clientTitle.addClass(Txplayer.dataset.hideClass)},addEventListerner:function(){var a=this;this.dataset.eventsList={},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(){a.hide()},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)}),this.dataset.$errorRefresh.off("click").on("click",function(){window.location.reload()}),this.dataset.$changePlayer.off("click").on("click",function(){a.setData("isUseFlash",1),window.location.reload()}),this.dataset.$openNewPage.off("click").on("click",function(){var b=a.context.config.otherVideoLink;b&&window.open(b)}),this.dataset.$clientBtn.off("click").on("click",function(){a.report("playererror-clientbtn-clicked");var b=a.context.dataset.vid||"",c=a.context.dataset.cid||"",d=Math.max(a.context.dataset.currentTime-5,0),e="web.playererror";h({support:!0,atag:"playererror",sso:"qqlive://sso/vbarid="+c+"&videoid="+b+"&start="+d+"&atag="+e,success:function(){a.report("playererror-clientbtn-play")},error:function(){"80.14"!==a.dataset.errorcodeStr&&"69.4"!==a.dataset.errorcodeStr||!f.os.mac?location.href="//node.video.qq.com/x/api/download_pc":window.open("https://v.qq.com/download.html#mac","_blank"),a.report("playererror-clientbtn-download")}})}),this.dataset.$qqbrowserBtn.off("click").on("click","a",function(){a.report("playererror-qqbrowser-clicked","exist="+j.exist),j.open(location.href)}),this.dataset.$playBtn.off("click").on("click",function(){a.report("playererror-playbtn-clicked"),a.context.msg.broadcast("playControl",{connectionPlayTime:a.context.dataset.connectionPlayTime,playStartTime:a.context.dataset.playStartTime,connectionPlayType:1}),a.context.msg.broadcast("userPlayPlayer"),a.hide()}),this.context.msg.on("error",function(b){b&&e.inArray(b.type,["film","cgi","init","hls"])===-1||(a.context.dataset.disableHotKey=!0,b&&94==b.code||a.showErrorUiTips(b))}),this.context.msg.on("switchDrmDefinitionError",function(b){a.context.msg.broadcast("pause"),a.context.msg.broadcast("userPausePlayer"),b.showPlayBtn=!0,a.showErrorUiTips(b)})},exportsModuleApis:function(){var a=this;this.dataset.privateApis={},this.dataset.privateApis.showErrorUiTips=this.showErrorUiTips.bind(this),e.each(this.dataset.privateApis,function(b,c){a.context.msg.on(b,c)})}},Txplayer.register("v4UiError",d)},300:function(a,b){a.exports='<txpdiv  data-role="<%=error%>" class="txp_video_error txp_none">\n  <img data-role="<%=errorTip%>" class="txp_error_pic" alt=""/>\n  <txpdiv class="txp_error_title">\n    <span data-role="<%=errorMsg%>">\u7f51\u7edc\u94fe\u63a5\u4f3c\u4e4e\u51fa\u73b0\u95ee\u9898\uff0c</span>\n    <span data-role="<%=errorRefresh%>">\n      \u4f60\u53ef\u4ee5 <button class="txp_btn">\u5237\u65b0</button>\n      <span data-role="<%=changePlayer%>"> \u6216 <button class="txp_btn">\u4f7f\u7528\u517c\u5bb9\u6a21\u5f0f\u64ad\u653e</button></span>\n      <span class="txp_none" data-role="<%=whenCoolOpen%>">\u8bd5\u8bd5</span>\n    </span>\n  </txpdiv >\n  <txpdiv class="txp_error_title2" data-role="<%=clientTitle%>">\n    <span data-role="<%=clientSpan%>">\u4f7f\u7528PC\u5ba2\u6237\u7aef\u64ad\u653e\u66f4\u7a33\u5b9a </span>\n    <a class="txp_link_btn" data-role="<%=clientBtn%>">\u7acb\u5373\u4e0b\u8f7d</a>\n    <txpdiv class="txp_error_title2 txp_link_btn txp_none" data-role="<%=playBtn%>" style="margin-right: 0;">\n      \u8fd4\u56de\u7ee7\u7eed\u64ad\u653e\n    </txpdiv>\n  </txpdiv>\n  <span class="txp_none" data-role="<%=qqbrowserBtn%>" style="margin: 16px 0 0 0;">\n    \u6216\u4f7f\u7528\u6700\u65b0 <a style="display:inline; margin: 16px 0 0 0;text-decoration: underline!important;">QQ\u6d4f\u89c8\u5668</a> / Chrome\u89c2\u770b\n  </span>\n  <txpdiv class="txp_error_code" ><span data-role="<%=errorCode%>">[ \u9519\u8bef\u7801: xx, xxx ]</span> <a href="//support.qq.com/products/2208" target="_blank">\u6211\u8981\u53cd\u9988</a></txpdiv >\n</txpdiv >\n'},301:function(a,b){var c=Txplayer.$;a.exports={exist:!1,minVersion:[10,2,2101,400],isLastestChromeSupportDrm:function(){var a,b=Txplayer.util.os;return b.windows?(a=parseFloat(b.version,10),a>6):b.mac?!Txplayer.util.browser.qqbrowser&&(a=(b.version||"").split("."),a=parseFloat((a[0]||"0")+"."+(a[1]||"0"),10),a>10.1):!b.linux&&void 0},compareVersion:function(a){var b=a.split("."),c=this.minVersion,d=!1;if(a===c.join("."))d=!0;else if(4===b.length){b.forEach(function(a,c){b[c]=parseInt(a,10)});for(var e=0;e<b.length;e++){if(b[e]>c[e]){d=!0;break}if(b[e]<c[e]){d=!1;break}}}return d},detect:function(){var a=this,b=c.Deferred(),d=c('<meta name="referrer" content="always" />');c("head").prepend(d);var e=this.isLastestChromeSupportDrm();return e?c.ajax({timeout:5e3,type:"POST",url:"http://127.0.0.1:28653/api/handle",dataType:"json",data:JSON.stringify({action:"GetQBVersion",cmd:""}),success:function(c){d.remove();var e=!1,f=c.result||"";a.minVersion;f&&(e=a.compareVersion(f)),e?(a.exist=!0,b.resolve({exist:!0})):(a.exist=!1,b.resolve({exist:!1}))},error:function(c){d.remove(),a.exist=!1,b.resolve({exist:!1})}}):b.reject(),b},download:function(){try{location.assign("http://dldir1.qq.com/invc/tt/QQBrowser_Setup_DRM.exe")}catch(a){}},open:function(a){if(this.exist){var b=c('<meta name="referrer" content="always" />');c("head").prepend(b),c.ajax({type:"POST",url:"http://127.0.0.1:28653/api/handle",dataType:"json",data:JSON.stringify({action:"Open",cmd:encodeURIComponent(a)}),success:function(){b.remove()},error:function(){b.remove()}})}else this.download()},text:{open:'\u6216\u4f7f\u7528\u6700\u65b0 <a style="display:inline; margin: 16px 0 0 0;text-decoration: underline!important;">QQ\u6d4f\u89c8\u5668</a> / Chrome \u89c2\u770b',download:'\u6216\u4e0b\u8f7d\u6700\u65b0 <a style="display:inline; margin: 16px 0 0 0;text-decoration: underline!important;">QQ\u6d4f\u89c8\u5668</a> / Chrome \u89c2\u770b'}}}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(245)},66:function(a,b){var c={unstarted:-1,ended:0,playing:1,paused:2,buffering:3,cued:4,stop:5},d={msd:"\u6d41\u7545180P",sd:"\u6807\u6e05270P",hd:"\u9ad8\u6e05480P",shd:"\u8d85\u6e05720P",fhd:"\u84dd\u51491080P",uhd:"4K"};a.exports={playerstate:c,definitionMap:d}},245:function(a,b,c){function d(a){f=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=c(246),f=Txplayer.$,g=Txplayer.util,h=(Txplayer.apiList,c(66).definitionMap);d.prototype={init:function(){this.write(),this.addEventListener(),this.exportsModuleApis()},write:function(){var a={hide:Txplayer.dataset.hideClass,tips:"txp-ui-tips",text:"txp-ui-tips-text",close:"txp-ui-tips-close"},b=f.tmpl(e,a);this.context.dataset.$loading?this.context.dataset.$loading.before(b):this.context.dataset.$playermod.append(b),this.dataset.$tips=this.context.dataset.$playermod.find('[data-role="'+a.tips+'"]'),this.dataset.$text=this.context.dataset.$playermod.find('[data-role="'+a.text+'"]'),this.dataset.$close=this.context.dataset.$playermod.find('[data-role="'+a.close+'"]')},remove:function(){this.dataset.$tips.remove()},stopTips:function(){this.context.msg.broadcast("hideUiTips"),this.dataset.trialMovie_TIMER&&(clearInterval(this.dataset.trialMovie_TIMER),this.dataset.trialMovie_TIMER=null)},dealVipTip:function(a){var b,c=this,d=5,e=0,f=function(){if(e>d)return void clearInterval(c.dataset.trialMovie_TIMER);e++;try{b=c.context.config.flashCallFn({type:c.context.dataset.trailerMode?"trailerMode":"getPayTip"})}catch(a){g.showInfo("[updateTrialData.getTips.error]",a)}if(b){c.dataset.getTip_TIMER&&(clearTimeout(c.dataset.getTip_TIMER),c.dataset.getTip_TIMER=null);var h=b.match(/\[.*?\]/);if(h){h=h[0];var i='<a href="javascript:;" data-action="openVIP" data-role="txp-ui-tips-openVIP">'+h.slice(1,-1)+"</a>";b=b.replace(h,i)}}else c.dataset.getTip_TIMER&&clearTimeout(c.dataset.getTip_TIMER),c.dataset.getTip_TIMER=setTimeout(function(){b=f()},1e3)},h=function(){c.context.dataset.isUiTipsShowing||c.context.dataset.isPlayingAd||(b||f(),b&&c.context.msg.broadcast("showUiTips",{text:b,time:300}))};h(),this.dataset.trialMovie_TIMER&&clearInterval(c.dataset.trialMovie_TIMER),this.dataset.trialMovie_TIMER=setInterval(function(){h()},5e3)},dealDujiaTip:function(){var a=this;this.context.msg.once(g.getUniqueMsgKey("videoPlaying"),function(){a.hasShownDujia||(a.hasShownDujia=!0,a.context.msg.broadcast("showUiTips",{text:"\u53ef\u8bd5\u770b1\u5206\u949f\u901f\u770b\u72ec\u5bb6\u5185\u5bb9",time:5,hideClose:!0}))}),this.context.msg.on(g.getUniqueMsgKey("vidChange"),function(){a.hasShownDujia=!1}),this.context.msg.on(g.getUniqueMsgKey("beforeVideoRePlay"),function(){a.hasShownDujia=!1})},dealAdditionTip:function(a){var b=this,c=a.duration||0,d=parseInt((c-b.context.dataset.duration)/60),e='<svg class="txp_alert_img" xmlns="http://www.w3.org/2000/svg" width="78" height="64" viewBox="0 0 78 64"><defs><linearGradient id="a" x1="2.35072545%" x2="97.4004585%" y1="26.1783854%" y2="26.1783868%"><stop offset="0%" stop-color="#FF6429"/><stop offset="100%" stop-color="#F6953E"/></linearGradient></defs><g fill="none" fill-rule="evenodd"><g fill-rule="nonzero"><path fill="#F7A741" d="M42.4245008 6.6705c.131 1.189 3.367 7.386 4.917 7.94 0 0 .727-.944.7925-1.6775l.0005.001c.198-.956.2825-2.4535-.1735-4.1175-.191-.696-.7235-1.103-.7235-1.103-1.7435-1.746-3.295-2.0525-3.295-2.0525.007.0245.0165.0495.024.0745-.499-.0045-1.637.078-1.542.935z"/><path fill="#FEE3D7" d="M46.404 24.7265s-3.038 12.2955-3.619 10.059c0 0-2.935 3.1645-5.5445 4.004-2.609.839-9.5575 1.595-12.5065.3385-2.9485-1.256-8.362-3.11-9.86-6.117 0 0-1.272.3365-2.6935-1.7625 1.414 1.1025-3.5215-3.4785-.1285-4.807l1.259 1.783s-2.13-6.8165-.954-10.011c0 0 7.692-13.2145 19.6405-12.671 0 0 17.19599995 4.29 14.4065 19.184z"/><path fill="#884C43" d="M38.9999994 13.123s-.669 7.598-19.3375 6.629c-.657-.7185.7105-3.2515 1.848-6.629 0 0-3.892 3.6375-5.544 11.3805-1.253 5.874 2.7485 9.355 5.5485 12.309l-1.045 2.994c-2.1675-.453-5.9065-3.61-5.9755-.5575-.0695 3.053-4.881 1.831-8.1825-1.6545 0 0-7.817-3.132-6.052-12.192 2.179-11.187 13.0295-22.6335 20.3265-24.6475 2.4375-.673 13.331-2.424 19.398 3.7935-1.808-1.8525 11.68849998 7.179 12.01549998 22.7605.2345 11.1885-7.0345 11.9245-8.4595 11.9465-2.72299998.0415-.3695-1.6605-4.90899998-.3915 0 0-7.16 1.2405.4335-4.887 6.41899998-5.1795 3.64549998-14.7095-.065-20.854z"/><path fill="#3ABA6B" d="M14.83999976 2.1595s1.424.61 1.2785 2.25c-.146 1.64-5.59499996 13.199-7.55899996 15.332 0 0-.5385 1.4275-3.0935-1.9515l9.37399996-15.6305z"/><path fill="#68E6A4" d="M13.43799917 1.748s2.548-.312 1.417 2.1075c0 0-5.1385 11.3505-7.71199997 13.7785 0 0-.863 1.1365-1.959-.124-1.0965-1.2605-3.673-7.871-2.743-9.8695.93-1.9985 4.3255-3.608 10.99699997-5.8925z"/><path fill="#FC9542" d="M15.1465007 5.6235s2.1425.159 2.4545 1.8715c.312 1.713-2.2975 9.4055-4.9445 10.362 0 0-2.6215-.5545-3.15-1.4415-.529-.887 5.64-10.792 5.64-10.792z"/><path fill="#F7A741" d="M15.14899947 5.549s-4.1655-.194-8.08849997 2.616c0 0-1.4355.6505-1.241 1.9895.4505 3.111 2.511 5.464 3.833 6.609 0 0 5.37299997-5.644 5.49649997-11.2145z"/><path fill="#F6B1A3" d="M17.594 29.078h2.75c1.0355 0 1.875-.8395 1.875-1.875 0-1.0355-.8395-1.875-1.875-1.875h-2.75c-1.036 0-1.875.8395-1.875 1.875 0 1.0355.839 1.875 1.875 1.875zm20.437 0h2.75c1.036 0 1.875-.8395 1.875-1.875 0-1.0355-.839-1.875-1.875-1.875h-2.75c-1.0355 0-1.875.8395-1.875 1.875 0 1.0355.8395 1.875 1.875 1.875z"/><path fill="#ED735B" d="M28.25 25.9845c-.1555.456-.25.9605-.25 1.5 0 1.933 1.1195 3.5 2.5 3.5s2.5-1.567 2.5-3.5c0-.5395-.0945-1.044-.25-1.5h-4.5z"/><path fill="#563C3B" d="M37 26.9845c1.1045 0 2-1.3435 2-3 0-1.657-.8955-3-2-3s-2 1.343-2 3c0 1.6565.8955 3 2 3zm-17.4840898-.9732736c.847-.113.8905-1.807 3.1255-2.0155 2.235-.209 2.207 2.04 3.045 1.266 1.28-1.1815-1.568-4.0985-4.1245-3.031-2.537 1.059-3.115 3.923-2.046 3.7805z"/></g><path fill="#FEE3D7" d="M49.7385176 22.25932683c1.27869925.0888412 2.38833683 1.09477949 2.2614824 3.74067336 1.00990039 1.98204108 4.35228745 8.37571337 4 9.99999997-.27983373 1.29022506-1.36322008 2.719475-5.00000006 3.00000006-.81021064.0624961-3.91448611 1.24308203-5 .99999996-1.886809-.42251816-1.73352652-2.47701646-1.99999992-2.99999995-.08227506-.1614739-.87704522-1.41743542.99999993-1.8599346 1.42146503-.33509971 5.64713936.12453104 5.59203223-1e-8-1.4782699-3.34059352-1.93627422-6.91777573-3.59203225-8.14006541-.42951148-.13955674-.85021187-1.49183833-.5422386-2.6546347l-1.5458273-1.71681524c-.3695507-.41042751-.33641342-1.0427248.07401414-1.41227542.41042755-.36955062 1.04272484-.33641334 1.41227546.07401422l1.33716578 1.485073c.0201374-.0117248.04039292-.02328804.06076096-.03468616l-.41476831-1.95133108c-.11482638-.54021604.23001993-1.07123286.77023593-1.18605932.540216-.11482647 1.07123285.23001993 1.18605932.77023592l.4008403 1.8858054z"/><path fill="#FFF" d="M38 35c.9333828 0 9.6023203-.5357031 11-1 .0665032-.0220918.3998366 2.6445749 1 8-4 2-7 3.3333333-9 4s-3-.3333333-3-3c-.6666667-5.3333333-.6666667-8 0-8z"/><path fill="url(#a)" d="M37 12h6v10h-9v2h5v6H4c-2.209139 0-4-1.790861-4-4V4c0-2.209139 1.790861-4 4-4h33v12zm3-12h8v8h-8V0zm5 22h6v5h-6v-5zm5-17h6v5h-6V5zm10-2h4v3h-4V3zm0 22h4v3h-4v-3zm6-12h3v2h-3v-2zm-14 2h5v4h-5v-4z" transform="translate(9 34)"/><path fill="#FFF" d="M26.5978254 47.4222938l5.1705843 3.8560439c.442726.3301698.5339708.9567257.203801 1.3994517a1.00000198 1.00000198 0 0 1-.203801.203801l-5.1705843 3.8560439c-.442726.3301699-1.0692819.2389251-1.3994518-.2038009C25.0695774 56.3611299 25 56.1514493 25 55.936008v-7.7120879c0-.5522847.4477153-1 1-1 .2154413 0 .4251219.0695774.5978254.1983737zM16 36h5l-3 6h-5l3-6zm10 0h5l-3 6h-5l3-6zm10 0h5l-3 6h-5l3-6z" opacity=".8"/><path fill="#FEE3D7" d="M9.11524516 42C4.2635276 49.38521401 2.89177921 54.385214 5 57c3.16233118 3.922179 5.2171776 6.922179 7 3 1.2973769-2.8542071-2.88475484-4.92607-2.88475484-4.92607V42z"/><path fill="#FFF" d="M9 53l-7-3c1.86666667-6 4.2-9 7-9v12z"/></g></svg>',f="";if("end"==a.type)f=g.tpl(e+'\u53ee\u549a\uff01\u4f60\u6709\u4e00\u4e2a"\u8fdb\u5ea6\u6761\u52a0\u957f\u5305"\u5c1a\u672a\u4f7f\u7528\uff0c<a href="javascript:;" data-action="refresh" data-role="txp-ui-tips-refresh">\u3010\u70b9\u6b64\u67e5\u6536\u3011</a>',{addition:d});else{if(d<=0)return;f=g.tpl(e+'\u89c6\u9891\u8ffd\u52a0${addition}\u5206\u949f\u65b0\u5185\u5bb9\uff0c<a href="javascript:;" data-action="refresh" data-role="txp-ui-tips-refresh">\u5237\u65b0</a>\u770b\u65b0\u5185\u5bb9',{addition:d})}b.context.msg.broadcast("showUiTips",{text:'<span class="txp_alert_info_complete">'+f+"</span>",time:10,hideClose:!1})},dealSeekTip:function(a){var b,c=this;a&&a.showTips?"undefined"==typeof Txplayer.plugins["txp-history-plugin"]&&(b="<a>"+g.formatPlayTime(a.seekTime)+"</a>",c.context.msg.broadcast("showUiTips",{text:"\u60a8\u4e0a\u6b21\u89c2\u770b\u81f3 "+b+" \u5904\uff0c\u6b63\u5728\u4e3a\u60a8\u7eed\u64ad",time:3,hideClose:!0})):a.connectionPlayTime?"undefined"==typeof Txplayer.plugins["txp-history-plugin"]&&(b="<a>"+g.formatPlayTime(a.connectionPlayTime)+"</a>",c.context.msg.broadcast("showUiTips",{text:"\u60a8\u4e0a\u6b21\u89c2\u770b\u81f3 "+b+" \u5904\uff0c\u6b63\u5728\u4e3a\u60a8\u7eed\u64ad",time:3,hideClose:!0})):a.playStartTime?c.dataset.hasShowTips||(b="<a>"+g.formatPlayTime(a.playStartTime)+"</a>",c.context.msg.broadcast("showUiTips",{text:"\u817e\u8baf\u89c6\u9891\u5df2\u4e3a\u60a8\u8df3\u8fc7\u7247\u5934",time:3,hideClose:!0})):a.historyTime?"undefined"==typeof Txplayer.plugins["txp-history-plugin"]&&c.context.msg.broadcast("showUiTips",{text:"\u60a8\u4e0a\u6b21\u89c2\u770b\u81f3 "+a.historyTime+" \u5904\uff0c\u6b63\u5728\u4e3a\u60a8\u7eed\u64ad",time:5}):a.uiText&&(c.context.msg.broadcast("showUiTips",{text:a.uiText,time:a.time,hideClose:a.hideClose}),c.dataset.hasShowTips=!0)},dealDenitionTip:function(){var a=this;this.dataset.eventsList[g.getUniqueMsgKey("setDefinitionStart")]=function(b,c){if(c)return void a.context.msg.broadcast("showUiTips",{text:"\u6b63\u5728\u7f13\u51b2...",time:3,hideClose:!0});var d=h[b];d&&(d="<a>["+d+"]</a>",a.context.msg.broadcast("showUiTips",{text:"\u6b63\u5728\u4e3a\u60a8\u5207\u6362\u6e05\u6670\u5ea6"+d,time:10}))},this.dataset.eventsList[g.getUniqueMsgKey("setDefinitionDone")]=function(b){a.context.msg.broadcast("hideUiTips")},this.dataset.eventsList[g.getUniqueMsgKey("setDefinitionFail")]=function(b){a.context.msg.broadcast("showUiTips",{text:"sorry, \u5207\u6362\u6e05\u6670\u5ea6\u5931\u8d25, \u8bf7\u7a0d\u540e\u91cd\u8bd5",time:5})}},dealPlaybackRateTip:function(a){if(!this.context.dataset.isPlayingAd){if(a>=4)return void this.context.msg.broadcast("showUiTips",{text:"\u64ad\u653e\u901f\u5ea6\u5df2\u7ecf\u8fbe\u5230\u6700\u9ad8\u503c",time:3,hideClose:!0});if(a<=.4)return void this.context.msg.broadcast("showUiTips",{text:"\u64ad\u653e\u901f\u5ea6\u5df2\u7ecf\u8fbe\u5230\u6700\u4f4e\u503c",time:3,hideClose:!0});a=1.25==a?a:a.toFixed(1),this.context.msg.broadcast("showUiTips",{text:"\u6b63\u5728<a>"+a+"</a>\u500d\u901f\u5ea6\u64ad\u653e",time:3,hideClose:!0})}},dealVolumeTip:function(a){a.mute===!0?this.context.msg.broadcast("showUiTips",{text:"\u89c6\u9891\u9759\u97f3",time:2,hideClose:!0}):a.mute===!1?this.context.msg.broadcast("showUiTips",{text:"\u53d6\u6d88\u89c6\u9891\u9759\u97f3",time:2,hideClose:!0}):a.volume>=0&&this.context.msg.broadcast("showUiTips",{text:"\u5f53\u524d\u97f3\u91cf: <a>"+a.volume+"</a>",time:3,hideClose:!0})},dealConsoleReportTip:function(a){this.context.msg.broadcast("showUiTips",{text:"\u60a8\u7684\u53cd\u9988\u6211\u4eec\u5df2\u6536\u5230\uff0c\u611f\u8c22\u60a8\u7684\u652f\u6301~",time:5,hideClose:!0})},showVIPShareTips:function(){var a="//vip.video.qq.com/fcgi-bin/comm_cgi?callback=?",b=f.jsonp||f.ajax,c=this,d=function(a){var b="\u8be5\u8d26\u53f7\u591a\u5730\u767b\u5f55\u5b58\u5728\u5b89\u5168\u9690\u60a3\uff0c\u5df2\u6682\u505c\u4f1a\u5458\u670d\u52a1\uff0c\u8bf7\u4fee\u6539\u5bc6\u7801\u5e76\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\u540e\u91cd\u8bd5\u3002";a=a||{},a.tips=a.tips||b;var d=0;c.context.dataset.openAccountData=[],a.buttonlist&&"array"===f.type(a.buttonlist)&&f.each(a.buttonlist,function(b,e){e&&(e.title&&e.url&&(a.tips+='&nbsp;<a href="javascript:;" data-action="shareVIP" data-click="'+d+'">'+e.title+"</a>&nbsp;",c.context.dataset.openAccountData.push(e)),d++)}),c.context.msg.broadcast("showUiTips",{text:a.tips,time:3e4})};b({url:a,data:{name:"attack_account",cmd:1},timeout:6e3,callback:Txplayer.util.getJsonpCallbackName("getshareviptips")}).done(function(a){d(a)}).fail(function(a,b){d()})},showUnOfficialLimitTips:function(a){if(!this.context.dataset.isUiTipsShowing){var b='\u53ef\u8bd5\u770b${min}\u5206\u949f\uff0c\u53bb\u817e\u8baf\u89c6\u9891\u89c2\u770b\u5b8c\u6574\u7248 <a target="_blank;" href="${href}">\u7acb\u5373\u524d\u5f80</a>';a.sec>0&&(b='\u53ef\u8bd5\u770b${min}\u5206\u949f${sec}\u79d2\uff0c\u53bb\u817e\u8baf\u89c6\u9891\u89c2\u770b\u5b8c\u6574\u7248 <a target="_blank;" href="${href}">\u7acb\u5373\u524d\u5f80</a>'),a.min<=0&&a.sec>0&&(b='\u53ef\u8bd5\u770b${sec}\u79d2\uff0c\u53bb\u817e\u8baf\u89c6\u9891\u89c2\u770b\u5b8c\u6574\u7248 <a target="_blank;" href="${href}">\u7acb\u5373\u524d\u5f80</a>'),this.context.msg.broadcast("showUiTips",{text:g.tpl(b,a),time:9999,hideClose:!0})}},addEventListener:function(){var a=this;this.dataset.$close.on("click",function(){a.context.msg.broadcast("hideUiTips",{userAction:!0,tips:a.dataset.$text.html()})}),this.dataset.eventsList={},this.dealDenitionTip(),this.dataset.eventsList[g.getUniqueMsgKey("vidChange")]=function(){a.stopTips(),a.dataset.hasShowTips=!1},this.dataset.eventsList[g.getUniqueMsgKey("error")]=function(b){a.stopTips(),b&&94==b.code&&a.showVIPShareTips()},f.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)}),a.context.msg.on("showUIVipGuide",function(b){a.stopTips()}),a.context.msg.on(g.getUniqueMsgKey("showDujiaDialog"),function(){a.stopTips()}),a.context.msg.on(g.getUniqueMsgKey("adblockCannotSetDef"),function(b){a.context.msg.broadcast("showUiTips",{text:'\u89c6\u9891\u6e05\u6670\u5ea6\u88ab\u8bef\u4f24\u4e86\uff0c\u6b63\u5e38\u89c2\u770b\u9700<a target="_blank;" href="javascript:;">\u5173\u95ed\u5e7f\u544a\u62e6\u622a\u63d2\u4ef6</a>',time:5,hideClose:!0})})},exportsModuleApis:function(){var a=this;this.dataset.moduleApis={},this.dataset.moduleApis.showUiTips=function(b){b&&b.text&&(a.context.dataset.isSmallWindowMode||(b.time=b.time||4,"undefined"===f.type(b.hideClose)&&(b.hideClose=!1),b.hideClose?a.dataset.$close.addClass(Txplayer.dataset.hideClass):a.dataset.$close.removeClass(Txplayer.dataset.hideClass),a.dataset.$tips.removeClass(Txplayer.dataset.hideClass),a.dataset.$text.html(b.text),a.context.dataset.isUiTipsShowing=!a.dataset.$tips.hasClass(Txplayer.dataset.hideClass),a.dataset.hide_TIMER&&clearTimeout(a.dataset.hide_TIMER),a.dataset.hide_TIMER=setTimeout(function(){a.context.msg.broadcast("hideUiTips")},1e3*b.time)))},this.dataset.moduleApis.hideUiTips=function(b){a.dataset.$tips.addClass(Txplayer.dataset.hideClass),a.context.dataset.isUiTipsShowing=!a.dataset.$tips.hasClass(Txplayer.dataset.hideClass)},this.dataset.moduleApis.showUIVipTip=function(b){a.dealVipTip(b)},this.dataset.moduleApis.showUIDujiaTip=function(b){a.dealDujiaTip(b)},this.dataset.moduleApis.showAdditionTip=function(b){a.dealAdditionTip(b)},this.dataset.moduleApis.showUiSeekTip=function(b){a.dealSeekTip(b)},this.dataset.moduleApis.showUiRateTip=function(b){a.dealPlaybackRateTip(b)},this.dataset.moduleApis.showUiPlaybackRateTip=function(b){a.dealPlaybackRateTip(b)},this.dataset.moduleApis.showUiVolumeTip=function(b){a.dealVolumeTip(b)},this.dataset.moduleApis.showConsoleReportTips=function(b){a.dealConsoleReportTip(b)},this.dataset.moduleApis.showUnOfficialLimitTips=function(b){a.showUnOfficialLimitTips(b)},f.each(this.dataset.moduleApis,function(b,c){a.context.msg.on(b,c)})}},Txplayer.register("UiTips",d)},246:function(a,b){a.exports='<txpdiv data-role="<%=tips%>" class="txp_alert_info <%=hide%>">\n  <txpdiv class="txp_alert_content">\n    <txpdiv data-role="<%=text%>" class="txp_alert_text"></txpdiv>\n    <button data-role="<%=close%>" class="txp_btn txp_btn_close" title="\u5173\u95ed"></button>\n  </txpdiv>\n</txpdiv>'}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(169)},169:function(a,b,c){function d(a){f=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=c(170),f=Txplayer.$,g=Txplayer.util;d.prototype={init:function(){this.dataset.controlHideClass="txp_autohide",this.context.dataset.isControlShow=!0,this.write(),this.addEventListener(),this.loadSubPlugins()},write:function(){var a={controlWrap:"txp-control-wrap",buttonsLeftRole:"txp-control-left",buttonsRightRole:"txp-control-right",buttonsCenterRole:"txp-control-center",hide:Txplayer.dataset.hideClass,autoHide:this.dataset.controlHideClass},b=f.tmpl(e,a);this.context.dataset.$playermod.append(b),this.dataset.$playermod=this.context.dataset.$playermod,this.dataset.$controlWrap=this.context.dataset.$playermod.find('[data-role="'+a.controlWrap+'"]'),this.dataset.$buttonsleftmod=this.context.dataset.$playermod.find('[data-role="'+a.buttonsLeftRole+'"]'),this.dataset.$buttonsrightmod=this.context.dataset.$playermod.find('[data-role="'+a.buttonsRightRole+'"]'),this.dataset.$buttonscentermod=this.context.dataset.$playermod.find('[data-role="'+a.buttonsCenterRole+'"]'),(this.context.config.autoplay||g.mobile)&&(this.context.dataset.$playermod.addClass(this.dataset.controlHideClass),this.uiControlVisibilityChange(!1),this.context.dataset.isControlShow=!1)},remove:function(){this.dataset.$controlWrap.remove()},loadSubPlugins:function(){var a=[];if(this.context.pluginConfig&&"array"===f.type(this.context.pluginConfig.subPlugins)&&(a=this.context.pluginConfig.subPlugins.slice(0)),!g.mobile&&"v4"==this.context.config.version)for(var b=0;b<a.length;b++)if(["UiControlPlay","UiVolume","UiDefinition"].indexOf(a[b])!=-1){if(g.inArray(this.context.config.removePluginsList,a[b])!=-1)continue;a[b]="v4"+a[b]}var c={msg:this.context.msg,adApi:this.context.adApi,userMsg:this.context.userMsg,userApi:this.context.userApi,privateApi:this.context.privateApi,dataset:this.context.dataset,config:this.context.config,$mod:{$playermod:this.dataset.$playermod,$progressmod:this.dataset.$buttonscentermod,$buttonsleftmod:this.dataset.$buttonsleftmod,$buttonsrightmod:this.dataset.$buttonsrightmod}};g.loadPlugins.call(this,a,c,this.context.config.settings)},handlerUiControlShowHide:function(){function a(a){h.context.msg.on("ready",function(){h.context.dataset.$shadow.on("touchend",function(e){c()?b():d(),a&&e.preventDefault()})})}function b(a){if(a=a||{},a&&!a.force){if(1!==h.context.dataset.playState&&!h.context.dataset.isPlayingAd)return;if(h.context.dataset.isSmallWindowMode)return;if(h.context.dataset.isFocusVideoBufferIng)return;if(h.context.dataset.isVideoSeeking)return;if(h.dataset.isMouseHoverControl)return;if(h.context.dataset.isRightClickMenu)return;if(h.context.dataset.disableHideControl)return}h.context.dataset.$playermod.addClass(h.dataset.controlHideClass),h.uiControlVisibilityChange(!1),h.context.msg.broadcast("hideUiControl"),h.context.dataset.isControlShow=!1,h.dataset.hideControl_TIMER&&(clearTimeout(h.dataset.hideControl_TIMER),h.dataset.hideControl_TIMER=null)}function c(){return!h.context.dataset.$playermod.hasClass(h.dataset.controlHideClass)}function d(a){if(a=a||{},a&&!a.force){if(h.context.dataset.isSmallWindowMode)return;if(h.dataset.errorcode)return}h.context.msg.broadcast("beforeUiControlShow"),h.context.dataset.$playermod.removeClass(h.dataset.controlHideClass),h.uiControlVisibilityChange(!0),h.context.dataset.isControlShow=!0,e()}function e(){h.dataset.hideControl_TIMER&&(clearTimeout(h.dataset.hideControl_TIMER),h.dataset.hideControl_TIMER=null),h.dataset.hideControl_TIMER=setTimeout(function(){b()},3e3)}var h=this;this.dataset.hideControl_TIMER=null,g.mobile?a(!1):(a(!0),this.dataset.$playermod.on("click mouseenter",function(a){d(a)}),this.dataset.$playermod.on("mouseleave",function(a){b(a)}),this.dataset.$playermod.on("mousemove",function(a){h.dataset.screenX==a.screenX&&h.dataset.screenY==a.screenY||(h.dataset.screenX=a.screenX,h.dataset.screenY=a.screenY,d(a))})),this.dataset.eventsList[g.getUniqueMsgKey("videoPause")]=function(a){a&&a.end||h.context.dataset.isPlayingAd||d()},this.dataset.eventsList[g.getUniqueMsgKey("videoEnd")]=function(a){a&&a.isAllEnd&&d()},this.dataset.eventsList[g.getUniqueMsgKey("error")]=function(a){a&&94==a.code||(b({force:!0}),h.dataset.errorcode=a.code)},this.dataset.eventsList[g.getUniqueMsgKey("videoPlaying")]=function(){delete h.dataset.errorcode,e()},this.dataset.eventsList[g.getUniqueMsgKey("smallWindowModeChange")]=function(a){a&&a.isSmallWindow&&b({force:!0})},this.dataset.eventsList[g.getUniqueMsgKey("hideUicontrol")]=function(a){b()},f.each(this.dataset.eventsList,function(a,b){h.context.msg.on(a,b)}),this.show=d,this.hide=b},uiControlVisibilityChange:function(a){try{a!==this.dataset.uiControlVisibilityChangeState&&(this.dataset.uiControlVisibilityChangeState=a,this.context.msg.broadcast("uiControlVisibilityChange",a),this.context.userMsg.broadcast("uiControlVisibilityChange",a))}catch(b){}},addEventListener:function(){var a=this;this.dataset.eventsList={},this.handlerUiControlShowHide(),this.dataset.eventsList[g.getUniqueMsgKey("userStopVideo")]=function(b){a.show()},this.dataset.eventsList[g.getUniqueMsgKey("showUicontrol")]=function(b){a.context.dataset.isSmallWindowMode||(a.context.dataset.$playermod.removeClass(a.dataset.controlHideClass),a.uiControlVisibilityChange(!0),a.context.dataset.isControlShow=!0)},this.dataset.eventsList[g.getUniqueMsgKey("videoEnd")]=function(b){if(b&&b.isAllEnd){if(a.context.dataset.isSmallWindowMode)return;a.context.dataset.$playermod.removeClass(a.dataset.controlHideClass),a.uiControlVisibilityChange(!0),a.context.dataset.isControlShow=!0}},this.dataset.$controlWrap.on("mouseenter",function(){a.dataset.isMouseHoverControl=!0}).on("mouseleave",function(){a.dataset.isMouseHoverControl=!1}),this.dataset.eventsList[g.getUniqueMsgKey("windowFullscreenChange")]=function(b){a.dataset.isMouseHoverControl=!1,setTimeout(function(){a.dataset.isMouseHoverControl=!1,a.hide({force:!0})},1e3)},this.dataset.eventsList[g.getUniqueMsgKey("browserFullscreenChange")]=function(b){a.dataset.isMouseHoverControl=!1,setTimeout(function(){a.dataset.isMouseHoverControl=!1,a.hide({force:!0})},200)},f.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)})}},Txplayer.register("UiControl",d)},170:function(a,b){a.exports='<txpdiv data-role="<%=controlWrap%>" class="txp_bottom" style="overflow:initial;">\n  <txpdiv class="txp_controls">\n    <txpdiv class="txp_left_controls" data-role="<%=buttonsLeftRole%>"></txpdiv>\n    <txpdiv class="txp_progress_bar_container" data-role="<%=buttonsCenterRole%>"></txpdiv>\n    <txpdiv class="txp_right_controls" data-role="<%=buttonsRightRole%>"></txpdiv>\n  </txpdiv>\n</txpdiv>'}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(227)},227:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=(Txplayer.apiList,c(228));d.prototype={init:function(){this.write(),this.addEventListerner()},write:function(){var a={loadedProgress:"txp-control-load-progress",playedProgress:"txp-control-play-progress",playStartTimePoint:"txp-control-play-start-time-point",playEndTimePoint:"txp-control-play-end-time-point",playedPoint:"txp-control-play-point",progressList:"txp-control-progress-list",progressIndicator:"txp-control-progress-indicator",tabindex:Txplayer.dataset.tabindex++,hideClass:Txplayer.dataset.hideClass};this.dataset.renderData=a;var b=e.tmpl(g,a);this.context.$mod.$progressmod.append(b),this.dataset.$loadedProgress=this.context.$mod.$progressmod.find('[data-role="'+a.loadedProgress+'"]'),this.dataset.$playprogress=this.context.$mod.$progressmod.find('[data-role="'+a.playedProgress+'"]'),this.dataset.$playStartTimePoint=this.context.$mod.$progressmod.find('[data-role="'+a.playStartTimePoint+'"]'),this.dataset.$playEndTimePoint=this.context.$mod.$progressmod.find('[data-role="'+a.playEndTimePoint+'"]'),this.dataset.$playpoint=this.context.$mod.$progressmod.find('[data-role="'+a.playedPoint+'"]'),this.dataset.$progressIndicator=this.context.$mod.$progressmod.find('[data-role="'+a.progressIndicator+'"]'),this.dataset.$progressList=this.context.$mod.$progressmod.find('[data-role="'+a.progressList+'"]')},remove:function(){this.dataset.$loadedProgress.remove(),this.dataset.$playprogress.remove(),this.dataset.$playpoint.remove(),this.dataset.$playStartTimePoint.remove(),this.dataset.$playEndTimePoint.remove(),this.dataset.$progressIndicator.remove(),this.dataset.$progressList.remove()},isInProgressArea:function(a){var b=this;if(1!=a.which)return!1;var c=e(a.target),d=c.data("role");return f.inArray([b.dataset.renderData.progressList,b.dataset.renderData.progressIndicator,b.dataset.renderData.playedPoint,b.dataset.renderData.playedProgress,b.dataset.renderData.loadedProgress,"txp-control-progress","txp-control-center"],d)>-1||c.hasClass("txp_interact_dot")||c.hasClass("txp_progress_role")},progressOnMouseMove:function(){var a,b,c,d=!1,f=this,g=-1,h=!1,i=function(b){var d=f.dataset.$progressList.parent(),e=d&&d[0]&&d[0].offsetLeft||0;g=b.pageX-f.context.$mod.$playermod.offset().left-e,g!==-1&&(g>a?g=a:g<0&&(g=0),c=parseInt(g/a*1e4)/100)},j=function(b){var c=parseInt(g/a*1e4)/100;0===g?0:parseInt(g/a*1e4)/100;f.updateProgressWidth(c+"%"),"mousedown"==b&&f.context.msg.broadcast("userSeekStart",{time:parseInt(f.context.dataset.duration*c/100)}),"mouseup"==b&&f.context.msg.broadcast("userSeekEnd",{time:parseInt(f.context.dataset.duration*c/100)})};this.context.$mod.$progressmod.on("mouseenter",function(){a=f.dataset.$progressList.width(),b=f.dataset.$progressIndicator.width();var c=f.dataset.$playStartTimePoint,d=f.dataset.$playEndTimePoint;f.context.dataset.skipPrelude?(f.context.dataset.playStartTime&&c.show(),f.context.dataset.playEndTime&&d.show()):(c.hide(),d.hide())}).on("mouseleave",function(){f.dataset.$playStartTimePoint.hide(),f.dataset.$playEndTimePoint.hide()});var k=f.context.dataset.$playermod&&f.context.dataset.$playermod.attr("id"),l="";e("body").on("mousedown",function(a){f.context.dataset.isPlayingAd||f.isVideoCanNotPlay()||f.context.dataset.isImgAdLoadingShowing||f.isInProgressArea(a)&&(f.context.dataset.isDisableProgress||(Object.keys&&Object.keys(Txplayer.dataset._instance).length>1&&(l=e(a.target).parents(".txp_player").attr("id")),k&&l&&l!==k||(h=!0,d=!0,f.context.dataset.isVideoSeeking=!0,f.context.msg.broadcast("pause"),i(a),j("mousedown"))))}).on("mousemove",function(a){f.context.dataset.isPlayingAd||f.context.dataset.isImgAdLoadingShowing||f.isVideoCanNotPlay()||k&&l&&l!==k||(i(a),h&&d&&j())}).on("mouseup",function(b){if(!f.context.dataset.duration)return void(h=!1);if(!f.context.dataset.isPlayingAd&&!f.context.dataset.isImgAdLoadingShowing&&h&&(!k||!l||l===k)){l="";f.context.dataset.playState;i(b);var c=parseInt(f.context.dataset.duration*(g/a));j("mouseup"),f.context.msg.broadcast("seekTo",c),d=!1,h=!1}})},isVideoCanNotPlay:function(){var a=this.context.dataset.playState;return 0===a||a===-1},progressOnTouch:function(){var a,b,c,d,e=this,f=function(a){var f=parseInt(b/c*1e4)/100,g=parseInt((b-d/2)/c*1e4)/100;e.updateProgressWidth(g+"%"),e.context.msg.broadcast("progressUpdate",f),"touchstart"==a&&e.context.msg.broadcast("userSeekStart",{time:parseInt(e.context.dataset.duration*f/100)}),"touchend"==a&&e.context.msg.broadcast("userSeekEnd",{time:parseInt(e.context.dataset.duration*f/100)})};this.context.$mod.$progressmod.on("touchstart",function(g){e.context.dataset.isPlayingAd||(g=g.originalEvent?g.originalEvent:g,g&&g.touches&&g.touches.length&&(g=g.touches[0],a=e.dataset.$progressList.offset().left,b=g.pageX-a,c=e.dataset.$progressList.width(),d=e.dataset.$progressIndicator.width(),f("touchstart"),e.context.dataset.isControlTouch=!0,e.context.msg.broadcast("pause")))}).on("touchmove",function(c){e.context.dataset.isPlayingAd||(c=c.originalEvent?c.originalEvent:c,c&&c.touches&&c.touches.length&&(c.preventDefault(),c=c.touches[0],b=c.pageX-a,b>e.dataset.$progressList.width()?b=e.dataset.$progressList.width():b<0&&(b=0),f(),e.context.dataset.isControlTouch=!0))}).on("touchend",function(a){if(!e.context.dataset.isPlayingAd){var d=parseInt(e.context.dataset.duration*(b/c));d>=e.context.dataset.duration&&(d=e.context.dataset.duration-1),f("touchend"),e.context.dataset.isControlTouch=!1,e.context.msg.broadcast("seekTo",d)}})},getCanplayTimeLimit:function(){var a;return"number"==e.type(this.context.dataset.canPlayTime)&&this.context.dataset.duration&&(a=this.context.dataset.canPlayTime/this.context.dataset.duration,a=100*a),a},updateBufferedBar:function(a){if(this.context.dataset.duration&&"number"===e.type(a)){var b=parseInt(100*a/this.context.dataset.duration);b>=99&&(b=100),this.dataset.$loadedProgress.css({width:b+"%"})}},updateProgressWidth:function(a){var b=this.getCanplayTimeLimit();b&&(a=parseFloat((a+"").replace("%","")),a>b&&(a=b),a+="%"),this.dataset.$playprogress.css("width",a),this.dataset.$playpoint.css("left",a)},updateSkipPrelude:function(){var a=this.context.dataset,b=this.dataset.$playStartTimePoint,c=this.dataset.$playEndTimePoint,d=a.playStartTime?+a.playStartTime:0,e=a.playEndTime?+a.playEndTime:0,f=this.context.dataset.duration||0;d?b.css("left",d/f*100+"%").removeClass(Txplayer.dataset.hideClass):b.addClass(Txplayer.dataset.hideClass),e?c.css("left",e/f*100+"%").removeClass(Txplayer.dataset.hideClass):c.addClass(Txplayer.dataset.hideClass)},addEventListerner:function(){var a=this;this.dataset.eventsList={},a.context.dataset.duration?a.updateSkipPrelude():this.dataset.eventsList[f.getUniqueMsgKey("getVideoUrlSuccess")]=function(){a.context.config.playEndTime&&(a.context.dataset.playEndTime=parseInt(a.context.dataset.duration)-parseInt(a.context.config.playEndTime),a.context.dataset.playEndTime<0&&(a.context.dataset.playEndTime=null)),a.updateSkipPrelude()},this.dataset.eventsList[f.getUniqueMsgKey("seekStart")]=function(b){if(a.context.dataset.isControlShow&&!a.context.dataset.isPlayingAd&&a.context.dataset.duration){var c=b.seekTime/a.context.dataset.duration;c=100*c+"%",a.updateProgressWidth(c),b.currentTimeWhenSeekStart&&b.currentTimeWhenSeekStart>b.seekTime&&a.updateBufferedBar(b.seekTime)}},this.dataset.eventsList[f.getUniqueMsgKey("videoTimeUpdate")]=function(){if(!a.context.dataset.isPlayingAd&&a.context.dataset.duration&&!a.context.dataset.isVideoSeeking){var b=a.context.dataset.currentTime;if(a.context.dataset.isControlShow||b%5===0){var c=b/a.context.dataset.duration;c=100*c+"%",a.updateProgressWidth(c),a.updateBufferedBar(a.context.dataset.bufferedTime)}}},this.context.dataset.$playermod.on("mouseenter",function(){if(!a.context.dataset.isPlayingAd&&a.context.dataset.duration&&!a.context.dataset.isVideoSeeking&&0!=a.context.dataset.playState){var b=a.context.dataset.currentTime,c=b/a.context.dataset.duration;c=100*c+"%",a.updateProgressWidth(c),a.updateBufferedBar(a.context.dataset.bufferedTime)}}),this.dataset.eventsList[f.getUniqueMsgKey("videoProgress")]=function(){a.context.dataset.isControlShow&&1===a.context.dataset.playState&&a.updateBufferedBar(a.context.dataset.bufferedTime)},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(){a.updateBufferedBar(0),a.updateProgressWidth(0)},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(b){b&&"endingad"===b.playListType&&(a.context.dataset.bufferedTime=0,a.updateBufferedBar(0),a.updateProgressWidth(0))},this.dataset.eventsList[f.getUniqueMsgKey("videoEnd")]=function(b){b&&b.isAllEnd&&(a.updateBufferedBar(0),a.updateProgressWidth(0))},this.dataset.eventsList[f.getUniqueMsgKey("videoEnd")]=function(b){b&&b.isTheLastFilm&&(a.updateBufferedBar(0),a.updateProgressWidth(0))},this.dataset.eventsList[f.getUniqueMsgKey("beforeVideoPlay")]=function(b){a.updateBufferedBar(0),a.updateProgressWidth(0)},this.dataset.eventsList[f.getUniqueMsgKey("speedyTouchmove")]=function(b){100*b/a.context.dataset.duration+"%";a.updateProgressWidth()},this.dataset.eventsList[f.getUniqueMsgKey("userStopVideo")]=function(b){a.updateBufferedBar(0),a.updateProgressWidth(0)},this.dataset.eventsList[f.getUniqueMsgKey("disableProgress")]=function(b){a.context.dataset.isDisableProgress=!0},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(b){if(b&&"film"===b.playListType){if(a.context.dataset.isDuringZcCountdown)return;a.context.dataset.isDisableProgress=!1}},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)}),f.mobile?this.progressOnTouch():this.progressOnMouseMove()}},Txplayer.register("UiProgress",d)},228:function(a,b){a.exports='<txpdiv class="txp_progress_list" data-role="<%=progressList%>" style="background-color: transparent;">\n  <txpdiv class="txp_progress_load" style="width:0%" data-role="<%=loadedProgress%>"></txpdiv>\n  <txpdiv class="txp_progress_play" style="width:0%" data-role="<%=playedProgress%>"></txpdiv>\n  <txpdiv class="txp_interact_progress_list">\n    <txpdiv class="txp_interact_dot <%= hideClass %>" data-role="<%=playStartTimePoint%>"></txpdiv>\n    <txpdiv class="txp_interact_dot <%= hideClass %>" data-role="<%=playEndTimePoint%>"></txpdiv>\n  </txpdiv>\n</txpdiv>\n\n<txpdiv class="txp_btn_scrubber" style="left:0%" data-role="<%=playedPoint%>">\n  <txpdiv class="txp_scrubber_indicator" data-role="<%=progressIndicator%>" style="left:0;top:0;"></txpdiv>\n</txpdiv>'}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(296)},172:function(a,b){a.exports='<txpdiv data-role="<%=playBtn%>" class="txp_btn txp_btn_play" data-status="play" aria-label="\u64ad\u653e/\u6682\u505c">\n  <% if(isUseH5Type){ %>\n  <svg class="txp_icon txp_icon_play" viewBox="0 0 60 60" >\n\t<use class="txp_svg_play" xlink:href="<%=svgPrefix%>#txp_svg_play" />\n\t<use class="txp_svg_pause" xlink:href="<%=svgPrefix%>#txp_svg_pause" />\n\t<use class="txp_svg_stop" xlink:href="<%=svgPrefix%>#txp_svg_stop" />\n\t<use class="txp_svg_replay" xlink:href="<%=svgPrefix%>#txp_svg_replay" />\n  </svg>\n  <% }else{%>\n  <svg class="txp_icon txp_icon_play" version="1.1" viewBox="0 0 36 36">\n    <use class="txp_svg_symbol txp_svg_play" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="<%=svgPrefix%>#txp_svg_play"></use>\n    <use class="txp_svg_symbol txp_svg_pause" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="<%=svgPrefix%>#txp_svg_pause"></use>\n    <use class="txp_svg_symbol txp_svg_stop" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="<%=svgPrefix%>#txp_svg_stop"></use>\n    <use class="txp_svg_symbol txp_svg_replay" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="<%=svgPrefix%>#txp_svg_replay"></use>\n  </svg>\n  <txpdiv data-role="<%=tips%>" class="txp_tooltip">\u64ad\u653e</txpdiv>\n  <% } %>\n</txpdiv>'},296:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=c(172),h=c(297);d.prototype={init:function(){this.write(),this.addEventListener()},write:function(){var a={playBtn:"txp-ui-control-playbtn",tips:"txp-ui-control-playbtn-tips",isUseH5Type:f.isUseH5Type(),tabindex:Txplayer.dataset.tabindex++},b=e.tmpl(g,a);if(this.context.config.enableStopButton){var c={stopBtn:"txp-ui-control-stopbtn",tips:"txp-ui-control-stopbtn-tips"},d=e.tmpl(h,c);this.context.$mod.$buttonsleftmod.append(d),this.dataset.$stopbtn=this.context.$mod.$buttonsleftmod.find('[data-role="'+c.stopBtn+'"]')}this.context.$mod.$buttonsleftmod.append(b),this.dataset.$playbtn=this.context.$mod.$buttonsleftmod.find('[data-role="'+a.playBtn+'"]'),this.dataset.$tips=this.context.$mod.$buttonsleftmod.find('[data-role="'+a.tips+'"]')},remove:function(){this.dataset.$playbtn.remove()},initPlayState:function(){var a=this.context.dataset.playState;1===a||3===a?(this.dataset.$playbtn.attr("data-status","pause"),this.dataset.$tips.html("\u6682\u505c")):0===a?(this.dataset.$playbtn.attr("data-status","replay"),this.dataset.$tips.html("\u91cd\u65b0\u64ad\u653e")):(this.dataset.$playbtn.attr("data-status","play"),this.dataset.$tips.html("\u64ad\u653e"))},bindMouseEvent:function(){var a=this;this.dataset.$playbtn.on("mouseenter",function(){a.dataset.$playbtn.addClass(Txplayer.dataset.btnHoverClass)}).on("mouseleave",function(){a.dataset.$playbtn.removeClass(Txplayer.dataset.btnHoverClass)})},stopPauseTimer:function(){this.dataset.pauseTimer&&(clearTimeout(this.dataset.pauseTimer),this.dataset.pauseTimer=null)},addEventListener:function(){var a=this;this.initPlayState(),this.dataset.$stopbtn&&this.dataset.$stopbtn.on(Txplayer.dataset.clickEventName,function(){"function"==typeof a.context.userApi.stop&&(a.context.userApi.stop(),a.context.userMsg.broadcast("userClickStopBtn"))}),this.dataset.$playbtn.on(Txplayer.dataset.clickEventName,function(){var b=(e(this),a.context.dataset.isPlayingAd);if(!b){a.context.msg.broadcast("reportUsrAction",{usr_action:a.dataset.$playbtn.attr("data-status")});try{a.context.userMsg.broadcast("userClickPlayBtn")}catch(c){}"pause"===a.dataset.$playbtn.attr("data-status")?(a.context.msg.broadcast("pauseControl"),a.context.msg.broadcast("userPausePlayer"),a.context.userMsg.broadcast("pause")):"replay"===a.dataset.$playbtn.attr("data-status")?(a.context.dataset.connectionPlayTime=0,a.context.msg.broadcast("beforeVideoRePlay"),a.context.msg.broadcast("playControl",{vid:a.context.dataset.vid,connectionPlayType:1,playStartTime:a.context.dataset.playStartTime,playEndTime:a.context.dataset.playEndTime}),a.context.msg.broadcast("userPlayPlayer")):(a.context.msg.broadcast("playControl",{connectionPlayType:1}),a.context.msg.broadcast("userPlayPlayer"))}}),this.dataset.eventsList={},this.dataset.eventsList[f.getUniqueMsgKey("getVideoUrlSuccess")]=function(){a.dataset.isAllEnd=!1},this.dataset.eventsList[f.getUniqueMsgKey("videoPlay")]=function(){a.dataset.isAllEnd=!1,a.dataset.$playbtn.attr("data-status","pause"),a.dataset.$tips.html("\u6682\u505c")},this.dataset.eventsList[f.getUniqueMsgKey("videoPause")]=function(b){b&&"film"!=b.playListType||a.context.dataset.isDefinitionSwitching&&!a.context.dataset.useChromeHls||(a.stopPauseTimer(),a.dataset.pauseTimer=setTimeout(function(){if(!a.context.dataset.isDefinitionSwitching||a.context.dataset.useChromeHls){if(a.dataset.isAllEnd)return a.dataset.$playbtn.attr("data-status","replay"),a.dataset.$tips.html("\u91cd\u65b0\u64ad\u653e"),void a.context.msg.broadcast("hideLoading");if(2===a.context.dataset.playState){if(a.context.dataset.canPlayTime&&a.context.dataset.currentTime>=a.context.dataset.canPlayTime)return a.dataset.isAllEnd=!0,a.dataset.$playbtn.attr("data-status","replay"),a.dataset.$playbtn.removeClass("txp_disabled"),void a.dataset.$tips.html("\u91cd\u65b0\u64ad\u653e");a.dataset.$playbtn.attr("data-status","play"),a.dataset.$tips.html("\u64ad\u653e"),a.context.msg.broadcast("hideLoading")}}},200))},this.dataset.eventsList[f.getUniqueMsgKey("seekEnd")]=function(b){"h5"!=a.context.config.playerType&&2===a.context.dataset.playState&&(!a.context.dataset.canPlayTime||a.context.dataset.currentTime<a.context.dataset.canPlayTime)&&(a.dataset.$playbtn.attr("data-status","play"),a.dataset.$tips.html("\u64ad\u653e"))},this.dataset.eventsList[f.getUniqueMsgKey("showUIVipGuide")]=function(b){b&&b.trialFinish&&(f.v4log("v4UiControlPlay-\u91cd\u65b0\u64ad\u653e\u6309\u94ae"),a.dataset.$playbtn.attr("data-status","replay"),a.dataset.$playbtn.removeClass("txp_disabled"),a.dataset.$tips.html("\u91cd\u65b0\u64ad\u653e"))},this.dataset.eventsList[f.getUniqueMsgKey("showLoginGuide")]=function(b){a.dataset.$playbtn.attr("data-status","play"),a.dataset.$tips.html("\u64ad\u653e")},this.dataset.eventsList[f.getUniqueMsgKey("videoEnd")]=function(b){b&&b.isAllEnd&&(a.dataset.isAllEnd=!0,a.context.msg.broadcast("pause"),a.dataset.$playbtn.attr("data-status","replay"),a.dataset.$playbtn.removeClass("txp_disabled"),a.dataset.$tips.html("\u91cd\u65b0\u64ad\u653e"))},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(b){a.dataset.$playbtn.attr("data-status","play"),a.dataset.$tips.html("\u64ad\u653e")},this.dataset.eventsList[f.getUniqueMsgKey("beforeVideoPlay")]=function(b){a.dataset.isAllEnd=!1,a.dataset.$playbtn.attr("data-status","play"),a.dataset.$playbtn.addClass("txp_disabled")},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(b){a.dataset.$playbtn.attr("data-status","pause"),a.dataset.$tips.html("\u6682\u505c"),setTimeout(function(){if("film"!=a.context.dataset.currentPlayListType){if(a.dataset.$playbtn.hasClass("txp_disabled"))return;a.dataset.$playbtn.addClass("txp_disabled")}else{if(a.context.dataset.isDuringZcCountdown)return;a.dataset.$playbtn.removeClass("txp_disabled")}},100)},this.dataset.eventsList[f.getUniqueMsgKey("isPlayingAdStatusChange")]=function(b){if(f.v4log("isPlayingAdStatusChange-disablePlayBtn",{isPlayingAd:b}),b){if(a.dataset.$playbtn.attr("data-status","pause"),a.dataset.$tips.html("\u6682\u505c"),a.dataset.$playbtn.hasClass("txp_disabled"))return;a.dataset.$playbtn.addClass("txp_disabled")}else a.dataset.$playbtn.removeClass("txp_disabled")},this.dataset.eventsList[f.getUniqueMsgKey("userStopVideo")]=function(b){a.initPlayState(),a.dataset.$playbtn.removeClass("txp_disabled")},this.dataset.eventsList[f.getUniqueMsgKey("disablePlayBtn")]=function(b){a.dataset.$playbtn.addClass("txp_disabled")},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)}),f.mobile||this.bindMouseEvent()}},Txplayer.register("v4UiControlPlay",d)},297:function(a,b){a.exports='<txpdiv data-role="<%=stopBtn%>" class="txp_btn txp_btn_play" data-status="stop" aria-label="\u505c\u6b62">\n    <svg class="txp_icon txp_icon_play" version="1.1" viewBox="0 0 36 36">\n    <use class="txp_svg_symbol txp_svg_stop" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="<%=svgPrefix%>#txp_svg_stop"></use>\n  </svg>\n    <txpdiv data-role="<%=tips%>" class="txp_tooltip">\u505c\u6b62</txpdiv>\n</txpdiv>'}});
/*! Txplayer - v3.0.0 - 2020-02-08 10:23:43
 * Copyright (c) 2020
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(215)},215:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=c(216),h=c(217),i=c(218);Txplayer.apiList;d.prototype={init:function(){this.dataset.playerConfig=this.context.config,this.dataset.nextData=null,this.context.dataset.nextVideoInfo={},this.dataset.nextVideoInfoCopy={},this.context.dataset.nextVid=this.dataset.playerConfig.nextVid,this.dataset.getNextVid="function"===e.type(this.dataset.playerConfig.getNextVid)?this.dataset.playerConfig.getNextVid:e.noop,this.write(),this.addEventListerner(),this.bindBrowserEvent(),this.exportsModuleApis()},write:function(){var a={next:"txp-ui-control-play-next",hideClass:Txplayer.dataset.hideClass,tabindex:Txplayer.dataset.tabindex++,nextTip:"txp-next-tip"};this.dataset.renderData=a;var b=e.tmpl(g,a);this.context.$mod.$buttonsleftmod.append(b),this.dataset.$next=this.context.$mod.$buttonsleftmod.find('[data-role="'+a.next+'"]'),this.dataset.$nextTip=this.context.$mod.$buttonsleftmod.find('[data-role="'+a.nextTip+'"]');var c={tipMod:"txp-next-tip-mod",tipText:"txp-next-tip-text",tipPreview:"txp-next-tip-preview",hideClass:Txplayer.dataset.hideClass},d=e.tmpl(h,c);this.context.$mod.$playermod.append(d),this.dataset.$tipMod=this.context.$mod.$playermod.find('[data-role="'+c.tipMod+'"]'),this.dataset.$tipText=this.dataset.$tipMod.find('[data-role="'+c.tipText+'"]'),this.dataset.$tipPreview=this.dataset.$tipMod.find('[data-role="'+c.tipPreview+'"]');var f={tipContentMod:"txp-next-tip-content-mod",tipContentText:"txp-next-tip-content-text",tipContentCancle:"txp-next-tip-content-cancle",tipContentPlay:"txp-next-tip-content-play",tipContentPoster:"txp-next-tip-content-poster",hideClass:Txplayer.dataset.hideClass},j=e.tmpl(i,f);this.context.$mod.$playermod.append(j),this.dataset.$tipContentMod=this.context.$mod.$playermod.find('[data-role="'+f.tipContentMod+'"]'),this.dataset.$tipContentText=this.dataset.$tipContentMod.find('[data-role="'+f.tipContentText+'"]'),this.dataset.$tipContentCancle=this.dataset.$tipContentMod.find('[data-role="'+f.tipContentCancle+'"]'),this.dataset.$tipContentPlay=this.dataset.$tipContentMod.find('[data-role="'+f.tipContentPlay+'"]'),this.dataset.$tipContentPoster=this.dataset.$tipContentMod.find('[data-role="'+f.tipContentPoster+'"]'),this.initDisplay()},remove:function(){this.dataset.$next.remove(),this.dataset.$tipMod.remove(),this.dataset.$tipContentMod.remove()},initDisplay:function(){1==this.context.dataset.nextVid?(this.dataset.$next.removeClass(Txplayer.dataset.hideClass),this.dataset.$next.removeClass("txp_disabled"),this.writeTips()):0==this.context.dataset.nextVid?(this.dataset.$tipMod.addClass(Txplayer.dataset.hideClass),this.dataset.$nextTip.addClass(Txplayer.dataset.hideClass),this.dataset.$next.addClass(Txplayer.dataset.hideClass)):(this.dataset.$next.removeClass(Txplayer.dataset.hideClass),this.dataset.$next.addClass("txp_disabled"))},writeTips:function(){this.dataset.nextData&&this.dataset.nextData.title&&this.dataset.nextData.preview&&(this.dataset.$tipText.html(f.xss(this.dataset.nextData.title)),this.dataset.$tipContentText.html(f.xss(this.dataset.nextData.title)),this.dataset.$tipPreview.attr("src",this.dataset.nextData.preview)),this.dataset.nextData&&this.dataset.nextData.previewPoster&&this.dataset.$tipContentPoster.css({"background-image":"url("+this.dataset.nextData.previewPoster+")"})},canclePlayTheNext:function(){this.dataset.isCancle=!0,clearTimeout(this.dataset.timer),this.dataset.timer=null,this.dataset.$tipContentMod.addClass(Txplayer.dataset.hideClass)},doPlayTheNext:function(a,b){var c=this;if(this.dataset.$tipContentMod.addClass(Txplayer.dataset.hideClass),c.dataset.nextData.showCountdown)return void c.nofreshDoPlayTheNext(c.dataset.nextVideoInfo,b);try{this.context.userMsg.broadcast("beforePlayNext",{vid:a||c.dataset.nextData.pageUrl})}catch(d){}},nofreshDoPlayTheNext:function(a,b){var c=this;if(11===a.vid.length){try{c.context.userMsg.broadcast("beforePlayNext",{vid:a.vid})}catch(d){}var e={vid:a.vid,nextVid:a.nextVid,bullet:a.bullet,bulletId:a.bulletId,duration:a.duration,playStartTime:a.playStartTime,playEndTime:a.playEndTime,isNeedPay:a.isNeedPay,title:a.title,autoplay:!a.hasOwnProperty("autoplay")||a.autoplay,defaultDefinition:a.defaultDefinition};b.hasOwnProperty("connectionPlayType")&&(e.connectionPlayType=b.connectionPlayType),c.context.msg.broadcast("playControl",e)}},playTheNext:function(a){if(f.showInfo("uiPlayNext.playTheNext",a),a=a||{},1==this.context.dataset.nextVid){var b,c=this,d=this.context.dataset.vid;try{b=c.dataset.orgNextVideoInfo?c.dataset.orgNextVideoInfo:c.dataset.getNextVid(d),c.dataset.nextVideoInfo=b}catch(e){f.showInfo("[playTheNext.getNextVid.error]",e)}if(!b||!b.vid)return void f.showError("\u64ad\u653e\u4e0b\u4e2a\u89c6\u9891\u5931\u8d25","\u627e\u4e0d\u5230vid");if(this.dataset.playNextOptions=a,this.dataset.isPageStopAutoPlay=!1,f.isPageSupportStopAutoPlay()&&"coolOpen"!==this.context.config.playerType){var g=f.isPageHidden(),h=f.isInScreen(this.context.dataset.$playermod);if("undefined"!=typeof g&&g||!h)return void(this.dataset.isPageStopAutoPlay=!0)}if(c.dataset.nextData&&(c.dataset.nextData.pageUrl||c.dataset.nextData.showCountdown)&&a.isAllEnd&&!f.os.ipad)return this.dataset.$tipContentMod.removeClass(Txplayer.dataset.hideClass),this.reportUserAction("play-next-float-view"),this.dataset.timer&&(clearTimeout(this.dataset.timer),this.dataset.timer=null),void(this.dataset.timer=setTimeout(function(){c.dataset.isCancle||c.doPlayTheNext(c.dataset.nextData.pageUrl,a)},1e4));if(c.dataset.nextData&&c.dataset.nextData.pageUrl&&!c.dataset.nextData.showCountdown)try{c.context.userMsg.broadcast("beforePlayNext",{vid:b.pageUrl})}catch(e){}else c.nofreshDoPlayTheNext(b,a),c.context.msg.broadcast("updateNextVideoInfo")}},toggleAutoPlayNext:function(a){if(a){if(this.dataset.isPageStopAutoPlay=!1,this.dataset.nextData&&this.dataset.nextData.pageUrl&&!this.dataset.nextData.showCountdown){try{this.context.userMsg.broadcast("beforePlayNext",{vid:this.dataset.nextVideoInfo.pageUrl})}catch(b){}return}this.nofreshDoPlayTheNext(this.dataset.nextVideoInfo,this.dataset.playNextOptions),this.context.msg.broadcast("updateNextVideoInfo")}},showTip:function(){var a=this;a.dataset.nextData&&a.dataset.nextData.title&&a.dataset.nextData.preview?a.dataset.$tipMod.removeClass(Txplayer.dataset.hideClass):a.dataset.$nextTip.removeClass(Txplayer.dataset.hideClass)},hideTip:function(){var a=this;a.dataset.nextData&&a.dataset.nextData.title&&a.dataset.nextData.preview?a.dataset.$tipMod.addClass(Txplayer.dataset.hideClass):a.dataset.$nextTip.addClass(Txplayer.dataset.hideClass)},bindMouseEvent:function(){var a=this;this.dataset.$next.on("mouseenter",function(b){e(b.relatedTarget).parents().hasClass("txp_btn_next")||a.showTip()}).on("mouseleave",function(b){e(b.relatedTarget).parents().hasClass("txp_btn_next")||a.hideTip()})},addEventListerner:function(){var a=this;this.dataset.$next.on(Txplayer.dataset.clickEventName,function(){a.context.dataset.nextVid&&(a.hideTip(),a.playTheNext({connectionPlayType:3}))}),this.dataset.$tipContentCancle.on(Txplayer.dataset.clickEventName,function(){a.reportUserAction("play-next-float-cancel-click"),a.canclePlayTheNext(),a.context.msg.broadcast("showUicontrol")}),this.dataset.$tipContentPlay.on(Txplayer.dataset.clickEventName,function(){a.reportUserAction("play-next-float-play-click"),a.doPlayTheNext(a.dataset.nextData.pageUrl,{connectionPlayType:3})}),this.dataset.eventsList={},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(){a.dataset.isCancle=null,a.dataset.nextData=null,a.dataset.$tipContentMod.addClass(Txplayer.dataset.hideClass)},this.dataset.eventsList[f.getUniqueMsgKey("hideUiControl")]=function(){a.hideTip()},this.dataset.eventsList[f.getUniqueMsgKey("beforeVideoPlay")]=function(){a.canclePlayTheNext(),a.dataset.isCancle=null},this.dataset.eventsList[f.getUniqueMsgKey("userStopVideo")]=function(){a.canclePlayTheNext(),a.dataset.isCancle=null},this.dataset.eventsList[f.getUniqueMsgKey("videoEnd")]=function(b){b.isAllEnd&&a.context.dataset.nextVid&&!a.context.dataset.canPlayTime&&(a.context.dataset.nextVideoInfo.vid||"v3"!=a.context.config.version||a.context.userApi.stop&&a.context.userApi.stop(),a.context.dataset.disableAutoPlayNext||a.context.dataset.isLoopPlay||a.playTheNext({connectionPlayType:2,isAllEnd:!0}))},this.dataset.eventsList[f.getUniqueMsgKey("updateNextVideoInfo")]=function(){var b=!a.context.dataset.isLoopPlay&&!a.context.dataset.disableAutoPlayNext;b?a.context.dataset.nextVideoInfo=a.dataset.nextVideoInfoCopy:a.context.dataset.nextVideoInfo={}},this.dataset.eventsList[f.getUniqueMsgKey("userPlayNext")]=function(b){a.context.dataset.nextVid&&(a.hideTip(),a.playTheNext(b))},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)}),f.mobile||this.bindMouseEvent()},bindBrowserEvent:function(){var a=this;if(f.isPageSupportStopAutoPlay()&&"coolOpen"!==a.context.config.playerType){f.addPageVisibilityChangeEvent(function(b){a.dataset.isPageStopAutoPlay&&!b&&f.isInScreen(a.context.dataset.$playermod)&&a.toggleAutoPlayNext(!0)});var b;e(window).scroll(function(){clearTimeout(b),b=setTimeout(function(){a.dataset.isPageStopAutoPlay&&f.isInScreen(a.context.dataset.$playermod)&&a.toggleAutoPlayNext(!0)},300)})}},reportUserAction:function(a){this.context.msg.broadcast("reportUsrAction",{usr_action:a})},exportsModuleApis:function(){var a=this;this.dataset.moduleApis={},this.dataset.moduleApis.getNextData=function(b,c){return a.dataset.nextData},this.dataset.moduleApis.setNextVid=function(b,c){if(a.context.dataset.nextVid=b.nextVid,1==a.context.dataset.nextVid){var d,e=a.context.dataset.vid;try{d=a.dataset.getNextVid(e)}catch(g){f.showInfo("[playTheNext.getNextVid.error]",g)}d&&(a.dataset.orgNextVideoInfo=d,a.dataset.nextData={vid:e,nextVid:d.vid},d.title&&(a.dataset.nextData.title=d.title),d.preview&&(a.dataset.nextData.preview=d.preview),d.showCountdown&&(a.dataset.nextData.showCountdown=d.showCountdown),d.pageUrl&&(a.dataset.nextData.pageUrl=d.pageUrl),d.previewPoster&&(a.dataset.nextData.previewPoster=d.previewPoster),"v.qq.com"!==location.hostname||f.os.ipad||a.dataset.nextData.pageUrl||a.context.dataset.canPlayTime||a.context.dataset.isLoopPlay?(a.context.dataset.nextVideoInfo={},a.dataset.nextVideoInfoCopy={}):(a.context.dataset.nextVideoInfo.vid=d.vid,a.context.dataset.nextVideoInfo.cid=d.cid||a.context.dataset.cid,a.dataset.nextVideoInfoCopy.vid=d.vid,a.dataset.nextVideoInfoCopy.cid=d.cid||a.context.dataset.cid))}else a.context.dataset.nextVideoInfo={},a.dataset.nextVideoInfoCopy={};a.initDisplay(),a.context.msg.broadcast("updateNextVideoInfo")},e.extend(this.context.userApi,this.dataset.moduleApis),e.each(this.dataset.moduleApis,function(b,c){a.context.msg.on(b,c)})}},Txplayer.register("UiPlayNext",d)},216:function(a,b){a.exports='<txpdiv data-role="<%=next%>" class="txp_btn txp_btn_next" data-report="play-next" aria-label="\u4e0b\u4e00\u96c6">\n  <svg class="txp_icon txp_icon_next" version="1.1" viewBox="0 0 36 36">\n    <use class="txp_svg_symbol txp_svg_next" xlink:href="<%=svgPrefix%>#txp_svg_next" />\n  </svg>\n  <txpdiv class="txp_tooltip <%=hideClass%>" data-role="<%=nextTip%>">\u4e0b\u4e00\u96c6</txpdiv>\n</txpdiv>'},217:function(a,b){a.exports='<txpdiv class="txp_hint_next <%=hideClass%>" data-role="<%=tipMod%>">\n<txpdiv class="txp_next_pic"><img data-role="<%=tipPreview%>" alt="" /></txpdiv>\n\t<txpdiv class="txp_next_wording">\n\t\t<txpdiv class="txp_label">\u4e0b\u4e00\u4e2a</txpdiv>\n\t\t<txpdiv class="txp_next_title" data-role="<%=tipText%>"></txpdiv>\n\t</txpdiv>\n</txpdiv>\n'},218:function(a,b){a.exports='<txpdiv class="txp_overlay_next <%=hideClass%>" data-role="<%=tipContentMod%>">\n<div class="txp_next_poster" data-role="<%=tipContentPoster%>" style="background-image:url()"></div>\n<txpdiv class="txp_next_content">\n\t<txpdiv class="txp_label">\u5373\u5c06\u64ad\u653e</txpdiv>\n\t<txpdiv class="txp_next_title" data-role="<%=tipContentText%>"></txpdiv>\n\t<a class="txp_cancel" href="javascript:" data-role="<%=tipContentCancle%>">\u53d6\u6d88</a>\n\t<button class="txp_btn txp_btn_play_lg" data-status="play" data-role="<%=tipContentPlay%>">\n\t\t<svg class="txp_icon txp_icon_play" viewBox="0 0 36 36" >\n\t\t\t<use class="txp_svg_symbol txp_svg_play" xlink:href="<%=svgPrefix%>#txp_svg_play" />\n\t\t</svg>\n\t\t<svg class="txp_icon_cirlce" viewBox="0 0 72 72" >\n\t\t\t<circle r="34" cy="36" cx="36"></circle>\n\t\t</svg>\n\t</button>\n</txpdiv>\n</txpdiv>'}});