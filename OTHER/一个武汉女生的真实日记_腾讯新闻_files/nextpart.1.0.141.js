/*!
 * Tencent Video Player creative plugins.
 * @Copyright 2019 
 * modify at: 2019-07-11 15:53:46
 * power by Tencent Video FE Team
 */
!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=74)}([function(t,e,i){"use strict";t.exports=function(t){return{log:function(){var e=Array.prototype.slice.call(arguments),i=new Date,n=[i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()].join(":");e.unshift(t?"["+n+" TxpCreativePlayer/"+t+"]":""),function(){window.TxpCreativePlayer&&TxpCreativePlayer.debug&&window.console&&window.console.log&&window.console.log.apply(window.console,arguments)}.apply(null,e)},err:function(){var e=Array.prototype.slice.call(arguments),i=new Date,n=[i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()].join(":");e.unshift(t?"["+n+" TxpCreativePlayer/"+t+"]":""),function(){window.TxpCreativePlayer&&TxpCreativePlayer.debug&&window.console&&window.console.error&&window.console.error.apply(window.console,arguments)}.apply(null,e)}}}},function(t,e,i){"use strict";t.exports={AD_STOP:"innerStopAdEvt",AD_SHOW:"innerShowAdEvt",AD_HIDE:"innerHideAdEvt",REPORT_EVENT:{AD_VIEW:"reportAdView",AD_GET_INFO:"reportAdGetInfo",AD_GET_INFO_ERROR:"reportAdGetInfoError",AD_LOAD_COMPLETE:"reportAdLoadComplete",AD_END:"reportAdEnd",AD_CLICK:"reportAdClick",AD_SCREEN_SHOT:"reportAdScreenShot",AD_DURING:"reportAdDuring",AD_MIND_CZC:"reportCzcMind",AD_DP3_CZC:"reportCzcDp3",AD_POINT_VIEW:"reportPointView",AD_3PARTY_VIEW:"report3PartyView",NEW_DP3:"newDp3"},TXPLAYER_EVENT:{AD_REQUEST_ORDER:"requestOrderEvt",AD_GET_INFO:"getAdInfoEvt",AD_LOAD_START:"loadStartEvt",AD_LOAD_READY:"loadReadyEvt",AD_LOAD_PROGRESS:"loadProgressEvt",AD_LOAD_COMPLETE:"loadCompleteEvt",AD_ENTER_COUNTDOWN:"enterCountdownEvt",AD_ENTER_COUNTDOWN_COMPLETE:"enterCountdownCompleteEvt",AD_PLAY_START:"playStartEvt",AD_PLAY_END:"playEndEvt",AD_PLAY_ERROR:"playErrorEvt",AD_SHOW:"showAdEvt",AD_STOP:"stopAdEvt",AD_EXIT_WINDOW_FULLSCREEN:"exitWindowFullscreen",AD_EXIT_BROWSER_FULLSCREEN:"exitBrowserFullscreen",AD_MOVE_IN:"moveinAd",AD_MOVE_OUT:"moveoutAd",AD_REPORT:"reportAd"},TXPLAYER_API:{UP_BARRAGE_ZINDEX:"upBarrageZindex",RESET_BARRAGE_ZINDEX:"resetBarrageZindex",GET_PLAYSTATE:"getPlayState",GET_CONTROL_STATUS:"getControlStatus",GET_VOLUME:"getVolume"},UI_EVENT:{VIDEO_SKIP_TEXT:"videoSkipTextClickEvt",VIDEO_CLOSE_BUTTON_CLICK:"videoCloseButtonClickEvt",VIDEO_NO_SKIP_CLOSE_BUTTON_CLICK:"videoNoSkipCloseButtonClickEvt",VIDEO_NO_SKIP_KNOW_BUTTON_CLICK:"videoNoSkipKnowButtonClickEvt",VIDEO_NO_SKIP_BUTTON_CLICK:"videoNoSkipButtonClickEvt",VIDEO_LINK_AREA_CLICK:"videoLinkAreaClickEvt",VIDEO_DETAIL_BUTTON_CLICK:"videoDetailButtonClickEvt",VIDEO_VOLUME_BUTTON_CLICK:"videoVolumeButtonClickEvt"},VPAID_EVENT:{AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError",AdPauseTimeCount:"AdPauseTimeCount",AdResumeTimeCount:"AdResumeTimeCount"}}},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports={getScale:function(t,e,i,n,o){var r,a,s;return r=i/t,a=n/e,s=Math.min(r,a),o&&(o.width=parseInt(o.width*s),o.height=parseInt(o.height*s)),s||1},checkSuffix:function(t,e){if(!t)return!1;t=t.toLowerCase();var i=/\.(\w+)(?:$|\?|\#)/.exec(t);if(!i||!i[1])return!1;if(!e)return i[1];if("string"==typeof e)return i[1]===e;if(e instanceof Array){for(var n=e.length-1;n>=0;n--)if(i[1]===e[n])return!0;return!1}},loadJs:function(t,e,i,n){var o=document.createElement("script");o.type="text/javascript",o.charset="UTF-8",o.src=t.replace(/http(s)?:/,location.protocol);var r=!1;if(o.onerror=function(t){r=!0,e({src:t.target.src,error:{type:"jserror",code:404}})},o.addEventListener?o.addEventListener("load",function(){r=!0,e()},!1):o.attachEvent&&o.attachEvent("onreadystatechange",function(){"loaded"==window.event.srcElement.readyState&&(r=!0,e())}),n){var a=document.createElement("base");a.href=o.src.match(/.+\//)[0],n.getElementsByTagName("head")[0].appendChild(a)}i?i.appendChild(o):document.getElementsByTagName("head")[0].appendChild(o),setTimeout(function(){r||(e&&e({src:t,error:{type:"js timeout",code:502}}),e=function(){})},5e3)},appendParamsToUrl:function(t,e){return"string"==typeof t&&e&&(t+=(-1==t.indexOf("?")?"?":"&")+this.param2url(e)),t},param2url:function(t){if("object"==(void 0===t?"undefined":n(t))){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i+"="+t[i]);return e.join("&")}return""},url2Obj:function(t){var e={};if(!t)return e;var i=document.createElement("a");i.href=t;var n=i.search||"";return n?((n=n.replace(/^\?/,"").split("&")).forEach(function(t){var i=t.split("=");e[i[0]]=i[1]}),e):e},refreshUrlParamOrder:function(t){if(!t)return"";var e=document.createElement("a");e.href=t;var i=e.search||"";if(!i)return t;if((i=i.replace(/^\?/,"").split("&")).sort(function(){return.5-Math.random()>0?1:-1}),i[0]&&/^vkey/.test(i[0])&&i.length>1){var n=i[0];i[0]=i[1],i[1]=n}return i=i.join("&"),e.href.replace(e.search,"?"+i)},getVideoType:function(){var t="";return window.COVER_INFO&&window.COVER_INFO.typeid?t=+window.COVER_INFO.typeid:window.VIDEO_INFO&&window.VIDEO_INFO.type&&(t=+window.VIDEO_INFO.type),t},getUA:function(t){if(!t)return"unknown";var e=-1,i=(t=t.toLowerCase()).match(/(?:metasr.\d*|qqlive.\d*|qqbrowser.\d*|maxthon.\d*|theworld|lbbrowser|firefox.\d*|opera.\d*|bidubrowser.\d*)/);if(null!==i)return i[0].replace(" ","").replace("/","");if(t.indexOf("android")>-1)return"android";if(t.indexOf("iphone")>-1)return"iphone";if(t.indexOf("ipad")>-1)return"ipad";if((e=t.indexOf("chrome"))>-1)return"chrome"+parseInt(t.substr(e+7,4));if((e=t.indexOf("safari"))>-1)return"safari";var n=t.indexOf("msie");if(n>-1)return"ie"+parseInt(t.substr(n+5,2));if(t.indexOf("trident")>-1){var o=t.indexOf("rv:");if(o>-1)return"ie"+parseInt(t.substr(o+3,2))}return t},cookie:{set:function(t,e,i,n,o){if(o){var r=new Date,a=new Date;a.setTime(r.getTime()+36e5*o)}return document.cookie=t+"="+e+"; "+(o?"expires="+a.toGMTString()+"; ":"")+(n?"path="+n+"; ":"path=/; ")+(i?"domain="+i+";":"domain="+window.location.host+";"),!0},get:function(t){var e=new RegExp("(?:^|;+|\\s+)"+t+"=([^;]*)"),i=document.cookie.match(e);return i?i[1]:""},del:function(t,e,i){var n=new Date;n.setTime(n.getTime()-1),document.cookie=t+"=; expires="+n.toGMTString()+";"+(i?"path="+i+"; ":"path=/; ")+(e?"domain="+e+";":"domain="+window.location.host+";")}}}},function(t,e,i){"use strict";t.exports={LD:"LD",HT:"HT",ZC:"ZC",CZC:"CZC",ZT:"ZT",KB:"KB",PSJ:"PSJ",PPB:"PPB",PVL:"PVL",ZI:"ZI",PDF:"PDF",BS:"BS",TP:"TP",VIN:"VIN"}},function(t,e,i){"use strict";t.exports={INIT:0,LOADING:1,LOAD_READY:2,PLAYING:3,PAUSED:4,END:-1,WAIT_FOR_STOP:-2}},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o="undefined"!=typeof Txplayer&&Txplayer.dataset.hideClass||"txp_none",r={},a=1;t.exports={attr:function(t,e,i){if(!t)return"";if(e){if(void 0!==i)return t.setAttribute(e,i);if("src"!==e)return t.getAttribute(e);t.src=src}return""},removeAttr:function(t,e){t&&e&&("src"===e?delete t.src:t.removeAttribute(e))},css:function(t,e,i){if(!t)return"";if(e){if(void 0===i&&"string"==typeof e){var o={};try{o=document.defaultView.getComputedStyle(t,null)}catch(s){o=t.currentStyle}return o[e]}if(void 0===i&&"object"===(void 0===e?"undefined":n(e))){var r=e;for(var a in r)r.hasOwnProperty(a)&&(/width|height|left|right|top|bottom/.test(a)&&"number"==typeof r[a]&&(r[a]=r[a]+"px"),t.style[a]=r[a])}else"string"==typeof e&&"string"==typeof i&&(/width|height|left|right|top|bottom/i.test(e)&&"number"==typeof i&&(i+="px"),t.style[e]=i)}},append:function(){var t=Array.prototype.slice.call(arguments),e=t.shift();if(e)for(var i=0,n=t.length;i<n;i++)e.appendChild(t[i])},addClass:function(t,e){if(!this.hasClass(t,e))if(t.className&&0!==t.className.length){var i=t.className.split(" ");i.push(e),t.className=i.join(" ")}else t.className=e},removeClass:function(t,e){if(this.hasClass(t,e)){var i=t.className.split(" "),n=i.indexOf(e);i.splice(n,1),t.className=i.join(" ")}},hasClass:function(t,e){return t.className&&t.className.indexOf(e)>-1},hide:function(t){this.addClass(t,o)},show:function(t){this.removeClass(t,o)},on:function(){var t,e=Array.prototype.slice.call(arguments),i=e.shift();if(i&&((t=i)._zid||(t._zid=a++),e.length>=2)){var n=function(t,e,i){var n=t._zid,o={evt:e};return r[n]||(r[n]={}),o.cb=function(t){i(t)},r[n][e]||(r[n][e]=[]),r[n][e].push(o),o}(i,e[0],e[1]),o=e[2];void 0!==o&&(o=!1),"function"==typeof i.addEventListener?i.addEventListener(e[0],n.cb,o):"function"==typeof i.attachEvent?i.attachEvent(e[0],n.cb,o):i["on"+e[0]]=n.cb}},_removeListener:function(t,e,i,n){void 0===n&&(n=!1),"function"==typeof t.removeEventListener?t.removeEventListener(e,i,n):"function"==typeof t.detachEvent?t.detachEvent("on"+e,i,n):t["on"+e]=null},off:function(){var t=Array.prototype.slice.call(arguments),e=t.shift(),i=this;if(e){var n=t[2];if(2===arguments.length)((function(t,e){var i=t._zid,n=[];return r[i]&&(n=r[i][e]),n})(e,t[0],t[1])||[]).forEach(function(t){i._removeListener(e,t.evt,t.cb,!1)}),function(t,e,i){var n=t._zid;r[n]&&(e?delete r[n][e]:delete r[n])}(e,t[0],t[1]);else arguments.length>2&&this._removeListener(e,t[0],t[1],n)}},text:function(){var t=Array.prototype.slice.call(arguments),e=t.shift();if(e)if(1===t.length)e.textContent=t[0];else if(0===t.length)return e.textContent},html:function(){var t=Array.prototype.slice.call(arguments),e=t.shift();if(e)return 1!==t.length?e.innerHTML:void(e.innerHTML=t[0])}}},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(n){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var o=i(4),r=i(3),a=i(1),s=i(0)("base/adBase"),l=i(2),h=i(9),d=0;t.exports=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s.log("new AdBase",e),this._name="adBase",this.infos=e.infos,this.info=e.infos&&e.infos[0]?e.infos[0]:null,this.scene=e.scene,this.dataset=e.dataset,this.$dom=e.dom,this.message=e.message,this.adplayer=e.adplayer,this._canPlay=!1,this._isShow=!1,this._state=o.INIT,this._isSmallWindow=!1}return n(t,[{key:"_loadReadyHandler",value:function(t){this._canPlay=!0,this._state=o.loadReady,this._emitEvent(a.TXPLAYER_EVENT.AD_LOAD_READY,t)}},{key:"_emitEvent",value:function(t,e){void 0===e&&(e={adtype:this.adtype,adinfo:this.info,isWholeScene:this.isWholeScene}),this.message&&this.message.emit(t,e)}},{key:"callOuterApi",value:function(t){var e=this.adplayer.getConf();if(e.playerMethod&&"function"==typeof e.playerMethod[t]){var i=Array.prototype.slice.call(arguments);return i.shift(),e.playerMethod[t].apply(null,i)}}},{key:"initUI",value:function(t,e,i){var n=t.layer;if(n){var o=this.template(i);if(!n.innerHTML||-1==n.innerHTML.indexOf(o)){var r=document.createElement("div");r.innerHTML=o,n.appendChild(r.children[0])}for(var a in i)i.hasOwnProperty(a)&&(e["$"+a]=n.querySelector('[data-role="'+i[a]+'"]'))}}},{key:"addEvent",value:function(){}},{key:"removeEvent",value:function(){}},{key:"load",value:function(){if(this._state=o.LOADING,this.info&&this.info.isEmpty&&!this.info.isVideoAd){if(this.adtype==r.PDF)return;this.message.emit(a.REPORT_EVENT.AD_VIEW,{adInfo:this.info})}}},{key:"play",value:function(){if(this._state=o.PLAYING,!this._isStart){this._isStart=!0;var t=this.adtype;t!==r.PDF&&t!==r.PPB&&t!==r.PVL&&this.message.emit(a.TXPLAYER_EVENT.AD_SHOW,{adtype:t})}}},{key:"pause",value:function(){this._state=o.PAUSED}},{key:"resume",value:function(){this._state=o.PLAYING}},{key:"mute",value:function(){}},{key:"unMute",value:function(){}},{key:"setVolume",value:function(){}},{key:"resize",value:function(t){}},{key:"setFullScreen",value:function(){}},{key:"setSmallWindow",value:function(t){this._isSmallWindow=t&&t.isSmallWindow}},{key:"stop",value:function(t){this._isStart=!1,this.removeEvent(),this._state=o.END,this._emitEvent(a.AD_STOP,t),this.adtype!==r.LD&&this.adtype!==r.KB&&this.adtype!==r.HT&&this.adtype!==r.ZC&&this.message.emit(a.TXPLAYER_EVENT.AD_STOP,{adtype:this.adtype})}},{key:"waitForStop",value:function(){this._state=o.WAIT_FOR_STOP}},{key:"show",value:function(){if(!this._isShow){this._isShow=!0;var t=this.adtype;t!==r.LD&&t!==r.KB&&t!==r.HT&&t!==r.ZC&&t!==r.PSJ&&t!==r.PDF&&t!==r.PPB&&t!==r.PVL&&this.message.emit(a.TXPLAYER_EVENT.AD_SHOW,{adtype:t})}this._emitEvent(a.AD_SHOW),this.showTime||(this.showTime=+new Date)}},{key:"hide",value:function(){this._isShow=!1,this._emitEvent(a.AD_HIDE)}},{key:"destroy",value:function(){}},{key:"openLink",value:function(){if(this.info&&this.info.link){var t=(new Date).getTime();if(t-d<300)s.log("click too fast");else{d=t;var e=this.adplayer.getConf(),i=e&&e.playerData&&e.playerData.playerPfEx||"",n=l.appendParamsToUrl(this.info.link,{pf_ex:i||"",appversion:h});window.open(n),this._emitEvent(a.REPORT_EVENT.AD_CLICK,{adInfo:this.info,adclick:this.info.order_id,clicktime:+new Date-this.showTime,scene:this.scene})}}}},{key:"template",value:function(t){return""}},{key:"adtype",get:function(){return this.info?this.info.adtype:""}},{key:"isWholeScene",get:function(){return!!this.scene&&this.scene.isWholeScene}},{key:"canPlay",get:function(){return this._canPlay}},{key:"state",get:function(){return this._state}},{key:"isShow",get:function(){return this._isShow}}]),t}()},function(t,e,i){(function(n,o){var r;!function(n){var a=n.Promise,s=a&&"resolve"in a&&"reject"in a&&"all"in a&&"race"in a&&function(){var t;return new a(function(e){t=e}),"function"==typeof t}();void 0!==e&&e?(e.Promise=s?a:C,e.Polyfill=C):(r=function(){return s?a:C}.call(e,i,e,t))===undefined||(t.exports=r);var l="pending",h="sealed",d="fulfilled",u="rejected",c=function(){};function p(t){return"[object Array]"===Object.prototype.toString.call(t)}var f,v=void 0!==o?o:setTimeout,y=[];function m(){for(var t=0;t<y.length;t++)y[t][0](y[t][1]);y=[],f=!1}function _(t,e){y.push([t,e]),f||(f=!0,v(m,0))}function g(t){var e=t.owner,i=e.state_,n=e.data_,o=t[i],r=t.then;if("function"==typeof o){i=d;try{n=o(n)}catch(a){T(r,a)}}A(r,n)||(i===d&&E(r,n),i===u&&T(r,n))}function A(t,e){var i;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"==typeof e)){var n=e.then;if("function"==typeof n)return n.call(e,function(n){i||(i=!0,e!==n?E(t,n):w(t,n))},function(e){i||(i=!0,T(t,e))}),!0}}catch(o){return i||T(t,o),!0}return!1}function E(t,e){t!==e&&A(t,e)||w(t,e)}function w(t,e){t.state_===l&&(t.state_=h,t.data_=e,_(P,t))}function T(t,e){t.state_===l&&(t.state_=h,t.data_=e,_(O,t))}function b(t){var e=t.then_;t.then_=undefined;for(var i=0;i<e.length;i++)g(e[i])}function P(t){t.state_=d,b(t)}function O(t){t.state_=u,b(t)}function C(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof C==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(t,e){function i(t){T(e,t)}try{t(function(t){E(e,t)},i)}catch(n){i(n)}}(t,this)}C.prototype={constructor:C,state_:l,then_:null,data_:undefined,then:function(t,e){var i={owner:this,then:new this.constructor(c),fulfilled:t,rejected:e};return this.state_===d||this.state_===u?_(g,i):this.then_.push(i),i.then},"catch":function(t){return this.then(null,t)}},C.all=function(t){if(!p(t))throw new TypeError("You must pass an array to Promise.all().");return new this(function(e,i){var n=[],o=0;function r(t){return o++,function(i){n[t]=i,--o||e(n)}}for(var a,s=0;s<t.length;s++)(a=t[s])&&"function"==typeof a.then?a.then(r(s),i):n[s]=a;o||e(n)})},C.race=function(t){if(!p(t))throw new TypeError("You must pass an array to Promise.race().");return new this(function(e,i){for(var n,o=0;o<t.length;o++)(n=t[o])&&"function"==typeof n.then?n.then(e,i):e(n)})},C.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this(function(e){e(t)})},C.reject=function(t){return new this(function(e,i){i(t)})}}("undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:this)}).call(e,i(6),i(14).setImmediate)},function(t,e,i){"use strict";t.exports="1.0.141"},,function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var o=i(0)("material/vpaid"),r=i(2),a=i(5),s=i(12),l=i(3),h=i(1).VPAID_EVENT,d=i(18),u={NOT_START:0,READY:1,LOAD_COMPLETE:2,PLAYING:3,PAUSE:4,END:5,STOP:6},c=0,p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instanceCount=c++,o.log("new Vpaid:",this.instanceCount),this.init(e),this.playState=u.NOT_START}return n(t,[{key:"init",value:function(t){this.params=t,this.wrapper=t.container,this.outerEvents=t.events;this.playTimer=new s,this.iframe=document.createElement("iframe"),this.iframe.id="adLoaderIframe"+this.instanceCount,this.iframe.name="adLoaderIframe"+this.instanceCount,this.iframe.frameBorder=0;try{this.iframe.setAttribute("allow","autoplay")}catch(e){o.log('iframe.setAttribute("allow", "autoplay") : ',e)}a.css(this.iframe,{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"none","pointer-events":"auto"}),this.wrapper.appendChild(this.iframe),a.css(this.iframe.contentWindow.document.body,{overflow:"hidden"})}},{key:"loadAd",value:function(t){o.log("load vpaid:",t,this.instanceCount),this.loadParams=t,this.outerEvents=t.events,this.api=t.api,this.info=t.info,this.duration=parseInt(t.adInfo.duration);var e=this;t.adInfo.richRes||(o.log("load vpaid error, richRes is empty."),this.callOuterEvents(h.AdError,this.loadParams),this.stopAd()),setTimeout(function(){var i=r.appendParamsToUrl(t.adInfo.richRes,{t:(new Date).getTime()});o.log("\u5bcc\u5a92\u4f53js\u5f00\u59cb\u52a0\u8f7d\uff1a",i,e.iframe.contentWindow,e.instanceCount),r.loadJs(i,e.onInitAd.bind(e),e.iframe.contentWindow.document.body,e.iframe.contentWindow.document)},100)}},{key:"onInitAd",value:function(t){var e,i=this;if(t&&t.error)return o.log("\u5bcc\u5a92\u4f53js\u52a0\u8f7d\u5931\u8d25\uff1a",t.error,this.instanceCount),this.loadParams.error=t.error,this.callOuterEvents(h.AdError,this.loadParams),void this.stopAd();if(o.log("vpaid params",this.params),this.params&&this.params.adInfo){this.params.adInfo.adtype!=l.ZI&&this.params.adInfo.adtype!==l.LD||(a.on(this.iframe.contentWindow.document.body,"click",function(t){o.log("\u70b9\u51fb\u4e86\u5bcc\u5a92\u4f53iframe"),t.currentTarget!==t.target&&t.target.dataset.click||(clearTimeout(e),e=setTimeout(function(){var t=i.safeCallOuterApi("getPlayState");i.safeCallOuterApi("getPlayState");t===d.PLAYING?i.safeCallOuterApi("userPausePlayer"):t===d.PAUSE&&i.safeCallOuterApi("userPlay")},300))}),a.on(this.iframe.contentWindow.document.body,"dblclick",function(t){clearTimeout(e),i.safeCallOuterApi("toggleWindowFullScreen")})),this.events={AdLoaded:h.AdLoaded,AdStarted:h.AdStarted,AdStopped:h.AdStopped,AdPaused:h.AdPaused,AdPlaying:h.AdPlaying,AdError:h.AdError,AdVideoStart:h.AdVideoStart,AdClickThru:h.AdClickThru,AdVideoComplete:h.AdVideoComplete,AdPauseTimeCount:h.AdPauseTimeCount,AdResumeTimeCount:h.AdResumeTimeCount};var n=this,r=n.iframe.contentWindow.getVPAIDAd;if(r&&"function"==typeof r){for(var s in n.VPAIDCreative=r(),this.events)n.VPAIDCreative.subscribe(n.onSubscribe,s,n);setTimeout(function(){n.VPAIDCreative.initAd(n.params.adWidth||n.params.playerData.playerWidth,n.params.adHeight||n.params.playerData.playerHeight,"normal",0,n.loadParams.adInfo.richData)},10)}}}},{key:"onSubscribe",value:function(t,e){this.events[t]&&this[this.events[t]](e)}},{key:"safeCallOuterApi",value:function(){var t=Array.prototype.slice.call(arguments).shift();if(this.api&&t&&this.api[t])try{return this.api[t]()}catch(e){o.log("call outer api error: ",t,", ",e)}}},{key:"safeCallCreativeMethod",value:function(){var t=Array.prototype.slice.call(arguments),e=t.shift();if(this.VPAIDCreative&&e&&this.VPAIDCreative[e])try{return this.VPAIDCreative[e].apply(this.VPAIDCreative,t)}catch(i){o.log("call vpaid method error: ",e,", ",i)}}},{key:"resize",value:function(t,e){this.safeCallCreativeMethod("resizeAd",t,e)}},{key:"mute",value:function(t){this.safeCallCreativeMethod("mute",t)}},{key:"setVolume",value:function(t){this.safeCallCreativeMethod("setAdVolume",t),!TxpCreativePlayer.fromPcClient&&this.api.getBrowserDisableIframeAutoPlay()&&(0===t?this.mute(!0):this.mute(!1))}},{key:"setPos",value:function(t){this.safeCallCreativeMethod("setPos",t)}},{key:"continueTimeout",value:function(){var t=this;this.duration>0&&this.params.adInfo.adtype!=l.ZT&&this.params.adInfo.adtype!=l.ZI&&this.playTimer.on(this.duration,function(){t.callOuterEvents(h.AdVideoComplete,t.loadParams),t.stopAd(),o.log("rich ad timeout !!!!  ",t.loadParams,t.instanceCount)})}},{key:"play",value:function(){this.VPAIDCreative&&(this.continueTimeout(),this.playState===u.PAUSE?(this.safeCallCreativeMethod("resumeAd"),this.playTimer.go()):this.playState===u.PAUSE&&this.playState===u.STOP&&this.playState===u.END||this.safeCallCreativeMethod("startAd"))}},{key:"pause",value:function(){this.playState!==u.PAUSE&&this.VPAIDCreative&&(this.safeCallCreativeMethod("pauseAd"),this.playTimer.pause())}},{key:"stopAd",value:function(){this.playState!==u.STOP&&(this.playTimer&&this.playTimer.clear(),this.VPAIDCreative&&(this.safeCallCreativeMethod("stopAd"),this.destroy()))}},{key:"callOuterEvents",value:function(t,e){if(o.log("callOuterEvents: ",t,e),this.outerEvents&&"function"==typeof this.outerEvents[t])try{this.outerEvents[t](e)}catch(i){o.log("callOuterEvents error: ",i)}}},{key:"destroy",value:function(){o.log("vpaid destroy.",this.instanceCount),this.playTimer&&this.playTimer.clear(),this.wrapper&&this.iframe&&this.wrapper.contains(this.iframe)&&this.wrapper.removeChild(this.iframe)}}]),t}();for(var f in h)h.hasOwnProperty(f)&&(p.prototype[f]||(p.prototype[f]=function(t){return function(e){var i=this;return t===h.AdPaused&&(this.playState=u.PAUSE),t!==h.AdStarted&&t!==h.AdPlaying||(this.playState=u.PLAYING),t===h.AdLoaded&&(this.playState=u.LOAD_COMPLETE),t!==h.AdStopped&&t!==h.AdError||(this.playState=u.STOP),t!==h.AdStopped&&t!==h.AdError||setTimeout(function(){i.destroy()},100),this.callOuterEvents(t,e)}}(f)));t.exports=p},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.timer=null,this.startTime=null,this.during=0,this.remain=-1,this.callback=null}return n(t,[{key:"on",value:function(t,e){var i=this;t<0||"function"==typeof e&&(this.clearTimer(),this.during=t,this.callback=e,this.timer=setTimeout(function(){i.callback&&i.callback(),i.clear()},t),this.startTime=(new Date).getTime())}},{key:"pause",value:function(){var t=(new Date).getTime()-this.startTime;t>this.during||(this.remain=this.during-t,this.clearTimer())}},{key:"go",value:function(){this.remain<0||this.on(this.remain,this.callback)}},{key:"clearTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.startTime=null,this.during=0}},{key:"clear",value:function(){this.clearTimer(),this.callback=null,this.remain=-1}}]),t}();t.exports=o},,function(t,e,i){(function(t){var n=void 0!==t&&t||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function r(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new r(o.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new r(o.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},i(15),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(e,i(6))},function(t,e,i){(function(t,e){!function(t,i){"use strict";if(!t.setImmediate){var n,o,r,a,s,l=1,h={},d=!1,u=t.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(t);c=c&&c.setTimeout?c:t,"[object process]"==={}.toString.call(t.process)?n=function(t){e.nextTick(function(){f(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?t.MessageChannel?((r=new MessageChannel).port1.onmessage=function(t){f(t.data)},n=function(t){r.port2.postMessage(t)}):u&&"onreadystatechange"in u.createElement("script")?(o=u.documentElement,n=function(t){var e=u.createElement("script");e.onreadystatechange=function(){f(t),e.onreadystatechange=null,o.removeChild(e),e=null},o.appendChild(e)}):n=function(t){setTimeout(f,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&f(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),n=function(e){t.postMessage(a+e,"*")}),c.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var o={callback:t,args:e};return h[l]=o,n(l),l++},c.clearImmediate=p}function p(t){delete h[t]}function f(t){if(d)setTimeout(f,0,t);else{var e=h[t];if(e){d=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(i,n)}}(e)}finally{p(t),d=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,i(6),i(16))},function(t,e){var i,n,o=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(i===setTimeout)return setTimeout(t,0);if((i===r||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:r}catch(t){i=r}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var l,h=[],d=!1,u=-1;function c(){d&&l&&(d=!1,l.length?h=l.concat(h):u=-1,h.length&&p())}function p(){if(!d){var t=s(c);d=!0;for(var e=h.length;e;){for(l=h,h=[];++u<e;)l&&l[u].run();u=-1,e=h.length}l=null,d=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];h.push(new f(t,e)),1!==h.length||d||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},,function(t,e,i){"use strict";t.exports={END:0,PLAYING:1,PAUSE:2,LOADING:3}},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var o=0,r=+new Date,a=i(8).Promise;t.exports=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.image=null,this.conf=e||{}}return n(t,[{key:"load",value:function(){var t=this;if(this.image)return a.resolve(this.image);var e=this.conf;return new a(function(i,n){var a=new Image;for(var s in a.id="adplayer_image_material_"+r+"_"+o,a.style.width="100%",a.style.height="100%",e.style)e.style.hasOwnProperty(s)&&(a.style[s]=e.style[s]);a.onload=function(){this.image=a,o++,i(this.image)}.bind(t),a.onerror=function(t){n(t)}.bind(t),a.src=e.url})}},{key:"destroy",value:function(){this.image&&(this.image.src="",this.image=null)}}]),t}()},function(t,e,i){"use strict";var n=i(8).Promise;function o(t,e){if("string"!=typeof e)return null;var i=e.split("."),n=i[0],o="";i.length>1&&(o=i[1]);var r=t.store;if(r.hasOwnProperty(n)){if(!o)return r[n];if(r[n].hasOwnProperty(o))return r[n][o]}}function r(){var t=new XMLHttpRequest;return t.open("GET","//dp3.qq.com/dynamic?pf=h5&sdktype=3&chid=-1&appversion=171101&get_type=sdkconfig"),new n(function(e,i){t.onreadystatechange=function(){if("200"==t.status&&4==t.readyState){var i=t.responseText,n={adflag:{}};try{var o=document.createElement("div");o.innerHTML=i,Array.prototype.forEach.call(o.querySelectorAll(".item"),function(t){var e=t.querySelector(".key").innerText,i=t.querySelector(".value").innerText;n.adflag[e]=i}),o=null}catch(r){}if(Object.keys(n.adflag).length)return void e(JSON.stringify(n));e(JSON.stringify({adflag:{PSJ:1,PPB:0,PVL:0,PDF:0}}))}},t.onerror=t.ontimeout=function(){e(JSON.stringify({adflag:{PSJ:0,PPB:0,PVL:0,PDF:0}}))},t.send(null)})}function a(t){var e,i,n={store:t=JSON.parse(t),t:(new Date).getTime()};return e="dp3config",i=JSON.stringify(n),window.localStorage&&window.localStorage.setItem(e,i),n}function s(t){return window.localStorage?window.localStorage.getItem(t):null}t.exports=function(t){var e;return e=t?"adflag."+t:"adflag",new n(function(t,i){var n=s("dp3config");if(n){var l=JSON.parse(n);(new Date).getTime()-l.t>36e5?r().then(function(i){t(o(a(i),e))})["catch"](i):t(o(l,e))}else r().then(function(i){t(o(a(i),e))})["catch"](i)})}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";var n=i(75),o=i(76),r=i(77),a=i(79),s=i(80),l=i(81);window.TxpCreativePlayer&&TxpCreativePlayer.adClass&&!TxpCreativePlayer.adClass.nextPartReady&&[{name:"ZtAd",factory:n},{name:"IvbAd",factory:o},{name:"FlowAd",factory:r},{name:"BuyAd",factory:a},{name:"VinAd",factory:l},{name:"CzcAd",factory:s}].forEach(function(t){TxpCreativePlayer.adClass.factory[t.name]={ready:!0,creater:function(e){return e._name=t.name,new t.factory(e)}},TxpCreativePlayer.adClass.nextPartReady=!0})},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function f(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(n===undefined){var o=Object.getPrototypeOf(t);return null===o?undefined:f(o,e,i)}if("value"in n)return n.value;var r=n.get;return r===undefined?undefined:r.call(i)};var r=i(7),a=i(4),s=i(11),l=i(5),h=i(2),d=i(1),u=i(0)("base/ztAd"),c={adName:"txpad-interact-pause",pauseAdImg:"txpad-interact-pause-img",pauseAdClose:"txpad-interact-pause-close",dspName:"txpad-interact-pause-dspname",vpaidContainer:"txpad-interact-pause-vpaidContainer"},p=!1;t.exports=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));u.log("new ZtAd");var n=i.$dom.$interactiveAd.$ztAd;return n||(n={},i.$dom.$interactiveAd.$ztAd=n,i.initUI(i.$dom.$interactiveAd,n,c)),i.$ztAd=n,l.hide(i.$ztAd.$adName),i.startTime=(new Date).getTime(),i.closeBtnClicked=!1,i.userClosed=!1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r),n(e,[{key:"load",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"load",this).call(this);var t=this;if(this.startLoadTime=(new Date).getTime(),l.html(this.$ztAd.$dspName,this.info.dsp_name),this.resize({width:this.dataset.playerWidth,height:this.dataset.playerHeight}),this.addEvent(),this.info.isRichMedia){var i={adInfo:this.info,playerData:this.dataset,container:this.$ztAd.$vpaidContainer,adWidth:400,adHeight:300};this.vpaidPlayer=new s(i);var n={};return n[d.VPAID_EVENT.AdLoaded]=function(){t._loadReadyHandler(),t._emitEvent(d.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:t.info,adload:(new Date).getTime()-t.startLoadTime,tpindex:1,oid:t.info.order_id}),t.vpaidPlayer.play(),t.show()},n[d.VPAID_EVENT.AdStopped]=function(){t.stop()},n[d.VPAID_EVENT.AdError]=function(){t.stop(),t._emitEvent(d.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:t.info,errorcode:2301})},n[d.VPAID_EVENT.AdClickThru]=function(){t.openLink()},this.vpaidPlayer.loadAd({index:1,preload:!1,adInfo:this.info,events:n,api:this.adplayer.getConf().playerMethod}),void l.hide(this.$ztAd.$pauseAdImg)}if(this.info.getCurMaterial()){var r=this.info.getCurMaterial().url;r&&-1!=r.indexOf("http")?(l.show(this.$ztAd.$pauseAdImg),this.$ztAd.$pauseAdImg.src=r):this.stop()}else this.stop()}},{key:"show",value:function(){this.isShow||(l.show(this.$ztAd.$adName),p=!0,o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"show",this).call(this),this.callOuterApi(d.TXPLAYER_API.RESET_BARRAGE_ZINDEX),this.firstview=parseInt(window.performance.now(),10),this.showTime=(new Date).getTime(),u.log("report",d.REPORT_EVENT.AD_VIEW),this.message.emit(d.REPORT_EVENT.AD_VIEW,{adInfo:this.info}))}},{key:"hide",value:function(){this.isShow&&(l.hide(this.$ztAd.$adName),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"hide",this).call(this))}},{key:"resize",value:function(t){if(!(!t||t.left&&t.top)&&this.info.getCurMaterial()){var e=parseInt(this.info.getCurMaterial().width),i=parseInt(this.info.getCurMaterial().height);if(e>t.width||i>t.height){var n=h.getScale(e,i,t.width,t.height);e*=n,i*=n}if(l.css(this.$ztAd.$adName,{width:e+"px",height:i+"px",top:"0px",left:"0px",right:"0px",bottom:"0px",margin:"auto"}),l.css(this.$ztAd.$pauseAdImg,{width:e+"px",height:i+"px"}),this.info.isRichMedia)try{this.vpaidPlayer.resize(e,i)}catch(o){}}}},{key:"setSmallWindow",value:function(t){t&&this.resize(t)}},{key:"addEvent",value:function(){"N"==this.info.no_click&&this.info.link?(l.css(this.$ztAd.$pauseAdImg,{cursor:"pointer"}),l.on(this.$ztAd.$pauseAdImg,"click",this.onAdImgClick.bind(this))):l.css(this.$ztAd.$pauseAdImg,{cursor:"none"}),l.on(this.$ztAd.$pauseAdClose,"click",this.onAdCloseBtnClick.bind(this)),l.on(this.$ztAd.$pauseAdImg,"load",this.onAdImgLoaded.bind(this)),l.on(this.$ztAd.$pauseAdImg,"error",this.onAdImgError.bind(this))}},{key:"removeEvent",value:function(){l.off(this.$ztAd.$pauseAdImg,"click"),l.off(this.$ztAd.$pauseAdClose,"click"),l.off(this.$ztAd.$pauseAdImg,"load"),l.off(this.$ztAd.$pauseAdImg,"error")}},{key:"onAdImgClick",value:function(t){this.info.link&&"N"==this.info.no_click&&this.openLink("pauseAd")}},{key:"onAdCloseBtnClick",value:function(t){this.closeBtnClicked=!0,this.stop()}},{key:"onAdImgLoaded",value:function(t){this._loadReadyHandler(),this.show(),u.log("report",d.REPORT_EVENT.AD_LOAD_COMPLETE),this._emitEvent(d.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:this.info,adload:(new Date).getTime()-this.startLoadTime,tpindex:1,oid:this.info.order_id})}},{key:"onAdImgError",value:function(t){u.log("report",d.REPORT_EVENT.AD_LOAD_COMPLETE),this._emitEvent(d.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:this.info,errorcode:2301}),this.stop()}},{key:"stop",value:function(){if(this.state!=a.END){if(!this.userClosed&&p){p=!1;var t={adInfo:this.info,adtt:new Date-this.startTime,firstview:this.firstview};this.closeBtnClicked&&(t.adclose=this.info.order_id,t.closetime=(new Date).getTime()-this.showTime,this.userClosed=!0,this.closeBtnClicked=!1),u.log("report",d.REPORT_EVENT.AD_END),this.message.emit(d.REPORT_EVENT.AD_END,t)}this.userClosed=!1,l.removeAttr(this.$ztAd.$pauseAdImg,"src"),this.vpaidPlayer&&(this.vpaidPlayer.stopAd(),this.vpaidPlayer=null),this.hide(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this)}}},{key:"template",value:function(t){return'\n        \x3c!-- \u6682\u505c\u5e7f\u544a\u4f4d\uff1a 400*300 --\x3e\n        <txpdiv data-role="'+t.adName+'" class="txp_ad txp_ad_center" style="position: absolute;z-index: 2;">\n            <button data-role="'+t.pauseAdClose+'" class="txp_btn txp_btn_close txp_btn_close_ad" title="\u5173\u95ed\u5e7f\u544a"></button>\n            <img data-role="'+t.pauseAdImg+'" alt="">\n            <txpdiv style="left:8px;bottom:8px;position:absolute;opacity:0.6;font-size:12px;z-index:99">\n                <txpdiv style="background:#000;display:inline-block;box-shadow:2px 2px #000">\u5e7f\u544a</txpdiv>\n                <txpdiv data-role="'+t.dspName+'" style="display:inline-block;margin-left:10px;text-shadow:2px 2px #000"></txpdiv>\n            </txpdiv>\n            <txpdiv data-role="'+t.vpaidContainer+'"></txpdiv>\n        </txpdiv>\n        '}}]),e}()},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function v(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(n===undefined){var o=Object.getPrototypeOf(t);return null===o?undefined:v(o,e,i)}if("value"in n)return n.value;var r=n.get;return r===undefined?undefined:r.call(i)};var r=i(7),a=i(4),s=i(11),l=i(1),h=l.VPAID_EVENT,d=i(19),u=i(5),c=i(2),p=i(0)("base/ivbAd"),f={adName:"txpad-interact-ivb",imgContainer:"txpad-interact-ivb-imgContainer",ivbAdImg:"txpad-interact-ivb-img",ivbAdClose:"txpad-interact-ivb-close",vpaidContainer:"txpad-interact-ivb-vpaidContainer"};t.exports=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));p.log("new IvbAd"),i.vpaidPlayer=null,i.material=null,i.moveStep=0,i.size={width:1004,height:60,imgWidth:960,closeWidth:40};var n=i.$dom.$interactiveAd.$ivbAd;return n||(n={},i.$dom.$interactiveAd.$ivbAd=n,i.initUI(i.$dom.$interactiveAd,n,f)),i.$ivbAd=n,i.hideContainer(),i.startTime=(new Date).getTime(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r),n(e,[{key:"setVolume",value:function(t){!isNaN(t)&&this.vpaidPlayer&&this.vpaidPlayer.setVolume(t)}},{key:"load",value:function(){var t=this;if(o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"load",this).call(this),this.info&&"new_ivb"==this.info.plugType&&this.info.richData){var i=this;if(this.startLoadTime=(new Date).getTime(),this.isRichMediaJs){var n={adInfo:this.info,playerData:this.dataset,container:this.$ivbAd.$vpaidContainer};this.vpaidPlayer=new s(n);var r={},a=Math.min(100,Math.max(0,this.callOuterApi(l.TXPLAYER_API.GET_VOLUME)));return r[h.AdLoaded]=function(){i._loadReadyHandler(),i._emitEvent(l.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:i.info,adload:(new Date).getTime()-i.startLoadTime,tpindex:1,oid:i.info.order_id}),i.vpaidPlayer.setVolume(a),i.vpaidPlayer.play(),i.show()},r[h.AdStopped]=function(){i.stop()},r[h.AdError]=function(){i.stop(),i._emitEvent(l.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:i.info,errorcode:2301})},r[h.AdClickThru]=function(){i.openLink()},void this.vpaidPlayer.loadAd({index:1,preload:!1,adInfo:this.info,events:r,api:this.adplayer.getConf().playerMethod})}var c=this.info.richData;if("N"==c.plugins.needAdMark)return this._startEndReport(),void this.stop();var f=parseInt(1e3*c.plugins.easeInTime)||5e3,v=parseInt(1e3*c.plugins.easeOutTime)||5e3,y=parseInt(1e3*c.plugins.stayTime);y=isNaN(y)?5e3:y,this.stepTime={1:f,2:v,3:y},this.setPosition({height:"initial",left:"initial",top:"initial"}),this.stepStart={},u.off(this.$ivbAd.$imgContainer,"mouseover"),u.off(this.$ivbAd.$imgContainer,"mouseout"),u.on(this.$ivbAd.$imgContainer,"mouseover",function(){clearTimeout(i.stepTimer),u.css(i.$ivbAd.$imgContainer,{right:i.$ivbAd.$imgContainer.offsetRight}),i.stepTime[i.step]-=new Date-i.stepStart[i.step]}),u.on(this.$ivbAd.$imgContainer,"mouseout",function(){m(i.step,i.stepTime[i.step],!0)});var m=function e(t,n,o){switch(i.step=t,i.stepTimer=null,t){case 0:p.log("ivb move stop",+new Date),i.moveIvb(0,o),i.stop();break;case 1:i.stepStart[i.step]=+new Date,u.css(i.$ivbAd.$imgContainer,{transitionProperty:"right",transitionDuration:n+"ms"}),p.log("ivb move in",+new Date),i.moveIvb(1,o),i.stepTimer=setTimeout(function(){e(2,v)},n+y);break;case 2:i.stepStart[i.step]=+new Date,u.css(i.$ivbAd.$imgContainer,{transitionDuration:n+"ms"}),p.log("ivb move out",+new Date),i.moveIvb(2,o),i.stepTimer=setTimeout(function(){e(0)},n)}};u.off(this.$ivbAd.$ivbAdClose,"click"),u.on(this.$ivbAd.$ivbAdClose,"click",function(){clearTimeout(i.stepTimer),i.recordWisdomPoint("1000000",c.oid,c.loc),i.stop()});var _=c.plugins.res[0].content;_?(this.material=new d({url:_}),this.material.load().then(function(e){t.$ivbAd.$ivbAdImg.src=_,t._loadReadyHandler(),t._emitEvent(l.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:t.info,adload:(new Date).getTime()-t.startLoadTime,tpindex:1,oid:t.info.order_id}),t.addEvent(),t.show(),t.resize({width:t.dataset.playerWidth,height:t.dataset.playerHeight}),t.setIvbBottom(t.callOuterApi(l.TXPLAYER_API.GET_CONTROL_STATUS)),u.css(t.$ivbAd.$imgContainer,{right:-t.dataset.playerWidth+"px"}),m(1,f)})["catch"](function(){t._emitEvent(l.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:t.info,errorcode:2301})})):this.stop()}else this.stop()}},{key:"addEvent",value:function(){var t=this;"N"==this.info.no_click&&this.info.link?(u.css(this.$ivbAd.$ivbAdImg,{cursor:"pointer"}),u.on(this.$ivbAd.$ivbAdImg,"click",function(e){t.openLink()})):u.css(this.$ivbAd.$ivbAdImg,{cursor:"none"})}},{key:"removeEvent",value:function(){u.off(this.$ivbAd.$ivbAdImg,"click")}},{key:"setIvbBottom",value:function(t){t?u.css(this.$ivbAd.$imgContainer,"bottom","50px"):u.css(this.$ivbAd.$imgContainer,"bottom","5px")}},{key:"show",value:function(){this.isShow||this._isSmallWindow||(this.showContainer(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"show",this).call(this),this.callOuterApi(l.TXPLAYER_API.UP_BARRAGE_ZINDEX),this.firstview=parseInt(window.performance.now(),10),this.message.emit(l.REPORT_EVENT.AD_VIEW,{adInfo:this.info}))}},{key:"hide",value:function(){this.isShow&&(this.hideContainer(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"hide",this).call(this),this.callOuterApi(l.TXPLAYER_API.RESET_BARRAGE_ZINDEX),this.message.emit(l.REPORT_EVENT.AD_END,{adInfo:this.info,adtt:new Date-this.startTime,firstview:this.firstview}))}},{key:"showContainer",value:function(){u.show(this.$ivbAd.$adName),this.isRichMediaJs?u.show(this.$ivbAd.$vpaidContainer):u.show(this.$ivbAd.$imgContainer)}},{key:"hideContainer",value:function(){u.hide(this.$ivbAd.$adName),u.hide(this.$ivbAd.$imgContainer),u.hide(this.$ivbAd.$vpaidContainer)}},{key:"_startEndReport",value:function(t){var e=this.info.richData;if(e){var i=this,n=function(t,n){e.plugins[t]&&(n=n||0,setTimeout(function(){i.sendReport(e.plugins[t])},n))};"start"!=t&&t||n("startReportUrl"),"end"==t&&n("endReportUrl"),t||n("endReportUrl",this.stepTime[1]+this.stepTime[2]+this.stepTime[3])}}},{key:"moveIvb",value:function(t,e){this.moveStep=t;switch(t){case 0:u.css(this.$ivbAd.$imgContainer,{left:"0px",right:"0px"}),e||this._startEndReport("end");break;case 1:var i=this.getAdWidth(),n=(this.dataset.playerWidth-i)/2;this.$ivbAd.$imgContainer.style.right=n+"px",e||this._startEndReport("start");break;case 2:n=this.dataset.playerWidth+this.getAdWidth();this.$ivbAd.$imgContainer.style.right=n+"px"}}},{key:"getAdWidth",value:function(){return this.getElWidth(this.$ivbAd.$imgContainer)}},{key:"getElWidth",value:function(t){return t?t.clientWidth||t.offsetWidth:0}},{key:"stop",value:function(){this.state!=a.END&&(this.hide(),this.$ivbAd.$ivbAdImg&&u.removeAttr(this.$ivbAd.$ivbAdImg,"src"),this.material&&(this.material.destroy(),this.material=null),this.isRichMediaJs&&this._callVpaidFunc("stopAd"),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this))}},{key:"_callVpaidFunc",value:function(t){if(this.vpaidPlayer&&"function"==typeof this.vpaidPlayer[t]){var e=Array.prototype.slice.call(arguments);e.shift(),this.vpaidPlayer[t].apply(this.vpaidPlayer,e)}}},{key:"sendReport",value:function(t,e){this.randomParam();var i=new Image;i.onload=i.onerror=function(){e&&e()},i.src=t}},{key:"randomParam",value:function(){return+new Date+".r"+Math.floor(1e3*Math.random())}},{key:"fixUrl",value:function(t,e){return 0==t.indexOf("http")?t.replace(/^http(s)?:/,e):0==t.indexOf("//")?e+t:e+"//"+t}},{key:"getUrl",value:function(t,e){return e?this.fixUrl(t,e+":"):0==location.protocol.indexOf("http")?this.fixUrl(t,location.protocol):this.fixUrl(t,"https:")}},{key:"recordWisdomPoint",value:function(t,e,i,n){var o="//p.l.qq.com?t=s&actid="+t+"&mid="+e+"&oid="+e+"&locid="+(i=i||"")+"&aver="+(n=n||"");this.sendReport(this.getUrl(o))}},{key:"setPosition",value:function(t){this.isRichMediaJs?this._callVpaidFunc("setPos",t):u.css(this.$ivbAd.$imgContainer,t)}},{key:"resize",value:function(t){if(!(!t||t.left&&t.top))if(this.isRichMediaJs)this._callVpaidFunc("resize",t.width,t.height);else{var e=c.getScale(this.size.width,this.size.height,t.width/2,t.height),i=function(t,e,i){return{width:t*i,height:e*i}};u.css(this.$ivbAd.$ivbAdImg,i(this.size.imgWidth,this.size.height,e)),u.css(this.$ivbAd.$ivbAdClose,i(this.size.closeWidth,this.size.height,e));var n=this.getElWidth(this.$ivbAd.$ivbAdImg)+this.getElWidth(this.$ivbAd.$ivbAdClose);u.css(this.$ivbAd.$imgContainer,{width:n})}}},{key:"setSmallWindow",value:function(t){t&&(o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setSmallWindow",this).call(this,t),this._isSmallWindow&&this.hide(),p.log("ivbAd setSmallWindow, ",t.toString()))}},{key:"template",value:function(t){return'\n        \n        <txpdiv data-role="'+t.adName+'" class="txp_ad _txp_ad_ivb">\n            <style>\n                .mod_player_float ._txp_ad_ivb {\n                    display: none;\n                }\n            </style>\n            \x3c!-- \u5e95\u90e8\u5e7f\u544a\u4f4d\uff1a 960*60 --\x3e\n            <txpdiv data-role="'+t.imgContainer+'" style="position: absolute;z-index: 1;margin: 0;white-space: nowrap;cursor: pointer;pointer-events: auto;">\n                <img data-role="'+t.ivbAdImg+'" alt="" style="margin: 0; max-width: initial;display: inline;">\n                <img data-role="'+t.ivbAdClose+'" src="https://ca.gtimg.com/adplugin/js/imgs/ivbclose.png"\n                style="width: 40px;height: 58px;display: inline;border: none" title="\u5173\u95ed\u5e7f\u544a">\n            </txpdiv>\n            \x3c!-- \u5bcc\u5a92\u4f53 --\x3e\n            <txpdiv data-role="'+t.vpaidContainer+'"></txpdiv>\n        </txpdiv>\n        '}},{key:"isRichMediaJs",get:function(){return this.info&&"richMediaJs"==this.info.richType}}]),e}()},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function y(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(n===undefined){var o=Object.getPrototypeOf(t);return null===o?undefined:y(o,e,i)}if("value"in n)return n.value;var r=n.get;return r===undefined?undefined:r.call(i)};var r=i(7),a=i(4),s=i(1),l=i(5),h=i(20),d=i(0)("base/flowAd"),u=i(78),c=i(8).Promise,p={adName:"txpad-interact-flow"},f=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return d.log("new FlowAd"),i.isShowingCidArr=[],i.hasReportCids={},i.yaliuRenderTimers={},i.yaliuFodderStart={},i.isPsjPausing=!1,i.hasResizedCidArr=[],i.$video=document.createElement("video"),i.$video.muted=!0,i.yaliuAd=null,i.playerSize={playerWidth:i.dataset.playerOWidth||i.dataset.playerWidth,playerHeight:i.dataset.playerOHeight||i.dataset.playerHeight,playerLeft:i.dataset.playerLeft||0,playerTop:i.dataset.playerTop||0},i._isForceHide=!1,i.firstStartTime=-1,i.adFlag=0,i.init(),h().then(function(t){i.adFlag=t.PSJ})["catch"](function(){}),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r),n(e,[{key:"init",value:function(){var t=this.$dom.$interactiveAd.$flowAd;t||(t={},this.$dom.$interactiveAd.$flowAd=t,this.initUI(this.$dom.$interactiveAd,t,p)),this.$flowAd=t,l.hide(this.$flowAd.$adName),this.initTime=+new Date,this._renderUI()}},{key:"_renderUI",value:function(){var t=this,e=this.$flowAd.$adName,i="yaliuad-"+this.info.creId,n="yaliu-video-"+this.info.creId;if(this.yaliuAd=e.querySelector("[data-role="+i+"]"),!this.yaliuAd){var o={yaliuAdId:i,videoId:n,adFlag:this.adFlag},r=document.createElement("div");r.innerHTML=this.canvasTemplate(o),e.appendChild(r.children[0]),l.show(e),this.yaliuAd=e.querySelector("[data-role="+i+"]"),this.yaliuAd.appendChild(this.$video),this.yaliuAdFlag=e.querySelector('[data-role="yaliuadflag"]')}var a=this.info.getCurMaterial().width,s=this.info.getCurMaterial().height;this.info.anchor&&(this.info.anchor.pos_w=a/2/1920,this.info.anchor.pos_h=s/1080);var h=this.playerSize.playerWidth*this.info.anchor.pos_w,d=this.yaliuadWidth=Math.floor(h)%2==0?Math.floor(h):Math.ceil(h),u=this.yaliuadHeight=this.playerSize.playerHeight*this.info.anchor.pos_h,c=this.playerSize.playerWidth*this.info.anchor.pos_x+this.playerSize.playerLeft,p=this.playerSize.playerHeight*this.info.anchor.pos_y+this.playerSize.playerTop,f=(this.$video,{position:"absolute",left:c+"px",top:p+"px",width:d+"px",height:u+"px"});this.yaliuAd.style.cssText=v(f),"N"==this.info.no_click&&this.info.link?(this.yaliuAd.style.cursor="pointer",this.yaliuAd.style.pointerEvents="auto",l.off(this.yaliuAd,"click"),l.on(this.yaliuAd,"click",function(e){t.openLink()})):(this.yaliuAd.style.cursor="auto",this.yaliuAd.style.pointerEvents="none"),this.hasReportCids[this.info.creId]&&this.scene.isWholeScene||(this.hasReportCids[this.info.creId]=!0)}},{key:"show",value:function(t){var i=this;t&&(this._isForceHide=!1,this.psjFrame&&this.psjFrame.startRender(),this.scene.isWholeScene&&setTimeout(function(){i.message.emit(s.TXPLAYER_EVENT.AD_SHOW,{adtype:i.adtype}),i.message.emit(s.TXPLAYER_EVENT.AD_MOVE_IN)},200)),this.isShow||(this.yaliuAd&&l.show(this.yaliuAd),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"show",this).call(this),this.firstview=parseInt(window.performance.now(),10),this.playTime=+new Date,t||this.message.emit(s.REPORT_EVENT.AD_VIEW,{adInfo:this.info,scene:this.scene}),this.callOuterApi(s.TXPLAYER_API.UP_BARRAGE_ZINDEX))}},{key:"hide",value:function(t){t&&(this._isForceHide=!0,this.psjFrame&&this.psjFrame.stopRender(),this.scene.isWholeScene&&this.message.emit(s.TXPLAYER_EVENT.AD_MOVE_OUT)),this.isShow&&(o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"hide",this).call(this),this.yaliuAd&&l.hide(this.yaliuAd),this.callOuterApi(s.TXPLAYER_API.RESET_BARRAGE_ZINDEX))}},{key:"superLoad",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"load",this).call(this)}},{key:"load",value:function(){if(this.info&&this.info.getCurMaterial()&&this.scene){var t=this;this._requestMP4(this.info.getCurMaterial().url).then(function(e){t.psjFrame=new u(t.$video,{url:e,fps:20,start:"manual",end:t.scene.isWholeScene?"loop":"once",videoWidth:2*t.yaliuadWidth,videoHeight:t.yaliuadHeight,playerWidth:t.playerSize.playerWidth,playerHeight:t.playerSize.playerHeight,videoStyles:{position:"absolute","background-color":"rgb(255, 255, 255)",visibility:"hidden"},interval:parseInt(t.info.anchor.interval||0),onPlaying:function(){"1"==t.adFlag&&t._toggleAdFlag(!0)},onEnd:function(){setTimeout(t.removeShowCid.bind(t),t.info.anchor.interval,t.info.creId),"1"==t.adFlag&&t._toggleAdFlag(!1)}}),t._loadReadyHandler({adtype:t.info.adtype,cid:t.info.creId}),t.loadTime=+new Date-t.initTime,t.message.emit(s.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:t.info,adload:t.loadTime,tpindex:t.info.orderIdx,oid:t.info.order_id}),t.superLoad()})["catch"](function(e){"error"==e&&t.message.emit(s.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:t.info,errorcode:"2301"})}),this.yaliuFodderStart[this.info.creId]=(new Date).getTime()}else this.stop()}},{key:"play",value:function(){if(this.firstStartTime<0){var t=this.dataset.playtime-this.scene.getStartSec();this.firstStartTime=t,t>0&&(this.scene.isWholeScene?this.$video.currentTime=.1:this.$video.currentTime=t)}d.log("psj play: ",this.$video.currentTime),this._isForceHide||this.isPsjPausing&&this.adplayer.dataset.playerIsPausing||(o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"play",this).call(this),this.info&&this.scene?(this.isPsjPausing&&(this.psjFrame&&this.psjFrame.startRender(),this.isPsjPausing=!1),this.isShowingCidArr.indexOf(this.info.creId)>-1||(this.psjFrame&&this.psjFrame.startRender(),this.isShowingCidArr.push(this.info.creId),this._isShow||this.show())):this.stop())}},{key:"_requestMP4",value:function(t){0==t.indexOf("http://")&&(t=location.protocol+"//"+t.split("http://")[1]);var e=new XMLHttpRequest;return e.open("GET",t,!0),e.responseType="arraybuffer",e.timeout="6000",e.send(),new c(function(t,i){e.onload=function(){if(200===e.status){var n=new Uint8Array(e.response),o=window.URL.createObjectURL(new Blob([n],{type:"video/mp4"}));t(o)}else i()},e.onerror=function(){i("error")},e.ontimeout=function(){i("timeout")}})}},{key:"setYaliuSize",value:function(){var t=this.info.creId;if(this.lastPlayerClientWidth!=this.playerSize.playerWidth||this.lastPlayerClientHeight!=this.playerSize.playerHeight||this.lastPlayerClientWidth==this.playerSize.playerWidth&&this.lastPlayerClientHeight==this.playerSize.playerHeight&&-1==this.hasResizedCidArr.indexOf(t)){var e=this.playerSize.playerWidth*this.info.anchor.pos_w,i=this.yaliuadWidth=Math.floor(e)%2==0?Math.floor(e):Math.ceil(e),n=this.yaliuadHeight=this.playerSize.playerHeight*this.info.anchor.pos_h,o={position:"absolute",left:this.playerSize.playerWidth*this.info.anchor.pos_x+this.playerSize.playerLeft+"px",top:this.playerSize.playerHeight*this.info.anchor.pos_y+this.playerSize.playerTop+"px",width:i+"px",height:n+"px"};if("N"==this.info.no_click&&this.info.link?(o.cursor="pointer",o["pointer-events"]="auto"):(o.cursor="auto",o["pointer-events"]="none"),this.yaliuAd.style.cssText=v(o),this.psjFrame){var r=this.playerSize.playerHeight/this.playerSize.playerWidth;this.psjFrame.resize(2*i,n,r,this.isPsjPausing)}this.lastPlayerClientWidth=this.playerSize.playerWidth,this.lastPlayerClientHeight=this.playerSize.playerHeight,this.hasResizedCidArr.push(t)}}},{key:"resize",value:function(t){this.hasResizedCidArr.length=0,t&&(this.playerSize.playerWidth=t.oWidth||t.width,this.playerSize.playerHeight=t.oHeight||t.height,this.playerSize.playerLeft=t.left||0,this.playerSize.playerTop=t.top||0,this.setYaliuSize()),!this._isForceHide&&this.yaliuAd&&l.show(this.yaliuAd)}},{key:"setSmallWindow",value:function(t){}},{key:"hideAdBeforeResize",value:function(){this.yaliuAd&&l.hide(this.yaliuAd)}},{key:"pause",value:function(){this.isPsjPausing=!0,this.psjFrame&&this.psjFrame.stopRender()}},{key:"stop",value:function(){if(this.state!=a.END){this._isForceHide=!1,this.hide(),this.removeShowCid(this.info.creId),this.psjFrame&&this.psjFrame.clearAll(),this.yaliuAd&&this.yaliuAd.parentNode&&this.yaliuAd.parentNode.removeChild(this.yaliuAd),this.firstStartTime=-1;var t=this.$flowAd.$adName;t.children&&0!=t.children.length||l.hide(t),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this),this.message.emit(s.REPORT_EVENT.AD_END,{adfbt:self.loadTime,adtt:+new Date-this.initTime,firstview:this.firstview,adInfo:this.info})}}},{key:"removeShowCid",value:function(t){if(this.isShowingCidArr){var e=this.isShowingCidArr.indexOf(t);e>-1&&this.isShowingCidArr.splice(e,1)}}},{key:"canvasTemplate",value:function(t){return'\n        <txpdiv data-role="'+t.yaliuAdId+'" style="position: absolute;">\n            <span data-role="yaliuadflag" class="txp_none" style="position: absolute;left: 0;bottom: 0;opacity: .8;line-height: 1;font-size: 12px;transform: scale(.7);z-index: 1;">\u5e7f\u544a</span>\n        </txpdiv>\n        '}},{key:"template",value:function(t){return'\n        <txpdiv>\n            <style>\n                .mod_player_float ._txp_ad_psj {\n                    display: none;\n                }\n            </style>\n            <txpdiv data-role="'+t.adName+'" class="txp_ad _txp_ad_psj" style="position: absolute; z-index: 2;">\n                \x3c!-- \u538b\u6d41\u5c55\u793acanvas --\x3e\n            </txpdiv>\n        </txpdiv>\n        '}},{key:"_toggleAdFlag",value:function(t){t?l.show(this.yaliuAdFlag):l.hide(this.yaliuAdFlag)}}]),e}();function v(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i+": "+t[i]+";");return e.join("")}t.exports=f},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:10,i=arguments[1];o(this,t),this.now=0,this.afternow=0,this.delta=0,this.fps=e,this.interval=1e3/e,this.callback=i,this.timecount=0,this._running=!1,this.requestAnimationFrame=window.requestAnimationFrame||function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length;i++)if(window[e[i]+"RequestAnimationFrame"])return window[e[i]+"RequestAnimationFrame"];return function(e){var i=(new Date).getTime(),n=Math.max(0,16.7-(i-t)),o=window.setTimeout(function(){e(i+n)},n);return t=i+n,o}}(),this.cancelAnimationFrame=window.cancelAnimationFrame||function(){for(var t=["ms","moz","webkit","o"],e=0;e<t.length;e++){if(window[t[e]+"CancelAnimationFrame"])return window[t[e]+"CancelAnimationFrame"];if(window[t[e]+"CancelRequestAnimationFrame"])return window[t[e]+"CancelRequestAnimationFrame"]}return function(t){clearTimeout(t)}}()}return n(t,[{key:"start",value:function(){this._running||(this._running=!0,this.afternow=Date.now(),this._timeupdate())}},{key:"_timeupdate",value:function(){this.now=Date.now(),this.delta=this.now-this.afternow,this.delta>this.interval&&(this.afternow=this.now-this.delta%this.interval,this.callback()),this.timecount=this.requestAnimationFrame.call(window,this._timeupdate.bind(this))}},{key:"stop",value:function(){this._running&&(this._running=!1),this.cancelAnimationFrame.call(window,this.timecount),this.timecount=0,this.now=0,this.delta=0,this.afternow=0}},{key:"running",get:function(){return this._running}}]),t}();var a={url:"",start:"autoplay",end:"once",canche:!1,fps:16,videoWidth:0,videoHeight:0,videoStyles:{position:"absolute","background-color":"rgb(255, 255, 255)",visibility:"hidden"},interval:0,onPlaying:function(){},onEnd:function(){}},s=function(){function t(e,i){o(this,t),this.options=this._setOptions(i),this.mytimer=null,this.isRendering=!1,this.$video=e,this.initWidth=0,this.initHeight=0,this.videoWidth=0,this.videoHeight=0,this.lastDisplayWidth=0,this.lastDisplayHeight=0,this.cacheData=[],this.isUpdateUI=!1,this.hasPlayedThrough=!1,this.index=0,this.firstPlay=!0,this.hasBeenPaused=!1,this.doRecord=!0,this.videoPromise=null,this._initVideo(),this._initUI()}return n(t,[{key:"_setOptions",value:function(t){for(var e in a)a.hasOwnProperty(e)&&(e in t||(t[e]=a[e]));return t}},{key:"_initVideo",value:function(){if(this.$video){if("VIDEO"!==this.$video.tagName)throw new Error("Not a video Element");if(!this.$video.src&&!this.options.url)throw new Error("Has no video url");this.$video.autoplay="autoplay"===this.options.start,this.$video.controls=!1,this.$video.crossOrigin="*",this.$video.style.cssText=h(this.options.videoStyles),this._initVideoEvent(),this.$video.src&&this.$video.src!==this.$video.baseURI||(this.$video.src=this.options.url)}}},{key:"_initVideoEvent",value:function(){this.$video.readyState>0?e():this.$video.addEventListener("loadedmetadata",function(){e()});var t=this;function e(){t.$video.addEventListener("playing",t.__onVideoPlaying.bind(t)),t.$video.addEventListener("pause",t.__onVideoPause.bind(t)),t.$video.addEventListener("ended",t.__onVideoEnded.bind(t))}}},{key:"_initUI",value:function(){this.$video&&(this.bufferCanvas=document.createElement("canvas"),this.bufferContext=this.bufferCanvas.getContext("2d"),this.displayCanvas=document.createElement("canvas"),this.displayContext=this.displayCanvas.getContext("2d"),l(this.bufferCanvas,this.$video),l(this.displayCanvas,this.$video),"click"===this.options.start&&(this._getPoster(),this._initUiEvent()),this.mytimer=new r(this.options.fps,this._timeUpdate.bind(this)))}},{key:"startRender",value:function(){if(this.mytimer&&(this.cacheData.length>0&&this.index>=this.cacheData.length&&(this.index=0),this.isRendering||(this.isRendering=!0,this.isUpdateUI||this._updateUI()),this.mytimer.running||this.mytimer.start(),this.$video&&(!this.doRecord||this.$video.paused&&(!this.hasPlayedThrough||!this.options.canche)))){var t=this.$video.play();t&&t.then&&(this.videoPromise=t)}}},{key:"_updateUI",value:function(t){t||(this.options.playerHeight/this.options.playerWidth>=this.hwRate?(this.videoWidth=this.videoWidth||this.options.videoWidth,this.videoHeight=this.hwRate?this.videoWidth*this.hwRate:this.videoHeight||this.options.videoHeight):(this.videoHeight=this.videoHeight||this.options.videoHeight,this.videoWidth=d(this.hwRate?this.videoHeight/this.hwRate:this.videoWidth||this.options.videoWidth)));this.isUpdateUI=!0,this.bufferCanvas.setAttribute("width",this.videoWidth),this.bufferCanvas.setAttribute("height",this.videoHeight),this.bufferCanvas.style.cssText=h({display:"none"});var e=this.displayCanvas;e.setAttribute("width",this.videoWidth/2),e.setAttribute("height",this.videoHeight);var i={position:"absolute",left:0,bottom:0,width:this.videoWidth/2+"px",height:this.videoHeight+"px",display:"block"};e.style.cssText=h(i)}},{key:"_resetDisplayCanvas",value:function(t,e){if(Math.floor(this.lastDisplayWidth)!==Math.floor(t)||Math.floor(this.lastDisplayHeight)!==Math.floor(e)){t=Math.floor(t),e=Math.floor(e),this.lastDisplayWidth=t,this.lastDisplayHeight=e;var i=this.displayCanvas;i.setAttribute("width",t),i.setAttribute("height",e);i.style.cssText=h({position:"absolute",left:0,bottom:0,display:"block"})}}},{key:"_scaleDisplayCanvas",value:function(t,e){t=Math.floor(t),e=Math.floor(e);var i=t/this.lastDisplayWidth,n=e/this.lastDisplayHeight,o=n>i?i:n,r={position:"absolute",left:0,bottom:0,transform:"scale("+o+","+o+")",display:"block"};this.displayCanvas.style.cssText=h(r)}},{key:"stopRender",value:function(t){var e=this;this.isRendering=!1,!0===this.mytimer.running&&this.mytimer.stop(),!this.$video||this.hasPlayedThrough&&this.options.canche||(t?this.$video.currentTime=0:this.videoPromise?this.videoPromise.then(function(){e.$video&&e.$video.pause()}):this.$video.pause()),this.$video&&this.$video.currentTime||this.index>0&&this.index<this.cacheData.length||(this.displayContext&&this.displayContext.clearRect(0,0,this.videoWidth/2,this.videoHeight),"function"==typeof this.options.onEnd&&this.options.onEnd())}},{key:"resize",value:function(t,e,i,n){i>=this.hwRate?(this.videoWidth=t,this.videoHeight=this.hwRate?t*this.hwRate:e):(this.videoHeight=e,this.videoWidth=d(this.hwRate?e/this.hwRate:t)),this._updateUI(!0),this.$video.currentTime&&this._getVideoFrame()}},{key:"clearAll",value:function(){this.stopRender(),this.$video&&this._destroyVideo(),"click"===this.options.start&&this._removeUiEvent(),this.cacheData.length>0&&this.cacheData.splice(0,this.cacheData.length),this.index=0,this.hasPlayedThrough=!1}},{key:"_timeUpdate",value:function(){if(this.isRendering&&this.mytimer.running){var t=void 0,e=new Image;this.hasPlayedThrough&&this.options.canche?(this.index>=this.cacheData.length&&("loop"===this.options.end?this.index=0:this.isRendering&&this.stopRender()),this.index<this.cacheData.length&&(e.onload||(e.onload=function(){this._resetDisplayCanvas(e.width,e.height),this.displayContext.clearRect(0,0,e.width,e.height),this.displayContext.drawImage(e,0,0),this._scaleDisplayCanvas(this.videoWidth/2,this.videoHeight),this.index++}),t=this.cacheData[this.index],e.src=t)):(this._getVideoFrame(),this.options.canche&&(t=this.displayCanvas.toDataURL(),this.cacheData.push(t)))}}},{key:"_getVideoFrame",value:function(){try{this.bufferContext.drawImage(this.$video,0,0,this.videoWidth,this.videoHeight);for(var t=this.bufferContext.getImageData(this.videoWidth/2,0,this.videoWidth/2,this.videoHeight),e=this.bufferContext.getImageData(0,0,this.videoWidth/2,this.videoHeight),i=e.data.length/4,n=0;n<i;n++)e.data[4*n+3]=t.data[4*n+1];this.displayContext.putImageData(e,0,0)}catch(o){}}},{key:"_destroyVideo",value:function(){this._removeVideoEvent(),this.$video.removeAttribute("src"),this.$video.parentNode&&this.$video.parentNode.removeChild(this.$video),this.$video=null}},{key:"_removeVideoEvent",value:function(){this.$video.removeEventListener("playing",this.__onVideoPlaying),this.$video.removeEventListener("ended",this.__onVideoEnded)}},{key:"__onVideoPlaying",value:function(){this.hwRate||(this.hwRate=this.$video.clientHeight/this.$video.clientWidth,this._updateUI()),this.firstPlay?(this.hasBeenPaused||this.$video.currentTime>300&&(this.doRecord=!1),this.firstPlay=!1):this.doRecord=!0,this.startRender(),"function"==typeof this.options.onPlaying&&this.options.onPlaying()}},{key:"__onVideoPause",value:function(){this.hasBeenPaused=!0}},{key:"__onVideoEnded",value:function(){if((!this.doRecord||this.options.canche&&this.$video.currentTime<this.$video.duration)&&!this.hasPlayedThrough&&this.cacheData.length>0&&this.cacheData.splice(0,this.cacheData.length),"loop"==this.options.end){if(this.options.interval)return this.$video.currentTime=0,void this.stopRender(!0);if(this.options.canche){if(!this.doRecord)return this.$video.currentTime=0,void this.$video.play();this.hasPlayedThrough=!0,this._destroyVideo(),this.startRender()}else this.$video.currentTime=0,this.$video.play()}else{if(!this.doRecord)return this.$video.currentTime=0,void this.stopRender(!0);this.hasPlayedThrough=!0,this.options.canche&&this._destroyVideo(),this.stopRender(!0)}}},{key:"_getPoster",value:function(){}},{key:"_initUiEvent",value:function(){this.displayCanvas.addEventListener("click",this.__onCanvasClick)}},{key:"__onCanvasClick",value:function(){this.isRendering?this.stopRender():this.startRender()}},{key:"_removeUiEvent",value:function(){this.displayCanvas.removeEventListener("click",this.__onCanvasClick)}}]),t}();function l(t,e){e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)}function h(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i+": "+t[i]+";");return e.join("")}function d(t){return Math.floor(t)%2==0?Math.floor(t):Math.ceil(t)}t.exports=s},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function p(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(n===undefined){var o=Object.getPrototypeOf(t);return null===o?undefined:p(o,e,i)}if("value"in n)return n.value;var r=n.get;return r===undefined?undefined:r.call(i)};var r=i(0)("base/buyAd"),a=i(5),s=i(2),l=i(7),h=i(4),d=i(1),u={adName:"txpad-interact-buy",title:"txpad-interact-buy-title",image:"txpad-interact-buy-image",closeButton:"txpad-interact-buy-close-btn",actionButton:"txpad-interact-buy-action-btn",imageButton:"txpad-interact-buy-image-btn"},c=i(9);t.exports=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));r.log("new BuyAd"),i._name="buyAd";var n=i.$dom.$interactiveAd.$buyAd;return n||(n={},i.$dom.$interactiveAd.$buyAd=n,i.initUI(i.$dom.$interactiveAd,n,u)),i.$buyAd=n,a.hide(i.$buyAd.$adName),i.startTime=(new Date).getTime(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,l),n(e,[{key:"load",value:function(){var t=this;if(o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"load",this).call(this),this.startLoadTime=(new Date).getTime(),this.info&&this.info.watchBuyData){this._loadReadyHandler();var i=this.info.watchBuyData.pic||"//i.gtimg.cn/qqlive/images/20170920/txp_interact_default_img.png";this.$buyAd.$image.onload=function(e){r.log("report",d.REPORT_EVENT.AD_LOAD_COMPLETE),t._emitEvent(d.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:t.info,adload:(new Date).getTime()-t.startLoadTime,tpindex:1,oid:t.info.order_id})},this.$buyAd.$image.onerror=function(e){r.log("report",d.REPORT_EVENT.AD_LOAD_COMPLETE),t._emitEvent(d.REPORT_EVENT.AD_LOAD_COMPLETE,{adInfo:t.info,errorcode:2301})},this.$buyAd.$image.src=i,a.text(this.$buyAd.$title,this.info.watchBuyData.title||""),a.text(this.$buyAd.$actionButton,this.info.watchBuyData.btn||"\u70b9\u51fb\u524d\u5f80"),this.show(),this.addEvent(),this.callPage("show");var n=this;this.createElementTimeoutHandler=setTimeout(function(){n.stop(),n.callPage("close")},this.info.duration)}else this.stop()}},{key:"show",value:function(){this.isShow||this._isSmallWindow||(a.show(this.$buyAd.$adName),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"show",this).call(this))}},{key:"hide",value:function(){this.isShow&&(a.hide(this.$buyAd.$adName),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"hide",this).call(this))}},{key:"addEvent",value:function(){a.on(this.$buyAd.$imageButton,"click",this.imageBtnClicked.bind(this)),a.on(this.$buyAd.$title,"click",this.titleClicked.bind(this)),a.on(this.$buyAd.$closeButton,"click",this.closeBtnClicked.bind(this)),a.on(this.$buyAd.$actionButton,"click",this.actionBtnClicked.bind(this))}},{key:"removeEvent",value:function(){a.off(this.$buyAd.$title,"click"),a.off(this.$buyAd.$closeButton,"click"),a.off(this.$buyAd.$actionButton,"click"),a.off(this.$buyAd.$imageButton,"click")}},{key:"setSmallWindow",value:function(t){t&&(o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setSmallWindow",this).call(this,t),this._isSmallWindow&&this.hide())}},{key:"stop",value:function(){this.state!=h.END&&(clearTimeout(this.createElementTimeoutHandler),this.createElementTimeoutHandler=null,a.removeAttr(this.$buyAd.$image,"src"),this.hide(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this))}},{key:"imageBtnClicked",value:function(){this.stop(),this.callPage("click")}},{key:"titleClicked",value:function(){this.stop(),this.callPage("click")}},{key:"closeBtnClicked",value:function(){this.stop(),this.callPage("close")}},{key:"actionBtnClicked",value:function(){if(this.info&&this.info.link){var t=this.adplayer.getConf(),e=t&&t.playerData&&t.playerData.playerPfEx||"",i=s.appendParamsToUrl(this.info.link,{pf_ex:e||"",appversion:c});window.open(i)}}},{key:"callPage",value:function(t){if("show"==t&&(this.firstview=parseInt(window.performance.now(),10),r.log("report",d.REPORT_EVENT.AD_VIEW),this.message.emit(d.REPORT_EVENT.AD_VIEW,{adInfo:this.info})),"click"==t&&(r.log("report",d.REPORT_EVENT.AD_CLICK),this.message.emit(d.REPORT_EVENT.AD_CLICK,{adInfo:this.info,adclick:this.info.link?this.info.order_id:"",clicktime:+new Date,scene:this.scene})),"click"==t||"close"==t){r.log("report",d.REPORT_EVENT.AD_END);var e={adInfo:this.info,adtt:(new Date).getTime()-this.startTime,firstview:this.firstview};"close"===t&&(e.adclose=this.info.order_id,e.closetime=(new Date).getTime()-this.showTime),this.message.emit(d.REPORT_EVENT.AD_END,e)}if("function"==typeof window.__tenvideo_setPlayerAction){var i={cmd:7,action:t,watch:{params:{watch_buy:this.info.watchBuyData}}};window.__tenvideo_setPlayerAction(i)}}},{key:"template",value:function(t){return'\n        <txpdiv class="txp_interact _txp_ad_bs" data-role="'+t.adName+'" style="pointer-events: auto;z-index: 3;">\n            <style>\n                .mod_player_float ._txp_ad_bs {\n                    display: none;\n                }\n            </style>\n            <button class="txp_btn txp_btn_close" title="\u5173\u95ed" data-role="'+t.closeButton+'"></button>\n            <txpdiv class="txp_interact_img_goods" data-role="'+t.imageButton+'">\n                <img data-role="'+t.image+'">\n            </txpdiv>\n            <txpdiv class="txp_interact_content">\n                <txpdiv class="txp_interact_head">\n                    <txpdiv class="txp_interact_title" data-role="'+t.title+'"></txpdiv>\n                </txpdiv>\n                <txpdiv class="txp_btn_interact" data-role="'+t.actionButton+'"></txpdiv>\n            </txpdiv>\n        </txpdiv>\n        '}}]),e}()},function(t,e,i){"use strict";var n=function c(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(n===undefined){var o=Object.getPrototypeOf(t);return null===o?undefined:c(o,e,i)}if("value"in n)return n.value;var r=n.get;return r===undefined?undefined:r.call(i)},o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=i(7),s=i(4),l=i(1),h=(i(5),i(0)("base/czcAd")),d=function(){function t(){r(this,t),this.timecount=0,this.running=!1,this.counter=null}return o(t,[{key:"start",value:function(){var t=this;this.running||(this.running=!0,this.counter=setInterval(function(){t.timecount+=100},100))}},{key:"stop",value:function(){this.running&&(this.running=!1),clearInterval(this.counter),this.counter=null}},{key:"clear",value:function(){this.counter&&(clearInterval(this.counter),this.counter=null),this.running=!1,this.timecount=0}},{key:"time",get:function(){return this.timecount}}]),t}(),u=function(t){function e(t){r(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return h.log("new RzcAd"),i.isFilmPausing=!1,i.filmPauseTime=0,i.conf=t.adplayer.getConf(),i.duringFlag=!1,i.mindPoint=null,i.hasDragged=!1,i.focusMonitor=null,i.reportPoins=[],i.init(),i.focusFlag=i.isInFocus()&&i.isInView(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),o(e,[{key:"init",value:function(){this.initTime=+new Date,this._initReportPoints(),this._initMindPoint(),this._initDuringReport(),this._initIntervalTimer()}},{key:"_initDuringReport",value:function(){var t=this.info,e=t._curCreative&&t._curCreative.creport&&t._curCreative.creport.dreport||{},i=this.scene.getStartSec(),n=this.scene.getEndSec();if(this.report_begin=this.info.reportBegin&&.001*this.info.reportBegin||"",this.report_end=this.info.reportEnd&&.001*this.info.reportEnd||"",e.reportitem&&e.reportitem.length){var o=e.reportitem;this.report_begin||(this.report_begin=.001*o[0].report_begin,this.report_begin<i&&(this.report_begin=i)),this.report_end||(this.report_end=.001*o[0].report_end,this.report_end>n&&(this.report_end=n))}}},{key:"_initIntervalTimer",value:function(){this.intervalTimer||(this.intervalTimer=new d)}},{key:"_initReportPoints",value:function(){var t=this,e=this.info,i=e._curCreative&&e._curCreative.creport||{},n=this.scene.getStartSec();"1"!=this.info.reportRange&&this.reportPoins.push({url:e.reportUrl,time:parseInt(.001*(parseInt(e.reportTime,10)||1e3)+n,10)}),["reportUrlOther"].forEach(function(i){e[i].reportitem.forEach(function(e){e.url&&t.reportPoins.push({url:e.url,time:parseInt(.001*(parseInt(e.reporttime,10)||1e3)+n,10),isOther:!0})})}),["reportUrlOther"].forEach(function(e){var o=i[e];o&&o.reportitem&&o.reportitem.forEach(function(e){e.url&&t.reportPoins.push({url:e.url,time:parseInt(.001*(parseInt(e.reporttime,10)||1e3)+n,10),isOther:!0})})})}},{key:"show",value:function(t){this.isShow||n(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"show",this).call(this)}},{key:"hide",value:function(t){this.isShow&&n(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"hide",this).call(this)}},{key:"load",value:function(){n(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"load",this).call(this),this._loadReadyHandler(),this.info&&this.info.getCurMaterial()&&this.scene||this.stop()}},{key:"play",value:function(){var t=this;if(n(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"play",this).call(this),this.info&&this.scene){if(this.isFilmPausing&&(this.isFilmPausing=!1),this._isShow||this.show(),this.intervalTimer.running||!this.focusFlag||this.isFilmPausing||this.intervalTimer.start(),this.focusMonitor||(this.focusMonitor=setInterval(function(){t.isInFocus()&&t.isInView()?(t.focusFlag||(t.focusFlag=!0),!t.intervalTimer||t.intervalTimer.running||t.isFilmPausing||t.intervalTimer.start()):(t.focusFlag&&(t.focusFlag=!1),t.intervalTimer&&t.intervalTimer.running&&t.intervalTimer.stop())},1e3)),this.mindPoint){var i=this.mindPoint,o=this.dataset.playtime,r=[1000003,1000004,1000005,1000006,1000007];[i.startTime+1,i.one,i.two,i.three,i.endTime-1].forEach(function(e,i){o==e&&t.message.emit(l.REPORT_EVENT.AD_MIND_CZC,{actid:r[i],orderId:t.info.order_id,locId:t.info.locId||t.info.extParams.loc||"",creative_id:t.info._cre_id,pf:t.conf.playerData.playerPf,extra:{t:o}})})}var a=this.info;if(this.reportPoins.length){var s=this.dataset.playtime;this.reportPoins.forEach(function(e){s==e.time&&(e.isOther?t.message.emit(l.REPORT_EVENT.AD_3PARTY_VIEW,{time:0,url:e.url}):t.message.emit(l.REPORT_EVENT.AD_POINT_VIEW,{time:0,url:e.url,adinfo:a}))})}if(this.report_begin&&this.report_end){var h=this.dataset.playtime;if(h<this.report_begin||h>this.report_end)this.duringFlag=!1;else if(!this.duringFlag){this.duringFlag=!0;var d=a._curCreative&&a._curCreative.creport&&a._curCreative.creport.dreport||{};"1"==this.info.reportRange&&this.message.emit(l.REPORT_EVENT.AD_DURING,{time:0,url:this.info.reportUrl,adinfo:this.info}),(d.reportitem||[]).forEach(function(e,i){t.message.emit(l.REPORT_EVENT.AD_DURING,{time:0,url:e.url,isOther:!0})})}}}else this.stop()}},{key:"pause",value:function(){this.isFilmPausing=!0,this.filmPauseTime=(new Date).getTime(),this.intervalTimer&&this.intervalTimer.running&&this.intervalTimer.stop()}},{key:"stop",value:function(){this.state!=s.END&&(this.hide(),n(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this),this.intervalTimer.stop(),this.message.emit(l.REPORT_EVENT.AD_DP3_CZC,{oid:this.info.order_id,cid:this.info._cre_id,creative_id:this.info._cre_id,adtt:this.intervalTimer.time,sceneid:this.scene.scene_id,startTime:1e3*this.mindPoint.startTime,endTime:1e3*this.mindPoint.endTime,drag:this.hasDragged?1:0}),this.intervalTimer.clear(),this.hasDragged=!1,this.focusMonitor&&(clearInterval(this.focusMonitor),this.focusMonitor=null))}},{key:"seekStart",value:function(t){if(this.mindPoint){t.seekTime;var e=t.currentTimeWhenSeekStart;e>=this.mindPoint.startTime&&e<=this.mindPoint.endTime&&(this.hasDragged=!0)}}},{key:"template",value:function(t){return""}},{key:"_initMindPoint",value:function(){if(this.scene){var t=this.scene,e=t.getStartSec(),i=t.getEndSec(),n=Math.floor((i-e)/4);this.mindPoint={startTime:e,endTime:i,one:e+n,two:e+2*n,three:i-n}}}},{key:"isInFocus",value:function(){if(TxpCreativePlayer.fromPcClient)return!0;try{if(document.hidden!==undefined&&!0===document.hidden)return!1;if(window.top.document.hasFocus)return window.top.document.hasFocus()}catch(t){this.error=t.message,this.DEBUG_MODE&&console.log(t)}return!1}},{key:"isInView",value:function(){if(TxpCreativePlayer.fromPcClient)return!0;var t=document.querySelector("#tenvideo_player");if(!t)return!1;var e=t.getBoundingClientRect(),i=e.left,n=e.top,o=e.width||e.right-e.left,r=e.height||e.bottom-e.top;return i>=0&&n>=0||(o+i)*(r+n)*100/(o*r)>=50}}]),e}();t.exports=u},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function d(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(n===undefined){var o=Object.getPrototypeOf(t);return null===o?undefined:d(o,e,i)}if("value"in n)return n.value;var r=n.get;return r===undefined?undefined:r.call(i)};var r=i(0)("base/VinAd"),a=i(7),s=i(4),l=i(1),h=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),n(e,[{key:"init",value:function(){}},{key:"show",value:function(t){this.isShow||o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"show",this).call(this)}},{key:"hide",value:function(t){this.isShow&&o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"hide",this).call(this)}},{key:"load",value:function(){if(o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"load",this).call(this),this.info&&this.info.reportUrlOther&&this.info.reportUrlOther.reportitem&&this.info.reportUrlOther.reportitem.length>0)for(var t=0,i=this.info.reportUrlOther.reportitem.length;t<i;t++){var n=this.info.reportUrlOther.reportitem[t];n.url&&n.url.replace&&(n.url=n.url.replace("[VIN_ADUNIT]",this.scene.adunit_id).replace("[VIN_BEGINTIME]",this.scene.time))}r.log("report",l.REPORT_EVENT.AD_VIEW),this.message.emit(l.REPORT_EVENT.AD_VIEW,{adInfo:this.info}),this.message.emit(l.REPORT_EVENT.NEW_DP3,{starttime:+new Date,adtype:this.adtype,errorcode:2350,anchorid:this.scene.scene_id,adunit_id:this.scene.adunit_id,adInfo:this.info})}},{key:"play",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"play",this).call(this)}},{key:"pause",value:function(){}},{key:"stop",value:function(){this.state!=s.END&&(this.message.emit(l.REPORT_EVENT.NEW_DP3,{starttime:+new Date,adtype:this.adtype,errorcode:2303,anchorid:this.scene.scene_id,adunit_id:this.scene.adunit_id,adInfo:this.info}),this.hide(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this))}}]),e}();t.exports=h}]);